<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}"
      lang="ja">
<head>
    <title>在庫詳細</title>
</head>
<body>
<div layout:fragment="content">
    <h1 class="page-title">在庫詳細</h1>

    <!-- アクションボタン -->
    <div class="action-buttons">
        <a th:href="@{/inventories}" class="btn btn-secondary">
            一覧に戻る
        </a>
    </div>

    <!-- 基本情報 -->
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">基本情報</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-4">
                    <dl>
                        <dt>倉庫コード</dt>
                        <dd th:text="${inventory.warehouseCode}"></dd>
                    </dl>
                </div>
                <div class="col-md-4">
                    <dl>
                        <dt>商品コード</dt>
                        <dd th:text="${inventory.productCode}"></dd>
                    </dl>
                </div>
                <div class="col-md-4">
                    <dl>
                        <dt>ロケーション</dt>
                        <dd th:text="${inventory.locationCode ?: '-'}"></dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>

    <!-- 在庫数量 -->
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">在庫数量</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3">
                    <dl>
                        <dt>現在庫数</dt>
                        <dd class="fs-4 fw-bold" th:text="${#numbers.formatDecimal(inventory.currentQuantity, 1, 0)}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>引当数</dt>
                        <dd class="fs-4" th:text="${#numbers.formatDecimal(inventory.allocatedQuantity, 1, 0)}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>有効在庫数</dt>
                        <dd class="fs-4"
                            th:class="${inventory.availableQuantity.compareTo(T(java.math.BigDecimal).ZERO) <= 0 ? 'text-danger fw-bold' : 'text-success fw-bold'}"
                            th:text="${#numbers.formatDecimal(inventory.availableQuantity, 1, 0)}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>発注残数</dt>
                        <dd class="fs-4" th:text="${#numbers.formatDecimal(inventory.orderedQuantity, 1, 0)}"></dd>
                    </dl>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-4">
                    <dl>
                        <dt>予定在庫数（有効在庫 + 発注残）</dt>
                        <dd class="fs-5" th:text="${#numbers.formatDecimal(inventory.projectedQuantity, 1, 0)}"></dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>

    <!-- 追加情報 -->
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">追加情報</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3">
                    <dl>
                        <dt>ロット番号</dt>
                        <dd th:text="${inventory.lotNumber ?: '-'}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>シリアル番号</dt>
                        <dd th:text="${inventory.serialNumber ?: '-'}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>有効期限</dt>
                        <dd>
                            <span th:if="${inventory.expirationDate != null}"
                                  th:class="${inventory.expired ? 'text-danger' : ''}"
                                  th:text="${#temporals.format(inventory.expirationDate, 'yyyy/MM/dd')}"></span>
                            <span th:if="${inventory.expirationDate == null}">-</span>
                            <span th:if="${inventory.expired}" class="badge bg-danger ms-2">期限切れ</span>
                        </dd>
                    </dl>
                </div>
            </div>
            <div class="row mt-3">
                <div class="col-md-3">
                    <dl>
                        <dt>最終入庫日</dt>
                        <dd th:text="${inventory.lastReceiptDate != null ? #temporals.format(inventory.lastReceiptDate, 'yyyy/MM/dd') : '-'}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>最終出庫日</dt>
                        <dd th:text="${inventory.lastShipmentDate != null ? #temporals.format(inventory.lastShipmentDate, 'yyyy/MM/dd') : '-'}"></dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>

    <!-- システム情報 -->
    <div class="card">
        <div class="card-header">
            <h5 class="mb-0">システム情報</h5>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col-md-3">
                    <dl>
                        <dt>作成日時</dt>
                        <dd th:text="${inventory.createdAt != null ? #temporals.format(inventory.createdAt, 'yyyy/MM/dd HH:mm') : '-'}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>作成者</dt>
                        <dd th:text="${inventory.createdBy ?: '-'}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>更新日時</dt>
                        <dd th:text="${inventory.updatedAt != null ? #temporals.format(inventory.updatedAt, 'yyyy/MM/dd HH:mm') : '-'}"></dd>
                    </dl>
                </div>
                <div class="col-md-3">
                    <dl>
                        <dt>更新者</dt>
                        <dd th:text="${inventory.updatedBy ?: '-'}"></dd>
                    </dl>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
