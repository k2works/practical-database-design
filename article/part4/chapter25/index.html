
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="基幹業務システム（販売管理・財務会計・生産管理）のデータベース設計を体系的に解説">
      
      
        <meta name="author" content="k2works">
      
      
      
        <link rel="prev" href="../chapter24/">
      
      
        <link rel="next" href="../chapter26/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>第25章 購買管理の設計 - 実践データベース設計：基幹業務システム編</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#25" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-header__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            実践データベース設計：基幹業務システム編
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第25章 購買管理の設計
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  実践データベース設計

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-nav__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    実践データベース設計：基幹業務システム編
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    実践データベース設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    実践データベース設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../techstack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    技術スタック
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    アウトライン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    執筆ワークフロー
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    運用ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../project-setup-instruction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    プロジェクトセットアップ手順書
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    デプロイ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    デプロイ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy-sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SMS デモデプロイ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy-fas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAS デモデプロイ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy-pms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    PMS デモデプロイ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第1部 基幹業務システムの全体像
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    第1部 基幹業務システムの全体像
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第1章 基幹業務システムとは
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第2章 基幹業務システムの業務領域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第3章 業務フローの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第2部 販売管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    第2部 販売管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第4章 販売管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第5章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第6章 受注・出荷・売上の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第7章 債権管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第8章 調達管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第9章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第10章 債務管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第11章 共通処理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第12章 販売管理データ設計（B社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第13章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第3部 財務会計システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    第3部 財務会計システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" checked>
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第4部 生産管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    第4部 生産管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章 生産管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第23章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第24章 生産計画の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    第25章 購買管理の設計
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    第25章 購買管理の設計
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#251-db" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.1 発注業務の DB 設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="25.1 発注業務の DB 設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        発注業務の流れ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        発注業務のデータ関連
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        発注関連のスキーマ設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="発注関連のスキーマ設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        テーブル構造
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        発注ステータスの状態遷移
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        オーダ情報・場所マスタ・単価マスタとの連携
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        諸口品目の扱い
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        納期管理・分納対応
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java エンティティの定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#typehandler" class="md-nav__link">
    <span class="md-ellipsis">
      
        TypeHandler の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mybatis-mapper-xml" class="md-nav__link">
    <span class="md-ellipsis">
      
        MyBatis Mapper XML
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mapper インターフェース
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        発注サービスの実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdd" class="md-nav__link">
    <span class="md-ellipsis">
      
        TDD: 発注データの登録テスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#252-db" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.2 入荷・検収業務の DB 設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="25.2 入荷・検収業務の DB 設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        入荷・受入業務の流れ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        入荷・検収関連のスキーマ設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="入荷・検収関連のスキーマ設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        テーブル構造
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        データの関連
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        発注明細との紐付け
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        入荷受入区分（入荷 / 受入返品）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#java_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Java エンティティの定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mybatis-mapper-xml_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        MyBatis Mapper XML（入荷・検収）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mapper_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mapper インターフェース（入荷・検収）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        コマンドクラス
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      
        入荷検収サービスの実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      
        在庫計上処理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdd_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        TDD: 入荷・検収のテスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#253" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.3 リレーションと楽観ロックの設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="25.3 リレーションと楽観ロックの設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mybatis-resultmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        MyBatis ネストした ResultMap によるリレーション設定
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MyBatis ネストした ResultMap によるリレーション設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resultmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        ネストした ResultMap の定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      
        リレーション設定のポイント
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      
        楽観ロックの実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="楽観ロックの実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flyway" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flyway マイグレーション: バージョンカラム追加
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      
        エンティティへのバージョンフィールド追加
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mybatis-mapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        MyBatis Mapper: 楽観ロック対応の更新
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository" class="md-nav__link">
    <span class="md-ellipsis">
      
        Repository 実装: 楽観ロック対応
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdd_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        TDD: 楽観ロックのテスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      
        入荷・検収処理における楽観ロックの考慮
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="入荷・検収処理における楽観ロックの考慮">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      
        分割入荷時の楽観ロック戦略
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      
        楽観ロックのベストプラクティス（購買管理向け）
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#254" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.4 まとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="25.4 まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      
        学んだこと
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      
        テーブル一覧
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    <span class="md-ellipsis">
      
        ENUM 一覧
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第26章 外注委託管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter27/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第27章 工程管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter28/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第28章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第29章 品質管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter30/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第30章 製造原価管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter31/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第31章 生産管理データ設計（E社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第32章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_12" >
        
          
          <label class="md-nav__link" for="__nav_1_12" id="__nav_1_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第5部 エンタープライズインテグレーション
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    第5部 エンタープライズインテグレーション
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter33/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第33章 システム統合の概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter34/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第34章 メッセージングパターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter35/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第35章 システム間連携パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter36/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第36章 マスタデータ管理（MDM）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter37/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第37章 イベント駆動アーキテクチャ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter38/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第38章 API設計とサービス連携
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter39/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第39章 データ連携の実装パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_13" >
        
          
          <label class="md-nav__link" for="__nav_1_13" id="__nav_1_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 販売管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 販売管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究5 AxonCQRS/ESの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_14" >
        
          
          <label class="md-nav__link" for="__nav_1_14" id="__nav_1_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究5 AxonCQRS/ESの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_15" >
        
          
          <label class="md-nav__link" for="__nav_1_15" id="__nav_1_15_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 生産管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 生産管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究5 AxonCQRS/ESの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_16" >
        
          
          <label class="md-nav__link" for="__nav_1_16" id="__nav_1_16_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システムORM実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システムORM実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter14-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter15-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter16-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter17-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter18-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter19-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter20-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter21-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter22-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章 Axon CQRS/ESの実装【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_17" >
        
          
          <label class="md-nav__link" for="__nav_1_17" id="__nav_1_17_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    付録
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    付録
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/er-diagrams.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A 全体ER図
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/table-definitions.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    B テーブル定義一覧
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/glossary.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C 用語集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_18" >
        
          
          <label class="md-nav__link" for="__nav_1_18" id="__nav_1_18_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    データベース
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_18_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_18">
            <span class="md-nav__icon md-icon"></span>
            
  
    データベース
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/schemaspy-output/sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SchemaSpy ER図（SMS）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/schemaspy-output/fas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SchemaSpy ER図（FAS）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/schemaspy-output/pms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SchemaSpy ER図（PMS）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="25">第25章：購買管理の設計<a class="headerlink" href="#25" title="Permanent link">&para;</a></h1>
<p>本章では、MRP で生成された購買オーダを実際の発注に変換し、入荷・検収までの一連の購買業務を設計します。</p>
<hr />
<h2 id="251-db">25.1 発注業務の DB 設計<a class="headerlink" href="#251-db" title="Permanent link">&para;</a></h2>
<p>発注業務は、購買オーダを基に取引先への発注を行い、納期管理を行う業務です。</p>
<h3 id="_1">発注業務の流れ<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkFDVElWSVRZIiBoZWlnaHQ9IjEwOThweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjEzNDZweDtoZWlnaHQ6MTA5OHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDEzNDYgMTA5OCIgd2lkdGg9IjEzNDZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzAzMzA7JiMyNzg4MDsmIzEyMzYzOyYjMTI0MjU7JiMyNjkwODsmIzIxNDU0OyYjMTI0MTQ7JiMxMjM5MTsmIzEyMzk4OyYjMjY5ODk7JiMyMTIwOTsmIzEyNTAxOyYjMTI1MjU7JiMxMjU0MDs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTUuOTk5MSIgeD0iNTczLjkzMjciIHk9IjMyLjk5NTEiPiYjMzAzMzA7JiMyNzg4MDsmIzEyMzYzOyYjMTI0MjU7JiMyNjkwODsmIzIxNDU0OyYjMTI0MTQ7JiMxMjM5MTsmIzEyMzk4OyYjMjY5ODk7JiMyMTIwOTsmIzEyNTAxOyYjMTI1MjU7JiMxMjU0MDs8L3RleHQ+PC9nPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMjAuOTUzMSIgc3R5bGU9InN0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjEzMTMuODY0NSIgeD0iMTUiIHk9IjUwLjA0MiIvPjxlbGxpcHNlIGN4PSI2NS45OTk3IiBjeT0iODUuOTk1MSIgZmlsbD0iIzIyMjIyMiIgcng9IjEwIiByeT0iMTAiIHN0eWxlPSJzdHJva2U6IzIyMjIyMjtzdHJva2Utd2lkdGg6MTsiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iODAuMDAwNSIgeD0iMjUuOTk5NSIgeT0iMTE1Ljk5NTEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2MC4wMDA1IiB4PSIzNS45OTk1IiB5PSIxMzcuMTMzOCI+JiMxMjQ1ODsmIzEyNTQwOyYjMTI0ODA7JiMyNDc3MzsmIzIyNTc3OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIxNSIgeDI9IjE1IiB5MT0iNTAuMDQyIiB5Mj0iMTA4Ni42MjAxIi8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQ0LjAwMDIiIHg9IjI4OS4wMDAxIiB5PSIxNjkuOTYzOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI0LjAwMDIiIHg9IjI5OS4wMDAxIiB5PSIxOTEuMTAyNSI+JiMzMDMzMDsmIzI3ODgwOzwvdGV4dD48cmVjdCBmaWxsPSIjNTU1NTU1IiBoZWlnaHQ9IjYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzU1NTU1NTtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzNjIuMDAxNCIgeD0iMTIwLjk5OTUiIHk9IjIyMy45MzI2Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjU2LjAwMDMiIHg9IjEzMi45OTk1IiB5PSIyNDkuOTMyNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM2LjAwMDMiIHg9IjE0Mi45OTk1IiB5PSIyNzEuMDcxMyI+JiMyNjkwODsmIzI2NjE5OyYjMzQ5MjA7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI1Ni4wMDAzIiB4PSIxOTguOTk5NyIgeT0iMjQ5LjkzMjYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNi4wMDAzIiB4PSIyMDguOTk5NyIgeT0iMjcxLjA3MTMiPiYjMjk2OTQ7JiMyMTY5NzsmIzMxMDgwOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTYuMDAwMyIgeD0iMjgzIiB5PSIyNDkuOTMyNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM2LjAwMDMiIHg9IjI5MyIgeT0iMjcxLjA3MTMiPiYjMjE0NjM7JiMzODkzNjsmIzI2MzYwOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTYuMDAwMyIgeD0iMzQ5LjAwMDMiIHk9IjI0OS45MzI2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuMDAwMyIgeD0iMzU5LjAwMDMiIHk9IjI3MS4wNzEzIj4mIzMyMDEzOyYjMjE2OTc7JiMyNjM2MDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjU2LjAwMDMiIHg9IjQxNS4wMDA2IiB5PSIyNDkuOTMyNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM2LjAwMDMiIHg9IjQyNS4wMDA2IiB5PSIyNzEuMDcxMyI+JiMyNzg4MDsmIzI1OTkxOyYjMjYzNjA7PC90ZXh0PjxyZWN0IGZpbGw9IiM1NTU1NTUiIGhlaWdodD0iNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojNTU1NTU1O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjM2Mi4wMDE0IiB4PSIxMjAuOTk5NSIgeT0iMzAzLjkwMTQiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNDQuMDAwMiIgeD0iMjg5LjAwMDEiIHk9IjcwMS43NzY0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQuMDAwMiIgeD0iMjk5LjAwMDEiIHk9IjcyMi45MTUiPiYjMjY5MDg7JiMyMTQ1NDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjY4LjAwMDQiIHg9IjIxMC45OTk4IiB5PSI5MjIuNjgyNiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ4LjAwMDQiIHg9IjIyMC45OTk4IiB5PSI5NDMuODIxMyI+JiMyNjkwODsmIzIxNDU0OyYjMzY4MjA7JiMyMTY5Nzs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMTE0Ljk5OTUiIHgyPSIxMTQuOTk5NSIgeTE9IjUwLjA0MiIgeTI9IjEwODYuNjIwMSIvPjxyZWN0IGZpbGw9IiM1NTU1NTUiIGhlaWdodD0iNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojNTU1NTU1O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjM2Mi4wMDE0IiB4PSI0OTMuMDAwOCIgeT0iMzI5LjkwMTQiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTYuMDAwMyIgeD0iNTA1LjAwMDgiIHk9IjM1NS45MDE0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuMDAwMyIgeD0iNTE1LjAwMDgiIHk9IjM3Ny4wNCI+JiMyNjkwODsmIzI2NjE5OyYjMzQ5MjA7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI1Ni4wMDAzIiB4PSI1NzEuMDAxMSIgeT0iMzU1LjkwMTQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNi4wMDAzIiB4PSI1ODEuMDAxMSIgeT0iMzc3LjA0Ij4mIzI5Njk0OyYjMjE2OTc7JiMzMTA4MDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjU2LjAwMDMiIHg9IjY1NS4wMDE0IiB5PSIzNTUuOTAxNCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM2LjAwMDMiIHg9IjY2NS4wMDE0IiB5PSIzNzcuMDQiPiYjMjE0NjM7JiMzODkzNjsmIzI2MzYwOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTYuMDAwMyIgeD0iNzIxLjAwMTciIHk9IjM1NS45MDE0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuMDAwMyIgeD0iNzMxLjAwMTciIHk9IjM3Ny4wNCI+JiMzMjAxMzsmIzIxNjk3OyYjMjYzNjA7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI1Ni4wMDAzIiB4PSI3ODcuMDAxOSIgeT0iMzU1LjkwMTQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNi4wMDAzIiB4PSI3OTcuMDAxOSIgeT0iMzc3LjA0Ij4mIzI3ODgwOyYjMjU5OTE7JiMyNjM2MDs8L3RleHQ+PHJlY3QgZmlsbD0iIzU1NTU1NSIgaGVpZ2h0PSI2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiM1NTU1NTU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMzYyLjAwMTQiIHg9IjQ5My4wMDA4IiB5PSI0MDkuODcwMSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0NC4wMDAyIiB4PSI2NjEuMDAxNCIgeT0iNDM1Ljg3MDEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNC4wMDAyIiB4PSI2NzEuMDAxNCIgeT0iNDU3LjAwODgiPiYjMjY0NDg7JiMyNjAwOTs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQ0LjAwMDIiIHg9IjU5NS4wMDEyIiB5PSI4NTMuNzEzOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI0LjAwMDIiIHg9IjYwNS4wMDEyIiB5PSI4NzQuODUyNSI+JiMyNjQ0ODsmIzI2MDA5OzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjguMDAwNCIgeD0iNTgzLjAwMTEiIHk9Ijk3Ni42NTE0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iNTkzLjAwMTEiIHk9Ijk5Ny43OSI+JiMzNjgyMDsmIzIxNjk3OyYjMzY4OTA7JiMzMDY5Mzs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iNDg3LjAwMDgiIHgyPSI0ODcuMDAwOCIgeTE9IjUwLjA0MiIgeTI9IjEwODYuNjIwMSIvPjxyZWN0IGZpbGw9IiM1NTU1NTUiIGhlaWdodD0iNiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojNTU1NTU1O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjE1NC4wMDA1IiB4PSI4NjUuMDAyMiIgeT0iNDg5LjgzODkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTYuMDAwMyIgeD0iODc3LjAwMjIiIHk9IjUxNS44Mzg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuMDAwMyIgeD0iODg3LjAwMjIiIHk9IjUzNi45Nzc1Ij4mIzI5Njk0OyYjMjE2OTc7JiMzNDkyMDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQ0LjAwMDIiIHg9Ijk2MS4wMDI1IiB5PSI1MTUuODM4OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI0LjAwMDIiIHg9Ijk3MS4wMDI1IiB5PSI1MzYuOTc3NSI+JiMyNjQ0ODsmIzI2MDA5OzwvdGV4dD48cmVjdCBmaWxsPSIjNTU1NTU1IiBoZWlnaHQ9IjYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzU1NTU1NTtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIxNTQuMDAwNSIgeD0iODY1LjAwMjIiIHk9IjU2OS44MDc2Ii8+PHJlY3QgZmlsbD0iIzU1NTU1NSIgaGVpZ2h0PSI2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiM1NTU1NTU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTU0LjAwMDUiIHg9IjkyOS4wMDI0IiB5PSI4NTMuNzEzOSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI1Ni4wMDAzIiB4PSI5NDMuMDAyNCIgeT0iODc5LjcxMzkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNi4wMDAzIiB4PSI5NTMuMDAyNCIgeT0iOTAwLjg1MjUiPiYjMjk2OTQ7JiMyMTY5NzsmIzM0OTIwOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNDQuMDAwMiIgeD0iMTAyNy4wMDI3IiB5PSI4NzkuNzEzOSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI0LjAwMDIiIHg9IjEwMzcuMDAyNyIgeT0iOTAwLjg1MjUiPiYjMjY0NDg7JiMyNjAwOTs8L3RleHQ+PHJlY3QgZmlsbD0iIzU1NTU1NSIgaGVpZ2h0PSI2IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiM1NTU1NTU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTU0LjAwMDUiIHg9IjkyOS4wMDI0IiB5PSI5MzMuNjgyNiIvPjxlbGxpcHNlIGN4PSI5NDEuMDAyNCIgY3k9IjEwNzUuNjIwMSIgZmlsbD0ibm9uZSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzIyMjIyMjtzdHJva2Utd2lkdGg6MTsiLz48ZWxsaXBzZSBjeD0iOTQxLjAwMjQiIGN5PSIxMDc1LjYyMDEiIGZpbGw9IiMyMjIyMjIiIHJ4PSI2IiByeT0iNiIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9Ijg1OS4wMDIyIiB4Mj0iODU5LjAwMjIiIHkxPSI1MC4wNDIiIHkyPSIxMDg2LjYyMDEiLz48cmVjdCBmaWxsPSIjNTU1NTU1IiBoZWlnaHQ9IjYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzU1NTU1NTtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyMzAuMDAwOCIgeD0iMTA5My4wMDI5IiB5PSI1OTUuODA3NiIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI1Ni4wMDAzIiB4PSIxMTA1LjAwMjkiIHk9IjYyMS44MDc2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuMDAwMyIgeD0iMTExNS4wMDI5IiB5PSI2NDIuOTQ2MyI+JiMyOTY5NDsmIzIxNjk3OyYjMzQ5MjA7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0NC4wMDAyIiB4PSIxMTgzLjAwMzIiIHk9IjYyMS44MDc2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjQuMDAwMiIgeD0iMTE5My4wMDMyIiB5PSI2NDIuOTQ2MyI+JiMyNjQ0ODsmIzI2MDA5OzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTYuMDAwMyIgeD0iMTI1NS4wMDM0IiB5PSI2MjEuODA3NiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM2LjAwMDMiIHg9IjEyNjUuMDAzNCIgeT0iNjQyLjk0NjMiPiYjMjY5MDg7JiMyNjYxOTsmIzM0OTIwOzwvdGV4dD48cmVjdCBmaWxsPSIjNTU1NTU1IiBoZWlnaHQ9IjYiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzU1NTU1NTtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyMzAuMDAwOCIgeD0iMTA5My4wMDI5IiB5PSI2NzUuNzc2NCIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI2OC4wMDA0IiB4PSIxMTcxLjAwMzIiIHk9Ijc1NS43NDUxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iMTE4MS4wMDMyIiB5PSI3NzYuODgzOCI+JiMyMTQ2MzsmIzIwODM3OyYjMjY5MDg7JiMyNjYxOTs8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0YxRjFGMSIgcG9pbnRzPSIxMTg4LjUwMzQsODA5LjcxMzksMTIyMS41MDMyLDgwOS43MTM5LDEyMzMuNTAzMiw4MjEuNzEzOSwxMjIxLjUwMzIsODMzLjcxMzksMTE4OC41MDM0LDgzMy43MTM5LDExNzYuNTAzNCw4MjEuNzEzOSwxMTg4LjUwMzQsODA5LjcxMzkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMyLjk5OTgiIHg9IjExODguNTAzNCIgeT0iODI1LjUyMiI+JiMxOTk4MTsmIzMzMzkxOyYjMjE2OTc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMyLjk5OTgiIHg9IjEyMzMuNTAzMiIgeT0iODE5LjExOTYiPiYjMjE1MTI7JiMyNjY4NDsmIzIxNjk3OzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9IjEyMDUuMDAzMywxMDIwLjYyMDEsMTIxNy4wMDMzLDEwMzIuNjIwMSwxMjA1LjAwMzMsMTA0NC42MjAxLDExOTMuMDAzMywxMDMyLjYyMDEsMTIwNS4wMDMzLDEwMjAuNjIwMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMTA4Ny4wMDI5IiB4Mj0iMTA4Ny4wMDI5IiB5MT0iNTAuMDQyIiB5Mj0iMTA4Ni42MjAxIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMTMyNy4wMDM3IiB4Mj0iMTMyNy4wMDM3IiB5MT0iNTAuMDQyIiB5Mj0iMTA4Ni42MjAxIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY1Ljk5OTciIHgyPSI2NS45OTk3IiB5MT0iOTUuOTk1MSIgeTI9IjExNS45OTUxIi8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2MS45OTk3LDEwNS45OTUxLDY1Ljk5OTcsMTE1Ljk5NTEsNjkuOTk5NywxMDUuOTk1MSw2NS45OTk3LDEwOS45OTUxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE2MC45OTk2IiB4Mj0iMTYwLjk5OTYiIHkxPSIyMjkuOTMyNiIgeTI9IjI0OS45MzI2Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxNTYuOTk5NiwyMzkuOTMyNiwxNjAuOTk5NiwyNDkuOTMyNiwxNjQuOTk5NiwyMzkuOTMyNiwxNjAuOTk5NiwyNDMuOTMyNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyMjYuOTk5OSIgeDI9IjIyNi45OTk5IiB5MT0iMjI5LjkzMjYiIHkyPSIyNDkuOTMyNiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjIyLjk5OTksMjM5LjkzMjYsMjI2Ljk5OTksMjQ5LjkzMjYsMjMwLjk5OTksMjM5LjkzMjYsMjI2Ljk5OTksMjQzLjkzMjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzExLjAwMDIiIHgyPSIzMTEuMDAwMiIgeTE9IjIyOS45MzI2IiB5Mj0iMjQ5LjkzMjYiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjMwNy4wMDAyLDIzOS45MzI2LDMxMS4wMDAyLDI0OS45MzI2LDMxNS4wMDAyLDIzOS45MzI2LDMxMS4wMDAyLDI0My45MzI2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjM3Ny4wMDA0IiB4Mj0iMzc3LjAwMDQiIHkxPSIyMjkuOTMyNiIgeTI9IjI0OS45MzI2Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNzMuMDAwNCwyMzkuOTMyNiwzNzcuMDAwNCwyNDkuOTMyNiwzODEuMDAwNCwyMzkuOTMyNiwzNzcuMDAwNCwyNDMuOTMyNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI0NDMuMDAwNyIgeDI9IjQ0My4wMDA3IiB5MT0iMjI5LjkzMjYiIHkyPSIyNDkuOTMyNiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDM5LjAwMDcsMjM5LjkzMjYsNDQzLjAwMDcsMjQ5LjkzMjYsNDQ3LjAwMDcsMjM5LjkzMjYsNDQzLjAwMDcsMjQzLjkzMjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTYwLjk5OTYiIHgyPSIxNjAuOTk5NiIgeTE9IjI4My45MDE0IiB5Mj0iMzAzLjkwMTQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE1Ni45OTk2LDI5My45MDE0LDE2MC45OTk2LDMwMy45MDE0LDE2NC45OTk2LDI5My45MDE0LDE2MC45OTk2LDI5Ny45MDE0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyNi45OTk5IiB4Mj0iMjI2Ljk5OTkiIHkxPSIyODMuOTAxNCIgeTI9IjMwMy45MDE0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMjIuOTk5OSwyOTMuOTAxNCwyMjYuOTk5OSwzMDMuOTAxNCwyMzAuOTk5OSwyOTMuOTAxNCwyMjYuOTk5OSwyOTcuOTAxNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMTEuMDAwMiIgeDI9IjMxMS4wMDAyIiB5MT0iMjgzLjkwMTQiIHkyPSIzMDMuOTAxNCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzA3LjAwMDIsMjkzLjkwMTQsMzExLjAwMDIsMzAzLjkwMTQsMzE1LjAwMDIsMjkzLjkwMTQsMzExLjAwMDIsMjk3LjkwMTQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzc3LjAwMDQiIHgyPSIzNzcuMDAwNCIgeTE9IjI4My45MDE0IiB5Mj0iMzAzLjkwMTQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM3My4wMDA0LDI5My45MDE0LDM3Ny4wMDA0LDMwMy45MDE0LDM4MS4wMDA0LDI5My45MDE0LDM3Ny4wMDA0LDI5Ny45MDE0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ0My4wMDA3IiB4Mj0iNDQzLjAwMDciIHkxPSIyODMuOTAxNCIgeTI9IjMwMy45MDE0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0MzkuMDAwNywyOTMuOTAxNCw0NDMuMDAwNywzMDMuOTAxNCw0NDcuMDAwNywyOTMuOTAxNCw0NDMuMDAwNywyOTcuOTAxNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMTEuMDAwMiIgeDI9IjMxMS4wMDAyIiB5MT0iMjAzLjkzMjYiIHkyPSIyMjMuOTMyNiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzA3LjAwMDIsMjEzLjkzMjYsMzExLjAwMDIsMjIzLjkzMjYsMzE1LjAwMDIsMjEzLjkzMjYsMzExLjAwMDIsMjE3LjkzMjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTMzLjAwMSIgeDI9IjUzMy4wMDEiIHkxPSIzMzUuOTAxNCIgeTI9IjM1NS45MDE0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1MjkuMDAxLDM0NS45MDE0LDUzMy4wMDEsMzU1LjkwMTQsNTM3LjAwMSwzNDUuOTAxNCw1MzMuMDAxLDM0OS45MDE0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjU5OS4wMDEzIiB4Mj0iNTk5LjAwMTMiIHkxPSIzMzUuOTAxNCIgeTI9IjM1NS45MDE0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1OTUuMDAxMywzNDUuOTAxNCw1OTkuMDAxMywzNTUuOTAxNCw2MDMuMDAxMywzNDUuOTAxNCw1OTkuMDAxMywzNDkuOTAxNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2ODMuMDAxNSIgeDI9IjY4My4wMDE1IiB5MT0iMzM1LjkwMTQiIHkyPSIzNTUuOTAxNCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNjc5LjAwMTUsMzQ1LjkwMTQsNjgzLjAwMTUsMzU1LjkwMTQsNjg3LjAwMTUsMzQ1LjkwMTQsNjgzLjAwMTUsMzQ5LjkwMTQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNzQ5LjAwMTgiIHgyPSI3NDkuMDAxOCIgeTE9IjMzNS45MDE0IiB5Mj0iMzU1LjkwMTQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijc0NS4wMDE4LDM0NS45MDE0LDc0OS4wMDE4LDM1NS45MDE0LDc1My4wMDE4LDM0NS45MDE0LDc0OS4wMDE4LDM0OS45MDE0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjgxNS4wMDIxIiB4Mj0iODE1LjAwMjEiIHkxPSIzMzUuOTAxNCIgeTI9IjM1NS45MDE0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI4MTEuMDAyMSwzNDUuOTAxNCw4MTUuMDAyMSwzNTUuOTAxNCw4MTkuMDAyMSwzNDUuOTAxNCw4MTUuMDAyMSwzNDkuOTAxNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI1MzMuMDAxIiB4Mj0iNTMzLjAwMSIgeTE9IjM4OS44NzAxIiB5Mj0iNDA5Ljg3MDEiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjUyOS4wMDEsMzk5Ljg3MDEsNTMzLjAwMSw0MDkuODcwMSw1MzcuMDAxLDM5OS44NzAxLDUzMy4wMDEsNDAzLjg3MDEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTk5LjAwMTMiIHgyPSI1OTkuMDAxMyIgeTE9IjM4OS44NzAxIiB5Mj0iNDA5Ljg3MDEiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU5NS4wMDEzLDM5OS44NzAxLDU5OS4wMDEzLDQwOS44NzAxLDYwMy4wMDEzLDM5OS44NzAxLDU5OS4wMDEzLDQwMy44NzAxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY4My4wMDE1IiB4Mj0iNjgzLjAwMTUiIHkxPSIzODkuODcwMSIgeTI9IjQwOS44NzAxIi8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2NzkuMDAxNSwzOTkuODcwMSw2ODMuMDAxNSw0MDkuODcwMSw2ODcuMDAxNSwzOTkuODcwMSw2ODMuMDAxNSw0MDMuODcwMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI3NDkuMDAxOCIgeDI9Ijc0OS4wMDE4IiB5MT0iMzg5Ljg3MDEiIHkyPSI0MDkuODcwMSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNzQ1LjAwMTgsMzk5Ljg3MDEsNzQ5LjAwMTgsNDA5Ljg3MDEsNzUzLjAwMTgsMzk5Ljg3MDEsNzQ5LjAwMTgsNDAzLjg3MDEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iODE1LjAwMjEiIHgyPSI4MTUuMDAyMSIgeTE9IjM4OS44NzAxIiB5Mj0iNDA5Ljg3MDEiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjgxMS4wMDIxLDM5OS44NzAxLDgxNS4wMDIxLDQwOS44NzAxLDgxOS4wMDIxLDM5OS44NzAxLDgxNS4wMDIxLDQwMy44NzAxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY4My4wMDE1IiB4Mj0iNjgzLjAwMTUiIHkxPSI0MTUuODcwMSIgeTI9IjQzNS44NzAxIi8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2NzkuMDAxNSw0MjUuODcwMSw2ODMuMDAxNSw0MzUuODcwMSw2ODcuMDAxNSw0MjUuODcwMSw2ODMuMDAxNSw0MjkuODcwMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5MDUuMDAyMyIgeDI9IjkwNS4wMDIzIiB5MT0iNDk1LjgzODkiIHkyPSI1MTUuODM4OSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iOTAxLjAwMjMsNTA1LjgzODksOTA1LjAwMjMsNTE1LjgzODksOTA5LjAwMjMsNTA1LjgzODksOTA1LjAwMjMsNTA5LjgzODkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iOTgzLjAwMjYiIHgyPSI5ODMuMDAyNiIgeTE9IjQ5NS44Mzg5IiB5Mj0iNTE1LjgzODkiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijk3OS4wMDI2LDUwNS44Mzg5LDk4My4wMDI2LDUxNS44Mzg5LDk4Ny4wMDI2LDUwNS44Mzg5LDk4My4wMDI2LDUwOS44Mzg5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjkwNS4wMDIzIiB4Mj0iOTA1LjAwMjMiIHkxPSI1NDkuODA3NiIgeTI9IjU2OS44MDc2Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI5MDEuMDAyMyw1NTkuODA3Niw5MDUuMDAyMyw1NjkuODA3Niw5MDkuMDAyMyw1NTkuODA3Niw5MDUuMDAyMyw1NjMuODA3NiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5ODMuMDAyNiIgeDI9Ijk4My4wMDI2IiB5MT0iNTQ5LjgwNzYiIHkyPSI1NjkuODA3NiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iOTc5LjAwMjYsNTU5LjgwNzYsOTgzLjAwMjYsNTY5LjgwNzYsOTg3LjAwMjYsNTU5LjgwNzYsOTgzLjAwMjYsNTYzLjgwNzYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iOTcxLjAwMjYiIHgyPSI5NzEuMDAyNiIgeTE9Ijg1OS43MTM5IiB5Mj0iODc5LjcxMzkiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijk2Ny4wMDI2LDg2OS43MTM5LDk3MS4wMDI2LDg3OS43MTM5LDk3NS4wMDI2LDg2OS43MTM5LDk3MS4wMDI2LDg3My43MTM5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEwNDkuMDAyOCIgeDI9IjEwNDkuMDAyOCIgeTE9Ijg1OS43MTM5IiB5Mj0iODc5LjcxMzkiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjEwNDUuMDAyOCw4NjkuNzEzOSwxMDQ5LjAwMjgsODc5LjcxMzksMTA1My4wMDI4LDg2OS43MTM5LDEwNDkuMDAyOCw4NzMuNzEzOSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5NzEuMDAyNiIgeDI9Ijk3MS4wMDI2IiB5MT0iOTEzLjY4MjYiIHkyPSI5MzMuNjgyNiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iOTY3LjAwMjYsOTIzLjY4MjYsOTcxLjAwMjYsOTMzLjY4MjYsOTc1LjAwMjYsOTIzLjY4MjYsOTcxLjAwMjYsOTI3LjY4MjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTA0OS4wMDI4IiB4Mj0iMTA0OS4wMDI4IiB5MT0iOTEzLjY4MjYiIHkyPSI5MzMuNjgyNiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTA0NS4wMDI4LDkyMy42ODI2LDEwNDkuMDAyOCw5MzMuNjgyNiwxMDUzLjAwMjgsOTIzLjY4MjYsMTA0OS4wMDI4LDkyNy42ODI2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjExMzMuMDAzIiB4Mj0iMTEzMy4wMDMiIHkxPSI2MDEuODA3NiIgeTI9IjYyMS44MDc2Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMTI5LjAwMyw2MTEuODA3NiwxMTMzLjAwMyw2MjEuODA3NiwxMTM3LjAwMyw2MTEuODA3NiwxMTMzLjAwMyw2MTUuODA3NiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjA1LjAwMzMiIHgyPSIxMjA1LjAwMzMiIHkxPSI2MDEuODA3NiIgeTI9IjYyMS44MDc2Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMjAxLjAwMzMsNjExLjgwNzYsMTIwNS4wMDMzLDYyMS44MDc2LDEyMDkuMDAzMyw2MTEuODA3NiwxMjA1LjAwMzMsNjE1LjgwNzYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTI4My4wMDM2IiB4Mj0iMTI4My4wMDM2IiB5MT0iNjAxLjgwNzYiIHkyPSI2MjEuODA3NiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTI3OS4wMDM2LDYxMS44MDc2LDEyODMuMDAzNiw2MjEuODA3NiwxMjg3LjAwMzYsNjExLjgwNzYsMTI4My4wMDM2LDYxNS44MDc2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjExMzMuMDAzIiB4Mj0iMTEzMy4wMDMiIHkxPSI2NTUuNzc2NCIgeTI9IjY3NS43NzY0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMTI5LjAwMyw2NjUuNzc2NCwxMTMzLjAwMyw2NzUuNzc2NCwxMTM3LjAwMyw2NjUuNzc2NCwxMTMzLjAwMyw2NjkuNzc2NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjA1LjAwMzMiIHgyPSIxMjA1LjAwMzMiIHkxPSI2NTUuNzc2NCIgeTI9IjY3NS43NzY0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMjAxLjAwMzMsNjY1Ljc3NjQsMTIwNS4wMDMzLDY3NS43NzY0LDEyMDkuMDAzMyw2NjUuNzc2NCwxMjA1LjAwMzMsNjY5Ljc3NjQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTI4My4wMDM2IiB4Mj0iMTI4My4wMDM2IiB5MT0iNjU1Ljc3NjQiIHkyPSI2NzUuNzc2NCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTI3OS4wMDM2LDY2NS43NzY0LDEyODMuMDAzNiw2NzUuNzc2NCwxMjg3LjAwMzYsNjY1Ljc3NjQsMTI4My4wMDM2LDY2OS43NzY0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMDUuMDAzMyIgeDI9IjEyMDUuMDAzMyIgeTE9Ijc4OS43MTM5IiB5Mj0iODA5LjcxMzkiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjEyMDEuMDAzMyw3OTkuNzEzOSwxMjA1LjAwMzMsODA5LjcxMzksMTIwOS4wMDMzLDc5OS43MTM5LDEyMDUuMDAzMyw4MDMuNzEzOSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2NS45OTk3IiB4Mj0iNjUuOTk5NyIgeTE9IjE0OS45NjM5IiB5Mj0iMTU0Ljk2MzkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjUuOTk5NyIgeDI9IjMxMS4wMDAyIiB5MT0iMTU0Ljk2MzkiIHkyPSIxNTQuOTYzOSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMTEuMDAwMiIgeDI9IjMxMS4wMDAyIiB5MT0iMTU0Ljk2MzkiIHkyPSIxNjkuOTYzOSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzA3LjAwMDIsMTU5Ljk2MzksMzExLjAwMDIsMTY5Ljk2MzksMzE1LjAwMDIsMTU5Ljk2MzksMzExLjAwMDIsMTYzLjk2MzkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzExLjAwMDIiIHgyPSIzMTEuMDAwMiIgeTE9IjMwOS45MDE0IiB5Mj0iMzE0LjkwMTQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzExLjAwMDIiIHgyPSI2ODMuMDAxNSIgeTE9IjMxNC45MDE0IiB5Mj0iMzE0LjkwMTQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjgzLjAwMTUiIHgyPSI2ODMuMDAxNSIgeTE9IjMxNC45MDE0IiB5Mj0iMzI5LjkwMTQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjY3OS4wMDE1LDMxOS45MDE0LDY4My4wMDE1LDMyOS45MDE0LDY4Ny4wMDE1LDMxOS45MDE0LDY4My4wMDE1LDMyMy45MDE0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY4My4wMDE1IiB4Mj0iNjgzLjAwMTUiIHkxPSI0NjkuODM4OSIgeTI9IjQ3NC44Mzg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY4My4wMDE1IiB4Mj0iOTQxLjAwMjQiIHkxPSI0NzQuODM4OSIgeTI9IjQ3NC44Mzg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9Ijk0MS4wMDI0IiB4Mj0iOTQxLjAwMjQiIHkxPSI0NzQuODM4OSIgeTI9IjQ4OS44Mzg5Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI5MzcuMDAyNCw0NzkuODM4OSw5NDEuMDAyNCw0ODkuODM4OSw5NDUuMDAyNCw0NzkuODM4OSw5NDEuMDAyNCw0ODMuODM4OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5NDEuMDAyNCIgeDI9Ijk0MS4wMDI0IiB5MT0iNTc1LjgwNzYiIHkyPSI1ODAuODA3NiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5NDEuMDAyNCIgeDI9IjEyMDUuMDAzMyIgeTE9IjU4MC44MDc2IiB5Mj0iNTgwLjgwNzYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwNS4wMDMzIiB4Mj0iMTIwNS4wMDMzIiB5MT0iNTgwLjgwNzYiIHkyPSI1OTUuODA3NiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTIwMS4wMDMzLDU4NS44MDc2LDEyMDUuMDAzMyw1OTUuODA3NiwxMjA5LjAwMzMsNTg1LjgwNzYsMTIwNS4wMDMzLDU4OS44MDc2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMDUuMDAzMyIgeDI9IjEyMDUuMDAzMyIgeTE9IjY4MS43NzY0IiB5Mj0iNjg2Ljc3NjQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwNS4wMDMzIiB4Mj0iMzExLjAwMDIiIHkxPSI2ODYuNzc2NCIgeTI9IjY4Ni43NzY0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjMxMS4wMDAyIiB4Mj0iMzExLjAwMDIiIHkxPSI2ODYuNzc2NCIgeTI9IjcwMS43NzY0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzMDcuMDAwMiw2OTEuNzc2NCwzMTEuMDAwMiw3MDEuNzc2NCwzMTUuMDAwMiw2OTEuNzc2NCwzMTEuMDAwMiw2OTUuNzc2NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMTEuMDAwMiIgeDI9IjMxMS4wMDAyIiB5MT0iNzM1Ljc0NTEiIHkyPSI3NDAuNzQ1MSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMTEuMDAwMiIgeDI9IjEyMDUuMDAzMyIgeTE9Ijc0MC43NDUxIiB5Mj0iNzQwLjc0NTEiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwNS4wMDMzIiB4Mj0iMTIwNS4wMDMzIiB5MT0iNzQwLjc0NTEiIHkyPSI3NTUuNzQ1MSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTIwMS4wMDMzLDc0NS43NDUxLDEyMDUuMDAzMyw3NTUuNzQ1MSwxMjA5LjAwMzMsNzQ1Ljc0NTEsMTIwNS4wMDMzLDc0OS43NDUxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjYxNy4wMDEzIiB4Mj0iNjE3LjAwMTMiIHkxPSI4ODcuNjgyNiIgeTI9IjkwNS4xODI2Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjYxNy4wMDEzIiB4Mj0iMjQ0Ljk5OTkiIHkxPSI5MDUuMTgyNiIgeTI9IjkwNS4xODI2Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI0NC45OTk5IiB4Mj0iMjQ0Ljk5OTkiIHkxPSI5MDUuMTgyNiIgeTI9IjkyMi42ODI2Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyNDAuOTk5OSw5MTIuNjgyNiwyNDQuOTk5OSw5MjIuNjgyNiwyNDguOTk5OSw5MTIuNjgyNiwyNDQuOTk5OSw5MTYuNjgyNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyNDQuOTk5OSIgeDI9IjI0NC45OTk5IiB5MT0iOTU2LjY1MTQiIHkyPSI5NjEuNjUxNCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyNDQuOTk5OSIgeDI9IjYxNy4wMDEzIiB5MT0iOTYxLjY1MTQiIHkyPSI5NjEuNjUxNCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2MTcuMDAxMyIgeDI9IjYxNy4wMDEzIiB5MT0iOTYxLjY1MTQiIHkyPSI5NzYuNjUxNCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNjEzLjAwMTMsOTY2LjY1MTQsNjE3LjAwMTMsOTc2LjY1MTQsNjIxLjAwMTMsOTY2LjY1MTQsNjE3LjAwMTMsOTcwLjY1MTQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTE3Ni41MDM0IiB4Mj0iNjE3LjAwMTMiIHkxPSI4MjEuNzEzOSIgeTI9IjgyMS43MTM5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjYxNy4wMDEzIiB4Mj0iNjE3LjAwMTMiIHkxPSI4MjEuNzEzOSIgeTI9Ijg1My43MTM5Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2MTMuMDAxMyw4NDMuNzEzOSw2MTcuMDAxMyw4NTMuNzEzOSw2MjEuMDAxMyw4NDMuNzEzOSw2MTcuMDAxMyw4NDcuNzEzOSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjMzLjUwMzIiIHgyPSIxMjQ1LjUwMzIiIHkxPSI4MjEuNzEzOSIgeTI9IjgyMS43MTM5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyNDUuNTAzMiIgeDI9IjEyNDUuNTAzMiIgeTE9IjgyMS43MTM5IiB5Mj0iODM5LjcxMzkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTI0NS41MDMyIiB4Mj0iMTAwNy4wMDI2IiB5MT0iODM5LjcxMzkiIHkyPSI4MzkuNzEzOSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMDA3LjAwMjYiIHgyPSIxMDA3LjAwMjYiIHkxPSI4MzkuNzEzOSIgeTI9Ijg1My43MTM5Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMDAzLjAwMjYsODQzLjcxMzksMTAwNy4wMDI2LDg1My43MTM5LDEwMTEuMDAyNiw4NDMuNzEzOSwxMDA3LjAwMjYsODQ3LjcxMzkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjE3LjAwMTMiIHgyPSI2MTcuMDAxMyIgeTE9IjEwMTAuNjIwMSIgeTI9IjEwMzIuNjIwMSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2MTcuMDAxMyIgeDI9IjExOTMuMDAzMyIgeTE9IjEwMzIuNjIwMSIgeTI9IjEwMzIuNjIwMSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTE4My4wMDMzLDEwMjguNjIwMSwxMTkzLjAwMzMsMTAzMi42MjAxLDExODMuMDAzMywxMDM2LjYyMDEsMTE4Ny4wMDMzLDEwMzIuNjIwMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMDA3LjAwMjYiIHgyPSIxMDA3LjAwMjYiIHkxPSI5MzkuNjgyNiIgeTI9IjEwMTQuNjIwMSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMDA3LjAwMjYiIHgyPSIxMjM1LjAwMzMiIHkxPSIxMDE0LjYyMDEiIHkyPSIxMDE0LjYyMDEiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIzNS4wMDMzIiB4Mj0iMTIzNS4wMDMzIiB5MT0iMTAxNC42MjAxIiB5Mj0iMTAzMi42MjAxIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMzUuMDAzMyIgeDI9IjEyMTcuMDAzMyIgeTE9IjEwMzIuNjIwMSIgeTI9IjEwMzIuNjIwMSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTIyNy4wMDMzLDEwMjguNjIwMSwxMjE3LjAwMzMsMTAzMi42MjAxLDEyMjcuMDAzMywxMDM2LjYyMDEsMTIyMy4wMDMzLDEwMzIuNjIwMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjA1LjAwMzMiIHgyPSIxMjA1LjAwMzMiIHkxPSIxMDQ0LjYyMDEiIHkyPSIxMDQ5LjYyMDEiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwNS4wMDMzIiB4Mj0iOTQxLjAwMjQiIHkxPSIxMDQ5LjYyMDEiIHkyPSIxMDQ5LjYyMDEiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iOTQxLjAwMjQiIHgyPSI5NDEuMDAyNCIgeTE9IjEwNDkuNjIwMSIgeTI9IjEwNjQuNjIwMSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iOTM3LjAwMjQsMTA1NC42MjAxLDk0MS4wMDI0LDEwNjQuNjIwMSw5NDUuMDAyNCwxMDU0LjYyMDEsOTQxLjAwMjQsMTA1OC42MjAxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODkuOTk5NSIgeD0iMjAiIHk9IjY2Ljc1Ij4mIzI5OTgzOyYjMjk5ODc7JiMzMTY0OTsmIzI5NzAyOyYjMzcwOTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUzLjk5OTciIHg9IjI3NC4wMDAzIiB5PSI2Ni43NSI+JiMzNjA5MjsmIzM2MDIzOyYjMzcwOTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUzLjk5OTciIHg9IjY0Ni4wMDE3IiB5PSI2Ni43NSI+JiMyMDE4MTsmIzIwODM3OyYjMjA4MDg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcxLjk5OTYiIHg9IjkzNy4wMDI4IiB5PSI2Ni43NSI+JiMzNjAzOTsmIzI2NDQ4OyYjMjA0ODk7JiMyNDIzNTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODkuOTk5NSIgeD0iMTE2Mi4wMDM2IiB5PSI2Ni43NSI+JiMyMTY5NzsmIzM2MDc0OyYjMzE2NDk7JiMyOTcwMjsmIzM3MDk2OzwvdGV4dD48P3BsYW50dW1sLXNyYyBuUDlGSmk5MDZDTnRTdWVreUdoalFQZk9qOTRLMHJyc0dQYVdEMEpSbjhCTUZtNllaR0czSGFpWTBPQTc2TVFjbE9LVlpiS2VCNG5TazlaNWxGcGNVc19VWkFjUjFLdFltT241MHM4dElUTFgzeFZLRklWc2FqWUZuMXdwUzRJUjBTNWpXYVM0Qm4yb2tEX2JfWnFWenhidGJrMjFYU2djTVpBSEpBZjMwMFlrQzVvWmxIUzVxM1hRbkF6bGR2MGlGMUlLQnZQRWEwbWtoM2tGLXItMmYxd2ZrVzZHa3dHTkRXeXBDZEtsYXp1TGt2YmN3NGFCdzFxUFI1WWRfWURoblk1YU1TdFJqMVJJTWlGd2ZtV29rX0RPOW4yenI2NTNBbXdURlFMblhFekVkRkpHbmF0TU0zSlNVODNWM3FZcnBETjV0Q3RONGh6MHNVVXNoV0FRNTNDS2ZFVWJ0NmhRWWZyZDgweWF5cldwamloLTNoMWRWbHBrbW81YmNuVFlLaGRjdEwxMU1nNmlJSmRnRExYbGlKUnVNdGNtejNueXNFQmYxbTAwPz48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_2">発注業務のデータ関連<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h3>
<p>発注業務では、オーダ情報を基に発注データを生成し、単価マスタを参照して発注金額を計算します。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjUwOHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MzYycHg7aGVpZ2h0OjUwOHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM2MiA1MDgiIHdpZHRoPSIzNjJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzAzMzA7JiMyNzg4MDsmIzI2OTg5OyYjMjEyMDk7JiMxMjM5ODsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzM4MzA2OyYjMzY4OTk7JiMyMjI1OTs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuOTk5MyIgeD0iOTcuNTAwMiIgeT0iMjIuOTk1MSI+JiMzMDMzMDsmIzI3ODgwOyYjMjY5ODk7JiMyMTIwOTsmIzEyMzk4OyYjMTI0ODc7JiMxMjU0MDsmIzEyNDc5OyYjMzgzMDY7JiMzNjg5OTsmIzIyMjU5OzwvdGV4dD48L2c+PCEtLWVudGl0eSBsb2NhdGlvbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImxvY2F0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBpZD0iZW50MDAwMiI+PHBhdGggZD0iTTYsNTMuMjk2OSBDNiw0My4yOTY5IDUwLjk5OTgsNDMuMjk2OSA1MC45OTk4LDQzLjI5NjkgQzUwLjk5OTgsNDMuMjk2OSA5NS45OTk3LDQzLjI5NjkgOTUuOTk5Nyw1My4yOTY5IEw5NS45OTk3LDc4LjU5MzggQzk1Ljk5OTcsODguNTkzOCA1MC45OTk4LDg4LjU5MzggNTAuOTk5OCw4OC41OTM4IEM1MC45OTk4LDg4LjU5MzggNiw4OC41OTM4IDYsNzguNTkzOCBMNiw1My4yOTY5IiBmaWxsPSIjRjFGMUYxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNiw1My4yOTY5IEM2LDYzLjI5NjkgNTAuOTk5OCw2My4yOTY5IDUwLjk5OTgsNjMuMjk2OSBDNTAuOTk5OCw2My4yOTY5IDk1Ljk5OTcsNjMuMjk2OSA5NS45OTk3LDUzLjI5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE2IiB5PSI4MC4yOTIiPiYjMjI1ODA7JiMyNTE1MjsmIzEyNTEwOyYjMTI0NzM7JiMxMjQ3OTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgb3JkZXItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJvcmRlciIgZGF0YS1zb3VyY2UtbGluZT0iNCIgaWQ9ImVudDAwMDMiPjxwYXRoIGQ9Ik0xMzEsNTMuMjk2OSBDMTMxLDQzLjI5NjkgMTc1Ljk5OTgsNDMuMjk2OSAxNzUuOTk5OCw0My4yOTY5IEMxNzUuOTk5OCw0My4yOTY5IDIyMC45OTk3LDQzLjI5NjkgMjIwLjk5OTcsNTMuMjk2OSBMMjIwLjk5OTcsNzguNTkzOCBDMjIwLjk5OTcsODguNTkzOCAxNzUuOTk5OCw4OC41OTM4IDE3NS45OTk4LDg4LjU5MzggQzE3NS45OTk4LDg4LjU5MzggMTMxLDg4LjU5MzggMTMxLDc4LjU5MzggTDEzMSw1My4yOTY5IiBmaWxsPSIjRjFGMUYxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTMxLDUzLjI5NjkgQzEzMSw2My4yOTY5IDE3NS45OTk4LDYzLjI5NjkgMTc1Ljk5OTgsNjMuMjk2OSBDMTc1Ljk5OTgsNjMuMjk2OSAyMjAuOTk5Nyw2My4yOTY5IDIyMC45OTk3LDUzLjI5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE0MSIgeT0iODAuMjkyIj4mIzEyNDU4OyYjMTI1NDA7JiMxMjQ4MDsmIzI0NzczOyYjMjI1Nzc7PC90ZXh0PjwvZz48IS0tZW50aXR5IHByaWNlLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0icHJpY2UiIGRhdGEtc291cmNlLWxpbmU9IjUiIGlkPSJlbnQwMDA0Ij48cGF0aCBkPSJNMjU2LDUzLjI5NjkgQzI1Niw0My4yOTY5IDMwMC45OTk4LDQzLjI5NjkgMzAwLjk5OTgsNDMuMjk2OSBDMzAwLjk5OTgsNDMuMjk2OSAzNDUuOTk5Nyw0My4yOTY5IDM0NS45OTk3LDUzLjI5NjkgTDM0NS45OTk3LDc4LjU5MzggQzM0NS45OTk3LDg4LjU5MzggMzAwLjk5OTgsODguNTkzOCAzMDAuOTk5OCw4OC41OTM4IEMzMDAuOTk5OCw4OC41OTM4IDI1Niw4OC41OTM4IDI1Niw3OC41OTM4IEwyNTYsNTMuMjk2OSIgZmlsbD0iI0YxRjFGMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTI1Niw1My4yOTY5IEMyNTYsNjMuMjk2OSAzMDAuOTk5OCw2My4yOTY5IDMwMC45OTk4LDYzLjI5NjkgQzMwMC45OTk4LDYzLjI5NjkgMzQ1Ljk5OTcsNjMuMjk2OSAzNDUuOTk5Nyw1My4yOTY5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIyNjYiIHk9IjgwLjI5MiI+JiMyMTMzNjsmIzIwMzg1OyYjMTI1MTA7JiMxMjQ3MzsmIzEyNDc5OzwvdGV4dD48L2c+PCEtLWVudGl0eSBwbGFuLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0icGxhbiIgZGF0YS1zb3VyY2UtbGluZT0iNyIgaWQ9ImVudDAwMDUiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTAzLjk5OTYiIHg9IjEyNCIgeT0iMTQ4LjU4NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSIxMzQiIHk9IjE3MS41ODIiPiYjMzYwOTI7JiMzNjAyMzsmIzM1MzM2OyYjMzAwMTE7JiMyMDMxNjsmIzI1MTA0OzwvdGV4dD48L2c+PCEtLWVudGl0eSBwdXJjaGFzZVBsYW4tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJwdXJjaGFzZVBsYW4iIGRhdGEtc291cmNlLWxpbmU9IjkiIGlkPSJlbnQwMDA2Ij48cGF0aCBkPSJNMTM4LDI1NC44ODY5IEMxMzgsMjQ0Ljg4NjkgMTc1Ljk5OTksMjQ0Ljg4NjkgMTc1Ljk5OTksMjQ0Ljg4NjkgQzE3NS45OTk5LDI0NC44ODY5IDIxMy45OTk4LDI0NC44ODY5IDIxMy45OTk4LDI1NC44ODY5IEwyMTMuOTk5OCwyODAuMTgzOCBDMjEzLjk5OTgsMjkwLjE4MzggMTc1Ljk5OTksMjkwLjE4MzggMTc1Ljk5OTksMjkwLjE4MzggQzE3NS45OTk5LDI5MC4xODM4IDEzOCwyOTAuMTgzOCAxMzgsMjgwLjE4MzggTDEzOCwyNTQuODg2OSIgZmlsbD0iI0YxRjFGMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEzOCwyNTQuODg2OSBDMTM4LDI2NC44ODY5IDE3NS45OTk5LDI2NC44ODY5IDE3NS45OTk5LDI2NC44ODY5IEMxNzUuOTk5OSwyNjQuODg2OSAyMTMuOTk5OCwyNjQuODg2OSAyMTMuOTk5OCwyNTQuODg2OSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iMTQ4IiB5PSIyODEuODgyIj4mIzM2MDkyOyYjMzYwMjM7JiMzNTMzNjsmIzMwMDExOzwvdGV4dD48L2c+PCEtLWVudGl0eSBwby0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InBvIiBkYXRhLXNvdXJjZS1saW5lPSIxMSIgaWQ9ImVudDAwMDciPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNDcuOTk5OSIgeD0iMTUyIiB5PSIzNTAuMTg2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ljk5OTkiIHg9IjE2MiIgeT0iMzczLjE4MiI+JiMzMDMzMDsmIzI3ODgwOzwvdGV4dD48L2c+PCEtLWVudGl0eSBwb0RhdGEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJwb0RhdGEiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBpZD0iZW50MDAwOCI+PHBhdGggZD0iTTEzOCw0NTYuNDc2OSBDMTM4LDQ0Ni40NzY5IDE3NS45OTk5LDQ0Ni40NzY5IDE3NS45OTk5LDQ0Ni40NzY5IEMxNzUuOTk5OSw0NDYuNDc2OSAyMTMuOTk5OCw0NDYuNDc2OSAyMTMuOTk5OCw0NTYuNDc2OSBMMjEzLjk5OTgsNDgxLjc3MzggQzIxMy45OTk4LDQ5MS43NzM4IDE3NS45OTk5LDQ5MS43NzM4IDE3NS45OTk5LDQ5MS43NzM4IEMxNzUuOTk5OSw0OTEuNzczOCAxMzgsNDkxLjc3MzggMTM4LDQ4MS43NzM4IEwxMzgsNDU2LjQ3NjkiIGZpbGw9IiNGMUYxRjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0xMzgsNDU2LjQ3NjkgQzEzOCw0NjYuNDc2OSAxNzUuOTk5OSw0NjYuNDc2OSAxNzUuOTk5OSw0NjYuNDc2OSBDMTc1Ljk5OTksNDY2LjQ3NjkgMjEzLjk5OTgsNDY2LjQ3NjkgMjEzLjk5OTgsNDU2LjQ3NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjE0OCIgeT0iNDgzLjQ3MiI+JiMzMDMzMDsmIzI3ODgwOyYjMjQ3NzM7JiMyMjU3Nzs8L3RleHQ+PC9nPjwhLS1saW5rIGxvY2F0aW9uIHRvIHBsYW4tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMiIgZGF0YS1lbnRpdHktMj0iZW50MDAwNSIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjE1IiBpZD0ibG5rOSI+PHBhdGggZD0iTTc4Ljc0LDg4Ljg2NjkgQzEwMS4zMywxMDYuNzE2OSAxMjguMDgyMSwxMjcuODY3MyAxNDkuMDQyMSwxNDQuNDI3MyIgZmlsbD0ibm9uZSIgaWQ9ImxvY2F0aW9uLXRvLXBsYW4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE1My43NSwxNDguMTQ2OSwxNDkuMTY3OSwxMzkuNDI4OCwxNDkuODI2NywxNDUuMDQ3MiwxNDQuMjA4NCwxNDUuNzA2MSwxNTMuNzUsMTQ4LjE0NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgb3JkZXIgdG8gcGxhbi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDAzIiBkYXRhLWVudGl0eS0yPSJlbnQwMDA1IiBkYXRhLWxpbmstdHlwZT0iZGVwZW5kZW5jeSIgZGF0YS1zb3VyY2UtbGluZT0iMTYiIGlkPSJsbmsxMCI+PHBhdGggZD0iTTE3Niw4OC44NjY5IEMxNzYsMTA2LjcxNjkgMTc2LDEyNS41ODY5IDE3NiwxNDIuMTQ2OSIgZmlsbD0ibm9uZSIgaWQ9Im9yZGVyLXRvLXBsYW4iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE3NiwxNDguMTQ2OSwxODAsMTM5LjE0NjksMTc2LDE0My4xNDY5LDE3MiwxMzkuMTQ2OSwxNzYsMTQ4LjE0NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgcHJpY2UgdG8gcGxhbi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA0IiBkYXRhLWVudGl0eS0yPSJlbnQwMDA1IiBkYXRhLWxpbmstdHlwZT0iZGVwZW5kZW5jeSIgZGF0YS1zb3VyY2UtbGluZT0iMTciIGlkPSJsbmsxMSI+PHBhdGggZD0iTTI3My4yNiw4OC44NjY5IEMyNTAuNjcsMTA2LjcxNjkgMjIzLjkxNzksMTI3Ljg2NzMgMjAyLjk1NzksMTQ0LjQyNzMiIGZpbGw9Im5vbmUiIGlkPSJwcmljZS10by1wbGFuIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxOTguMjUsMTQ4LjE0NjksMjA3Ljc5MTYsMTQ1LjcwNjEsMjAyLjE3MzMsMTQ1LjA0NzIsMjAyLjgzMjEsMTM5LjQyODgsMTk4LjI1LDE0OC4xNDY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHBsYW4gdG8gcHVyY2hhc2VQbGFuLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDUiIGRhdGEtZW50aXR5LTI9ImVudDAwMDYiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIxOCIgaWQ9ImxuazEyIj48cGF0aCBkPSJNMTc2LDE4NC45NDY5IEMxNzYsMjAxLjUzNjkgMTc2LDIyMC42OTY5IDE3NiwyMzguNjg2OSIgZmlsbD0ibm9uZSIgaWQ9InBsYW4tdG8tcHVyY2hhc2VQbGFuIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxNzYsMjQ0LjY4NjksMTgwLDIzNS42ODY5LDE3NiwyMzkuNjg2OSwxNzIsMjM1LjY4NjksMTc2LDI0NC42ODY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIHB1cmNoYXNlUGxhbiB0byBwby0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA2IiBkYXRhLWVudGl0eS0yPSJlbnQwMDA3IiBkYXRhLWxpbmstdHlwZT0iZGVwZW5kZW5jeSIgZGF0YS1zb3VyY2UtbGluZT0iMTkiIGlkPSJsbmsxMyI+PHBhdGggZD0iTTE3NiwyOTAuNDU2OSBDMTc2LDMwOC4zMDY5IDE3NiwzMjcuMTc2OSAxNzYsMzQzLjc0NjkiIGZpbGw9Im5vbmUiIGlkPSJwdXJjaGFzZVBsYW4tdG8tcG8iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE3NiwzNDkuNzQ2OSwxODAsMzQwLjc0NjksMTc2LDM0NC43NDY5LDE3MiwzNDAuNzQ2OSwxNzYsMzQ5Ljc0NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgcG8gdG8gcG9EYXRhLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDciIGRhdGEtZW50aXR5LTI9ImVudDAwMDgiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIyMCIgaWQ9ImxuazE0Ij48cGF0aCBkPSJNMTc2LDM4Ni41MzY5IEMxNzYsNDAzLjEyNjkgMTc2LDQyMi4yODY5IDE3Niw0NDAuMjc2OSIgZmlsbD0ibm9uZSIgaWQ9InBvLXRvLXBvRGF0YSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTc2LDQ0Ni4yNzY5LDE4MCw0MzcuMjc2OSwxNzYsNDQxLjI3NjksMTcyLDQzNy4yNzY5LDE3Niw0NDYuMjc2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48P3BsYW50dW1sLXNyYyBBeWFpb0tiTFUzdnByeEZEQXZ1ak5Wa3FVLVJabmRNRmN6aVZELXp2dEJKX3ZSSDVCbmlNRnZzemNPaWg5UjRhQ0ljbkU1TDF3VWMyQlN5dzZudXRwdGxTajFFZUhhYVhpTFdYOXB5dmlJR3BGbXo5c1VFY0xJMTNjWGtVRFJTLU5SMEhoMm9fQTJNcjJEY2V0WGJGellyNERRZ1dBM0N2Yk9raEEzTXY5MzRsN1VXdWZIVVJ6eHBPakZ0NVlleGRLdE9fc0psZE1TUzRZQ0FTbjNuYVRvNGhXb1dlQktoRTA0ZTVXMUtZNkdabkJhSERGaDhIcTcxMEVCV1d0bUtlb1NLNXl2LTJoZ3VUbjZBbUxuMVNpQWtIazQwMm1hRHMwcDg3OGZsRkxQMEZQTzRpMFcwMD8+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_3">発注関連のスキーマ設計<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>発注業務で使用するテーブルを定義します。</p>
<h4 id="_4">テーブル構造<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>テーブル名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>単価マスタ</td>
<td>品目・取引先ごとの単価情報を管理</td>
</tr>
<tr>
<td>発注データ</td>
<td>発注ヘッダ情報（発注番号、取引先、ステータス等）</td>
</tr>
<tr>
<td>発注明細データ</td>
<td>発注明細情報（品目、数量、単価、金額等）</td>
</tr>
<tr>
<td>諸口品目情報</td>
<td>マスタに登録されていない臨時品目の情報</td>
</tr>
</tbody>
</table>
<h4 id="_5">発注ステータスの状態遷移<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h4>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IlNUQVRFIiBoZWlnaHQ9IjgyMHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MjkwcHg7aGVpZ2h0OjgyMHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDI5MCA4MjAiIHdpZHRoPSIyOTBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzAzMzA7JiMyNzg4MDsmIzEyNDczOyYjMTI0ODY7JiMxMjU0MDsmIzEyNDc5OyYjMTI0NzM7JiMxMjM5ODsmIzI5MzY2OyYjMjQ5MDc7JiMzNjk4MzsmIzMxMjI3OzwvdGl0bGU+PGRlZnMvPjxnPjxnIGNsYXNzPSJ0aXRsZSIgZGF0YS1zb3VyY2UtbGluZT0iMSI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2Ny45OTkzIiB4PSI1NC4wMDA0IiB5PSIyMi45OTUxIj4mIzMwMzMwOyYjMjc4ODA7JiMxMjQ3MzsmIzEyNDg2OyYjMTI1NDA7JiMxMjQ3OTsmIzEyNDczOyYjMTIzOTg7JiMyOTM2NjsmIzI0OTA3OyYjMzY5ODM7JiMzMTIyNzs8L3RleHQ+PC9nPjxlbGxpcHNlIGN4PSIyMDMiIGN5PSI1My4yOTY5IiBmaWxsPSIjMjIyMjIyIiByeD0iMTAiIHJ5PSIxMCIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxnPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNTAiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjEuOTk5OCIgeD0iMTcyIiB5PSIxNDAuMjk2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjE3MiIgeDI9IjIzMy45OTk4IiB5MT0iMTY2LjU5MzgiIHkyPSIxNjYuNTkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjk5OTgiIHg9IjE4MiIgeT0iMTU4LjI5MiI+JiMyMDMxNjsmIzI1MTA0OyYjMjAwMTM7PC90ZXh0PjwvZz48Zz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjUwIiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjYxLjk5OTgiIHg9IjEyMiIgeT0iMjY3LjI5NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxMjIiIHgyPSIxODMuOTk5OCIgeTE9IjI5My41OTM4IiB5Mj0iMjkzLjU5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSIxMzIiIHk9IjI4NS4yOTIiPiYjMzAzMzA7JiMyNzg4MDsmIzI4MTY4OzwvdGV4dD48L2c+PGc+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI1MCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI1MCIgeD0iMjMzIiB5PSIzNDcuMjk2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjIzMyIgeDI9IjI4MyIgeTE9IjM3My41OTM4IiB5Mj0iMzczLjU5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNy45OTk5IiB4PSIyNDQuMDAwMSIgeT0iMzY1LjI5MiI+JiMyMTQ2MjsmIzI4MDQwOzwvdGV4dD48L2c+PGc+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI1MCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI3NS45OTk4IiB4PSI3IiB5PSI0MjcuMjk2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjciIHgyPSI4Mi45OTk4IiB5MT0iNDUzLjU5MzgiIHkyPSI0NTMuNTkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjE3IiB5PSI0NDUuMjkyIj4mIzE5OTY4OyYjMzcwOTY7JiMyMDgzNzsmIzMzNjU1OzwvdGV4dD48L2c+PGc+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI1MCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI3NS45OTk4IiB4PSIxMTUiIHk9IjU1NC4yOTY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTE1IiB4Mj0iMTkwLjk5OTgiIHkxPSI1ODAuNTkzOCIgeTI9IjU4MC41OTM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iMTI1IiB5PSI1NzIuMjkyIj4mIzIwODM3OyYjMzM2NTU7JiMyMzQzNjsmIzIwMTAyOzwvdGV4dD48L2c+PGc+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI1MCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI3NS45OTk4IiB4PSIxMjciIHk9IjY4MS4yOTY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTI3IiB4Mj0iMjAyLjk5OTgiIHkxPSI3MDcuNTkzOCIgeTI9IjcwNy41OTM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iMTM3IiB5PSI2OTkuMjkyIj4mIzI2OTA4OyYjMjE0NTQ7JiMyMzQzNjsmIzIwMTAyOzwvdGV4dD48L2c+PGVsbGlwc2UgY3g9IjIxNCIgY3k9IjgwMy4yOTY5IiBmaWxsPSJub25lIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxlbGxpcHNlIGN4PSIyMTQiIGN5PSI4MDMuMjk2OSIgZmlsbD0iIzIyMjIyMiIgcng9IjYiIHJ5PSI2IiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PCEtLWxpbmsgKnN0YXJ0KiB0byA/Pz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMiIgZGF0YS1lbnRpdHktMj0iZW50MDAwMyIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjMiIGlkPSJsbms0Ij48cGF0aCBkPSJNMjAzLDYzLjY3NjkgQzIwMyw4MC40MDY5IDIwMywxMDkuODg2OSAyMDMsMTMzLjkyNjkiIGZpbGw9Im5vbmUiIGlkPSIqc3RhcnQqLXRvLSYjMjAzMTY7JiMyNTEwNDsmIzIwMDEzOyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjAzLDEzOS45MjY5LDIwNywxMzAuOTI2OSwyMDMsMTM0LjkyNjksMTk5LDEzMC45MjY5LDIwMywxMzkuOTI2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUyLjAwMDEiIHg9IjIwNCIgeT0iMTA2LjM2MzgiPiYjMzAzMzA7JiMyNzg4MDsmIzIwMzE2OyYjMjUxMDQ7PC90ZXh0PjwvZz48IS0tbGluayA/Pz8gdG8gPz8/LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDMiIGRhdGEtZW50aXR5LTI9ImVudDAwMDUiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSI0IiBpZD0ibG5rNiI+PHBhdGggZD0iTTE3NC44OCwxOTAuNjM2OSBDMTY2Ljk3LDE5OS4xNDY5IDE1OS4zNCwyMDkuMzM2OSAxNTUsMjIwLjI5NjkgQzE0OS4xOCwyMzQuOTY2OSAxNDguMjcyMSwyNDYuNzMwOCAxNDkuMjMyMSwyNjAuODIwOCIgZmlsbD0ibm9uZSIgaWQ9IiYjMjAzMTY7JiMyNTEwNDsmIzIwMDEzOy10by0mIzMwMzMwOyYjMjc4ODA7JiMyODE2ODsiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE0OS42NCwyNjYuODA2OSwxNTMuMDE5LDI1Ny41NTU4LDE0OS4zMDAxLDI2MS44MTg0LDE0NS4wMzc1LDI1OC4wOTk2LDE0OS42NCwyNjYuODA2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUyLjAwMDEiIHg9IjE1NiIgeT0iMjMzLjM2MzgiPiYjMzAzMzA7JiMyNzg4MDsmIzMwOTA2OyYjMjM0NTA7PC90ZXh0PjwvZz48IS0tbGluayA/Pz8gdG8gPz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMyIgZGF0YS1lbnRpdHktMj0iZW50MDAwNyIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjUiIGlkPSJsbms4Ij48cGF0aCBkPSJNMjA5LjUzLDE5MC42MTY5IEMyMjAuMTEsMjMwLjA3NjkgMjM5LjM0NTEsMzAxLjc4MTkgMjQ5LjkyNTEsMzQxLjIxMTkiIGZpbGw9Im5vbmUiIGlkPSImIzIwMzE2OyYjMjUxMDQ7JiMyMDAxMzstdG8tJiMyMTQ2MjsmIzI4MDQwOyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjUxLjQ4LDM0Ny4wMDY5LDI1My4wMTA5LDMzNy4yNzc3LDI1MC4xODQyLDM0Mi4xNzc3LDI0NS4yODQzLDMzOS4zNTEsMjUxLjQ4LDM0Ny4wMDY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjIyMi4yNCIgeT0iMjMzLjM2MzgiPiYjMjE0NjI7JiMyODA0MDs8L3RleHQ+PC9nPjwhLS1saW5rID8/PyB0byA/Pz8/LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDUiIGRhdGEtZW50aXR5LTI9ImVudDAwMDkiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSI2IiBpZD0ibG5rMTAiPjxwYXRoIGQ9Ik0xMjEuNTUsMzA3LjYzNjkgQzEwNC44NCwzMTYuNzY2OSA4NS4yNywzMzAuMTE2OSA3MywzNDcuMjk2OSBDNTYuMDUsMzcxLjAzNjkgNTAuMDU5NSwzOTguNTA3OCA0Ny40MTk1LDQyMC45OTc4IiBmaWxsPSJub25lIiBpZD0iJiMzMDMzMDsmIzI3ODgwOyYjMjgxNjg7LXRvLSYjMTk5Njg7JiMzNzA5NjsmIzIwODM3OyYjMzM2NTU7IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0Ni43Miw0MjYuOTU2OSw1MS43NDIsNDE4LjQ4NDYsNDcuMzAyOSw0MjEuOTkxLDQzLjc5NjUsNDE3LjU1MTksNDYuNzIsNDI2Ljk1NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi4wMDAxIiB4PSI3NCIgeT0iMzc2Ljg2MzgiPiYjMjA5OTg7JiMyMTEwNjsmIzIwODM3OyYjMzM2NTU7PC90ZXh0PjwvZz48IS0tbGluayA/Pz8gdG8gPz8/Py0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA1IiBkYXRhLWVudGl0eS0yPSJlbnQwMDExIiBkYXRhLWxpbmstdHlwZT0iZGVwZW5kZW5jeSIgZGF0YS1zb3VyY2UtbGluZT0iNyIgaWQ9ImxuazEyIj48cGF0aCBkPSJNMTUzLDMxNy41OTY5IEMxNTMsMzcxLjQzNjkgMTUzLDQ5NC4yNzY5IDE1Myw1NDguMDU2OSIgZmlsbD0ibm9uZSIgaWQ9IiYjMzAzMzA7JiMyNzg4MDsmIzI4MTY4Oy10by0mIzIwODM3OyYjMzM2NTU7JiMyMzQzNjsmIzIwMTAyOyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTUzLDU1NC4wNTY5LDE1Nyw1NDUuMDU2OSwxNTMsNTQ5LjA1NjksMTQ5LDU0NS4wNTY5LDE1Myw1NTQuMDU2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUyLjAwMDEiIHg9IjE1NCIgeT0iNDU2Ljg2MzgiPiYjMjA4NDA7JiMyNTk2ODsmIzIwODM3OyYjMzM2NTU7PC90ZXh0PjwvZz48IS0tbGluayA/Pz8/IHRvID8/Pz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwOSIgZGF0YS1lbnRpdHktMj0iZW50MDAxMSIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjgiIGlkPSJsbmsxMyI+PHBhdGggZD0iTTUwLjY0LDQ3Ny41MzY5IEM1NC45NSw0OTIuMjA2OSA2Mi4wNSw1MTAuNjU2OSA3Myw1MjQuMjk2OSBDODQuMjIsNTM4LjI3NjkgOTQuOTE5LDU0Ni44ODAzIDEwOS41MjksNTU1LjgwMDMiIGZpbGw9Im5vbmUiIGlkPSImIzE5OTY4OyYjMzcwOTY7JiMyMDgzNzsmIzMzNjU1Oy10by0mIzIwODM3OyYjMzM2NTU7JiMyMzQzNjsmIzIwMTAyOyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTE0LjY1LDU1OC45MjY5LDEwOS4wNTI5LDU1MC44MjMsMTEwLjM4MjUsNTU2LjMyMTQsMTA0Ljg4NDEsNTU3LjY1MSwxMTQuNjUsNTU4LjkyNjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi4wMDAxIiB4PSI3NCIgeT0iNTIwLjM2MzgiPiYjMjc1MzE7JiMyNTk2ODsmIzIwODM3OyYjMzM2NTU7PC90ZXh0PjwvZz48IS0tbGluayA/Pz8/IHRvID8/Pz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAxMSIgZGF0YS1lbnRpdHktMj0iZW50MDAxNCIgZGF0YS1saW5rLXR5cGU9ImRlcGVuZGVuY3kiIGRhdGEtc291cmNlLWxpbmU9IjkiIGlkPSJsbmsxNSI+PHBhdGggZD0iTTE1NS4zNCw2MDQuNjk2OSBDMTU3LjQ2LDYyNi43MTY5IDE1OS45NzcyLDY1Mi45ODQzIDE2Mi4wODcyLDY3NC45ODQzIiBmaWxsPSJub25lIiBpZD0iJiMyMDgzNzsmIzMzNjU1OyYjMjM0MzY7JiMyMDEwMjstdG8tJiMyNjkwODsmIzIxNDU0OyYjMjM0MzY7JiMyMDEwMjsiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE2Mi42Niw2ODAuOTU2OSwxNjUuNzgyNSw2NzEuNjE2MSwxNjIuMTgyNiw2NzUuOTc5NywxNTcuODE5LDY3Mi4zNzk5LDE2Mi42Niw2ODAuOTU2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUyLjAwMDEiIHg9IjE2MC43MiIgeT0iNjQ3LjM2MzgiPiYjMjY5MDg7JiMyMTQ1NDsmIzIwOTY2OyYjMjk3MDI7PC90ZXh0PjwvZz48IS0tbGluayA/Pz8/IHRvICplbmQqLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMTQiIGRhdGEtZW50aXR5LTI9ImVudDAwMTYiIGRhdGEtbGluay10eXBlPSJkZXBlbmRlbmN5IiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgaWQ9ImxuazE3Ij48cGF0aCBkPSJNMTc3LjYyLDczMS43NTY5IEMxODcuOTQsNzUxLjc3NjkgMTk5LjIyMDIsNzczLjY0NDEgMjA2LjQ3MDIsNzg3LjcwNDEiIGZpbGw9Im5vbmUiIGlkPSImIzI2OTA4OyYjMjE0NTQ7JiMyMzQzNjsmIzIwMTAyOy10by0qZW5kKiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjA5LjIyLDc5My4wMzY5LDIwOC42NTA0LDc4My4yMDQ1LDIwNi45Mjg1LDc4OC41OTI5LDIwMS41NDAxLDc4Ni44NzA5LDIwOS4yMiw3OTMuMDM2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayA/PyB0byAqZW5kKi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA3IiBkYXRhLWVudGl0eS0yPSJlbnQwMDE2IiBkYXRhLWxpbmstdHlwZT0iZGVwZW5kZW5jeSIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGlkPSJsbmsxOCI+PHBhdGggZD0iTTI1OC41NSwzOTcuNTg2OSBDMjU5LjE0LDQyNS43NjY5IDI2MCw0NzMuNjQ2OSAyNjAsNTE0Ljc5NjkgQzI2MCw1MTQuNzk2OSAyNjAsNTE0Ljc5NjkgMjYwLDcwNy4yOTY5IEMyNjAsNzQyLjg0NjkgMjM3LjQwNDYsNzc0LjQ1MzkgMjI0LjYxNDYsNzg5LjkxMzkiIGZpbGw9Im5vbmUiIGlkPSImIzIxNDYyOyYjMjgwNDA7LXRvLSplbmQqIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMjAuNzksNzk0LjUzNjksMjI5LjYwODksNzkwLjE1MjEsMjIzLjk3NzIsNzkwLjY4NDQsMjIzLjQ0NDksNzg1LjA1MjYsMjIwLjc5LDc5NC41MzY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjw/cGxhbnR1bWwtc3JjIEF5YWlvS2JMVTN2cHJ4RkRBbnV0eE5wU3RGUXVVU19aZmxxV1RrRXd2cnRSZGhMc2xzcFNfZHB2Ull3a1FBck8xTHJURXVLZFUtU3l3dlptUENUUTFJa2VKZVc4NXE4MmYwbVl6TW43MXJwUHlxTXhkZ3dSWFFSaVFWLXFQemowUVkwQ0JlR3NpNXF4NmJ1c2h0WlFrbEg1eHRRR2Nld3NmdnNSODVtcWJIMzFmLWp3ZGtuZzB3YmlOVjVpd1dRZUlYSEppMlgtamd1UmVIWDUzZ0p1c1A4dkpfbHg0OGVYdEZQYnBvVXFTUTc4V0hHMzB1YUJ3WUtlNW0wMD8+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<details>
<summary>DDL: 発注関連テーブル</summary>

<div class="highlight"><pre><span></span><code><span class="c1">-- V009__create_purchasing_tables.sql</span>

<span class="c1">-- 発注ステータス</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="err">発注ステータス</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;作成中&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;発注済&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;一部入荷&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;入荷完了&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;検収完了&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;取消&#39;</span><span class="p">);</span>

<span class="c1">-- 入荷受入区分</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="err">入荷受入区分</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;通常入荷&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;分割入荷&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;返品入荷&#39;</span><span class="p">);</span>

<span class="c1">-- 単価マスタ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;単価マスタ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;品目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;取引先コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;ロット単位数&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;使用開始日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;使用停止日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;単価&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_単価マスタ_品目&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;品目マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_単価マスタ_取引先&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;取引先マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;取引先コード&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;ロット単位数&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;使用開始日&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 発注データ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;発注データ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;取引先コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注担当者コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;発注部門コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;ステータス&quot;</span><span class="w"> </span><span class="err">発注ステータス</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;作成中&#39;</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;備考&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_発注データ_取引先&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;取引先マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 発注明細データ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注行番号&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;オーダNO&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;納入場所コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;品目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;諸口品目区分&quot;</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;受入予定日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;回答納期&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注単価&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注数量&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷済数量&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検査済数量&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収済数量&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注金額&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;消費税金額&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;完了フラグ&quot;</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;明細備考&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_発注明細_発注&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;発注データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_発注明細_品目&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;品目マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 諸口品目情報（マスタに登録されていない臨時品目）</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;諸口品目情報&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注行番号&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;品目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;品名&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;規格&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;図番メーカー&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;版数&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">UNIQUE</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- インデックス</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_発注データ_取引先コード&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;発注データ&quot;</span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_発注データ_発注日&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;発注データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注日&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_発注明細_発注番号&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_発注明細_品目コード&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_単価マスタ_品目取引先&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;単価マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;取引先コード&quot;</span><span class="p">);</span>
</code></pre></div>

</details>

<h3 id="_6">オーダ情報・場所マスタ・単価マスタとの連携<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>発注データは以下のマスタ情報と連携します。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjYyNnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDg1cHg7aGVpZ2h0OjYyNnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQ4NSA2MjYiIHdpZHRoPSI0ODVweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzAzMzA7JiMyNzg4MDsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyMzkyOyYjMTI1MTA7JiMxMjQ3MzsmIzEyNDc5OyYjMTIzOTg7JiMzODMwNjsmIzM2ODk5OzwvdGl0bGU+PGRlZnMvPjxnPjxnIGNsYXNzPSJ0aXRsZSIgZGF0YS1zb3VyY2UtbGluZT0iMSI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2Ny45OTkzIiB4PSIxNTEuODczNyIgeT0iMjIuOTk1MSI+JiMzMDMzMDsmIzI3ODgwOyYjMTI0ODc7JiMxMjU0MDsmIzEyNDc5OyYjMTIzOTI7JiMxMjUxMDsmIzEyNDczOyYjMTI0Nzk7JiMxMjM5ODsmIzM4MzA2OyYjMzY4OTk7PC90ZXh0PjwvZz48IS0tY2xhc3MgcG8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJwbyIgZGF0YS1zb3VyY2UtbGluZT0iMyIgaWQ9ImVudDAwMDIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTEzLjE4NzUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEyOC42MDcxIiB4PSIyNTMuOTQiIHk9IjQ0LjI5NjkiLz48ZWxsaXBzZSBjeD0iMjgwLjkxMzMiIGN5PSI2MC4yOTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yODUuMDIyNyw2Ni4yOTY5IEwyNzcuMzAzOSw2Ni4yOTY5IEwyNzcuMzAzOSw1My45MDYzIEwyODUuMDIyNyw1My45MDYzIEwyODUuMDIyNyw1Ni4wNjI1IEwyNzkuNzU3MSw1Ni4wNjI1IEwyNzkuNzU3MSw1OC43MzQ0IEwyODQuNTIyNyw1OC43MzQ0IEwyODQuNTIyNyw2MC44OTA2IEwyNzkuNzU3MSw2MC44OTA2IEwyNzkuNzU3MSw2NC4xNDA2IEwyODUuMDIyNyw2NC4xNDA2IEwyODUuMDIyNyw2Ni4yOTY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMjk3LjU3NCIgeT0iNjUuMTQzNiI+JiMzMDMzMDsmIzI3ODgwOyYjMTI0ODc7JiMxMjU0MDsmIzEyNDc5OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNTQuOTQiIHgyPSIzODEuNTQ3MSIgeTE9Ijc2LjI5NjkiIHkyPSI3Ni4yOTY5Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIyNjQuOTQiIGN5PSI4OS45NDUzIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODguOTk2OCIgeD0iMjczLjk0IiB5PSI5My4yOTIiPiYjMzAzMzA7JiMyNzg4MDsmIzMwMDU4OyYjMjE0OTU7IFtQS108L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI1NC45NCIgeDI9IjM4MS41NDcxIiB5MT0iMTAwLjU5MzgiIHkyPSIxMDAuNTkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNi42MDcxIiB4PSIyNTkuOTQiIHk9IjExNy41ODg5Ij4mIzIxNDYyOyYjMjQzNDE7JiMyMDgwODsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsgW0ZLXTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSIyNTkuOTQiIHk9IjEzMy44ODU3Ij4mIzMwMzMwOyYjMjc4ODA7JiMyNjA4NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMjU5Ljk0IiB5PSIxNTAuMTgyNiI+JiMxMjQ3MzsmIzEyNDg2OyYjMTI1NDA7JiMxMjQ3OTsmIzEyNDczOzwvdGV4dD48L2c+PCEtLWNsYXNzIHBvZC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InBvZCIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGlkPSJlbnQwMDAzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjE2Mi4wNzgxIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDIuNjA3IiB4PSIxNTcuOTQiIHk9IjIzNC40ODY5Ii8+PGVsbGlwc2UgY3g9IjE3OC42MTMzIiBjeT0iMjUwLjQ4NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTE4Mi43MjI3LDI1Ni40ODY5IEwxNzUuMDA0LDI1Ni40ODY5IEwxNzUuMDA0LDI0NC4wOTYyIEwxODIuNzIyNywyNDQuMDk2MiBMMTgyLjcyMjcsMjQ2LjI1MjUgTDE3Ny40NTcxLDI0Ni4yNTI1IEwxNzcuNDU3MSwyNDguOTI0NCBMMTgyLjIyMjcsMjQ4LjkyNDQgTDE4Mi4yMjI3LDI1MS4wODA2IEwxNzcuNDU3MSwyNTEuMDgwNiBMMTc3LjQ1NzEsMjU0LjMzMDYgTDE4Mi43MjI3LDI1NC4zMzA2IEwxODIuNzIyNywyNTYuNDg2OSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjE5My44NzQxIiB5PSIyNTUuMzMzNiI+JiMzMDMzMDsmIzI3ODgwOyYjMjYxMjY7JiMzMjA0ODsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTU4Ljk0IiB4Mj0iMjk5LjU0NyIgeTE9IjI2Ni40ODY5IiB5Mj0iMjY2LjQ4NjkiLz48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjE2OC45NCIgY3k9IjI4MC4xMzUzIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEwLjY4MDQiIHg9IjE3Ny45NCIgeT0iMjgzLjQ4MiI+JiMzMDMzMDsmIzI3ODgwOyYjMzAwNTg7JiMyMTQ5NTsgW1BLLEZLXTwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjE2OC45NCIgY3k9IjI5Ni40MzIyIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjk5NjgiIHg9IjE3Ny45NCIgeT0iMjk5Ljc3ODkiPiYjMzAzMzA7JiMyNzg4MDsmIzM0ODkyOyYjMzAwNTg7JiMyMTQ5NTsgW1BLXTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU4Ljk0IiB4Mj0iMjk5LjU0NyIgeTE9IjMwNy4wODA2IiB5Mj0iMzA3LjA4MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ni4wOTk0IiB4PSIxNjMuOTQiIHk9IjMyNC4wNzU3Ij4mIzEyNDU4OyYjMTI1NDA7JiMxMjQ4MDtOTyBbRktdPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMi42MDcxIiB4PSIxNjMuOTQiIHk9IjM0MC4zNzI2Ij4mIzIxNjk3OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7IFtGS108L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMwLjYwNyIgeD0iMTYzLjk0IiB5PSIzNTYuNjY5NSI+JiMzMjAxMzsmIzIwODM3OyYjMjI1ODA7JiMyNTE1MjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsgW0ZLXTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIxNjMuOTQiIHk9IjM3Mi45NjY0Ij4mIzMwMzMwOyYjMjc4ODA7JiMyNTk2ODsmIzM3MzI3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIxNjMuOTQiIHk9IjM4OS4yNjMyIj4mIzMwMzMwOyYjMjc4ODA7JiMyMTMzNjsmIzIwMzg1OzwvdGV4dD48L2c+PCEtLWNsYXNzIG9yZGVyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0ib3JkZXIiIGRhdGEtc291cmNlLWxpbmU9IjIyIiBpZD0iZW50MDAwNCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMTMuMTg3NSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTIyLjQ4OTEiIHg9IjciIHk9IjQ4OS44NjY5Ii8+PGVsbGlwc2UgY3g9IjMxLjIyMDIiIGN5PSI1MDUuODY2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMzUuMzI5Niw1MTEuODY2OSBMMjcuNjEwOCw1MTEuODY2OSBMMjcuNjEwOCw0OTkuNDc2MiBMMzUuMzI5Niw0OTkuNDc2MiBMMzUuMzI5Niw1MDEuNjMyNSBMMzAuMDY0LDUwMS42MzI1IEwzMC4wNjQsNTA0LjMwNDQgTDM0LjgyOTYsNTA0LjMwNDQgTDM0LjgyOTYsNTA2LjQ2MDYgTDMwLjA2NCw1MDYuNDYwNiBMMzAuMDY0LDUwOS43MTA2IEwzNS4zMjk2LDUwOS43MTA2IEwzNS4zMjk2LDUxMS44NjY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDcuMjY5MiIgeT0iNTEwLjcxMzYiPiYjMTI0NTg7JiMxMjU0MDsmIzEyNDgwOyYjMjQ3NzM7JiMyMjU3Nzs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjEyOC40ODkxIiB5MT0iNTIxLjg2NjkiIHkyPSI1MjEuODY2OSIvPjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMTgiIGN5PSI1MzUuNTE1MyIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk2LjQ4OTEiIHg9IjI3IiB5PSI1MzguODYyIj4mIzEyNDU4OyYjMTI1NDA7JiMxMjQ4MDtOTyBbUEtdPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI4IiB4Mj0iMTI4LjQ4OTEiIHkxPSI1NDYuMTYzNyIgeTI9IjU0Ni4xNjM3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMTMiIHk9IjU2My4xNTg5Ij4mIzIxNjk3OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjEzIiB5PSI1NzkuNDU1NyI+JiMyNTE1MjsmIzM1MjAxOyYjMjU5Njg7JiMzNzMyNzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iMTMiIHk9IjU5NS43NTI2Ij4mIzI1MTUyOyYjMzUyMDE7JiMyNjA4NTs8L3RleHQ+PC9nPjwhLS1jbGFzcyBwcmljZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InByaWNlIiBkYXRhLXNvdXJjZS1saW5lPSIzMCIgaWQ9ImVudDAwMDUiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTQ1Ljc4MTMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEyOC42MDcxIiB4PSIxNjQuOTQiIHk9IjQ3My41NjY5Ii8+PGVsbGlwc2UgY3g9IjE5MS45MTMzIiBjeT0iNDg5LjU2NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTE5Ni4wMjI3LDQ5NS41NjY5IEwxODguMzAzOSw0OTUuNTY2OSBMMTg4LjMwMzksNDgzLjE3NjMgTDE5Ni4wMjI3LDQ4My4xNzYzIEwxOTYuMDIyNyw0ODUuMzMyNSBMMTkwLjc1NzEsNDg1LjMzMjUgTDE5MC43NTcxLDQ4OC4wMDQ0IEwxOTUuNTIyNyw0ODguMDA0NCBMMTk1LjUyMjcsNDkwLjE2MDYgTDE5MC43NTcxLDQ5MC4xNjA2IEwxOTAuNzU3MSw0OTMuNDEwNiBMMTk2LjAyMjcsNDkzLjQxMDYgTDE5Ni4wMjI3LDQ5NS41NjY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMjA4LjU3NCIgeT0iNDk0LjQxMzYiPiYjMjEzMzY7JiMyMDM4NTsmIzEyNTEwOyYjMTI0NzM7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTY1Ljk0IiB4Mj0iMjkyLjU0NzEiIHkxPSI1MDUuNTY2OSIgeTI9IjUwNS41NjY5Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxNzUuOTQiIGN5PSI1MTkuMjE1MyIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ3LjkwNjMiIHg9IjE4NC45NCIgeT0iNTIyLjU2MiI+SUQgW1BLXTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTY1Ljk0IiB4Mj0iMjkyLjU0NzEiIHkxPSI1MjkuODYzOCIgeTI9IjUyOS44NjM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjYwNzEiIHg9IjE3MC45NCIgeT0iNTQ2Ljg1ODkiPiYjMjE2OTc7JiMzMDQ0NjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsgW0ZLXTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTYuNjA3MSIgeD0iMTcwLjk0IiB5PSI1NjMuMTU1NyI+JiMyMTQ2MjsmIzI0MzQxOyYjMjA4MDg7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7IFtGS108L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjcuOTk5OSIgeD0iMTcwLjk0IiB5PSI1NzkuNDUyNiI+JiMyMTMzNjsmIzIwMzg1OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIxNzAuOTQiIHk9IjU5NS43NDk1Ij4mIzIwMzUxOyYjMjk5OTI7JiMzODI4MzsmIzIyOTg3OyYjMjYwODU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE3MC45NCIgeT0iNjEyLjA0NjQiPiYjMjAzNTE7JiMyOTk5MjsmIzIwNTcyOyYjMjc0OTA7JiMyNjA4NTs8L3RleHQ+PC9nPjwhLS1jbGFzcyBsb2NhdGlvbi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImxvY2F0aW9uIiBkYXRhLXNvdXJjZS1saW5lPSI0MCIgaWQ9ImVudDAwMDYiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iODAuNTkzOCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTI4Ljk5NjgiIHg9IjMyOC43NSIgeT0iNTA2LjE1NjkiLz48ZWxsaXBzZSBjeD0iMzU1Ljg5ODciIGN5PSI1MjIuMTU2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMzYwLjAwODEsNTI4LjE1NjkgTDM1Mi4yODkzLDUyOC4xNTY5IEwzNTIuMjg5Myw1MTUuNzY2MiBMMzYwLjAwODEsNTE1Ljc2NjIgTDM2MC4wMDgxLDUxNy45MjI1IEwzNTQuNzQyNCw1MTcuOTIyNSBMMzU0Ljc0MjQsNTIwLjU5NDQgTDM1OS41MDgxLDUyMC41OTQ0IEwzNTkuNTA4MSw1MjIuNzUwNiBMMzU0Ljc0MjQsNTIyLjc1MDYgTDM1NC43NDI0LDUyNi4wMDA2IEwzNjAuMDA4MSw1MjYuMDAwNiBMMzYwLjAwODEsNTI4LjE1NjkgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIzNzIuNTk4NCIgeT0iNTI3LjAwMzYiPiYjMjI1ODA7JiMyNTE1MjsmIzEyNTEwOyYjMTI0NzM7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzI5Ljc1IiB4Mj0iNDU2Ljc0NjgiIHkxPSI1MzguMTU2OSIgeTI9IjUzOC4xNTY5Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIzMzkuNzUiIGN5PSI1NTEuODA1MyIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMi45OTY4IiB4PSIzNDguNzUiIHk9IjU1NS4xNTIiPiYjMjI1ODA7JiMyNTE1MjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsgW1BLXTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzI5Ljc1IiB4Mj0iNDU2Ljc0NjgiIHkxPSI1NjIuNDUzNyIgeTI9IjU2Mi40NTM3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iMzM0Ljc1IiB5PSI1NzkuNDQ4OSI+JiMyMjU4MDsmIzI1MTUyOyYjMjE1MTc7PC90ZXh0PjwvZz48IS0tY2xhc3Mgc3VwcGxpZXItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJzdXBwbGllciIgZGF0YS1zb3VyY2UtbGluZT0iNDYiIGlkPSJlbnQwMDA3Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjgwLjU5MzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE0Mi45OTY3IiB4PSIzMzUuNzUiIHk9IjI3NS4yMjY5Ii8+PGVsbGlwc2UgY3g9IjM2Mi44OTg3IiBjeT0iMjkxLjIyNjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTM2Ny4wMDgxLDI5Ny4yMjY5IEwzNTkuMjg5MywyOTcuMjI2OSBMMzU5LjI4OTMsMjg0LjgzNjIgTDM2Ny4wMDgxLDI4NC44MzYyIEwzNjcuMDA4MSwyODYuOTkyNSBMMzYxLjc0MjQsMjg2Ljk5MjUgTDM2MS43NDI0LDI4OS42NjQ0IEwzNjYuNTA4MSwyODkuNjY0NCBMMzY2LjUwODEsMjkxLjgyMDYgTDM2MS43NDI0LDI5MS44MjA2IEwzNjEuNzQyNCwyOTUuMDcwNiBMMzY3LjAwODEsMjk1LjA3MDYgTDM2Ny4wMDgxLDI5Ny4yMjY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMzc5LjU5ODQiIHk9IjI5Ni4wNzM2Ij4mIzIxNDYyOyYjMjQzNDE7JiMyMDgwODsmIzEyNTEwOyYjMTI0NzM7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMzM2Ljc1IiB4Mj0iNDc3Ljc0NjciIHkxPSIzMDcuMjI2OSIgeTI9IjMwNy4yMjY5Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIzNDYuNzUiIGN5PSIzMjAuODc1MyIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNi45OTY3IiB4PSIzNTUuNzUiIHk9IjMyNC4yMjIiPiYjMjE0NjI7JiMyNDM0MTsmIzIwODA4OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OyBbUEtdPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMzYuNzUiIHgyPSI0NzcuNzQ2NyIgeTE9IjMzMS41MjM3IiB5Mj0iMzMxLjUyMzciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIzNDEuNzUiIHk9IjM0OC41MTg5Ij4mIzIxNDYyOyYjMjQzNDE7JiMyMDgwODsmIzIxNTE3OzwvdGV4dD48L2c+PCEtLWxpbmsgcG8gdG8gcG9kLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDIiIGRhdGEtZW50aXR5LTI9ImVudDAwMDMiIGRhdGEtbGluay10eXBlPSJjcm93Zm9vdCIgZGF0YS1zb3VyY2UtbGluZT0iNTIiIGlkPSJsbms4Ij48cGF0aCBjb2RlTGluZT0iNTIiIGQ9Ik0yOTEuNzcyOCwxNjUuMTM3MiBDMjgxLjk5MjgsMTg4LjUxNzIgMjgwLjQ3MDQsMTkyLjE1MjkgMjY5LjgwMDQsMjE3LjY0MjkiIGZpbGw9Im5vbmUiIGlkPSJwby1wb2QiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjg5LjYyNjIiIHgyPSIyOTcuMDA2NSIgeTE9IjE1OS45MDM0IiB5Mj0iMTYyLjk5MDYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjg4LjQ2ODUiIHgyPSIyOTUuODQ4OCIgeTE9IjE2Mi42NzEiIHkyPSIxNjUuNzU4MyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyOTEuNzcyOCIgeDI9IjI5NC44NiIgeTE9IjE2NS4xMzcyIiB5Mj0iMTU3Ljc1NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjY1LjkzOSIgeDI9IjI2OC4zODQ3IiB5MT0iMjI2Ljg2NzMiIHkyPSIyMzYuNTYzNyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyNjUuOTM5IiB4Mj0iMjU3LjMxNTMiIHkxPSIyMjYuODY3MyIgeTI9IjIzMS45MzAxIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI2NS45MzkiIHgyPSIyNjIuODUiIHkxPSIyMjYuODY3MyIgeTI9IjIzNC4yNDY5Ii8+PGVsbGlwc2UgY3g9IjI2OC4yNTU4IiBjeT0iMjIxLjMzMjciIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1LjAyNzgiIHg9IjI4Mi43MiIgeT0iMjAwLjU1MzgiPmNvbnRhaW5zPC90ZXh0PjwvZz48IS0tbGluayBwbyB0byBzdXBwbGllci0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDAyIiBkYXRhLWVudGl0eS0yPSJlbnQwMDA3IiBkYXRhLWxpbmstdHlwZT0iY3Jvd2Zvb3QiIGRhdGEtc291cmNlLWxpbmU9IjUzIiBpZD0ibG5rOSI+PHBhdGggY29kZUxpbmU9IjUzIiBkPSJNMzQ4LjU4MDMsMTc0LjM2MDkgQzM2My45ODAzLDIxMS4xNTA5IDM3My43MzEyLDIzNC40NTcyIDM4Ny41MzEyLDI2Ny40MjcyIiBmaWxsPSJub25lIiBpZD0icG8tc3VwcGxpZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzQ0LjcxOSIgeDI9IjMzNi4wOTUzIiB5MT0iMTY1LjEzNjQiIHkyPSIxNjAuMDczNiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzNDQuNzE5IiB4Mj0iMzQ3LjE2NDciIHkxPSIxNjUuMTM2NCIgeTI9IjE1NS40NDAxIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjM0NC43MTkiIHgyPSIzNDEuNjMiIHkxPSIxNjUuMTM2NCIgeTI9IjE1Ny43NTY5Ii8+PGVsbGlwc2UgY3g9IjM0Ny4wMzU4IiBjeT0iMTcwLjY3MTEiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzOTIuNzY1NCIgeDI9IjM4NS4zODU4IiB5MT0iMjY5LjU3MjYiIHkyPSIyNzIuNjYxNSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzOTEuNjA3MSIgeDI9IjM4NC4yMjc0IiB5MT0iMjY2LjgwNTMiIHkyPSIyNjkuODk0MSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzODcuNTMxMiIgeDI9IjM5MC42MiIgeTE9IjI2Ny40MjcyIiB5Mj0iMjc0LjgwNjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzOSIgeD0iMzYxLjA4IiB5PSIyMDAuNTUzOCI+JiMzMDMzMDsmIzI3ODgwOyYjMjA4MDg7PC90ZXh0PjwvZz48IS0tbGluayBwb2QgdG8gb3JkZXItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMyIgZGF0YS1lbnRpdHktMj0iZW50MDAwNCIgZGF0YS1saW5rLXR5cGU9ImNyb3dmb290IiBkYXRhLXNvdXJjZS1saW5lPSI1NCIgaWQ9ImxuazEwIj48cGF0aCBjb2RlTGluZT0iNTQiIGQ9Ik0xNjIuMzUyOSw0MTEuNjM4NiBDMTQwLjc4MjksNDQyLjI5ODYgMTM1LjY5MTcsNDQ5LjU2OTMgMTE2LjA4MTcsNDc3LjQzOTMiIGZpbGw9Im5vbmUiIGlkPSJwb2Qtb3JkZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTY4LjEwNjgiIHgyPSIxNjcuODAyNyIgeTE9IjQwMy40NTk5IiB5Mj0iMzkzLjQ2NDUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTY4LjEwNjgiIHgyPSIxNzcuNjE3MyIgeTE9IjQwMy40NTk5IiB5Mj0iNDAwLjM2OTIiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTY4LjEwNjgiIHgyPSIxNzIuNzEiIHkxPSI0MDMuNDU5OSIgeTI9IjM5Ni45MTY5Ii8+PGVsbGlwc2UgY3g9IjE2NC42NTQ1IiBjeT0iNDA4LjM2NzEiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMTMuNzc5OSIgeDI9IjEwNy40NSIgeTE9IjQ4MC43MTA3IiB5Mj0iNDg5LjcwNjkiLz48ZWxsaXBzZSBjeD0iMTEzLjc3OTkiIGN5PSI0ODAuNzEwNyIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjExMy4wMjMxIiB4Mj0iMTA2LjQ4MDUiIHkxPSI0ODguNzM3MyIgeTI9IjQ4NC4xMzM3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzkiIHg9IjE0OS43NCIgeT0iNDM5LjYzMzgiPiYjMzIwMTY7JiMyMDE4NDsmIzEyMzY5OzwvdGV4dD48L2c+PCEtLWxpbmsgcG9kIHRvIHByaWNlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDMiIGRhdGEtZW50aXR5LTI9ImVudDAwMDUiIGRhdGEtbGluay10eXBlPSJjcm93Zm9vdCIgZGF0YS1zb3VyY2UtbGluZT0iNTUiIGlkPSJsbmsxMSI+PHBhdGggY29kZUxpbmU9IjU1IiBkPSJNMjI5LjI0LDQxNC45MTY5IEMyMjkuMjQsNDM5Ljc4NjkgMjI5LjI0LDQ0MS4wMDY5IDIyOS4yNCw0NjUuMjc2OSIgZmlsbD0ibm9uZSIgaWQ9InBvZC1wcmljZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyMjkuMjQiIHgyPSIyMjMuMjQiIHkxPSI0MDQuOTE2OSIgeTI9IjM5Ni45MTY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyOS4yNCIgeDI9IjIzNS4yNCIgeTE9IjQwNC45MTY5IiB5Mj0iMzk2LjkxNjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjI5LjI0IiB4Mj0iMjI5LjI0IiB5MT0iNDA0LjkxNjkiIHkyPSIzOTYuOTE2OSIvPjxlbGxpcHNlIGN4PSIyMjkuMjQiIGN5PSI0MTAuOTE2OSIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIzMy4yNCIgeDI9IjIyNS4yNCIgeTE9IjQ2OS4yNzY5IiB5Mj0iNDY5LjI3NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjMzLjI0IiB4Mj0iMjI1LjI0IiB5MT0iNDY2LjI3NjkiIHkyPSI0NjYuMjc2OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyMjkuMjQiIHgyPSIyMjkuMjQiIHkxPSI0NjUuMjc2OSIgeTI9IjQ3My4yNzY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTIuMDAwMSIgeD0iMjMwLjI0IiB5PSI0MzkuNjMzOCI+JiMyMTMzNjsmIzIwMzg1OyYjMjE0NDI7JiMyOTAzMTs8L3RleHQ+PC9nPjwhLS1saW5rIHBvZCB0byBsb2NhdGlvbi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDAzIiBkYXRhLWVudGl0eS0yPSJlbnQwMDA2IiBkYXRhLWxpbmstdHlwZT0iY3Jvd2Zvb3QiIGRhdGEtc291cmNlLWxpbmU9IjU2IiBpZD0ibG5rMTIiPjxwYXRoIGNvZGVMaW5lPSI1NiIgZD0iTTI5Ny4zMTI5LDQxMS41NDkzIEMzMjMuNzEyOSw0NDguMzk5MyAzMzQuNjAyOSw0NjMuNjA0MSAzNTYuMDQyOSw0OTMuNTI0MSIgZmlsbD0ibm9uZSIgaWQ9InBvZC1sb2NhdGlvbiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyOTEuNDg5MSIgeDI9IjI4MS45NTI1IiB5MT0iNDAzLjQyMDIiIHkyPSI0MDAuNDExMiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyOTEuNDg5MSIgeDI9IjI5MS43MDc1IiB5MT0iNDAzLjQyMDIiIHkyPSIzOTMuNDIyNiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyOTEuNDg5MSIgeDI9IjI4Ni44MyIgeTE9IjQwMy40MjAyIiB5Mj0iMzk2LjkxNjkiLz48ZWxsaXBzZSBjeD0iMjk0Ljk4MzQiIGN5PSI0MDguMjk3NyIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjM1OC4zNzI4IiB4Mj0iMzY0Ljc4IiB5MT0iNDk2Ljc3NTUiIHkyPSI1MDUuNzE2OSIvPjxlbGxpcHNlIGN4PSIzNTguMzcyOCIgY3k9IjQ5Ni43NzU1IiBmaWxsPSJub25lIiByeD0iNCIgcnk9IjQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzY1LjcwMTUiIHgyPSIzNTkuMTk4NyIgeTE9IjUwMC4xMzU2IiB5Mj0iNTA0Ljc5NTQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzOSIgeD0iMzE3LjE2IiB5PSI0MzkuNjMzOCI+JiMzMjAxMzsmIzIwODM3OyYjMjA4MDg7PC90ZXh0PjwvZz48P3BsYW50dW1sLXNyYyBUUDkxSnk4bTY4UmxfSE1ESC1GLTA2VFpPYXBLRV81ME84U2JQMkttM3VRSGkycUoyRThtMmM4cTFaMDg4UDVXTTY5R2IxeXBraDVfdVRRTW9JUlNzZHh6dGxWZnNxeUlmM0dGZE9URlVwQW1qOUFicEluclJZZFUtamJJZnNHelNmalRqX1cyMDJ6QVdkRzFUb0F0VHMwWTFwQzh2aTRrNHQ4UUdzbnltRlpmcUhkV0U4MkQ5ZnVyaTV3c3I4ZFZlYkxXX0MwaHFTbHNWR191TGplYkNyVWRlMTByaXJsTlpaY0VNZ09zVWt4dnNnbFpQVVNnR2NFZkdtOUhGM3dYNkZYTVNIdjdLSlFwWGxLVVJmanNmUldQa3A1c0ltUlJ1NWZoeVREUG5tdlNSNHQ3eE5TMlpCOGZGYWtHR21vaGJDOE9tM0RVbFloQ1hjc3lnRE95ZzZsbUtwSUtoOTNhWVNWWF9aUGZ6a21qbHlCVWlsWVVFdFMzanJkNV9RaGxJX1RPVVJCVmtiNEVjYkE4OHVzSTJLYjA4YTd2NS1FQVl2cFpVWXNhNWQyNTE3RmRjS25RT0Ziak9leUU2dkZyMWJFTUVHeGJvUnA0TzFBOUthOEdTdHdYVzNYRWJsLWFPc25lbDZ4V3RfUmhJNlJfdlhORC1rQWhQSWF0R1Q1aGZlNzc4OHFENndnWnp6VVJXbzN5Vlo5SlVsYU4/PjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_7">諸口品目の扱い<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p>マスタに登録されていない臨時品目（諸口品目）を発注する場合、発注明細データの「諸口品目区分」を <code>TRUE</code> に設定し、諸口品目情報テーブルに品目の詳細情報を登録します。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjQxOXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6Mzc0cHg7aGVpZ2h0OjQxOXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM3NCA0MTkiIHdpZHRoPSIzNzRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzU1NzY7JiMyMTQ3NTsmIzIxNjk3OyYjMzA0NDY7JiMxMjM5ODsmIzM4MzA2OyYjMzY4OTk7PC90aXRsZT48ZGVmcy8+PGc+PGcgY2xhc3M9InRpdGxlIiBkYXRhLXNvdXJjZS1saW5lPSIxIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iMTMxLjI1MDMiIHk9IjIyLjk5NTEiPiYjMzU1NzY7JiMyMTQ3NTsmIzIxNjk3OyYjMzA0NDY7JiMxMjM5ODsmIzM4MzA2OyYjMzY4OTk7PC90ZXh0PjwvZz48IS0tY2xhc3MgcG9kLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0icG9kIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBpZD0iZW50MDAwMiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMTMuMTg3NSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTI5Ljk5OTYiIHg9IjciIHk9IjQ0LjI5NjkiLz48ZWxsaXBzZSBjeD0iMjIiIGN5PSI2MC4yOTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yNi4xMDk0LDY2LjI5NjkgTDE4LjM5MDYsNjYuMjk2OSBMMTguMzkwNiw1My45MDYzIEwyNi4xMDk0LDUzLjkwNjMgTDI2LjEwOTQsNTYuMDYyNSBMMjAuODQzOCw1Ni4wNjI1IEwyMC44NDM4LDU4LjczNDQgTDI1LjYwOTQsNTguNzM0NCBMMjUuNjA5NCw2MC44OTA2IEwyMC44NDM4LDYwLjg5MDYgTDIwLjg0MzgsNjQuMTQwNiBMMjYuMTA5NCw2NC4xNDA2IEwyNi4xMDk0LDY2LjI5NjkgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSIzNiIgeT0iNjUuMTQzNiI+JiMzMDMzMDsmIzI3ODgwOyYjMjYxMjY7JiMzMjA0ODsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjEzNS45OTk2IiB5MT0iNzYuMjk2OSIgeTI9Ijc2LjI5NjkiLz48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjE4IiBjeT0iODkuOTQ1MyIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg4Ljk5NjgiIHg9IjI3IiB5PSI5My4yOTIiPiYjMzAzMzA7JiMyNzg4MDsmIzMwMDU4OyYjMjE0OTU7IFtQS108L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjEwNi4yNDIyIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjk5NjgiIHg9IjI3IiB5PSIxMDkuNTg4OSI+JiMzMDMzMDsmIzI3ODgwOyYjMzQ4OTI7JiMzMDA1ODsmIzIxNDk1OyBbUEtdPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI4IiB4Mj0iMTM1Ljk5OTYiIHkxPSIxMTYuODkwNiIgeTI9IjExNi44OTA2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMTMiIHk9IjEzMy44ODU3Ij4mIzIxNjk3OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjEzIiB5PSIxNTAuMTgyNiI+JiMzNTU3NjsmIzIxNDc1OyYjMjE2OTc7JiMzMDQ0NjsmIzIxMzA2OyYjMjA5OTg7PC90ZXh0PjwvZz48IS0tY2xhc3MgbWlzYy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Im1pc2MiIGRhdGEtc291cmNlLWxpbmU9IjExIiBpZD0iZW50MDAwMyI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxNzguMzc1IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTUuOTk5NiIgeD0iMTQiIHk9IjIzNC40NzY5Ii8+PGVsbGlwc2UgY3g9IjI5IiBjeT0iMjUwLjQ3NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTMzLjEwOTQsMjU2LjQ3NjkgTDI1LjM5MDYsMjU2LjQ3NjkgTDI1LjM5MDYsMjQ0LjA4NjMgTDMzLjEwOTQsMjQ0LjA4NjMgTDMzLjEwOTQsMjQ2LjI0MjUgTDI3Ljg0MzgsMjQ2LjI0MjUgTDI3Ljg0MzgsMjQ4LjkxNDQgTDMyLjYwOTQsMjQ4LjkxNDQgTDMyLjYwOTQsMjUxLjA3MDYgTDI3Ljg0MzgsMjUxLjA3MDYgTDI3Ljg0MzgsMjU0LjMyMDYgTDMzLjEwOTQsMjU0LjMyMDYgTDMzLjEwOTQsMjU2LjQ3NjkgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSI0MyIgeT0iMjU1LjMyMzYiPiYjMzU1NzY7JiMyMTQ3NTsmIzIxNjk3OyYjMzA0NDY7JiMyNDc3MzsmIzIyNTc3OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxNSIgeDI9IjEyOC45OTk2IiB5MT0iMjY2LjQ3NjkiIHkyPSIyNjYuNDc2OSIvPjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMjUiIGN5PSIyODAuMTI1MyIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ3LjkwNjMiIHg9IjM0IiB5PSIyODMuNDcyIj5JRCBbUEtdPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNSIgeDI9IjEyOC45OTk2IiB5MT0iMjkwLjc3MzgiIHkyPSIyOTAuNzczOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg4LjYwNzIiIHg9IjIwIiB5PSIzMDcuNzY4OSI+JiMzMDMzMDsmIzI3ODgwOyYjMzAwNTg7JiMyMTQ5NTsgW0ZLXTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDIuNjA3MSIgeD0iMjAiIHk9IjMyNC4wNjU3Ij4mIzMwMzMwOyYjMjc4ODA7JiMzNDg5MjsmIzMwMDU4OyYjMjE0OTU7IFtGS108L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMjAiIHk9IjM0MC4zNjI2Ij4mIzIxNjk3OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ljk5OTkiIHg9IjIwIiB5PSIzNTYuNjU5NSI+JiMyMTY5NzsmIzIxNTE3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNy45OTk5IiB4PSIyMCIgeT0iMzcyLjk1NjQiPiYjMzUyMTU7JiMyNjY4NDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMjAiIHk9IjM4OS4yNTMyIj4mIzIyMjU5OyYjMzAwNTg7JiMxMjUxMzsmIzEyNTQwOyYjMTI0NTk7JiMxMjU0MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjcuOTk5OSIgeD0iMjAiIHk9IjQwNS41NTAxIj4mIzI5MjU2OyYjMjU5Njg7PC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJHTU41IiBkYXRhLXNvdXJjZS1saW5lPSIyNiIgaWQ9ImVudDAwMDYiPjxwYXRoIGQ9Ik0xNjQuNSwzMDMuNTM2OSBMMTY0LjUsMzE5LjY2NjkgTDEzMC4zNSwzMjMuNjY2OSBMMTY0LjUsMzI3LjY2NjkgTDE2NC41LDM0My44MDI1IEEwLDAgMCAwIDAgMTY0LjUsMzQzLjgwMjUgTDM2Ny41MDAyLDM0My44MDI1IEEwLDAgMCAwIDAgMzY3LjUwMDIsMzQzLjgwMjUgTDM2Ny41MDAyLDMxMy41MzY5IEwzNTcuNTAwMiwzMDMuNTM2OSBMMTY0LjUsMzAzLjUzNjkgQTAsMCAwIDAgMCAxNjQuNSwzMDMuNTM2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTM1Ny41MDAyLDMwMy41MzY5IEwzNTcuNTAwMiwzMTMuNTM2OSBMMzY3LjUwMDIsMzEzLjUzNjkgTDM1Ny41MDAyLDMwMy41MzY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODIuMDAwMiIgeD0iMTcwLjUiIHk9IjMyMC42MDM4Ij4mIzIxNjk3OyYjMzA0NDY7JiMxMjUxMDsmIzEyNDczOyYjMTI0Nzk7JiMxMjM5NTsmIzMwMzMxOyYjMzc2ODI7JiMxMjM3MzsmIzEyNDI4OyYjMTIzOTA7JiMxMjM1NjsmIzEyMzk0OyYjMTIzNTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMC4wMDAyIiB4PSIxNzAuNSIgeT0iMzM1LjczNjYiPiYjMzMyNTY7JiMyNjE3ODsmIzIxNjk3OyYjMzA0NDY7JiMxMjM5ODsmIzI0NzczOyYjMjI1Nzc7JiMxMjQzNDsmIzIwNDQ1OyYjMjUzNDU7PC90ZXh0PjwvZz48IS0tbGluayBwb2QgdG8gbWlzYy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDAyIiBkYXRhLWVudGl0eS0yPSJlbnQwMDAzIiBkYXRhLWxpbmstdHlwZT0iYXNzb2NpYXRpb24iIGRhdGEtc291cmNlLWxpbmU9IjIzIiBpZD0ibG5rNCI+PHBhdGggY29kZUxpbmU9IjIzIiBkPSJNNzIsMTY1Ljg4NjkgQzcyLDE4OS4wMDY5IDcyLDE5My4zNzY5IDcyLDIxOS4wOTY5IiBmaWxsPSJub25lIiBpZD0icG9kLW1pc2MiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjgiIHgyPSI3NiIgeTE9IjE2MS44ODY5IiB5Mj0iMTYxLjg4NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjgiIHgyPSI3NiIgeTE9IjE2NC44ODY5IiB5Mj0iMTY0Ljg4NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNzIiIHgyPSI3MiIgeTE9IjE2NS44ODY5IiB5Mj0iMTU3Ljg4NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNzIiIHgyPSI3MiIgeTE9IjIyMy4wOTY5IiB5Mj0iMjM0LjA5NjkiLz48ZWxsaXBzZSBjeD0iNzIiIGN5PSIyMjMuMDk2OSIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9Ijc2IiB4Mj0iNjgiIHkxPSIyMzAuMDk2OSIgeTI9IjIzMC4wOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTEuMDAwMSIgeD0iNzMiIHk9IjIwMC41NDM4Ij4mIzM1NTc2OyYjMjE0NzU7JiMyMTY5NzsmIzMwNDQ2OyYjMTIzOTg7JiMyMjU4MDsmIzIxNTEyOzwvdGV4dD48L2c+PD9wbGFudHVtbC1zcmMgUFAzMUlpRDA1NE50eW5MM2JxOS1tQks4dWlRemsxMFJEUTJEc0RjOEFKV1BqSWI0S3ZJOGVJWWZYTDhRQURLS3I1aGVucG5kYWxvNWFxSFpoOWk3Uy1UbnB4c0ZRRUgwbk43bW5mcVVsd0xIUG1IcWJEbXo5TVN6WERHUXFTVzloYUpVTDhHM1NOeVRKU1IwY2kxY09DdWhVQmtFWl9HZ0ZhTEJFRC04dDI1dE5sN2NubGZNZVNMVGtvbWgybGg2YzY3Z21yZ2UzRVZzYjVrTmdGN0JCbHlBVGk3enZtbnlnREx0Q2xCUUljN3lEeUlnNUZ6NUlDTDVsZHBwelhNQS11eG1QdVh0R2hhQ2g5a3IzRUg0S1NpSXhaV0RiVE9yMzROSFpKcDB5a0JiazNfWFJHa1hjYXZLVkFwanhIRWl4c1F4RnJaczJFUXhGMV9HOEY4LTRsaTVnMGtjM1JHRnoxcGVLNHVLRG1WMkNtbEpsM1FPRHZfcDFzNUpVUGVnSlc1Vj8+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_8">納期管理・分納対応<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>発注明細には「受入予定日」と「回答納期」の 2 つの日付を持ちます。</p>
<table>
<thead>
<tr>
<th>フィールド</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>受入予定日</td>
<td>発注時に指定した希望納期</td>
</tr>
<tr>
<td>回答納期</td>
<td>仕入先から回答された実際の納期</td>
</tr>
</tbody>
</table>
<p>分納（分割納品）に対応するため、発注明細ごとに「入荷済数量」「検査済数量」「検収済数量」を管理します。</p>
<h3 id="java">Java エンティティの定義<a class="headerlink" href="#java" title="Permanent link">&para;</a></h3>
<details>
<summary>発注ステータス Enum</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/PurchaseOrderStatus.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Getter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>

<span class="nd">@Getter</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">CREATING</span><span class="p">(</span><span class="s">&quot;作成中&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">ORDERED</span><span class="p">(</span><span class="s">&quot;発注済&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">PARTIALLY_RECEIVED</span><span class="p">(</span><span class="s">&quot;一部入荷&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">RECEIVED</span><span class="p">(</span><span class="s">&quot;入荷完了&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">ACCEPTED</span><span class="p">(</span><span class="s">&quot;検収完了&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">CANCELLED</span><span class="p">(</span><span class="s">&quot;取消&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="nf">fromDisplayName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">values</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="na">displayName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">displayName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;不正な発注ステータス: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displayName</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>入荷受入区分 Enum</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/ReceivingType.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Getter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>

<span class="nd">@Getter</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NORMAL</span><span class="p">(</span><span class="s">&quot;通常入荷&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">SPLIT</span><span class="p">(</span><span class="s">&quot;分割入荷&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">RETURN</span><span class="p">(</span><span class="s">&quot;返品入荷&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="nf">fromDisplayName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">ReceivingType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">values</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="na">displayName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">displayName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;不正な入荷受入区分: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displayName</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>単価マスタエンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/UnitPrice.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.supplier.Supplier</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">UnitPrice</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">lotUnitQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">effectiveFrom</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">effectiveTo</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">unitPrice</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>発注データエンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/PurchaseOrder.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.supplier.Supplier</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">orderDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">ordererCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>発注明細データエンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/PurchaseOrderDetail.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.plan.Order</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrderDetail</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">orderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">deliveryLocationCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">miscellaneousItemFlag</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">expectedReceivingDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">confirmedDeliveryDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">orderUnitPrice</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">orderQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivedQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">inspectedQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">acceptedQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">orderAmount</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxAmount</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">completedFlag</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">detailRemarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Order</span><span class="w"> </span><span class="n">order</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MiscellaneousItem</span><span class="w"> </span><span class="n">miscellaneousItem</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Receiving</span><span class="o">&gt;</span><span class="w"> </span><span class="n">receivings</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Acceptance</span><span class="o">&gt;</span><span class="w"> </span><span class="n">acceptances</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>諸口品目情報エンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/MiscellaneousItem.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MiscellaneousItem</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemName</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">specification</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">manufacturerDrawingNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">revision</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="typehandler">TypeHandler の実装<a class="headerlink" href="#typehandler" title="Permanent link">&para;</a></h3>
<p>PostgreSQL の日本語 ENUM 型と Java の英語 Enum を相互変換するために TypeHandler を実装します。</p>
<details>
<summary>PurchaseOrderStatusTypeHandler</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/typehandler/PurchaseOrderStatusTypeHandler.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.typehandler</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrderStatus</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.type.BaseTypeHandler</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.type.JdbcType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.type.MappedTypes</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.CallableStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>

<span class="nd">@MappedTypes</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrderStatusTypeHandler</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseTypeHandler</span><span class="o">&lt;</span><span class="n">PurchaseOrderStatus</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setNonNullParameter</span><span class="p">(</span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">ps</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="n">JdbcType</span><span class="w"> </span><span class="n">jdbcType</span><span class="p">)</span>
<span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="p">.</span><span class="na">getDisplayName</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="nf">getNullableResult</span><span class="p">(</span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">columnName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">fromDisplayName</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="nf">getNullableResult</span><span class="p">(</span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">columnIndex</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnIndex</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">fromDisplayName</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="nf">getNullableResult</span><span class="p">(</span><span class="n">CallableStatement</span><span class="w"> </span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">columnIndex</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnIndex</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">fromDisplayName</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>ReceivingTypeTypeHandler</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/typehandler/ReceivingTypeTypeHandler.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.typehandler</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.ReceivingType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.type.BaseTypeHandler</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.type.JdbcType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.type.MappedTypes</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.CallableStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.PreparedStatement</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.ResultSet</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.SQLException</span><span class="p">;</span>

<span class="nd">@MappedTypes</span><span class="p">(</span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ReceivingTypeTypeHandler</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseTypeHandler</span><span class="o">&lt;</span><span class="n">ReceivingType</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">setNonNullParameter</span><span class="p">(</span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">ps</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="n">parameter</span><span class="p">,</span><span class="w"> </span><span class="n">JdbcType</span><span class="w"> </span><span class="n">jdbcType</span><span class="p">)</span>
<span class="w">            </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">ps</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">parameter</span><span class="p">.</span><span class="na">getDisplayName</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="nf">getNullableResult</span><span class="p">(</span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">columnName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnName</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">fromDisplayName</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="nf">getNullableResult</span><span class="p">(</span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">columnIndex</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnIndex</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">fromDisplayName</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="nf">getNullableResult</span><span class="p">(</span><span class="n">CallableStatement</span><span class="w"> </span><span class="n">cs</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">columnIndex</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SQLException</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="n">columnIndex</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">fromDisplayName</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="mybatis-mapper-xml">MyBatis Mapper XML<a class="headerlink" href="#mybatis-mapper-xml" title="Permanent link">&para;</a></h3>
<details>
<summary>UnitPriceMapper.xml</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- src/main/resources/mapper/UnitPriceMapper.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.UnitPriceMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;UnitPriceResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.UnitPrice&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;取引先コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lotUnitQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ロット単位数&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;effectiveFrom&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;使用開始日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;effectiveTo&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;使用停止日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;unitPrice&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;単価&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;単価マスタ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;品目コード&quot;,<span class="w"> </span>&quot;取引先コード&quot;,<span class="w"> </span>&quot;ロット単位数&quot;,<span class="w"> </span>&quot;使用開始日&quot;,
<span class="w">            </span>&quot;使用停止日&quot;,<span class="w"> </span>&quot;単価&quot;,<span class="w"> </span>&quot;作成者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{itemCode},
<span class="w">            </span>#{supplierCode},
<span class="w">            </span>#{lotUnitQuantity},
<span class="w">            </span>#{effectiveFrom},
<span class="w">            </span>#{effectiveTo},
<span class="w">            </span>#{unitPrice},
<span class="w">            </span>#{createdBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findEffectiveUnitPrice&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;UnitPriceResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;単価マスタ&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;品目コード&quot;<span class="w"> </span>=<span class="w"> </span>#{itemCode}
<span class="w">          </span>AND<span class="w"> </span>&quot;取引先コード&quot;<span class="w"> </span>=<span class="w"> </span>#{supplierCode}
<span class="w">          </span>AND<span class="w"> </span>&quot;使用開始日&quot;<span class="w"> </span><span class="ni">&amp;lt;</span>=<span class="w"> </span>#{date}
<span class="w">          </span>AND<span class="w"> </span>(&quot;使用停止日&quot;<span class="w"> </span>IS<span class="w"> </span>NULL<span class="w"> </span>OR<span class="w"> </span>&quot;使用停止日&quot;<span class="w"> </span><span class="ni">&amp;gt;</span>=<span class="w"> </span>#{date})
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;使用開始日&quot;<span class="w"> </span>DESC
<span class="w">        </span>LIMIT<span class="w"> </span>1
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;単価マスタ&quot;
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<details>
<summary>PurchaseOrderMapper.xml</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- src/main/resources/mapper/PurchaseOrderMapper.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.PurchaseOrderMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrder&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;取引先コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;ordererCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注担当者コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;departmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注部門コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;status&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ステータス&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;remarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 INSERT --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrder&quot;</span>
<span class="w">            </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注日&quot;,<span class="w"> </span>&quot;取引先コード&quot;,<span class="w"> </span>&quot;発注担当者コード&quot;,<span class="w"> </span>&quot;発注部門コード&quot;,
<span class="w">            </span>&quot;ステータス&quot;,<span class="w"> </span>&quot;備考&quot;,<span class="w"> </span>&quot;作成者&quot;,<span class="w"> </span>&quot;更新者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{orderDate},
<span class="w">            </span>#{supplierCode},
<span class="w">            </span>#{ordererCode},
<span class="w">            </span>#{departmentCode},
<span class="w">            </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler}::発注ステータス,
<span class="w">            </span>#{remarks},
<span class="w">            </span>#{createdBy},
<span class="w">            </span>#{updatedBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 INSERT --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrder&quot;</span>
<span class="w">            </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注日&quot;,<span class="w"> </span>&quot;取引先コード&quot;,<span class="w"> </span>&quot;発注担当者コード&quot;,<span class="w"> </span>&quot;発注部門コード&quot;,
<span class="w">            </span>&quot;ステータス&quot;,<span class="w"> </span>&quot;備考&quot;,<span class="w"> </span>&quot;作成者&quot;,<span class="w"> </span>&quot;更新者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{orderDate},
<span class="w">            </span>#{supplierCode},
<span class="w">            </span>#{ordererCode},
<span class="w">            </span>#{departmentCode},
<span class="w">            </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler},
<span class="w">            </span>#{remarks},
<span class="w">            </span>#{createdBy},
<span class="w">            </span>#{updatedBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findById&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByPurchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findBySupplierCode&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;取引先コード&quot;<span class="w"> </span>=<span class="w"> </span>#{supplierCode}<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;発注日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 findByStatus --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByStatus&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ステータス&quot;<span class="w"> </span>=<span class="w"> </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler}::発注ステータス<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;発注日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 findByStatus --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByStatus&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ステータス&quot;<span class="w"> </span>=<span class="w"> </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler}<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;発注日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findAll&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;発注日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 updateStatus --&gt;</span>
<span class="w">    </span><span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateStatus&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>UPDATE<span class="w"> </span>&quot;発注データ&quot;
<span class="w">        </span>SET<span class="w"> </span>&quot;ステータス&quot;<span class="w"> </span>=<span class="w"> </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler}::発注ステータス,
<span class="w">            </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span><span class="nt">&lt;/update&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 updateStatus --&gt;</span>
<span class="w">    </span><span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateStatus&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>UPDATE<span class="w"> </span>&quot;発注データ&quot;
<span class="w">        </span>SET<span class="w"> </span>&quot;ステータス&quot;<span class="w"> </span>=<span class="w"> </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler},
<span class="w">            </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span><span class="nt">&lt;/update&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>TRUNCATE<span class="w"> </span>TABLE<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>CASCADE
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<details>
<summary>PurchaseOrderDetailMapper.xml</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- src/main/resources/mapper/PurchaseOrderDetailMapper.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.PurchaseOrderDetailMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;PurchaseOrderDetailResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrderDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;オーダNO&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;deliveryLocationCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;納入場所コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;miscellaneousItemFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;諸口品目区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;expectedReceivingDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;受入予定日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;confirmedDeliveryDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;回答納期&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderUnitPrice&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注単価&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷済数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検査済数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収済数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;消費税金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;completedFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;完了フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;detailRemarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;明細備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;発注明細データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注行番号&quot;,<span class="w"> </span>&quot;オーダNO&quot;,<span class="w"> </span>&quot;納入場所コード&quot;,<span class="w"> </span>&quot;品目コード&quot;,
<span class="w">            </span>&quot;諸口品目区分&quot;,<span class="w"> </span>&quot;受入予定日&quot;,<span class="w"> </span>&quot;回答納期&quot;,<span class="w"> </span>&quot;発注単価&quot;,<span class="w"> </span>&quot;発注数量&quot;,
<span class="w">            </span>&quot;発注金額&quot;,<span class="w"> </span>&quot;消費税金額&quot;,<span class="w"> </span>&quot;作成者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{lineNumber},
<span class="w">            </span>#{orderNumber},
<span class="w">            </span>#{deliveryLocationCode},
<span class="w">            </span>#{itemCode},
<span class="w">            </span>#{miscellaneousItemFlag},
<span class="w">            </span>#{expectedReceivingDate},
<span class="w">            </span>#{confirmedDeliveryDate},
<span class="w">            </span>#{orderUnitPrice},
<span class="w">            </span>#{orderQuantity},
<span class="w">            </span>#{orderAmount},
<span class="w">            </span>#{taxAmount},
<span class="w">            </span>#{createdBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByPurchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderDetailResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;発注行番号&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByPurchaseOrderNumberAndLineNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PurchaseOrderDetailResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}<span class="w"> </span>AND<span class="w"> </span>&quot;発注行番号&quot;<span class="w"> </span>=<span class="w"> </span>#{lineNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateReceivedQuantity&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>UPDATE<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">        </span>SET<span class="w"> </span>&quot;入荷済数量&quot;<span class="w"> </span>=<span class="w"> </span>#{receivedQuantity},<span class="w"> </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}<span class="w"> </span>AND<span class="w"> </span>&quot;発注行番号&quot;<span class="w"> </span>=<span class="w"> </span>#{lineNumber}
<span class="w">    </span><span class="nt">&lt;/update&gt;</span>

<span class="w">    </span><span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateAcceptedQuantity&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>UPDATE<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">        </span>SET<span class="w"> </span>&quot;検収済数量&quot;<span class="w"> </span>=<span class="w"> </span>#{acceptedQuantity},<span class="w"> </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}<span class="w"> </span>AND<span class="w"> </span>&quot;発注行番号&quot;<span class="w"> </span>=<span class="w"> </span>#{lineNumber}
<span class="w">    </span><span class="nt">&lt;/update&gt;</span>

<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<h3 id="mapper">Mapper インターフェース<a class="headerlink" href="#mapper" title="Permanent link">&para;</a></h3>
<details>
<summary>UnitPriceMapper</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/mapper/UnitPriceMapper.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.UnitPrice</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">UnitPriceMapper</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">UnitPrice</span><span class="w"> </span><span class="n">unitPrice</span><span class="p">);</span>
<span class="w">    </span><span class="n">UnitPrice</span><span class="w"> </span><span class="nf">findEffectiveUnitPrice</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;itemCode&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">,</span>
<span class="w">                                     </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;supplierCode&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">,</span>
<span class="w">                                     </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>PurchaseOrderMapper</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/mapper/PurchaseOrderMapper.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrderStatus</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">PurchaseOrderMapper</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">);</span>
<span class="w">    </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="nf">findById</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">    </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="nf">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrder</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findBySupplierCode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrder</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByStatus</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrder</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findAll</span><span class="p">();</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateStatus</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>PurchaseOrderDetailMapper</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/mapper/PurchaseOrderDetailMapper.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrderDetail</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">PurchaseOrderDetailMapper</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">detail</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">    </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="nf">findByPurchaseOrderNumberAndLineNumber</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;lineNumber&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateReceivedQuantity</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">,</span>
<span class="w">                                </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;lineNumber&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">,</span>
<span class="w">                                </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;receivedQuantity&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivedQuantity</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateAcceptedQuantity</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">,</span>
<span class="w">                                </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;lineNumber&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">,</span>
<span class="w">                                </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;acceptedQuantity&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">acceptedQuantity</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="_9">発注サービスの実装<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h3>
<details>
<summary>PurchaseOrderService</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/service/PurchaseOrderService.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.RoundingMode</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.format.DateTimeFormatter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrderService</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PurchaseOrderMapper</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PurchaseOrderDetailMapper</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">UnitPriceMapper</span><span class="w"> </span><span class="n">unitPriceMapper</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 発注番号を生成する</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generatePurchaseOrderNumber</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">orderDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PO-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">orderDate</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&quot;yyyyMM&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">latestNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">findLatestPurchaseOrderNumber</span><span class="p">(</span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">latestNumber</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="w">            </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%04d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sequence</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 発注を作成する</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="nf">createPurchaseOrder</span><span class="p">(</span><span class="n">PurchaseOrderCreateInput</span><span class="w"> </span><span class="n">input</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generatePurchaseOrderNumber</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">getOrderDate</span><span class="p">());</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">getTaxRate</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">getTaxRate</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 発注ヘッダを作成</span>
<span class="w">        </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">getOrderDate</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">getSupplierCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">ordererCode</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">getOrdererCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">departmentCode</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">getDepartmentCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CREATING</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">remarks</span><span class="p">(</span><span class="n">input</span><span class="p">.</span><span class="na">getRemarks</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 発注明細を作成</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">lineNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">PurchaseOrderDetailInput</span><span class="w"> </span><span class="n">detailInput</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">getDetails</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">lineNumber</span><span class="o">++</span><span class="p">;</span>

<span class="w">            </span><span class="c1">// 単価を取得</span>
<span class="w">            </span><span class="n">UnitPrice</span><span class="w"> </span><span class="n">unitPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">findEffectiveUnitPrice</span><span class="p">(</span>
<span class="w">                    </span><span class="n">detailInput</span><span class="p">.</span><span class="na">getItemCode</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">input</span><span class="p">.</span><span class="na">getSupplierCode</span><span class="p">(),</span>
<span class="w">                    </span><span class="n">input</span><span class="p">.</span><span class="na">getOrderDate</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">unitPrice</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span>
<span class="w">                        </span><span class="s">&quot;Unit price not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">detailInput</span><span class="p">.</span><span class="na">getItemCode</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; / &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">input</span><span class="p">.</span><span class="na">getSupplierCode</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// 金額計算</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">orderAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unitPrice</span><span class="p">.</span><span class="na">getUnitPrice</span><span class="p">().</span><span class="na">multiply</span><span class="p">(</span><span class="n">detailInput</span><span class="p">.</span><span class="na">getOrderQuantity</span><span class="p">());</span>
<span class="w">            </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">orderAmount</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="n">taxRate</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>

<span class="w">            </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">detail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrderDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="n">lineNumber</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderNumber</span><span class="p">(</span><span class="n">detailInput</span><span class="p">.</span><span class="na">getOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">deliveryLocationCode</span><span class="p">(</span><span class="n">detailInput</span><span class="p">.</span><span class="na">getDeliveryLocationCode</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="n">detailInput</span><span class="p">.</span><span class="na">getItemCode</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">miscellaneousItemFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">expectedReceivingDate</span><span class="p">(</span><span class="n">detailInput</span><span class="p">.</span><span class="na">getExpectedReceivingDate</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderUnitPrice</span><span class="p">(</span><span class="n">unitPrice</span><span class="p">.</span><span class="na">getUnitPrice</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderQuantity</span><span class="p">(</span><span class="n">detailInput</span><span class="p">.</span><span class="na">getOrderQuantity</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderAmount</span><span class="p">(</span><span class="n">orderAmount</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">taxAmount</span><span class="p">(</span><span class="n">taxAmount</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">detail</span><span class="p">);</span>

<span class="w">            </span><span class="n">details</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">detail</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">setDetails</span><span class="p">(</span><span class="n">details</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 発注を確定する</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="nf">confirmPurchaseOrder</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Purchase order not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getStatus</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CREATING</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Only creating purchase orders can be confirmed: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">updateStatus</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">,</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">ORDERED</span><span class="p">);</span>
<span class="w">        </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">ORDERED</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 発注を取消する</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="nf">cancelPurchaseOrder</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Purchase order not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">        </span><span class="kt">boolean</span><span class="w"> </span><span class="n">hasReceived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">anyMatch</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span>
<span class="w">                        </span><span class="n">d</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">().</span><span class="na">compareTo</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">hasReceived</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Cannot cancel purchase order with received items: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">updateStatus</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">,</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CANCELLED</span><span class="p">);</span>
<span class="w">        </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">setStatus</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CANCELLED</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>入力 DTO クラス</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/service/PurchaseOrderCreateInput.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrderCreateInput</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">orderDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">ordererCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxRate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrderDetailInput</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/service/PurchaseOrderDetailInput.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrderDetailInput</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">orderQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">expectedReceivingDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">orderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">deliveryLocationCode</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="tdd">TDD: 発注データの登録テスト<a class="headerlink" href="#tdd" title="Permanent link">&para;</a></h3>
<details>
<summary>PurchaseOrderServiceTest</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/test/java/com/example/pms/application/service/PurchaseOrderServiceTest.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.ItemCategory</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.master.Supplier</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.mybatis.spring.boot.test.autoconfigure.MybatisTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Import</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertyRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertySource</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.containers.PostgreSQLContainer</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Container</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Testcontainers</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.*</span><span class="p">;</span>

<span class="nd">@MybatisTest</span>
<span class="nd">@AutoConfigureTestDatabase</span><span class="p">(</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AutoConfigureTestDatabase</span><span class="p">.</span><span class="na">Replace</span><span class="p">.</span><span class="na">NONE</span><span class="p">)</span>
<span class="nd">@Import</span><span class="p">(</span><span class="n">PurchaseOrderService</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="nd">@Testcontainers</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;発注業務&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">PurchaseOrderServiceTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Container</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="s">&quot;postgres:15&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withDatabaseName</span><span class="p">(</span><span class="s">&quot;testdb&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withUsername</span><span class="p">(</span><span class="s">&quot;testuser&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withPassword</span><span class="p">(</span><span class="s">&quot;testpass&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@DynamicPropertySource</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureProperties</span><span class="p">(</span><span class="n">DynamicPropertyRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getJdbcUrl</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.username&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getUsername</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getPassword</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderService</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderMapper</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderDetailMapper</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ItemMapper</span><span class="w"> </span><span class="n">itemMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">SupplierMapper</span><span class="w"> </span><span class="n">supplierMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UnitPriceMapper</span><span class="w"> </span><span class="n">unitPriceMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">supplierMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">itemMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;発注データの作成&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">PurchaseOrderCreation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;購買オーダから発注データを作成できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canCreatePurchaseOrderFromOrder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange: マスタデータを準備</span>
<span class="w">            </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Supplier</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierName</span><span class="p">(</span><span class="s">&quot;テスト仕入先株式会社&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierNameKana</span><span class="p">(</span><span class="s">&quot;テストシイレサキカブシキガイシャ&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">supplierMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">supplier</span><span class="p">);</span>

<span class="w">            </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Item</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemName</span><span class="p">(</span><span class="s">&quot;材料A&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCategory</span><span class="p">(</span><span class="n">ItemCategory</span><span class="p">.</span><span class="na">MATERIAL</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">itemMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="w">            </span><span class="n">UnitPrice</span><span class="w"> </span><span class="n">unitPrice</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UnitPrice</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">unitPrice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">unitPrice</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act: 発注を作成</span>
<span class="w">            </span><span class="n">PurchaseOrderCreateInput</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrderCreateInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">taxRate</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                            </span><span class="n">PurchaseOrderDetailInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-001&quot;</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">orderQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">expectedReceivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">                    </span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">.</span><span class="na">createPurchaseOrder</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">).</span><span class="na">isNotNull</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">()).</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;PO-&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getStatus</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CREATING</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getDetails</span><span class="p">()).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getDetails</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">getOrderQuantity</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getDetails</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">getOrderUnitPrice</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getDetails</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">getOrderAmount</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;発注を発注済ステータスに変更できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canConfirmPurchaseOrder</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange: 発注データを準備</span>
<span class="w">            </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Supplier</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-003&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierName</span><span class="p">(</span><span class="s">&quot;ステータス確認用仕入先&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">supplierMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">supplier</span><span class="p">);</span>

<span class="w">            </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Item</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-004&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemName</span><span class="p">(</span><span class="s">&quot;材料D&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCategory</span><span class="p">(</span><span class="n">ItemCategory</span><span class="p">.</span><span class="na">MATERIAL</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">itemMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="w">            </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">UnitPrice</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-004&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-003&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">unitPrice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;2000&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="n">PurchaseOrderCreateInput</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrderCreateInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-003&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                            </span><span class="n">PurchaseOrderDetailInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-004&quot;</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">orderQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">))</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">expectedReceivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">                    </span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">.</span><span class="na">createPurchaseOrder</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act: 発注確定</span>
<span class="w">            </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">confirmedOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">.</span><span class="na">confirmPurchaseOrder</span><span class="p">(</span>
<span class="w">                    </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">confirmedOrder</span><span class="p">.</span><span class="na">getStatus</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">ORDERED</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;消費税計算&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">TaxCalculation</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;消費税額が正しく計算される&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">calculatesTaxCorrectly</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Supplier</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-004&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierName</span><span class="p">(</span><span class="s">&quot;消費税確認用仕入先&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">supplierMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">supplier</span><span class="p">);</span>

<span class="w">            </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Item</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-005&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemName</span><span class="p">(</span><span class="s">&quot;材料E&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCategory</span><span class="p">(</span><span class="n">ItemCategory</span><span class="p">.</span><span class="na">MATERIAL</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">itemMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="w">            </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">UnitPrice</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-005&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-004&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">unitPrice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="n">PurchaseOrderCreateInput</span><span class="w"> </span><span class="n">input</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrderCreateInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-004&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">taxRate</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                            </span><span class="n">PurchaseOrderDetailInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-005&quot;</span><span class="p">)</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">orderQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">expectedReceivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                                    </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">                    </span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">.</span><span class="na">createPurchaseOrder</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert: 100 × 1000 = 100,000円、消費税 10,000円</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getDetails</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">getOrderAmount</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getDetails</span><span class="p">().</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">getTaxAmount</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10000&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="252-db">25.2 入荷・検収業務の DB 設計<a class="headerlink" href="#252-db" title="Permanent link">&para;</a></h2>
<p>入荷・検収業務は、発注した品目が納品された後の一連の処理を管理します。</p>
<h3 id="_10">入荷・受入業務の流れ<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkFDVElWSVRZIiBoZWlnaHQ9IjQ2NnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDY5cHg7aGVpZ2h0OjQ2NnB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQ2OSA0NjYiIHdpZHRoPSI0NjlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjA4Mzc7JiMzMzY1NTsmIzEyMzYzOyYjMTI0MjU7JiMyNjkwODsmIzIxNDU0OyYjMTI0MTQ7JiMxMjM5MTsmIzEyMzk4OyYjMjc5Njk7JiMxMjQyODs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuOTk5MyIgeD0iMTU2LjAwMDgiIHk9IjMyLjk5NTEiPiYjMjA4Mzc7JiMzMzY1NTsmIzEyMzYzOyYjMTI0MjU7JiMyNjkwODsmIzIxNDU0OyYjMTI0MTQ7JiMxMjM5MTsmIzEyMzk4OyYjMjc5Njk7JiMxMjQyODs8L3RleHQ+PC9nPjxlbGxpcHNlIGN4PSIxNjEuNTAwNCIgY3k9IjU3LjI5NjkiIGZpbGw9IiMyMjIyMjIiIHJ4PSIxMCIgcnk9IjEwIiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjY4LjAwMDQiIHg9IjEyNy41MDAyIiB5PSI4Ny4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iMTM3LjUwMDIiIHk9IjEwOC40MzU1Ij4mIzMwMzMwOyYjMjc4ODA7JiMyNjEyNjsmIzMyMDQ4OzwvdGV4dD48cGF0aCBkPSJNMjE1LjUwMDYsMTM4LjExNzIgTDIxNS41MDA2LDE1NC4yNSBMMTk1LjUwMDYsMTU4LjI1IEwyMTUuNTAwNiwxNjIuMjUgTDIxNS41MDA2LDE3OC4zODI4IEEwLDAgMCAwIDAgMjE1LjUwMDYsMTc4LjM4MjggTDM2Ni41MDA4LDE3OC4zODI4IEEwLDAgMCAwIDAgMzY2LjUwMDgsMTc4LjM4MjggTDM2Ni41MDA4LDE0OC4xMTcyIEwzNTYuNTAwOCwxMzguMTE3MiBMMjE1LjUwMDYsMTM4LjExNzIgQTAsMCAwIDAgMCAyMTUuNTAwNiwxMzguMTE3MiIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTM1Ni41MDA4LDEzOC4xMTcyIEwzNTYuNTAwOCwxNDguMTE3MiBMMzY2LjUwMDgsMTQ4LjExNzIgTDM1Ni41MDA4LDEzOC4xMTcyIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzAuMDAwMiIgeD0iMjIxLjUwMDYiIHk9IjE1NS4xODQxIj4mIzEyNTM5OyYjMzIwMTM7JiMyMTY5NzsmIzI2MzYwOyYjMTIzOTI7JiMyOTY5NDsmIzIxNjk3OyYjMTIzOTg7JiMzMDkwNjsmIzM1NDY5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuMDAwMSIgeD0iMjIxLjUwMDYiIHk9IjE3MC4zMTY5Ij4mIzEyNTM5OyYjMjA4Mzc7JiMzMzY1NTsmIzI1OTY4OyYjMzczMjc7JiMxMjM5ODsmIzM1MzUyOyYjMzc2ODI7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI2OC4wMDA0IiB4PSIxMjcuNTAwMiIgeT0iMTQxLjI2NTYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OC4wMDA0IiB4PSIxMzcuNTAwMiIgeT0iMTYyLjQwNDMiPiYjMjA4Mzc7JiMzMzY1NTsmIzIxNDYzOyYjMjAxODQ7PC90ZXh0PjxwYXRoIGQ9Ik0yMTUuNTAwNiwxOTUuMjM0NCBMMjE1LjUwMDYsMjExLjM2NzIgTDE5NS41MDA2LDIxNS4zNjcyIEwyMTUuNTAwNiwyMTkuMzY3MiBMMjE1LjUwMDYsMjM1LjUgQTAsMCAwIDAgMCAyMTUuNTAwNiwyMzUuNSBMMzU3Ljg4MDYsMjM1LjUgQTAsMCAwIDAgMCAzNTcuODgwNiwyMzUuNSBMMzU3Ljg4MDYsMjA1LjIzNDQgTDM0Ny44ODA2LDE5NS4yMzQ0IEwyMTUuNTAwNiwxOTUuMjM0NCBBMCwwIDAgMCAwIDIxNS41MDA2LDE5NS4yMzQ0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMzQ3Ljg4MDYsMTk1LjIzNDQgTDM0Ny44ODA2LDIwNS4yMzQ0IEwzNTcuODgwNiwyMDUuMjM0NCBMMzQ3Ljg4MDYsMTk1LjIzNDQiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNC4wMDAxIiB4PSIyMjEuNTAwNiIgeT0iMjEyLjMwMTMiPiYjMTI1Mzk7JiMyMTY5NzsmIzM2MDc0OyYjMjY5MDg7JiMyNjYxOTsmIzEyMzk4OyYjMjM0NTU7JiMyNjA0NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIxLjM4IiB4PSIyMjEuNTAwNiIgeT0iMjI3LjQzNDEiPiYjMTI1Mzk7JiMzMzM5MTsmIzIxNjk3Oy8mIzE5OTgxOyYjMzMzOTE7JiMyMTY5NzsmIzEyMzk4OyYjMjEwMjg7JiMyMzQ1MDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjY4LjAwMDQiIHg9IjEyNy41MDAyIiB5PSIxOTguMzgyOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ4LjAwMDQiIHg9IjEzNy41MDAyIiB5PSIyMTkuNTIxNSI+JiMyMTQ2MzsmIzIwODM3OyYjMjY5MDg7JiMyNjYxOTs8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0YxRjFGMSIgcG9pbnRzPSIxMzkuNTAwNiwyNTUuNSwxODMuNTAwMywyNTUuNSwxOTUuNTAwMywyNjcuNSwxODMuNTAwMywyNzkuNSwxMzkuNTAwNiwyNzkuNSwxMjcuNTAwNiwyNjcuNSwxMzkuNTAwNiwyNTUuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDMuOTk5NyIgeD0iMTM5LjUwMDYiIHk9IjI3MS4zMDgxIj4mIzI2OTA4OyYjMjY2MTk7JiMzMjA4MDsmIzI2NTI0OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMS45OTk4IiB4PSIxMDUuNTAwNyIgeT0iMjY0LjkwNTgiPiYjMjE1MTI7JiMyNjY4NDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzIuOTk5OCIgeD0iMTk1LjUwMDMiIHk9IjI2NC45MDU4Ij4mIzE5OTgxOyYjMjE1MTI7JiMyNjY4NDs8L3RleHQ+PHBhdGggZD0iTTk5LjAwMDQsMjg5LjUgTDk5LjAwMDQsMzA1LjYzMjggTDc5LjAwMDQsMzA5LjYzMjggTDk5LjAwMDQsMzEzLjYzMjggTDk5LjAwMDQsMzI5Ljc2NTYgQTAsMCAwIDAgMCA5OS4wMDA0LDMyOS43NjU2IEwyMjQuMDAwNSwzMjkuNzY1NiBBMCwwIDAgMCAwIDIyNC4wMDA1LDMyOS43NjU2IEwyMjQuMDAwNSwyOTkuNSBMMjE0LjAwMDUsMjg5LjUgTDk5LjAwMDQsMjg5LjUgQTAsMCAwIDAgMCA5OS4wMDA0LDI4OS41IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMjE0LjAwMDUsMjg5LjUgTDIxNC4wMDA1LDI5OS41IEwyMjQuMDAwNSwyOTkuNSBMMjE0LjAwMDUsMjg5LjUiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNC4wMDAxIiB4PSIxMDUuMDAwNCIgeT0iMzA2LjU2NjkiPiYjMTI1Mzk7JiMyNjkwODsmIzIxNDU0OyYjMjU5Njg7JiMzNzMyNzsmIzEyMzk4OyYjMzA5MDY7JiMyMzQ1MDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjUuMDAwMSIgeD0iMTA1LjAwMDQiIHk9IjMyMS42OTk3Ij4mIzEyNTM5OyYjMjAxODE7JiMyMDgzNzsmIzM1MzM2OyYjMTk5Nzg7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI2OC4wMDA0IiB4PSIxMSIgeT0iMjkyLjY0ODQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OC4wMDA0IiB4PSIyMSIgeT0iMzEzLjc4NzEiPiYjMjY5MDg7JiMyMTQ1NDsmIzIwOTY2OyYjMjk3MDI7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI2OC4wMDA0IiB4PSIxMSIgeT0iMzQ5Ljc2NTYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OC4wMDA0IiB4PSIyMSIgeT0iMzcwLjkwNDMiPiYjMjIzMTI7JiMyNDIzNTsmIzM1MzM2OyYjMTk5Nzg7PC90ZXh0PjxwYXRoIGQ9Ik0zMzIuMDAwOSwyODkuNSBMMzMyLjAwMDksMzA1LjYzMjggTDMxMi4wMDA5LDMwOS42MzI4IEwzMzIuMDAwOSwzMTMuNjMyOCBMMzMyLjAwMDksMzI5Ljc2NTYgQTAsMCAwIDAgMCAzMzIuMDAwOSwzMjkuNzY1NiBMNDU3LjAwMSwzMjkuNzY1NiBBMCwwIDAgMCAwIDQ1Ny4wMDEsMzI5Ljc2NTYgTDQ1Ny4wMDEsMjk5LjUgTDQ0Ny4wMDEsMjg5LjUgTDMzMi4wMDA5LDI4OS41IEEwLDAgMCAwIDAgMzMyLjAwMDksMjg5LjUiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik00NDcuMDAxLDI4OS41IEw0NDcuMDAxLDI5OS41IEw0NTcuMDAxLDI5OS41IEw0NDcuMDAxLDI4OS41IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NS4wMDAxIiB4PSIzMzguMDAwOSIgeT0iMzA2LjU2NjkiPiYjMTI1Mzk7JiMzNjgyMDsmIzIxNjk3OyYjMjA5NjY7JiMyOTcwMjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA0LjAwMDEiIHg9IjMzOC4wMDA5IiB5PSIzMjEuNjk5NyI+JiMxMjUzOTsmIzIwMTgxOyYjMjA4Mzc7JiMyMDgwODsmIzEyNDA4OyYjMTIzOTg7JiMzNjg5MDsmIzMwNjkzOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjguMDAwNCIgeD0iMjQ0LjAwMDUiIHk9IjI5Mi42NDg0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iMjU0LjAwMDUiIHk9IjMxMy43ODcxIj4mIzI2OTA4OyYjMjE0NTQ7JiMzNjgyMDsmIzIxNjk3OzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9IjE2MS41MDA0LDM4OS43MzQ0LDE3My41MDA0LDQwMS43MzQ0LDE2MS41MDA0LDQxMy43MzQ0LDE0OS41MDA0LDQwMS43MzQ0LDE2MS41MDA0LDM4OS43MzQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48ZWxsaXBzZSBjeD0iMTYxLjUwMDQiIGN5PSI0NDQuNzM0NCIgZmlsbD0ibm9uZSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzIyMjIyMjtzdHJva2Utd2lkdGg6MTsiLz48ZWxsaXBzZSBjeD0iMTYxLjUwMDQiIGN5PSI0NDQuNzM0NCIgZmlsbD0iIzIyMjIyMiIgcng9IjYiIHJ5PSI2IiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE2MS41MDA0IiB4Mj0iMTYxLjUwMDQiIHkxPSI2Ny4yOTY5IiB5Mj0iODcuMjk2OSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTU3LjUwMDQsNzcuMjk2OSwxNjEuNTAwNCw4Ny4yOTY5LDE2NS41MDA0LDc3LjI5NjksMTYxLjUwMDQsODEuMjk2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNjEuNTAwNCIgeDI9IjE2MS41MDA0IiB5MT0iMTIxLjI2NTYiIHkyPSIxNDEuMjY1NiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTU3LjUwMDQsMTMxLjI2NTYsMTYxLjUwMDQsMTQxLjI2NTYsMTY1LjUwMDQsMTMxLjI2NTYsMTYxLjUwMDQsMTM1LjI2NTYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTYxLjUwMDQiIHgyPSIxNjEuNTAwNCIgeTE9IjE3NS4yMzQ0IiB5Mj0iMTk4LjM4MjgiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE1Ny41MDA0LDE4OC4zODI4LDE2MS41MDA0LDE5OC4zODI4LDE2NS41MDA0LDE4OC4zODI4LDE2MS41MDA0LDE5Mi4zODI4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ1LjAwMDIiIHgyPSI0NS4wMDAyIiB5MT0iMzI2LjYxNzIiIHkyPSIzNDkuNzY1NiIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDEuMDAwMiwzMzkuNzY1Niw0NS4wMDAyLDM0OS43NjU2LDQ5LjAwMDIsMzM5Ljc2NTYsNDUuMDAwMiwzNDMuNzY1NiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjcuNTAwNiIgeDI9IjQ1LjAwMDIiIHkxPSIyNjcuNSIgeTI9IjI2Ny41Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ1LjAwMDIiIHgyPSI0NS4wMDAyIiB5MT0iMjY3LjUiIHkyPSIyOTIuNjQ4NCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDEuMDAwMiwyODIuNjQ4NCw0NS4wMDAyLDI5Mi42NDg0LDQ5LjAwMDIsMjgyLjY0ODQsNDUuMDAwMiwyODYuNjQ4NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOTUuNTAwMyIgeDI9IjI3OC4wMDA3IiB5MT0iMjY3LjUiIHkyPSIyNjcuNSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyNzguMDAwNyIgeDI9IjI3OC4wMDA3IiB5MT0iMjY3LjUiIHkyPSIyOTIuNjQ4NCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjc0LjAwMDcsMjgyLjY0ODQsMjc4LjAwMDcsMjkyLjY0ODQsMjgyLjAwMDcsMjgyLjY0ODQsMjc4LjAwMDcsMjg2LjY0ODQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDUuMDAwMiIgeDI9IjQ1LjAwMDIiIHkxPSIzODMuNzM0NCIgeTI9IjQwMS43MzQ0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ1LjAwMDIiIHgyPSIxNDkuNTAwNCIgeTE9IjQwMS43MzQ0IiB5Mj0iNDAxLjczNDQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjEzOS41MDA0LDM5Ny43MzQ0LDE0OS41MDA0LDQwMS43MzQ0LDEzOS41MDA0LDQwNS43MzQ0LDE0My41MDA0LDQwMS43MzQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI3OC4wMDA3IiB4Mj0iMjc4LjAwMDciIHkxPSIzMjYuNjE3MiIgeTI9IjQwMS43MzQ0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI3OC4wMDA3IiB4Mj0iMTczLjUwMDQiIHkxPSI0MDEuNzM0NCIgeTI9IjQwMS43MzQ0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxODMuNTAwNCwzOTcuNzM0NCwxNzMuNTAwNCw0MDEuNzM0NCwxODMuNTAwNCw0MDUuNzM0NCwxNzkuNTAwNCw0MDEuNzM0NCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNjEuNTAwNCIgeDI9IjE2MS41MDA0IiB5MT0iMjMyLjM1MTYiIHkyPSIyNTUuNSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTU3LjUwMDQsMjQ1LjUsMTYxLjUwMDQsMjU1LjUsMTY1LjUwMDQsMjQ1LjUsMTYxLjUwMDQsMjQ5LjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTYxLjUwMDQiIHgyPSIxNjEuNTAwNCIgeTE9IjQxMy43MzQ0IiB5Mj0iNDMzLjczNDQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE1Ny41MDA0LDQyMy43MzQ0LDE2MS41MDA0LDQzMy43MzQ0LDE2NS41MDA0LDQyMy43MzQ0LDE2MS41MDA0LDQyNy43MzQ0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PD9wbGFudHVtbC1zcmMgTlA3SEppOG01OFJsLW5JelgybGx1TWJDN0JBNDMwRHowOGoxWFoyc0g5NjlZcEM2VEM1YTRlNThjRUIzVDZzdGpfMHFKS0h0VHpnbHZfX19TcWZDcVowbXh5dXB2dUZIMFVscW5JcFd4ZVpIRlFDbFpDUFlHcmJkWTUyUjdCUzhHWEx2am5FaElGV1prTHZNdVFuUmtKajk0eC1BaDJPblNDaXloSEY0QlhBdlRsV3I1VlRSSFlGZnhnNDZHVmNxb25RRW1oZkxaOVR2cG1NR0hOdS1WNFU2VE9BTFpEOXM5XzA2MGVhbUFNZzNNQlBRUTBSREYweDV4UFMyTVZ5RHM1NndUTkliZTN0WnlWSUZpYmQzOVRxZ0R2dnUyQ2dPcjBxQmJ4WGRZeVZGQ2doZTlWM1VpX0drWXl3UV9TUTZVUEd1VzNHUGd2NFlFenJVX0hpWllGWmtMVHpOYVQ1ZTZ4VzR5R2Zjc1ZTRGYyc1F3TGlUdkUzMWtwUVppREt1RnZfQVM3dW1XeUFpZ1N6Z2RscTA/PjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_11">入荷・検収関連のスキーマ設計<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h3>
<h4 id="_12">テーブル構造<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>テーブル名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>入荷受入データ</td>
<td>入荷情報（入荷番号、数量、担当者等）</td>
</tr>
<tr>
<td>欠点マスタ</td>
<td>不良品の欠点コード・内容</td>
</tr>
<tr>
<td>受入検査データ</td>
<td>受入検査情報（良品数、不良品数等）</td>
</tr>
<tr>
<td>検収データ</td>
<td>検収情報（検収数、検収金額等）</td>
</tr>
</tbody>
</table>
<h4 id="_13">データの関連<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9Ijg0OXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MjE1cHg7aGVpZ2h0Ojg0OXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDIxNSA4NDkiIHdpZHRoPSIyMTVweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjA4Mzc7JiMzMzY1NTsmIzEyNTM5OyYjMjY5MDg7JiMyMTQ1NDsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyMzk4OyYjMzgzMDY7JiMzNjg5OTs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuOTk5MyIgeD0iMjMuNzUwMSIgeT0iMjIuOTk1MSI+JiMyMDgzNzsmIzMzNjU1OyYjMTI1Mzk7JiMyNjkwODsmIzIxNDU0OyYjMTI0ODc7JiMxMjU0MDsmIzEyNDc5OyYjMTIzOTg7JiMzODMwNjsmIzM2ODk5OzwvdGV4dD48L2c+PCEtLWNsYXNzIHBvZC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9InBvZCIgZGF0YS1zb3VyY2UtbGluZT0iMyIgaWQ9ImVudDAwMDIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTI5LjQ4NDQiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEyOS45OTk2IiB4PSI3OC41IiB5PSI0NC4yOTY5Ii8+PGVsbGlwc2UgY3g9IjkzLjUiIGN5PSI2MC4yOTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik05Ny42MDk0LDY2LjI5NjkgTDg5Ljg5MDYsNjYuMjk2OSBMODkuODkwNiw1My45MDYzIEw5Ny42MDk0LDUzLjkwNjMgTDk3LjYwOTQsNTYuMDYyNSBMOTIuMzQzOCw1Ni4wNjI1IEw5Mi4zNDM4LDU4LjczNDQgTDk3LjEwOTQsNTguNzM0NCBMOTcuMTA5NCw2MC44OTA2IEw5Mi4zNDM4LDYwLjg5MDYgTDkyLjM0MzgsNjQuMTQwNiBMOTcuNjA5NCw2NC4xNDA2IEw5Ny42MDk0LDY2LjI5NjkgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSIxMDcuNSIgeT0iNjUuMTQzNiI+JiMzMDMzMDsmIzI3ODgwOyYjMjYxMjY7JiMzMjA0ODsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNzkuNSIgeDI9IjIwNy40OTk2IiB5MT0iNzYuMjk2OSIgeTI9Ijc2LjI5NjkiLz48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9Ijg5LjUiIGN5PSI4OS45NDUzIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODguOTk2OCIgeD0iOTguNSIgeT0iOTMuMjkyIj4mIzMwMzMwOyYjMjc4ODA7JiMzMDA1ODsmIzIxNDk1OyBbUEtdPC90ZXh0PjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iODkuNSIgY3k9IjEwNi4yNDIyIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjk5NjgiIHg9Ijk4LjUiIHk9IjEwOS41ODg5Ij4mIzMwMzMwOyYjMjc4ODA7JiMzNDg5MjsmIzMwMDU4OyYjMjE0OTU7IFtQS108L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9Ijc5LjUiIHgyPSIyMDcuNDk5NiIgeTE9IjExNi44OTA2IiB5Mj0iMTE2Ljg5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSI4NC41IiB5PSIxMzMuODg1NyI+JiMzMDMzMDsmIzI3ODgwOyYjMjU5Njg7JiMzNzMyNzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iODQuNSIgeT0iMTUwLjE4MjYiPiYjMjA4Mzc7JiMzMzY1NTsmIzI4MTY4OyYjMjU5Njg7JiMzNzMyNzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iODQuNSIgeT0iMTY2LjQ3OTUiPiYjMjY5MDg7JiMyMTQ1NDsmIzI4MTY4OyYjMjU5Njg7JiMzNzMyNzs8L3RleHQ+PC9nPjwhLS1jbGFzcyByY3YtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJyY3YiIGRhdGEtc291cmNlLWxpbmU9IjEyIiBpZD0iZW50MDAwMyI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxNDUuNzgxMyIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTI5Ljk5OTYiIHg9IjE4LjUiIHk9IjI1MC43ODY5Ii8+PGVsbGlwc2UgY3g9IjMzLjUiIGN5PSIyNjYuNzg2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMzcuNjA5NCwyNzIuNzg2OSBMMjkuODkwNiwyNzIuNzg2OSBMMjkuODkwNiwyNjAuMzk2MyBMMzcuNjA5NCwyNjAuMzk2MyBMMzcuNjA5NCwyNjIuNTUyNSBMMzIuMzQzOCwyNjIuNTUyNSBMMzIuMzQzOCwyNjUuMjI0NCBMMzcuMTA5NCwyNjUuMjI0NCBMMzcuMTA5NCwyNjcuMzgwNiBMMzIuMzQzOCwyNjcuMzgwNiBMMzIuMzQzOCwyNzAuNjMwNiBMMzcuNjA5NCwyNzAuNjMwNiBMMzcuNjA5NCwyNzIuNzg2OSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjQ3LjUiIHk9IjI3MS42MzM2Ij4mIzIwODM3OyYjMzM2NTU7JiMyMTQ2MzsmIzIwODM3OyYjMTI0ODc7JiMxMjU0MDsmIzEyNDc5OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxOS41IiB4Mj0iMTQ3LjQ5OTYiIHkxPSIyODIuNzg2OSIgeTI9IjI4Mi43ODY5Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIyOS41IiBjeT0iMjk2LjQzNTMiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4OC45OTY4IiB4PSIzOC41IiB5PSIyOTkuNzgyIj4mIzIwODM3OyYjMzM2NTU7JiMzMDA1ODsmIzIxNDk1OyBbUEtdPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOS41IiB4Mj0iMTQ3LjQ5OTYiIHkxPSIzMDcuMDgzOCIgeTI9IjMwNy4wODM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODguNjA3MiIgeD0iMjQuNSIgeT0iMzI0LjA3ODkiPiYjMzAzMzA7JiMyNzg4MDsmIzMwMDU4OyYjMjE0OTU7IFtGS108L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjYwNzEiIHg9IjI0LjUiIHk9IjM0MC4zNzU3Ij4mIzMwMzMwOyYjMjc4ODA7JiMzNDg5MjsmIzMwMDU4OyYjMjE0OTU7IFtGS108L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iMjQuNSIgeT0iMzU2LjY3MjYiPiYjMjA4Mzc7JiMzMzY1NTsmIzI2MDg1OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIyNC41IiB5PSIzNzIuOTY5NSI+JiMyMDgzNzsmIzMzNjU1OyYjMjU5Njg7JiMzNzMyNzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMjQuNSIgeT0iMzg5LjI2NjQiPiYjMjA4Mzc7JiMzMzY1NTsmIzIxNDYzOyYjMjA4Mzc7JiMyMTMwNjsmIzIwOTk4OzwvdGV4dD48L2c+PCEtLWNsYXNzIGlucy0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9ImlucyIgZGF0YS1zb3VyY2UtbGluZT0iMjIiIGlkPSJlbnQwMDA0Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEyOS40ODQ0IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDIuOTk2NyIgeD0iNyIgeT0iNDczLjU2NjkiLz48ZWxsaXBzZSBjeD0iMjcuODQ4NyIgY3k9IjQ4OS41NjY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0zMS45NTgxLDQ5NS41NjY5IEwyNC4yMzkzLDQ5NS41NjY5IEwyNC4yMzkzLDQ4My4xNzYzIEwzMS45NTgxLDQ4My4xNzYzIEwzMS45NTgxLDQ4NS4zMzI1IEwyNi42OTI1LDQ4NS4zMzI1IEwyNi42OTI1LDQ4OC4wMDQ0IEwzMS40NTgxLDQ4OC4wMDQ0IEwzMS40NTgxLDQ5MC4xNjA2IEwyNi42OTI1LDQ5MC4xNjA2IEwyNi42OTI1LDQ5My40MTA2IEwzMS45NTgxLDQ5My40MTA2IEwzMS45NTgxLDQ5NS41NjY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iNDMuMTQ4NCIgeT0iNDk0LjQxMzYiPiYjMjE0NjM7JiMyMDgzNzsmIzI2OTA4OyYjMjY2MTk7JiMxMjQ4NzsmIzEyNTQwOyYjMTI0Nzk7PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjgiIHgyPSIxNDguOTk2NyIgeTE9IjUwNS41NjY5IiB5Mj0iNTA1LjU2NjkiLz48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjE4IiBjeT0iNTE5LjIxNTMiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTYuOTk2NyIgeD0iMjciIHk9IjUyMi41NjIiPiYjMjE0NjM7JiMyMDgzNzsmIzI2OTA4OyYjMjY2MTk7JiMzMDA1ODsmIzIxNDk1OyBbUEtdPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI4IiB4Mj0iMTQ4Ljk5NjciIHkxPSI1MjkuODYzOCIgeTI9IjUyOS44NjM4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODguNjA3MiIgeD0iMTMiIHk9IjU0Ni44NTg5Ij4mIzIwODM3OyYjMzM2NTU7JiMzMDA1ODsmIzIxNDk1OyBbRktdPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjEzIiB5PSI1NjMuMTU1NyI+JiMyMTQ2MzsmIzIwODM3OyYjMjY5MDg7JiMyNjYxOTsmIzI2MDg1OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSIxMyIgeT0iNTc5LjQ1MjYiPiYjMzMzOTE7JiMyMTY5NzsmIzI1OTY4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIxMyIgeT0iNTk1Ljc0OTUiPiYjMTk5ODE7JiMzMzM5MTsmIzIxNjk3OyYjMjU5Njg7PC90ZXh0PjwvZz48IS0tY2xhc3MgYWNjLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iYWNjIiBkYXRhLXNvdXJjZS1saW5lPSIzMSIgaWQ9ImVudDAwMDUiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTYyLjA3ODEiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEyOC42MDcxIiB4PSI3Ni4xOSIgeT0iNjgwLjA0NjkiLz48ZWxsaXBzZSBjeD0iMTAzLjE2MzMiIGN5PSI2OTYuMDQ2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMTA3LjI3MjcsNzAyLjA0NjkgTDk5LjU1MzksNzAyLjA0NjkgTDk5LjU1MzksNjg5LjY1NjMgTDEwNy4yNzI3LDY4OS42NTYzIEwxMDcuMjcyNyw2OTEuODEyNSBMMTAyLjAwNzEsNjkxLjgxMjUgTDEwMi4wMDcxLDY5NC40ODQ0IEwxMDYuNzcyNyw2OTQuNDg0NCBMMTA2Ljc3MjcsNjk2LjY0MDYgTDEwMi4wMDcxLDY5Ni42NDA2IEwxMDIuMDA3MSw2OTkuODkwNiBMMTA3LjI3MjcsNjk5Ljg5MDYgTDEwNy4yNzI3LDcwMi4wNDY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMTE5LjgyNCIgeT0iNzAwLjg5MzYiPiYjMjY5MDg7JiMyMTQ1NDsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iNzcuMTkiIHgyPSIyMDMuNzk3MSIgeTE9IjcxMi4wNDY5IiB5Mj0iNzEyLjA0NjkiLz48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9Ijg3LjE5IiBjeT0iNzI1LjY5NTMiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4OC45OTY4IiB4PSI5Ni4xOSIgeT0iNzI5LjA0MiI+JiMyNjkwODsmIzIxNDU0OyYjMzAwNTg7JiMyMTQ5NTsgW1BLXTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNzcuMTkiIHgyPSIyMDMuNzk3MSIgeTE9IjczNi4zNDM4IiB5Mj0iNzM2LjM0MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTYuNjA3MSIgeD0iODIuMTkiIHk9Ijc1My4zMzg5Ij4mIzIxNDYzOyYjMjA4Mzc7JiMyNjkwODsmIzI2NjE5OyYjMzAwNTg7JiMyMTQ5NTsgW0ZLXTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4OC42MDcyIiB4PSI4Mi4xOSIgeT0iNzY5LjYzNTciPiYjMzAzMzA7JiMyNzg4MDsmIzMwMDU4OyYjMjE0OTU7IFtGS108L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjYwNzEiIHg9IjgyLjE5IiB5PSI3ODUuOTMyNiI+JiMzMDMzMDsmIzI3ODgwOyYjMzQ4OTI7JiMzMDA1ODsmIzIxNDk1OyBbRktdPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjk5OTgiIHg9IjgyLjE5IiB5PSI4MDIuMjI5NSI+JiMyNjkwODsmIzIxNDU0OyYjMjYwODU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjk5OTgiIHg9IjgyLjE5IiB5PSI4MTguNTI2NCI+JiMyNjkwODsmIzIxNDU0OyYjMjU5Njg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjgyLjE5IiB5PSI4MzQuODIzMiI+JiMyNjkwODsmIzIxNDU0OyYjMzczMjk7JiMzODk4OTs8L3RleHQ+PC9nPjwhLS1saW5rIHBvZCB0byByY3YtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMiIgZGF0YS1lbnRpdHktMj0iZW50MDAwMyIgZGF0YS1saW5rLXR5cGU9ImNyb3dmb290IiBkYXRhLXNvdXJjZS1saW5lPSI0MiIgaWQ9ImxuazYiPjxwYXRoIGNvZGVMaW5lPSI0MiIgZD0iTTEyMy4yMzk3LDE4MS44MjY5IEMxMTYuNDQ5NywyMDUuOTE2OSAxMTUuNzQzMywyMDguNDM0NyAxMDguNzQzMywyMzMuMjE0NyIgZmlsbD0ibm9uZSIgaWQ9InBvZC1yY3YiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwLjQ3NDkiIHgyPSIxMjguMTc0OCIgeTE9IjE3Ni44OTE3IiB5Mj0iMTc5LjA2MiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMTkuNjYxIiB4Mj0iMTI3LjM2MSIgeTE9IjE3OS43NzkyIiB5Mj0iMTgxLjk0OTUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIzLjIzOTciIHgyPSIxMjUuNDEiIHkxPSIxODEuODI2OSIgeTI9IjE3NC4xMjY5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEwNi4wMjQ4IiB4Mj0iMTA5LjYyNCIgeTE9IjI0Mi44MzgyIiB5Mj0iMjUyLjE2OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMDYuMDI0OCIgeDI9Ijk4LjA3NiIgeTE9IjI0Mi44MzgyIiB5Mj0iMjQ4LjkwNTgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTA2LjAyNDgiIHgyPSIxMDMuODUiIHkxPSIyNDIuODM4MiIgeTI9IjI1MC41MzY5Ii8+PGVsbGlwc2UgY3g9IjEwNy42NTU5IiBjeT0iMjM3LjA2NDEiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSIxMTYuMyIgeT0iMjE2Ljg1MzgiPiYjMjA4Mzc7JiMzMzY1NTs8L3RleHQ+PC9nPjwhLS1saW5rIHJjdiB0byBpbnMtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMyIgZGF0YS1lbnRpdHktMj0iZW50MDAwNCIgZGF0YS1saW5rLXR5cGU9ImNyb3dmb290IiBkYXRhLXNvdXJjZS1saW5lPSI0MyIgaWQ9ImxuazciPjxwYXRoIGNvZGVMaW5lPSI0MyIgZD0iTTgxLjYxMyw0MDQuOTU0NyBDODEuMDMzLDQyOS43NTQ3IDgwLjk5Niw0MzEuMzMxOSA4MC40MjYsNDU1LjQxMTkiIGZpbGw9Im5vbmUiIGlkPSJyY3YtaW5zIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9Ijc3LjcwNzYiIHgyPSI4NS43MDU0IiB5MT0iNDAwLjg2MjMiIHkyPSI0MDEuMDQ5MyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI3Ny42Mzc0IiB4Mj0iODUuNjM1MiIgeTE9IjQwMy44NjE0IiB5Mj0iNDA0LjA0ODUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iODEuNjEzIiB4Mj0iODEuOCIgeTE9IjQwNC45NTQ3IiB5Mj0iMzk2Ljk1NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iODAuMTg5MyIgeDI9Ijg1Ljk5ODMiIHkxPSI0NjUuNDA5MSIgeTI9IjQ3My41NDg5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjgwLjE4OTMiIHgyPSI3NC4wMDE3IiB5MT0iNDY1LjQwOTEiIHkyPSI0NzMuMjY0OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI4MC4xODkzIiB4Mj0iODAiIHkxPSI0NjUuNDA5MSIgeTI9IjQ3My40MDY5Ii8+PGVsbGlwc2UgY3g9IjgwLjMzMTMiIGN5PSI0NTkuNDEwOCIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjgyIiB5PSI0MzkuNjMzOCI+JiMyNjkwODsmIzI2NjE5OzwvdGV4dD48L2c+PCEtLWxpbmsgaW5zIHRvIGFjYy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA0IiBkYXRhLWVudGl0eS0yPSJlbnQwMDA1IiBkYXRhLWxpbmstdHlwZT0iY3Jvd2Zvb3QiIGRhdGEtc291cmNlLWxpbmU9IjQ0IiBpZD0ibG5rOCI+PHBhdGggY29kZUxpbmU9IjQ0IiBkPSJNOTguNjc0OCw2MTEuMTY4NCBDMTA1LjM2NDgsNjM0Ljk2ODQgMTA2LjAwNTQsNjM3LjI0NjcgMTEzLjA0NTQsNjYyLjMyNjciIGZpbGw9Im5vbmUiIGlkPSJpbnMtYWNjIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjkzLjc0MTciIHgyPSIxMDEuNDQzMiIgeTE9IjYwOC40MDAxIiB5Mj0iNjA2LjIzNTIiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iOTQuNTUzNSIgeDI9IjEwMi4yNTUiIHkxPSI2MTEuMjg4MSIgeTI9IjYwOS4xMjMzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9Ijk4LjY3NDgiIHgyPSI5Ni41MSIgeTE9IjYxMS4xNjg0IiB5Mj0iNjAzLjQ2NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTE1Ljc0NzkiIHgyPSIxMjMuNjg2NyIgeTE9IjY3MS45NTQ2IiB5Mj0iNjc4LjAzNTMiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTE1Ljc0NzkiIHgyPSIxMTIuMTMzMyIgeTE9IjY3MS45NTQ2IiB5Mj0iNjgxLjI3ODQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTE1Ljc0NzkiIHgyPSIxMTcuOTEiIHkxPSI2NzEuOTU0NiIgeTI9IjY3OS42NTY5Ii8+PGVsbGlwc2UgY3g9IjExNC4xMjY0IiBjeT0iNjY2LjE3NzgiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSIxMTAuNSIgeT0iNjQ2LjExMzgiPiYjMjY5MDg7JiMyMTQ1NDs8L3RleHQ+PC9nPjwhLS1saW5rIHBvZCB0byBhY2MtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMiIgZGF0YS1lbnRpdHktMj0iZW50MDAwNSIgZGF0YS1saW5rLXR5cGU9ImNyb3dmb290IiBkYXRhLXNvdXJjZS1saW5lPSI0NSIgaWQ9ImxuazkiPjxwYXRoIGNvZGVMaW5lPSI0NSIgZD0iTTE1Ni44NjYxLDE4Mi4xNTk1IEMxNjAuODI2MSwyMDYuMDg5NSAxNjMuNDMsMjI1LjY0NjkgMTY1LjUsMjUwLjc4NjkgQzE3OC4zMyw0MDYuODE2OSAxODAuODEsNDQ3LjA0NjkgMTY3LjUsNjAzLjA0NjkgQzE2NS4zNiw2MjguMTI2OSAxNjQuNDQ4Niw2MzcuNDk5MSAxNjAuMTM4Niw2NjEuOTk5MSIgZmlsbD0ibm9uZSIgaWQ9InBvZC1hY2MiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTUyLjI2NjciIHgyPSIxNjAuMTU5NCIgeTE9IjE3OC44NjYzIiB5Mj0iMTc3LjU2MDIiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTUyLjc1NjUiIHgyPSIxNjAuNjQ5MiIgeTE9IjE4MS44MjYiIHkyPSIxODAuNTE5OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTYuODY2MSIgeDI9IjE1NS41NiIgeTE9IjE4Mi4xNTk1IiB5Mj0iMTc0LjI2NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU4LjQwNjEiIHgyPSIxNjIuOTI5MyIgeTE9IjY3MS44NDc5IiB5Mj0iNjgwLjc2NjQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU4LjQwNjEiIHgyPSIxNTEuMTEwNyIgeTE9IjY3MS44NDc5IiB5Mj0iNjc4LjY4NzMiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU4LjQwNjEiIHgyPSIxNTcuMDIiIHkxPSI2NzEuODQ3OSIgeTI9IjY3OS43MjY5Ii8+PGVsbGlwc2UgY3g9IjE1OS40NDU2IiBjeT0iNjY1LjkzODYiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSIxNzcuMzciIHk9IjQzOS42MzM4Ij4mIzI2OTA4OyYjMjE0NTQ7PC90ZXh0PjwvZz48P3BsYW50dW1sLXNyYyBBeWFpb0tiTFVEZ3d6NE5semlWRGt2eWpjVkVxbC16blNfbFp2WnNGY19PX1JicHRTamdZYm1zQmtSWEl5cWVvSW9lTGI5eEZ0RkxpeXVmZENfZ1VSemEwTHdVYWE1WWlLOTJWZWIzRGZRSzBLVjV5d2dnZF9UaUxlV0V5Ty01WUJuUnM4MGxod2Q5MUpQa3d1TUx4Rm5WNDVTenNUNDN2NENTVy1CSzhMcTJLRmtzVjNjSVdrZzhla0dwaTJlV0FoRFIxMURzMFdYV0UwbWIyN0o5ekFPbzV4M3c4Zkt6eFRadGpRNERuNGJXU3dFUGR5dFVaRVlhcGhuWlk5MkdMUTB2M1RJdE8zS1lBR0l2dnFSZC13VUg2ZTRrdWRrcGVITjJHNzgwTVRzMmg0dkVKbUxQM3ZEMGpuVThVSDlXRzMyTGV6MDNUMWNLMWRHRFhsTW9WLTc5WEJ5WGplM0hIS3dFaGNyeURaWFdoUUJIbVdKWEdTTDNlTTJiME5DNDV1YTM1R0t3dFdaZVNzSG5hU0cwMD8+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<details>
<summary>DDL: 入荷・検収関連テーブル</summary>

<div class="highlight"><pre><span></span><code><span class="c1">-- V010__create_receiving_tables.sql</span>

<span class="c1">-- 入荷受入データ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;入荷受入データ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注行番号&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷担当者コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;入荷受入区分&quot;</span><span class="w"> </span><span class="err">入荷受入区分</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;通常入荷&#39;</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;品目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;諸口品目区分&quot;</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷数量&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷備考&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_入荷受入_発注明細&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_入荷受入_品目&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;品目マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 欠点マスタ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;欠点マスタ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;欠点コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;欠点内容&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 受入検査データ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;受入検査データ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;受入検査番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入荷番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注行番号&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;受入検査日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;受入検査担当者コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;品目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;諸口品目区分&quot;</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;良品数&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;不良品数&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;受入検査備考&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_受入検査_入荷&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;入荷番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;入荷受入データ&quot;</span><span class="p">(</span><span class="ss">&quot;入荷番号&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_受入検査_品目&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;品目マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 検収データ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;検収データ&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;ID&quot;</span><span class="w"> </span><span class="nb">SERIAL</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;受入検査番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;発注行番号&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収担当者コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;取引先コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;品目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;諸口品目区分&quot;</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">FALSE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収数&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収単価&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収金額&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収消費税額&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;検収備考&quot;</span><span class="w"> </span><span class="nb">TEXT</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新者&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_検収_受入検査&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;受入検査番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;受入検査データ&quot;</span><span class="p">(</span><span class="ss">&quot;受入検査番号&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_検収_発注明細&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_検収_取引先&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;取引先マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;取引先コード&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_検収_品目&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;品目マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;品目コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- インデックス</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_入荷受入_発注番号&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;入荷受入データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_入荷受入_入荷日&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;入荷受入データ&quot;</span><span class="p">(</span><span class="ss">&quot;入荷日&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_受入検査_入荷番号&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;受入検査データ&quot;</span><span class="p">(</span><span class="ss">&quot;入荷番号&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_検収_受入検査番号&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;検収データ&quot;</span><span class="p">(</span><span class="ss">&quot;受入検査番号&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_検収_発注番号&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;検収データ&quot;</span><span class="p">(</span><span class="ss">&quot;発注番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;発注行番号&quot;</span><span class="p">);</span>
</code></pre></div>

</details>

<h3 id="_14">発注明細との紐付け<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h3>
<p>入荷受入データは発注明細データと紐付けられ、入荷のたびに発注明細の「入荷済数量」が更新されます。これにより、分納への対応が可能になります。</p>
<h3 id="_15">入荷受入区分（入荷 / 受入返品）<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h3>
<p>入荷受入区分は以下の値を取ります。</p>
<table>
<thead>
<tr>
<th>区分</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>通常入荷</td>
<td>通常の入荷処理</td>
</tr>
<tr>
<td>分割入荷</td>
<td>発注数量を分割して入荷する場合</td>
</tr>
<tr>
<td>返品入荷</td>
<td>検収後の返品を受け入れる場合</td>
</tr>
</tbody>
</table>
<h3 id="java_1">Java エンティティの定義<a class="headerlink" href="#java_1" title="Permanent link">&para;</a></h3>
<details>
<summary>入荷受入データエンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/Receiving.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Receiving</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">receivingNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">receivingDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">receiverCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="n">receivingType</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">miscellaneousItemFlag</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivingQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">purchaseOrderDetail</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Inspection</span><span class="o">&gt;</span><span class="w"> </span><span class="n">inspections</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>受入検査データエンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/Inspection.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Inspection</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">inspectionNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">receivingNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">inspectionDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">inspectorCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">miscellaneousItemFlag</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">goodQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">defectQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Acceptance</span><span class="o">&gt;</span><span class="w"> </span><span class="n">acceptances</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>検収データエンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/Acceptance.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.supplier.Supplier</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Acceptance</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">acceptanceNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">inspectionNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">acceptanceDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">acceptorCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">itemCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">miscellaneousItemFlag</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">acceptedQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">unitPrice</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxAmount</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">purchaseOrderDetail</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="mybatis-mapper-xml_1">MyBatis Mapper XML（入荷・検収）<a class="headerlink" href="#mybatis-mapper-xml_1" title="Permanent link">&para;</a></h3>
<details>
<summary>ReceivingMapper.xml</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- src/main/resources/mapper/ReceivingMapper.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.ReceivingMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;ReceivingResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Receiving&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receiverCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷担当者コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷受入区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.typehandler.ReceivingTypeTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;miscellaneousItemFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;諸口品目区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;remarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 INSERT --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Receiving&quot;</span>
<span class="w">            </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;入荷番号&quot;,<span class="w"> </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注行番号&quot;,<span class="w"> </span>&quot;入荷日&quot;,<span class="w"> </span>&quot;入荷担当者コード&quot;,
<span class="w">            </span>&quot;入荷受入区分&quot;,<span class="w"> </span>&quot;品目コード&quot;,<span class="w"> </span>&quot;諸口品目区分&quot;,<span class="w"> </span>&quot;入荷数量&quot;,<span class="w"> </span>&quot;入荷備考&quot;,<span class="w"> </span>&quot;作成者&quot;,<span class="w"> </span>&quot;更新者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{receivingNumber},
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{lineNumber},
<span class="w">            </span>#{receivingDate},
<span class="w">            </span>#{receiverCode},
<span class="w">            </span>#{receivingType,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.ReceivingTypeTypeHandler}::入荷受入区分,
<span class="w">            </span>#{itemCode},
<span class="w">            </span>#{miscellaneousItemFlag},
<span class="w">            </span>#{receivingQuantity},
<span class="w">            </span>#{remarks},
<span class="w">            </span>#{createdBy},
<span class="w">            </span>#{updatedBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 INSERT --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Receiving&quot;</span>
<span class="w">            </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;入荷番号&quot;,<span class="w"> </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注行番号&quot;,<span class="w"> </span>&quot;入荷日&quot;,<span class="w"> </span>&quot;入荷担当者コード&quot;,
<span class="w">            </span>&quot;入荷受入区分&quot;,<span class="w"> </span>&quot;品目コード&quot;,<span class="w"> </span>&quot;諸口品目区分&quot;,<span class="w"> </span>&quot;入荷数量&quot;,<span class="w"> </span>&quot;入荷備考&quot;,<span class="w"> </span>&quot;作成者&quot;,<span class="w"> </span>&quot;更新者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{receivingNumber},
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{lineNumber},
<span class="w">            </span>#{receivingDate},
<span class="w">            </span>#{receiverCode},
<span class="w">            </span>#{receivingType,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.ReceivingTypeTypeHandler},
<span class="w">            </span>#{itemCode},
<span class="w">            </span>#{miscellaneousItemFlag},
<span class="w">            </span>#{receivingQuantity},
<span class="w">            </span>#{remarks},
<span class="w">            </span>#{createdBy},
<span class="w">            </span>#{updatedBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findById&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;ReceivingResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByReceivingNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;ReceivingResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;入荷番号&quot;<span class="w"> </span>=<span class="w"> </span>#{receivingNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByPurchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;ReceivingResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;入荷日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByPurchaseOrderNumberAndLineNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;ReceivingResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}<span class="w"> </span>AND<span class="w"> </span>&quot;発注行番号&quot;<span class="w"> </span>=<span class="w"> </span>#{lineNumber}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;入荷日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findAll&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;ReceivingResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;入荷日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>TRUNCATE<span class="w"> </span>TABLE<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>CASCADE
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<details>
<summary>InspectionMapper.xml</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- src/main/resources/mapper/InspectionMapper.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.InspectionMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;InspectionResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Inspection&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectionNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;受入検査番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入荷番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectionDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;受入検査日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectorCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;受入検査担当者コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;miscellaneousItemFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;諸口品目区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;goodQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;良品数&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;defectQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;不良品数&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;remarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;受入検査備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Inspection&quot;</span>
<span class="w">            </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;受入検査番号&quot;,<span class="w"> </span>&quot;入荷番号&quot;,<span class="w"> </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注行番号&quot;,<span class="w"> </span>&quot;受入検査日&quot;,
<span class="w">            </span>&quot;受入検査担当者コード&quot;,<span class="w"> </span>&quot;品目コード&quot;,<span class="w"> </span>&quot;諸口品目区分&quot;,<span class="w"> </span>&quot;良品数&quot;,<span class="w"> </span>&quot;不良品数&quot;,
<span class="w">            </span>&quot;受入検査備考&quot;,<span class="w"> </span>&quot;作成者&quot;,<span class="w"> </span>&quot;更新者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{inspectionNumber},
<span class="w">            </span>#{receivingNumber},
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{lineNumber},
<span class="w">            </span>#{inspectionDate},
<span class="w">            </span>#{inspectorCode},
<span class="w">            </span>#{itemCode},
<span class="w">            </span>#{miscellaneousItemFlag},
<span class="w">            </span>#{goodQuantity},
<span class="w">            </span>#{defectQuantity},
<span class="w">            </span>#{remarks},
<span class="w">            </span>#{createdBy},
<span class="w">            </span>#{updatedBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findById&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;InspectionResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByInspectionNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;InspectionResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;受入検査番号&quot;<span class="w"> </span>=<span class="w"> </span>#{inspectionNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByReceivingNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;InspectionResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;入荷番号&quot;<span class="w"> </span>=<span class="w"> </span>#{receivingNumber}<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;受入検査日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findAll&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;InspectionResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;受入検査日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>TRUNCATE<span class="w"> </span>TABLE<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>CASCADE
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;受入検査データ&quot;
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<details>
<summary>AcceptanceMapper.xml</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- src/main/resources/mapper/AcceptanceMapper.xml --&gt;</span>
<span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.AcceptanceMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;AcceptanceResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Acceptance&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptanceNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectionNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;受入検査番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptanceDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptorCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収担当者コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;取引先コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;miscellaneousItemFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;諸口品目区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収数&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;unitPrice&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収単価&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;amount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収消費税額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;remarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;検収備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insert&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Acceptance&quot;</span>
<span class="w">            </span><span class="na">useGeneratedKeys=</span><span class="s">&quot;true&quot;</span><span class="w"> </span><span class="na">keyProperty=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">keyColumn=</span><span class="s">&quot;ID&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;検収番号&quot;,<span class="w"> </span>&quot;受入検査番号&quot;,<span class="w"> </span>&quot;発注番号&quot;,<span class="w"> </span>&quot;発注行番号&quot;,<span class="w"> </span>&quot;検収日&quot;,
<span class="w">            </span>&quot;検収担当者コード&quot;,<span class="w"> </span>&quot;取引先コード&quot;,<span class="w"> </span>&quot;品目コード&quot;,<span class="w"> </span>&quot;諸口品目区分&quot;,
<span class="w">            </span>&quot;検収数&quot;,<span class="w"> </span>&quot;検収単価&quot;,<span class="w"> </span>&quot;検収金額&quot;,<span class="w"> </span>&quot;検収消費税額&quot;,<span class="w"> </span>&quot;検収備考&quot;,<span class="w"> </span>&quot;作成者&quot;,<span class="w"> </span>&quot;更新者&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{acceptanceNumber},
<span class="w">            </span>#{inspectionNumber},
<span class="w">            </span>#{purchaseOrderNumber},
<span class="w">            </span>#{lineNumber},
<span class="w">            </span>#{acceptanceDate},
<span class="w">            </span>#{acceptorCode},
<span class="w">            </span>#{supplierCode},
<span class="w">            </span>#{itemCode},
<span class="w">            </span>#{miscellaneousItemFlag},
<span class="w">            </span>#{acceptedQuantity},
<span class="w">            </span>#{unitPrice},
<span class="w">            </span>#{amount},
<span class="w">            </span>#{taxAmount},
<span class="w">            </span>#{remarks},
<span class="w">            </span>#{createdBy},
<span class="w">            </span>#{updatedBy}
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findById&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;AcceptanceResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByAcceptanceNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;AcceptanceResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;検収番号&quot;<span class="w"> </span>=<span class="w"> </span>#{acceptanceNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByInspectionNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;AcceptanceResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;受入検査番号&quot;<span class="w"> </span>=<span class="w"> </span>#{inspectionNumber}<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;検収日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByPurchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;AcceptanceResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;検収日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findAll&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;AcceptanceResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;検収日&quot;<span class="w"> </span>DESC
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- PostgreSQL用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;postgresql&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>TRUNCATE<span class="w"> </span>TABLE<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>CASCADE
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- H2用 DELETE --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="w"> </span><span class="na">databaseId=</span><span class="s">&quot;h2&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;検収データ&quot;
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<h3 id="mapper_1">Mapper インターフェース（入荷・検収）<a class="headerlink" href="#mapper_1" title="Permanent link">&para;</a></h3>
<details>
<summary>ReceivingMapper</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/mapper/ReceivingMapper.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.Receiving</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Param</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">ReceivingMapper</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="p">);</span>
<span class="w">    </span><span class="n">Receiving</span><span class="w"> </span><span class="nf">findByReceivingNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">receivingNumber</span><span class="p">);</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">findLatestReceivingNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Receiving</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>InspectionMapper</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/mapper/InspectionMapper.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.Inspection</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">InspectionMapper</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="p">);</span>
<span class="w">    </span><span class="n">Inspection</span><span class="w"> </span><span class="nf">findByInspectionNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">inspectionNumber</span><span class="p">);</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">findLatestInspectionNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>AcceptanceMapper</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/out/persistence/mapper/AcceptanceMapper.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.Acceptance</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.ibatis.annotations.Mapper</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Mapper</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">AcceptanceMapper</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">insert</span><span class="p">(</span><span class="n">Acceptance</span><span class="w"> </span><span class="n">acceptance</span><span class="p">);</span>
<span class="w">    </span><span class="n">Acceptance</span><span class="w"> </span><span class="nf">findByAcceptanceNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">acceptanceNumber</span><span class="p">);</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="nf">findLatestAcceptanceNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="p">);</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Acceptance</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPurchaseOrderNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">);</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="_16">コマンドクラス<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h3>
<p>ヘキサゴナルアーキテクチャに従い、入力用 DTO は <code>application/port/in/command</code> に配置し、命名は <code>xxxCommand</code> とします。</p>
<details>
<summary>ReceivingCommand</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/port/in/command/ReceivingCommand.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.port.in.command</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.ReceivingType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ReceivingCommand</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">receivingDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">receiverCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="n">receivingType</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivingQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>InspectionCommand</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/port/in/command/InspectionCommand.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.port.in.command</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">InspectionCommand</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">receivingNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">inspectionDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">inspectorCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">goodQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">defectQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>AcceptanceCommand</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/port/in/command/AcceptanceCommand.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.port.in.command</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AcceptanceCommand</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">inspectionNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">acceptanceDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">acceptorCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxRate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="_17">入荷検収サービスの実装<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h3>
<details>
<summary>ReceivingService</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/application/service/ReceivingService.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Service</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.RoundingMode</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.format.DateTimeFormatter</span><span class="p">;</span>

<span class="nd">@Service</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ReceivingService</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ReceivingMapper</span><span class="w"> </span><span class="n">receivingMapper</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">InspectionMapper</span><span class="w"> </span><span class="n">inspectionMapper</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">AcceptanceMapper</span><span class="w"> </span><span class="n">acceptanceMapper</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PurchaseOrderMapper</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PurchaseOrderDetailMapper</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 入荷を登録する</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Receiving</span><span class="w"> </span><span class="nf">registerReceiving</span><span class="p">(</span><span class="n">ReceivingCommand</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">detail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">findByPurchaseOrderNumberAndLineNumber</span><span class="p">(</span>
<span class="w">                </span><span class="n">command</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">(),</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">());</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">detail</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;Purchase order detail not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivedQuantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detail</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span>
<span class="w">                </span><span class="n">detail</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">;</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">remainingQuantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detail</span><span class="p">.</span><span class="na">getOrderQuantity</span><span class="p">().</span><span class="na">subtract</span><span class="p">(</span><span class="n">receivedQuantity</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingQuantity</span><span class="p">().</span><span class="na">compareTo</span><span class="p">(</span><span class="n">remainingQuantity</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Cannot receive more than ordered quantity&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">receivingNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateReceivingNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingDate</span><span class="p">());</span>

<span class="w">        </span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Receiving</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">receivingNumber</span><span class="p">(</span><span class="n">receivingNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingDate</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">receiverCode</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceiverCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">receivingType</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingType</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingType</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="n">detail</span><span class="p">.</span><span class="na">getItemCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">miscellaneousItemFlag</span><span class="p">(</span><span class="n">detail</span><span class="p">.</span><span class="na">getMiscellaneousItemFlag</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingQuantity</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">remarks</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getRemarks</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">receivingMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">receiving</span><span class="p">);</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">newReceivedQuantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivedQuantity</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingQuantity</span><span class="p">());</span>
<span class="w">        </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">updateReceivedQuantity</span><span class="p">(</span>
<span class="w">                </span><span class="n">command</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">(),</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">(),</span><span class="w"> </span><span class="n">newReceivedQuantity</span><span class="p">);</span>

<span class="w">        </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">newStatus</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newReceivedQuantity</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">detail</span><span class="p">.</span><span class="na">getOrderQuantity</span><span class="p">())</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">RECEIVED</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">PARTIALLY_RECEIVED</span><span class="p">;</span>
<span class="w">        </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">updateStatus</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">(),</span><span class="w"> </span><span class="n">newStatus</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">receiving</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generateReceivingNumber</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;RCV-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&quot;yyyyMM&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">latestNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingMapper</span><span class="p">.</span><span class="na">findLatestReceivingNumber</span><span class="p">(</span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">latestNumber</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="w">            </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%04d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sequence</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 受入検査を登録する</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Inspection</span><span class="w"> </span><span class="nf">registerInspection</span><span class="p">(</span><span class="n">InspectionCommand</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingMapper</span><span class="p">.</span><span class="na">findByReceivingNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingNumber</span><span class="p">());</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">receiving</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Receiving not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingNumber</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">totalQuantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getGoodQuantity</span><span class="p">().</span><span class="na">add</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getDefectQuantity</span><span class="p">());</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalQuantity</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getReceivingQuantity</span><span class="p">())</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalStateException</span><span class="p">(</span><span class="s">&quot;Inspection quantity exceeds receiving quantity&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">inspectionNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateInspectionNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getInspectionDate</span><span class="p">());</span>

<span class="w">        </span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Inspection</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">inspectionNumber</span><span class="p">(</span><span class="n">inspectionNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">receivingNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getReceivingNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">inspectionDate</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getInspectionDate</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">inspectorCode</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getInspectorCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getItemCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">miscellaneousItemFlag</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getMiscellaneousItemFlag</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">goodQuantity</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getGoodQuantity</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">defectQuantity</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getDefectQuantity</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">remarks</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getRemarks</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">inspectionMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">inspection</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">inspection</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generateInspectionNumber</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;INS-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&quot;yyyyMM&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">latestNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inspectionMapper</span><span class="p">.</span><span class="na">findLatestInspectionNumber</span><span class="p">(</span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">latestNumber</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="w">            </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%04d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sequence</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 検収処理を行う</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Acceptance</span><span class="w"> </span><span class="nf">processAcceptance</span><span class="p">(</span><span class="n">AcceptanceCommand</span><span class="w"> </span><span class="n">command</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inspectionMapper</span><span class="p">.</span><span class="na">findByInspectionNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getInspectionNumber</span><span class="p">());</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">inspection</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Inspection not found: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getInspectionNumber</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">detail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">findByPurchaseOrderNumberAndLineNumber</span><span class="p">(</span>
<span class="w">                </span><span class="n">inspection</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">(),</span><span class="w"> </span><span class="n">inspection</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">());</span>

<span class="w">        </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span>
<span class="w">                </span><span class="n">inspection</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">());</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxRate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getTaxRate</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">command</span><span class="p">.</span><span class="na">getTaxRate</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detail</span><span class="p">.</span><span class="na">getOrderUnitPrice</span><span class="p">().</span><span class="na">multiply</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getGoodQuantity</span><span class="p">());</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxAmount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">amount</span><span class="p">.</span><span class="na">multiply</span><span class="p">(</span><span class="n">taxRate</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">divide</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">RoundingMode</span><span class="p">.</span><span class="na">HALF_UP</span><span class="p">);</span>

<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">acceptanceNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">generateAcceptanceNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getAcceptanceDate</span><span class="p">());</span>

<span class="w">        </span><span class="n">Acceptance</span><span class="w"> </span><span class="n">acceptance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Acceptance</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">acceptanceNumber</span><span class="p">(</span><span class="n">acceptanceNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">inspectionNumber</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getInspectionNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">acceptanceDate</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getAcceptanceDate</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">acceptorCode</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getAcceptorCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getSupplierCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getItemCode</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">miscellaneousItemFlag</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getMiscellaneousItemFlag</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">acceptedQuantity</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getGoodQuantity</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">unitPrice</span><span class="p">(</span><span class="n">detail</span><span class="p">.</span><span class="na">getOrderUnitPrice</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="n">amount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">taxAmount</span><span class="p">(</span><span class="n">taxAmount</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">remarks</span><span class="p">(</span><span class="n">command</span><span class="p">.</span><span class="na">getRemarks</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">acceptanceMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">acceptance</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">acceptance</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">generateAcceptanceNumber</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;ACC-&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">date</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&quot;yyyyMM&quot;</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;-&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">latestNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acceptanceMapper</span><span class="p">.</span><span class="na">findLatestAcceptanceNumber</span><span class="p">(</span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">latestNumber</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">substring</span><span class="p">(</span><span class="n">latestNumber</span><span class="p">.</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">4</span><span class="p">));</span>
<span class="w">            </span><span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">currentSequence</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">prefix</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%04d&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">sequence</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="_18">在庫計上処理<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>検収処理が完了すると、良品数が在庫に計上されます。在庫計上処理の詳細は第28章で解説します。</p>
<h3 id="tdd_1">TDD: 入荷・検収のテスト<a class="headerlink" href="#tdd_1" title="Permanent link">&para;</a></h3>
<details>
<summary>ReceivingServiceTest</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/test/java/com/example/pms/application/service/ReceivingServiceTest.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.application.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.Item</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.item.ItemCategory</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.master.Supplier</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.mybatis.spring.boot.test.autoconfigure.MybatisTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.context.annotation.Import</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertyRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertySource</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.containers.PostgreSQLContainer</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Container</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Testcontainers</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.*</span><span class="p">;</span>

<span class="nd">@MybatisTest</span>
<span class="nd">@AutoConfigureTestDatabase</span><span class="p">(</span><span class="n">replace</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AutoConfigureTestDatabase</span><span class="p">.</span><span class="na">Replace</span><span class="p">.</span><span class="na">NONE</span><span class="p">)</span>
<span class="nd">@Import</span><span class="p">({</span><span class="n">ReceivingService</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">PurchaseOrderService</span><span class="p">.</span><span class="na">class</span><span class="p">})</span>
<span class="nd">@Testcontainers</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;入荷・検収業務&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">ReceivingServiceTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Container</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="s">&quot;postgres:15&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withDatabaseName</span><span class="p">(</span><span class="s">&quot;testdb&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withUsername</span><span class="p">(</span><span class="s">&quot;testuser&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withPassword</span><span class="p">(</span><span class="s">&quot;testpass&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@DynamicPropertySource</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureProperties</span><span class="p">(</span><span class="n">DynamicPropertyRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getJdbcUrl</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.username&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getUsername</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getPassword</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ReceivingService</span><span class="w"> </span><span class="n">receivingService</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderService</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ItemMapper</span><span class="w"> </span><span class="n">itemMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">SupplierMapper</span><span class="w"> </span><span class="n">supplierMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">UnitPriceMapper</span><span class="w"> </span><span class="n">unitPriceMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AcceptanceMapper</span><span class="w"> </span><span class="n">acceptanceMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">InspectionMapper</span><span class="w"> </span><span class="n">inspectionMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ReceivingMapper</span><span class="w"> </span><span class="n">receivingMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderDetailMapper</span><span class="w"> </span><span class="n">purchaseOrderDetailMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderMapper</span><span class="w"> </span><span class="n">purchaseOrderMapper</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">testPurchaseOrder</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// テストデータのクリーンアップ</span>
<span class="w">        </span><span class="n">acceptanceMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">inspectionMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">receivingMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">purchaseOrderDetailMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">purchaseOrderMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">supplierMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">        </span><span class="n">itemMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// マスタデータの準備</span>
<span class="w">        </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Supplier</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-RCV-001&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">supplierName</span><span class="p">(</span><span class="s">&quot;入荷テスト用仕入先&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">supplierMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">supplier</span><span class="p">);</span>

<span class="w">        </span><span class="n">Item</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Item</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-RCV-001&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemName</span><span class="p">(</span><span class="s">&quot;入荷テスト用材料&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemCategory</span><span class="p">(</span><span class="n">ItemCategory</span><span class="p">.</span><span class="na">MATERIAL</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">itemMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">item</span><span class="p">);</span>

<span class="w">        </span><span class="n">unitPriceMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">UnitPrice</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-RCV-001&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-RCV-001&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">effectiveFrom</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">unitPrice</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;1000&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">        </span><span class="c1">// テスト用発注を作成</span>
<span class="w">        </span><span class="n">PurchaseOrderCreateInput</span><span class="w"> </span><span class="n">poInput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrderCreateInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-RCV-001&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">15</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">                        </span><span class="n">PurchaseOrderDetailInput</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                                </span><span class="p">.</span><span class="na">itemCode</span><span class="p">(</span><span class="s">&quot;MAT-RCV-001&quot;</span><span class="p">)</span>
<span class="w">                                </span><span class="p">.</span><span class="na">orderQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                                </span><span class="p">.</span><span class="na">expectedReceivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                                </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">                </span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">        </span><span class="n">testPurchaseOrder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderService</span><span class="p">.</span><span class="na">createPurchaseOrder</span><span class="p">(</span><span class="n">poInput</span><span class="p">);</span>
<span class="w">        </span><span class="n">purchaseOrderService</span><span class="p">.</span><span class="na">confirmPurchaseOrder</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;入荷登録&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">ReceivingRegistration</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;発注に対して入荷を登録できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canRegisterReceiving</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="n">ReceivingCommand</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceivingCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;50&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerReceiving</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">receiving</span><span class="p">).</span><span class="na">isNotNull</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getReceivingNumber</span><span class="p">()).</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;RCV-&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getReceivingQuantity</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;50&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getReceivingType</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;分割入荷を登録できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canRegisterSplitReceiving</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange: 1回目の入荷</span>
<span class="w">            </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerReceiving</span><span class="p">(</span><span class="n">ReceivingCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;30&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingType</span><span class="p">(</span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">SPLIT</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Act: 2回目の入荷</span>
<span class="w">            </span><span class="n">Receiving</span><span class="w"> </span><span class="n">secondReceiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerReceiving</span><span class="p">(</span><span class="n">ReceivingCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">28</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;70&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingType</span><span class="p">(</span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">SPLIT</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">secondReceiving</span><span class="p">).</span><span class="na">isNotNull</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">secondReceiving</span><span class="p">.</span><span class="na">getReceivingType</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">SPLIT</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;発注数量を超える入荷はエラーになる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">cannotReceiveMoreThanOrdered</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Act &amp; Assert</span>
<span class="w">            </span><span class="n">ReceivingCommand</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ReceivingCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;150&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerReceiving</span><span class="p">(</span><span class="n">command</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">IllegalStateException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">hasMessageContaining</span><span class="p">(</span><span class="s">&quot;Cannot receive more than ordered quantity&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;受入検査&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">InspectionRegistration</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;入荷に対して受入検査を登録できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canRegisterInspection</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerReceiving</span><span class="p">(</span><span class="n">ReceivingCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="n">InspectionCommand</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">InspectionCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingNumber</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getReceivingNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">inspectionDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">26</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">goodQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;95&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">defectQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;5&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerInspection</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">inspection</span><span class="p">).</span><span class="na">isNotNull</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getInspectionNumber</span><span class="p">()).</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;INS-&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getGoodQuantity</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;95&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getDefectQuantity</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;5&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;検収処理&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">AcceptanceProcessing</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;検査合格品を検収できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canProcessAcceptance</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="n">Receiving</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerReceiving</span><span class="p">(</span><span class="n">ReceivingCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">testPurchaseOrder</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">25</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">registerInspection</span><span class="p">(</span><span class="n">InspectionCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">receivingNumber</span><span class="p">(</span><span class="n">receiving</span><span class="p">.</span><span class="na">getReceivingNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">inspectionDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">26</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">goodQuantity</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">defectQuantity</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="n">AcceptanceCommand</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AcceptanceCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">inspectionNumber</span><span class="p">(</span><span class="n">inspection</span><span class="p">.</span><span class="na">getInspectionNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">acceptanceDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">27</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">taxRate</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10&quot;</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">Acceptance</span><span class="w"> </span><span class="n">acceptance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">receivingService</span><span class="p">.</span><span class="na">processAcceptance</span><span class="p">(</span><span class="n">command</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">acceptance</span><span class="p">).</span><span class="na">isNotNull</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">acceptance</span><span class="p">.</span><span class="na">getAcceptanceNumber</span><span class="p">()).</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;ACC-&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">acceptance</span><span class="p">.</span><span class="na">getAcceptedQuantity</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="c1">// 100個 × 1000円 = 100,000円</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">acceptance</span><span class="p">.</span><span class="na">getAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="c1">// 消費税 10% = 10,000円</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">acceptance</span><span class="p">.</span><span class="na">getTaxAmount</span><span class="p">()).</span><span class="na">isEqualByComparingTo</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;10000&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="253">25.3 リレーションと楽観ロックの設計<a class="headerlink" href="#253" title="Permanent link">&para;</a></h2>
<h3 id="mybatis-resultmap">MyBatis ネストした ResultMap によるリレーション設定<a class="headerlink" href="#mybatis-resultmap" title="Permanent link">&para;</a></h3>
<p>購買管理データは、発注→発注明細、入荷→発注明細、検収→入荷 という複数のリレーションを持ちます。MyBatis でこれらの関係を効率的に取得するための設定を実装します。</p>
<h4 id="resultmap">ネストした ResultMap の定義<a class="headerlink" href="#resultmap" title="Permanent link">&para;</a></h4>
<details>
<summary>PurchaseOrderMapper.xml（リレーション設定）</summary>

<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>

<span class="cm">&lt;!-- src/main/resources/mapper/PurchaseOrderMapper.xml --&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.PurchaseOrderMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 発注データ ResultMap（明細込み） --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;purchaseOrderWithDetailsResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrder&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_発注日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_取引先コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaserCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_発注担当者コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;departmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_発注部門コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;status&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_ステータス&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;remarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;version&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_バージョン&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_作成者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedBy&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;po_更新者&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 取引先マスタとの N:1 関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;association</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplier&quot;</span><span class="w"> </span><span class="na">javaType=</span><span class="s">&quot;com.example.pms.domain.model.master.Supplier&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;s_取引先コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierName&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;s_取引先名&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;supplierType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;s_取引先区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/association&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 発注明細との 1:N 関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;collection</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;details&quot;</span><span class="w"> </span><span class="na">ofType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrderDetail&quot;</span>
<span class="w">                    </span><span class="na">resultMap=</span><span class="s">&quot;purchaseOrderDetailNestedResultMap&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 発注明細のネスト ResultMap --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;purchaseOrderDetailNestedResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrderDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_オーダNO&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;deliveryLocationCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_納入場所コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;isMiscellaneous&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_諸口品目区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;expectedReceiveDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_受入予定日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;confirmedDeliveryDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_回答納期&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;unitPrice&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注単価&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_入荷済数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_検査済数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_検収済数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;amount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_消費税金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;isCompleted&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_完了フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineRemarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_明細備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;version&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_バージョン&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 品目マスタとの N:1 関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;association</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;item&quot;</span><span class="w"> </span><span class="na">javaType=</span><span class="s">&quot;com.example.pms.domain.model.item.Item&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;i_品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemName&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;i_品名&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCategory&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;i_品目区分&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;unit&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;i_単位&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/association&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- JOIN による一括取得クエリ --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findWithDetailsByPurchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;purchaseOrderWithDetailsResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT
<span class="w">            </span>--<span class="w"> </span>発注データ
<span class="w">            </span>po.&quot;ID&quot;<span class="w"> </span>AS<span class="w"> </span>po_ID,
<span class="w">            </span>po.&quot;発注番号&quot;<span class="w"> </span>AS<span class="w"> </span>po_発注番号,
<span class="w">            </span>po.&quot;発注日&quot;<span class="w"> </span>AS<span class="w"> </span>po_発注日,
<span class="w">            </span>po.&quot;取引先コード&quot;<span class="w"> </span>AS<span class="w"> </span>po_取引先コード,
<span class="w">            </span>po.&quot;発注担当者コード&quot;<span class="w"> </span>AS<span class="w"> </span>po_発注担当者コード,
<span class="w">            </span>po.&quot;発注部門コード&quot;<span class="w"> </span>AS<span class="w"> </span>po_発注部門コード,
<span class="w">            </span>po.&quot;ステータス&quot;<span class="w"> </span>AS<span class="w"> </span>po_ステータス,
<span class="w">            </span>po.&quot;備考&quot;<span class="w"> </span>AS<span class="w"> </span>po_備考,
<span class="w">            </span>po.&quot;バージョン&quot;<span class="w"> </span>AS<span class="w"> </span>po_バージョン,
<span class="w">            </span>po.&quot;作成日時&quot;<span class="w"> </span>AS<span class="w"> </span>po_作成日時,
<span class="w">            </span>po.&quot;作成者&quot;<span class="w"> </span>AS<span class="w"> </span>po_作成者,
<span class="w">            </span>po.&quot;更新日時&quot;<span class="w"> </span>AS<span class="w"> </span>po_更新日時,
<span class="w">            </span>po.&quot;更新者&quot;<span class="w"> </span>AS<span class="w"> </span>po_更新者,
<span class="w">            </span>--<span class="w"> </span>取引先マスタ
<span class="w">            </span>s.&quot;取引先コード&quot;<span class="w"> </span>AS<span class="w"> </span>s_取引先コード,
<span class="w">            </span>s.&quot;取引先名&quot;<span class="w"> </span>AS<span class="w"> </span>s_取引先名,
<span class="w">            </span>s.&quot;取引先区分&quot;<span class="w"> </span>AS<span class="w"> </span>s_取引先区分,
<span class="w">            </span>--<span class="w"> </span>発注明細データ
<span class="w">            </span>pod.&quot;ID&quot;<span class="w"> </span>AS<span class="w"> </span>pod_ID,
<span class="w">            </span>pod.&quot;発注番号&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注番号,
<span class="w">            </span>pod.&quot;発注行番号&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注行番号,
<span class="w">            </span>pod.&quot;オーダNO&quot;<span class="w"> </span>AS<span class="w"> </span>pod_オーダNO,
<span class="w">            </span>pod.&quot;納入場所コード&quot;<span class="w"> </span>AS<span class="w"> </span>pod_納入場所コード,
<span class="w">            </span>pod.&quot;品目コード&quot;<span class="w"> </span>AS<span class="w"> </span>pod_品目コード,
<span class="w">            </span>pod.&quot;諸口品目区分&quot;<span class="w"> </span>AS<span class="w"> </span>pod_諸口品目区分,
<span class="w">            </span>pod.&quot;受入予定日&quot;<span class="w"> </span>AS<span class="w"> </span>pod_受入予定日,
<span class="w">            </span>pod.&quot;回答納期&quot;<span class="w"> </span>AS<span class="w"> </span>pod_回答納期,
<span class="w">            </span>pod.&quot;発注単価&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注単価,
<span class="w">            </span>pod.&quot;発注数量&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注数量,
<span class="w">            </span>pod.&quot;入荷済数量&quot;<span class="w"> </span>AS<span class="w"> </span>pod_入荷済数量,
<span class="w">            </span>pod.&quot;検査済数量&quot;<span class="w"> </span>AS<span class="w"> </span>pod_検査済数量,
<span class="w">            </span>pod.&quot;検収済数量&quot;<span class="w"> </span>AS<span class="w"> </span>pod_検収済数量,
<span class="w">            </span>pod.&quot;発注金額&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注金額,
<span class="w">            </span>pod.&quot;消費税金額&quot;<span class="w"> </span>AS<span class="w"> </span>pod_消費税金額,
<span class="w">            </span>pod.&quot;完了フラグ&quot;<span class="w"> </span>AS<span class="w"> </span>pod_完了フラグ,
<span class="w">            </span>pod.&quot;明細備考&quot;<span class="w"> </span>AS<span class="w"> </span>pod_明細備考,
<span class="w">            </span>pod.&quot;バージョン&quot;<span class="w"> </span>AS<span class="w"> </span>pod_バージョン,
<span class="w">            </span>--<span class="w"> </span>品目マスタ
<span class="w">            </span>i.&quot;品目コード&quot;<span class="w"> </span>AS<span class="w"> </span>i_品目コード,
<span class="w">            </span>i.&quot;品名&quot;<span class="w"> </span>AS<span class="w"> </span>i_品名,
<span class="w">            </span>i.&quot;品目区分&quot;<span class="w"> </span>AS<span class="w"> </span>i_品目区分,
<span class="w">            </span>i.&quot;単位&quot;<span class="w"> </span>AS<span class="w"> </span>i_単位
<span class="w">        </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>po
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;取引先マスタ&quot;<span class="w"> </span>s<span class="w"> </span>ON<span class="w"> </span>po.&quot;取引先コード&quot;<span class="w"> </span>=<span class="w"> </span>s.&quot;取引先コード&quot;
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;発注明細データ&quot;<span class="w"> </span>pod<span class="w"> </span>ON<span class="w"> </span>po.&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>pod.&quot;発注番号&quot;
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;品目マスタ&quot;<span class="w"> </span>i<span class="w"> </span>ON<span class="w"> </span>pod.&quot;品目コード&quot;<span class="w"> </span>=<span class="w"> </span>i.&quot;品目コード&quot;
<span class="w">            </span>AND<span class="w"> </span>i.&quot;適用開始日&quot;<span class="w"> </span>=<span class="w"> </span>(
<span class="w">                </span>SELECT<span class="w"> </span>MAX(&quot;適用開始日&quot;)<span class="w"> </span>FROM<span class="w"> </span>&quot;品目マスタ&quot;
<span class="w">                </span>WHERE<span class="w"> </span>&quot;品目コード&quot;<span class="w"> </span>=<span class="w"> </span>pod.&quot;品目コード&quot;
<span class="w">                </span>AND<span class="w"> </span>&quot;適用開始日&quot;<span class="w"> </span><span class="err">&lt;</span>=<span class="w"> </span>CURRENT_DATE
<span class="w">            </span>)
<span class="w">        </span>WHERE<span class="w"> </span>po.&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaseOrderNumber}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>pod.&quot;発注行番号&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<details>
<summary>ReceivingMapper.xml（リレーション設定）</summary>

<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>

<span class="cm">&lt;!-- src/main/resources/mapper/ReceivingMapper.xml --&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.mapper.ReceivingMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 入荷受入データ ResultMap（発注明細・検査・検収込み） --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;receivingWithRelationsResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Receiving&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_入荷受入番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_入荷日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivingType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_入荷受入区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.pms.infrastructure.out.persistence.typehandler.ReceivingTypeTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;receivedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_入荷数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;locationCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_入荷場所コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;remarks&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_備考&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;version&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_バージョン&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;r_更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 発注明細との N:1 関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;association</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderDetail&quot;</span><span class="w"> </span><span class="na">javaType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrderDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;purchaseOrderNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;itemCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_品目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;orderQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;unitPrice&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;pod_発注単価&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/association&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 検査データとの 1:1 関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;association</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspection&quot;</span><span class="w"> </span><span class="na">javaType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Inspection&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ins_ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectionNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ins_検査番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectionDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ins_検査日&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;inspectedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ins_検査数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;goodQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ins_良品数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;defectQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;ins_不良数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/association&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 検収データとの 1:1 関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;association</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptance&quot;</span><span class="w"> </span><span class="na">javaType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.Acceptance&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;id&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;acc_ID&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptanceNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;acc_検収番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptanceDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;acc_検収日&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;acceptedQuantity&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;acc_検収数量&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;amount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;acc_検収金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">            </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;acc_消費税額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;/association&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- JOIN による一括取得クエリ --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findWithRelationsByReceivingNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;receivingWithRelationsResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT
<span class="w">            </span>--<span class="w"> </span>入荷受入データ
<span class="w">            </span>r.&quot;ID&quot;<span class="w"> </span>AS<span class="w"> </span>r_ID,
<span class="w">            </span>r.&quot;入荷受入番号&quot;<span class="w"> </span>AS<span class="w"> </span>r_入荷受入番号,
<span class="w">            </span>r.&quot;発注番号&quot;<span class="w"> </span>AS<span class="w"> </span>r_発注番号,
<span class="w">            </span>r.&quot;発注行番号&quot;<span class="w"> </span>AS<span class="w"> </span>r_発注行番号,
<span class="w">            </span>r.&quot;入荷日&quot;<span class="w"> </span>AS<span class="w"> </span>r_入荷日,
<span class="w">            </span>r.&quot;入荷受入区分&quot;<span class="w"> </span>AS<span class="w"> </span>r_入荷受入区分,
<span class="w">            </span>r.&quot;入荷数量&quot;<span class="w"> </span>AS<span class="w"> </span>r_入荷数量,
<span class="w">            </span>r.&quot;入荷場所コード&quot;<span class="w"> </span>AS<span class="w"> </span>r_入荷場所コード,
<span class="w">            </span>r.&quot;備考&quot;<span class="w"> </span>AS<span class="w"> </span>r_備考,
<span class="w">            </span>r.&quot;バージョン&quot;<span class="w"> </span>AS<span class="w"> </span>r_バージョン,
<span class="w">            </span>r.&quot;作成日時&quot;<span class="w"> </span>AS<span class="w"> </span>r_作成日時,
<span class="w">            </span>r.&quot;更新日時&quot;<span class="w"> </span>AS<span class="w"> </span>r_更新日時,
<span class="w">            </span>--<span class="w"> </span>発注明細データ
<span class="w">            </span>pod.&quot;ID&quot;<span class="w"> </span>AS<span class="w"> </span>pod_ID,
<span class="w">            </span>pod.&quot;発注番号&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注番号,
<span class="w">            </span>pod.&quot;発注行番号&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注行番号,
<span class="w">            </span>pod.&quot;品目コード&quot;<span class="w"> </span>AS<span class="w"> </span>pod_品目コード,
<span class="w">            </span>pod.&quot;発注数量&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注数量,
<span class="w">            </span>pod.&quot;発注単価&quot;<span class="w"> </span>AS<span class="w"> </span>pod_発注単価,
<span class="w">            </span>--<span class="w"> </span>受入検査データ
<span class="w">            </span>ins.&quot;ID&quot;<span class="w"> </span>AS<span class="w"> </span>ins_ID,
<span class="w">            </span>ins.&quot;検査番号&quot;<span class="w"> </span>AS<span class="w"> </span>ins_検査番号,
<span class="w">            </span>ins.&quot;検査日&quot;<span class="w"> </span>AS<span class="w"> </span>ins_検査日,
<span class="w">            </span>ins.&quot;検査数量&quot;<span class="w"> </span>AS<span class="w"> </span>ins_検査数量,
<span class="w">            </span>ins.&quot;良品数量&quot;<span class="w"> </span>AS<span class="w"> </span>ins_良品数量,
<span class="w">            </span>ins.&quot;不良数量&quot;<span class="w"> </span>AS<span class="w"> </span>ins_不良数量,
<span class="w">            </span>--<span class="w"> </span>検収データ
<span class="w">            </span>acc.&quot;ID&quot;<span class="w"> </span>AS<span class="w"> </span>acc_ID,
<span class="w">            </span>acc.&quot;検収番号&quot;<span class="w"> </span>AS<span class="w"> </span>acc_検収番号,
<span class="w">            </span>acc.&quot;検収日&quot;<span class="w"> </span>AS<span class="w"> </span>acc_検収日,
<span class="w">            </span>acc.&quot;検収数量&quot;<span class="w"> </span>AS<span class="w"> </span>acc_検収数量,
<span class="w">            </span>acc.&quot;検収金額&quot;<span class="w"> </span>AS<span class="w"> </span>acc_検収金額,
<span class="w">            </span>acc.&quot;消費税額&quot;<span class="w"> </span>AS<span class="w"> </span>acc_消費税額
<span class="w">        </span>FROM<span class="w"> </span>&quot;入荷受入データ&quot;<span class="w"> </span>r
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;発注明細データ&quot;<span class="w"> </span>pod
<span class="w">            </span>ON<span class="w"> </span>r.&quot;発注番号&quot;<span class="w"> </span>=<span class="w"> </span>pod.&quot;発注番号&quot;<span class="w"> </span>AND<span class="w"> </span>r.&quot;発注行番号&quot;<span class="w"> </span>=<span class="w"> </span>pod.&quot;発注行番号&quot;
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;受入検査データ&quot;<span class="w"> </span>ins<span class="w"> </span>ON<span class="w"> </span>r.&quot;入荷受入番号&quot;<span class="w"> </span>=<span class="w"> </span>ins.&quot;入荷受入番号&quot;
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;検収データ&quot;<span class="w"> </span>acc<span class="w"> </span>ON<span class="w"> </span>r.&quot;入荷受入番号&quot;<span class="w"> </span>=<span class="w"> </span>acc.&quot;入荷受入番号&quot;
<span class="w">        </span>WHERE<span class="w"> </span>r.&quot;入荷受入番号&quot;<span class="w"> </span>=<span class="w"> </span>#{receivingNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<h4 id="_19">リレーション設定のポイント<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>設定項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;collection&gt;</code></td>
<td>発注→発注明細 の 1:N 関連</td>
</tr>
<tr>
<td><code>&lt;association&gt;</code></td>
<td>入荷→発注明細、入荷→検査、入荷→検収 の N:1/1:1 関連</td>
</tr>
<tr>
<td>エイリアス</td>
<td><code>po_</code>（発注）、<code>pod_</code>（発注明細）、<code>r_</code>（入荷）、<code>ins_</code>（検査）、<code>acc_</code>（検収）</td>
</tr>
<tr>
<td>有効日サブクエリ</td>
<td>品目マスタの適用開始日を考慮した最新レコード取得</td>
</tr>
</tbody>
</table>
<h3 id="_20">楽観ロックの実装<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h3>
<p>発注から検収までの一連の業務で複数ユーザーが同時に操作する可能性があるため、楽観ロックを実装します。</p>
<h4 id="flyway">Flyway マイグレーション: バージョンカラム追加<a class="headerlink" href="#flyway" title="Permanent link">&para;</a></h4>
<details>
<summary>V010__add_purchasing_version_columns.sql</summary>

<div class="highlight"><pre><span></span><code><span class="c1">-- src/main/resources/db/migration/V010__add_purchasing_version_columns.sql</span>

<span class="c1">-- 発注データテーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;発注データ&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 発注明細データテーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 入荷受入データテーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;入荷受入データ&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 受入検査データテーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;受入検査データ&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 検収データテーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;検収データ&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- コメント追加</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;発注データ&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;発注明細データ&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;入荷受入データ&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;受入検査データ&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;検収データ&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
</code></pre></div>

</details>

<h4 id="_21">エンティティへのバージョンフィールド追加<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<details>
<summary>PurchaseOrder.java（バージョンフィールド追加）</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/PurchaseOrder.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.master.Supplier</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrder</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">orderDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">supplierCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaserCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">createdBy</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">updatedBy</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 楽観ロック用バージョン</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Supplier</span><span class="w"> </span><span class="n">supplier</span><span class="p">;</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">PurchaseOrderDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>Receiving.java（バージョンフィールド追加）</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/domain/model/purchase/Receiving.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Receiving</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">receivingNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">receivingDate</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="n">receivingType</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivedQuantity</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">locationCode</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">remarks</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// 楽観ロック用バージョン</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">purchaseOrderDetail</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Inspection</span><span class="w"> </span><span class="n">inspection</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Acceptance</span><span class="w"> </span><span class="n">acceptance</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="mybatis-mapper">MyBatis Mapper: 楽観ロック対応の更新<a class="headerlink" href="#mybatis-mapper" title="Permanent link">&para;</a></h4>
<details>
<summary>PurchaseOrderMapper.xml（楽観ロック対応 UPDATE）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- 楽観ロック対応の更新（バージョンチェック付き） --&gt;</span>
<span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateWithOptimisticLock&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.pms.domain.model.purchase.PurchaseOrder&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>UPDATE<span class="w"> </span>&quot;発注データ&quot;
<span class="w">    </span>SET
<span class="w">        </span>&quot;発注日&quot;<span class="w"> </span>=<span class="w"> </span>#{orderDate},
<span class="w">        </span>&quot;取引先コード&quot;<span class="w"> </span>=<span class="w"> </span>#{supplierCode},
<span class="w">        </span>&quot;発注担当者コード&quot;<span class="w"> </span>=<span class="w"> </span>#{purchaserCode},
<span class="w">        </span>&quot;発注部門コード&quot;<span class="w"> </span>=<span class="w"> </span>#{departmentCode},
<span class="w">        </span>&quot;ステータス&quot;<span class="w"> </span>=<span class="w"> </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler}::発注ステータス,
<span class="w">        </span>&quot;備考&quot;<span class="w"> </span>=<span class="w"> </span>#{remarks},
<span class="w">        </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP,
<span class="w">        </span>&quot;更新者&quot;<span class="w"> </span>=<span class="w"> </span>#{updatedBy},
<span class="w">        </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>+<span class="w"> </span>1
<span class="w">    </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span>AND<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>#{version}
<span class="nt">&lt;/update&gt;</span>

<span class="cm">&lt;!-- ステータス更新（楽観ロック対応） --&gt;</span>
<span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateStatusWithOptimisticLock&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>UPDATE<span class="w"> </span>&quot;発注データ&quot;
<span class="w">    </span>SET
<span class="w">        </span>&quot;ステータス&quot;<span class="w"> </span>=<span class="w"> </span>#{status,<span class="w"> </span>typeHandler=com.example.pms.infrastructure.out.persistence.typehandler.PurchaseOrderStatusTypeHandler}::発注ステータス,
<span class="w">        </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP,
<span class="w">        </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>+<span class="w"> </span>1
<span class="w">    </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span>AND<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>#{version}
<span class="nt">&lt;/update&gt;</span>

<span class="cm">&lt;!-- 現在のバージョン取得 --&gt;</span>
<span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findVersionById&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;java.lang.Integer&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>SELECT<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>FROM<span class="w"> </span>&quot;発注データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div>

</details>

<details>
<summary>PurchaseOrderDetailMapper.xml（楽観ロック対応 UPDATE）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- 入荷数量更新（楽観ロック対応） --&gt;</span>
<span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateReceivedQuantityWithOptimisticLock&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>UPDATE<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">    </span>SET
<span class="w">        </span>&quot;入荷済数量&quot;<span class="w"> </span>=<span class="w"> </span>&quot;入荷済数量&quot;<span class="w"> </span>+<span class="w"> </span>#{additionalQuantity},
<span class="w">        </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP,
<span class="w">        </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>+<span class="w"> </span>1
<span class="w">    </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span>AND<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>#{version}
<span class="nt">&lt;/update&gt;</span>

<span class="cm">&lt;!-- 検収数量更新（楽観ロック対応） --&gt;</span>
<span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateAcceptedQuantityWithOptimisticLock&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>UPDATE<span class="w"> </span>&quot;発注明細データ&quot;
<span class="w">    </span>SET
<span class="w">        </span>&quot;検収済数量&quot;<span class="w"> </span>=<span class="w"> </span>&quot;検収済数量&quot;<span class="w"> </span>+<span class="w"> </span>#{additionalQuantity},
<span class="w">        </span>&quot;完了フラグ&quot;<span class="w"> </span>=<span class="w"> </span>CASE
<span class="w">            </span>WHEN<span class="w"> </span>&quot;検収済数量&quot;<span class="w"> </span>+<span class="w"> </span>#{additionalQuantity}<span class="w"> </span>&gt;=<span class="w"> </span>&quot;発注数量&quot;<span class="w"> </span>THEN<span class="w"> </span>TRUE
<span class="w">            </span>ELSE<span class="w"> </span>FALSE
<span class="w">        </span>END,
<span class="w">        </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP,
<span class="w">        </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>+<span class="w"> </span>1
<span class="w">    </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="w">    </span>AND<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>#{version}
<span class="nt">&lt;/update&gt;</span>

<span class="cm">&lt;!-- 現在のバージョン取得 --&gt;</span>
<span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findVersionById&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;java.lang.Integer&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>SELECT<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>FROM<span class="w"> </span>&quot;発注明細データ&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;ID&quot;<span class="w"> </span>=<span class="w"> </span>#{id}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div>

</details>

<h4 id="repository">Repository 実装: 楽観ロック対応<a class="headerlink" href="#repository" title="Permanent link">&para;</a></h4>
<details>
<summary>PurchaseOrderRepositoryImpl.java（楽観ロック対応）</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/pms/infrastructure/persistence/repository/PurchaseOrderRepositoryImpl.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.typehandler.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.application.port.out.PurchaseOrderRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.exception.OptimisticLockException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrderStatus</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.mapper.PurchaseOrderMapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Optional</span><span class="p">;</span>

<span class="nd">@Repository</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PurchaseOrderRepositoryImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">PurchaseOrderRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PurchaseOrderMapper</span><span class="w"> </span><span class="n">mapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">PurchaseOrder</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">updatedCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">updateWithOptimisticLock</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">updatedCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">currentVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">findVersionById</span><span class="p">(</span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentVersion</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OptimisticLockException</span><span class="p">(</span><span class="s">&quot;発注&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getId</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OptimisticLockException</span><span class="p">(</span><span class="s">&quot;発注&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">purchaseOrder</span><span class="p">.</span><span class="na">getVersion</span><span class="p">(),</span><span class="w"> </span><span class="n">currentVersion</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateStatus</span><span class="p">(</span><span class="n">Integer</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">version</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">updatedCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">updateStatusWithOptimisticLock</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">updatedCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">currentVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mapper</span><span class="p">.</span><span class="na">findVersionById</span><span class="p">(</span><span class="n">id</span><span class="p">);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentVersion</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OptimisticLockException</span><span class="p">(</span><span class="s">&quot;発注&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OptimisticLockException</span><span class="p">(</span><span class="s">&quot;発注&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="n">currentVersion</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">PurchaseOrder</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findWithDetailsByPurchaseOrderNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">purchaseOrderNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Optional</span><span class="p">.</span><span class="na">ofNullable</span><span class="p">(</span><span class="n">mapper</span><span class="p">.</span><span class="na">findWithDetailsByPurchaseOrderNumber</span><span class="p">(</span><span class="n">purchaseOrderNumber</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// その他のメソッド...</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="tdd_2">TDD: 楽観ロックのテスト<a class="headerlink" href="#tdd_2" title="Permanent link">&para;</a></h4>
<details>
<summary>PurchaseOrderRepositoryOptimisticLockTest.java</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/test/java/com/example/pms/infrastructure/persistence/repository/PurchaseOrderRepositoryOptimisticLockTest.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.pms.infrastructure.out.persistence.typehandler.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.application.port.out.PurchaseOrderRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.exception.OptimisticLockException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.domain.model.purchase.PurchaseOrderStatus</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.pms.testsetup.BaseIntegrationTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.*</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;発注リポジトリ - 楽観ロック&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">PurchaseOrderRepositoryOptimisticLockTest</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseIntegrationTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">PurchaseOrderRepository</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;楽観ロック&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">OptimisticLocking</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;同じバージョンで更新できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canUpdateWithSameVersion</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CREATING</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">po</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">fetched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0001&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="n">fetched</span><span class="p">.</span><span class="na">setRemarks</span><span class="p">(</span><span class="s">&quot;更新テスト&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">fetched</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0001&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">updated</span><span class="p">.</span><span class="na">getRemarks</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="s">&quot;更新テスト&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">updated</span><span class="p">.</span><span class="na">getVersion</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;異なるバージョンで更新すると楽観ロック例外が発生する&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">throwsExceptionWhenVersionMismatch</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0002&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CREATING</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">po</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// ユーザーAが取得</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">poA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0002&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="c1">// ユーザーBが取得</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">poB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0002&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// ユーザーAが更新（成功）</span>
<span class="w">            </span><span class="n">poA</span><span class="p">.</span><span class="na">setRemarks</span><span class="p">(</span><span class="s">&quot;ユーザーAの更新&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">poA</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act &amp; Assert: ユーザーBが古いバージョンで更新（失敗）</span>
<span class="w">            </span><span class="n">poB</span><span class="p">.</span><span class="na">setRemarks</span><span class="p">(</span><span class="s">&quot;ユーザーBの更新&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">poB</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">OptimisticLockException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">hasMessageContaining</span><span class="p">(</span><span class="s">&quot;他のユーザーによって更新されています&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;ステータス更新も楽観ロックが適用される&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">statusUpdateWithOptimisticLock</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">po</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PurchaseOrder</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0003&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">orderDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2025</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">20</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">supplierCode</span><span class="p">(</span><span class="s">&quot;SUP-001&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CREATING</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">            </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">po</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// ユーザーAとBが同時に取得</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">poA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0003&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">poB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">findByPurchaseOrderNumber</span><span class="p">(</span><span class="s">&quot;PO-2025-0003&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// ユーザーAがステータス更新（成功）</span>
<span class="w">            </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">updateStatus</span><span class="p">(</span><span class="n">poA</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">ORDERED</span><span class="p">,</span><span class="w"> </span><span class="n">poA</span><span class="p">.</span><span class="na">getVersion</span><span class="p">());</span>

<span class="w">            </span><span class="c1">// Act &amp; Assert: ユーザーBが古いバージョンでステータス更新（失敗）</span>
<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                    </span><span class="n">purchaseOrderRepository</span><span class="p">.</span><span class="na">updateStatus</span><span class="p">(</span><span class="n">poB</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span><span class="w"> </span><span class="n">PurchaseOrderStatus</span><span class="p">.</span><span class="na">CANCELLED</span><span class="p">,</span><span class="w"> </span><span class="n">poB</span><span class="p">.</span><span class="na">getVersion</span><span class="p">()))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">OptimisticLockException</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="_22">入荷・検収処理における楽観ロックの考慮<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h3>
<p>入荷から検収までの一連の処理では、発注明細の数量を段階的に更新するため、楽観ロックの適切な処理が重要です。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IlNFUVVFTkNFIiBoZWlnaHQ9IjcxMXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6ODMycHg7aGVpZ2h0OjcxMXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDgzMiA3MTEiIHdpZHRoPSI4MzJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjA4Mzc7JiMzMzY1NTsmIzEyNTM5OyYjMjY5MDg7JiMyMTQ1NDsmIzIwOTY2OyYjMjk3MDI7JiMxMjM5MjsmIzI3MDA1OyYjMzUyNTE7JiMxMjUyNTsmIzEyNDgzOyYjMTI0NjM7PC90aXRsZT48ZGVmcy8+PGc+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4MS45OTkyIiB4PSIzMjYuNDE4OCIgeT0iMjcuOTk1MSI+JiMyMDgzNzsmIzMzNjU1OyYjMTI1Mzk7JiMyNjkwODsmIzIxNDU0OyYjMjA5NjY7JiMyOTcwMjsmIzEyMzkyOyYjMjcwMDU7JiMzNTI1MTsmIzEyNTI1OyYjMTI0ODM7JiMxMjQ2Mzs8L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIxOTAuNjAxNiIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB3aWR0aD0iODE1LjgzNjkiIHg9IjEwIiB5PSI0MjUuOTIxOSIvPjxnIGNsYXNzPSJwYXJ0aWNpcGFudC1saWZlbGluZSIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iUmVjdlN2YyIgaWQ9InBhcnQxLWxpZmVsaW5lIj48Zz48dGl0bGU+Li4uLi4uPC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iNTI4LjkyOTciIHdpZHRoPSI4IiB4PSI2NC45OTk4IiB5PSIxMDQuNTkzOCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41O3N0cm9rZS1kYXNoYXJyYXk6NSw1OyIgeDE9IjY4IiB4Mj0iNjgiIHkxPSIxMDQuNTkzOCIgeTI9IjYzMy41MjM0Ii8+PC9nPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQtbGlmZWxpbmUiIGRhdGEtZW50aXR5LXVpZD0icGFydDIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9IlBPRFJlcG8iIGlkPSJwYXJ0Mi1saWZlbGluZSI+PGc+PHRpdGxlPi4uLi4uLi4uLjwvdGl0bGU+PHJlY3QgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwIiBoZWlnaHQ9IjUyOC45Mjk3IiB3aWR0aD0iOCIgeD0iNDQyLjAwNTciIHk9IjEwNC41OTM4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7c3Ryb2tlLWRhc2hhcnJheTo1LDU7IiB4MT0iNDQ1LjAwNiIgeDI9IjQ0NS4wMDYiIHkxPSIxMDQuNTkzOCIgeTI9IjYzMy41MjM0Ii8+PC9nPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQtbGlmZWxpbmUiIGRhdGEtZW50aXR5LXVpZD0icGFydDMiIGRhdGEtcXVhbGlmaWVkLW5hbWU9IlJlY3ZSZXBvIiBpZD0icGFydDMtbGlmZWxpbmUiPjxnPjx0aXRsZT4uLi4uLi4uPC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iNTI4LjkyOTciIHdpZHRoPSI4IiB4PSI1NzguMDA1MiIgeT0iMTA0LjU5MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSI1ODEuMDA1NCIgeDI9IjU4MS4wMDU0IiB5MT0iMTA0LjU5MzgiIHkyPSI2MzMuNTIzNCIvPjwvZz48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50LWxpZmVsaW5lIiBkYXRhLWVudGl0eS11aWQ9InBhcnQ0IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJEQiIgaWQ9InBhcnQ0LWxpZmVsaW5lIj48Zz48dGl0bGU+REI8L3RpdGxlPjxyZWN0IGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMCIgaGVpZ2h0PSI1MjguOTI5NyIgd2lkdGg9IjgiIHg9Ijc5My44MzY5IiB5PSIxMDQuNTkzOCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41O3N0cm9rZS1kYXNoYXJyYXk6NSw1OyIgeDE9Ijc5Ny44MzY5IiB4Mj0iNzk3LjgzNjkiIHkxPSIxMDQuNTkzOCIgeTI9IjYzMy41MjM0Ii8+PC9nPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtaGVhZCIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iUmVjdlN2YyIgaWQ9InBhcnQxLWhlYWQiPjxyZWN0IGZpbGw9IiNFMkUyRjAiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iOTcuOTk5NiIgeD0iMjAiIHk9IjczLjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSIyNyIgeT0iOTMuMjkyIj4mIzIwODM3OyYjMzM2NTU7JiMxMjQ2OTsmIzEyNTQwOyYjMTI0OTk7JiMxMjQ3Mzs8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC10YWlsIiBkYXRhLWVudGl0eS11aWQ9InBhcnQxIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJSZWN2U3ZjIiBpZD0icGFydDEtdGFpbCI+PHJlY3QgZmlsbD0iI0UyRTJGMCIgaGVpZ2h0PSIzMC4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI5Ny45OTk2IiB4PSIyMCIgeT0iNjMyLjUyMzQiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSIyNyIgeT0iNjUyLjUxODYiPiYjMjA4Mzc7JiMzMzY1NTsmIzEyNDY5OyYjMTI1NDA7JiMxMjQ5OTsmIzEyNDczOzwvdGV4dD48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LWhlYWQiIGRhdGEtZW50aXR5LXVpZD0icGFydDIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9IlBPRFJlcG8iIGlkPSJwYXJ0Mi1oZWFkIj48cmVjdCBmaWxsPSIjRTJFMkYwIiBoZWlnaHQ9IjMwLjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEzOS45OTk1IiB4PSIzNzYuMDA2IiB5PSI3My4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI1Ljk5OTUiIHg9IjM4My4wMDYiIHk9IjkzLjI5MiI+JiMzMDMzMDsmIzI3ODgwOyYjMjYxMjY7JiMzMjA0ODsmIzEyNTIyOyYjMTI1MDk7JiMxMjQ3MjsmIzEyNDg4OyYjMTI1MjI7PC90ZXh0PjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MiIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iUE9EUmVwbyIgaWQ9InBhcnQyLXRhaWwiPjxyZWN0IGZpbGw9IiNFMkUyRjAiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTM5Ljk5OTUiIHg9IjM3Ni4wMDYiIHk9IjYzMi41MjM0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI1Ljk5OTUiIHg9IjM4My4wMDYiIHk9IjY1Mi41MTg2Ij4mIzMwMzMwOyYjMjc4ODA7JiMyNjEyNjsmIzMyMDQ4OyYjMTI1MjI7JiMxMjUwOTsmIzEyNDcyOyYjMTI0ODg7JiMxMjUyMjs8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLWVudGl0eS11aWQ9InBhcnQzIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJSZWN2UmVwbyIgaWQ9InBhcnQzLWhlYWQiPjxyZWN0IGZpbGw9IiNFMkUyRjAiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTExLjk5OTYiIHg9IjUyNi4wMDU0IiB5PSI3My4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iNTMzLjAwNTQiIHk9IjkzLjI5MiI+JiMyMDgzNzsmIzMzNjU1OyYjMTI1MjI7JiMxMjUwOTsmIzEyNDcyOyYjMTI0ODg7JiMxMjUyMjs8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC10YWlsIiBkYXRhLWVudGl0eS11aWQ9InBhcnQzIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJSZWN2UmVwbyIgaWQ9InBhcnQzLXRhaWwiPjxyZWN0IGZpbGw9IiNFMkUyRjAiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTExLjk5OTYiIHg9IjUyNi4wMDU0IiB5PSI2MzIuNTIzNCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjUzMy4wMDU0IiB5PSI2NTIuNTE4NiI+JiMyMDgzNzsmIzMzNjU1OyYjMTI1MjI7JiMxMjUwOTsmIzEyNDcyOyYjMTI0ODg7JiMxMjUyMjs8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLWVudGl0eS11aWQ9InBhcnQ0IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJEQiIgaWQ9InBhcnQ0LWhlYWQiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIwLjM4NDgiIHg9Ijc4NC42NDQ1IiB5PSIxMDEuMjkyIj5EQjwvdGV4dD48cGF0aCBkPSJNNzc5LjgzNjksNTIuMjk2OSBDNzc5LjgzNjksNDIuMjk2OSA3OTcuODM2OSw0Mi4yOTY5IDc5Ny44MzY5LDQyLjI5NjkgQzc5Ny44MzY5LDQyLjI5NjkgODE1LjgzNjksNDIuMjk2OSA4MTUuODM2OSw1Mi4yOTY5IEw4MTUuODM2OSw3OC4yOTY5IEM4MTUuODM2OSw4OC4yOTY5IDc5Ny44MzY5LDg4LjI5NjkgNzk3LjgzNjksODguMjk2OSBDNzk3LjgzNjksODguMjk2OSA3NzkuODM2OSw4OC4yOTY5IDc3OS44MzY5LDc4LjI5NjkgTDc3OS44MzY5LDUyLjI5NjkiIGZpbGw9IiNFMkUyRjAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik03NzkuODM2OSw1Mi4yOTY5IEM3NzkuODM2OSw2Mi4yOTY5IDc5Ny44MzY5LDYyLjI5NjkgNzk3LjgzNjksNjIuMjk2OSBDNzk3LjgzNjksNjIuMjk2OSA4MTUuODM2OSw2Mi4yOTY5IDgxNS44MzY5LDUyLjI5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0NCIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iREIiIGlkPSJwYXJ0NC10YWlsIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMC4zODQ4IiB4PSI3ODQuNjQ0NSIgeT0iNjQ1LjUxODYiPkRCPC90ZXh0PjxwYXRoIGQ9Ik03NzkuODM2OSw2NTguODIwMyBDNzc5LjgzNjksNjQ4LjgyMDMgNzk3LjgzNjksNjQ4LjgyMDMgNzk3LjgzNjksNjQ4LjgyMDMgQzc5Ny44MzY5LDY0OC44MjAzIDgxNS44MzY5LDY0OC44MjAzIDgxNS44MzY5LDY1OC44MjAzIEw4MTUuODM2OSw2ODQuODIwMyBDODE1LjgzNjksNjk0LjgyMDMgNzk3LjgzNjksNjk0LjgyMDMgNzk3LjgzNjksNjk0LjgyMDMgQzc5Ny44MzY5LDY5NC44MjAzIDc3OS44MzY5LDY5NC44MjAzIDc3OS44MzY5LDY4NC44MjAzIEw3NzkuODM2OSw2NTguODIwMyIgZmlsbD0iI0UyRTJGMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTc3OS44MzY5LDY1OC44MjAzIEM3NzkuODM2OSw2NjguODIwMyA3OTcuODM2OSw2NjguODIwMyA3OTcuODM2OSw2NjguODIwMyBDNzk3LjgzNjksNjY4LjgyMDMgODE1LjgzNjksNjY4LjgyMDMgODE1LjgzNjksNjU4LjgyMDMiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDEiIGRhdGEtZW50aXR5LTI9InBhcnQyIiBpZD0ibXNnMSI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0MzQuMDA1NywxMzEuNzI2Niw0NDQuMDA1NywxMzUuNzI2Niw0MzQuMDA1NywxMzkuNzI2Niw0MzguMDA1NywxMzUuNzI2NiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2OC45OTk4IiB4Mj0iNDQwLjAwNTciIHkxPSIxMzUuNzI2NiIgeTI9IjEzNS43MjY2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzUzLjAwNTkiIHg9Ijc1Ljk5OTgiIHk9IjEzMC42NjA2Ij5maW5kQnlQdXJjaGFzZU9yZGVyQW5kTGluZShwb051bWJlciwgbGluZU51bWJlcik8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0MiIgZGF0YS1lbnRpdHktMj0icGFydDQiIGlkPSJtc2cyIj48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijc4NS44MzY5LDE2MC44NTk0LDc5NS44MzY5LDE2NC44NTk0LDc4NS44MzY5LDE2OC44NTk0LDc4OS44MzY5LDE2NC44NTk0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ0Ni4wMDU3IiB4Mj0iNzkxLjgzNjkiIHkxPSIxNjQuODU5NCIgeTI9IjE2NC44NTk0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzI3LjgzMTIiIHg9IjQ1My4wMDU3IiB5PSIxNTkuNzkzNSI+U0VMRUNUIC4uLiBXSEVSRSAmIzMwMzMwOyYjMjc4ODA7JiMzMDA1ODsmIzIxNDk1OyA9ID8gQU5EICYjMzAzMzA7JiMyNzg4MDsmIzM0ODkyOyYjMzAwNTg7JiMyMTQ5NTsgPSA/PC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDQiIGRhdGEtZW50aXR5LTI9InBhcnQyIiBpZD0ibXNnMyI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0NTcuMDA1NywxODkuOTkyMiw0NDcuMDA1NywxOTMuOTkyMiw0NTcuMDA1NywxOTcuOTkyMiw0NTMuMDA1NywxOTMuOTkyMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjIsMjsiIHgxPSI0NTEuMDA1NyIgeDI9Ijc5Ni44MzY5IiB5MT0iMTkzLjk5MjIiIHkyPSIxOTMuOTkyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2OS4wMDAyIiB4PSI0NjMuMDA1NyIgeT0iMTg4LjkyNjMiPiYjMzAzMzA7JiMyNzg4MDsmIzI2MTI2OyYjMzIwNDg7JiM2NTI4ODsmIzEyNDk2OyYjMTI1NDA7JiMxMjQ3MjsmIzEyNTE5OyYjMTI1MzE7JiMzNjc5NjsmIzEyNDE1OyYjNjUyODk7PC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDIiIGRhdGEtZW50aXR5LTI9InBhcnQxIiBpZD0ibXNnNCI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI3OS45OTk4LDIxOS4xMjUsNjkuOTk5OCwyMjMuMTI1LDc5Ljk5OTgsMjI3LjEyNSw3NS45OTk4LDIyMy4xMjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheToyLDI7IiB4MT0iNzMuOTk5OCIgeDI9IjQ0NS4wMDU3IiB5MT0iMjIzLjEyNSIgeTI9IjIyMy4xMjUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzUuMDE0NiIgeD0iODUuOTk5OCIgeT0iMjE4LjA1OTEiPlB1cmNoYXNlT3JkZXJEZXRhaWw8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0MSIgZGF0YS1lbnRpdHktMj0icGFydDEiIGlkPSJtc2c1Ij48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjguOTk5OCIgeDI9IjExMC45OTk4IiB5MT0iMjUyLjI1NzgiIHkyPSIyNTIuMjU3OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMTAuOTk5OCIgeDI9IjExMC45OTk4IiB5MT0iMjUyLjI1NzgiIHkyPSIyNjUuMjU3OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2OS45OTk4IiB4Mj0iMTEwLjk5OTgiIHkxPSIyNjUuMjU3OCIgeTI9IjI2NS4yNTc4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI3OS45OTk4LDI2MS4yNTc4LDY5Ljk5OTgsMjY1LjI1NzgsNzkuOTk5OCwyNjkuMjU3OCw3NS45OTk4LDI2NS4yNTc4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTEuMDAwMSIgeD0iNzUuOTk5OCIgeT0iMjQ3LjE5MTkiPiYjMjA4Mzc7JiMzMzY1NTsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzIwMzE2OyYjMjUxMDQ7PC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDEiIGRhdGEtZW50aXR5LTI9InBhcnQzIiBpZD0ibXNnNiI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1NzAuMDA1MiwyOTAuMzkwNiw1ODAuMDA1MiwyOTQuMzkwNiw1NzAuMDA1MiwyOTguMzkwNiw1NzQuMDA1MiwyOTQuMzkwNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2OC45OTk4IiB4Mj0iNTc2LjAwNTIiIHkxPSIyOTQuMzkwNiIgeTI9IjI5NC4zOTA2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAwLjQ3MDciIHg9Ijc1Ljk5OTgiIHk9IjI4OS4zMjQ3Ij5zYXZlKHJlY2VpdmluZyk8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0MyIgZGF0YS1lbnRpdHktMj0icGFydDQiIGlkPSJtc2c3Ij48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijc4NS44MzY5LDMxOS41MjM0LDc5NS44MzY5LDMyMy41MjM0LDc4NS44MzY5LDMyNy41MjM0LDc4OS44MzY5LDMyMy41MjM0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjU4Mi4wMDUyIiB4Mj0iNzkxLjgzNjkiIHkxPSIzMjMuNTIzNCIgeTI9IjMyMy41MjM0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3Ljk5NDciIHg9IjU4OS4wMDUyIiB5PSIzMTguNDU3NSI+SU5TRVJUIElOVE8gJiMyMDgzNzsmIzMzNjU1OyYjMjE0NjM7JiMyMDgzNzsmIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTs8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0NCIgZGF0YS1lbnRpdHktMj0icGFydDMiIGlkPSJtc2c4Ij48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU5My4wMDUyLDM0OC42NTYzLDU4My4wMDUyLDM1Mi42NTYzLDU5My4wMDUyLDM1Ni42NTYzLDU4OS4wMDUyLDM1Mi42NTYzIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjU4Ny4wMDUyIiB4Mj0iNzk2LjgzNjkiIHkxPSIzNTIuNjU2MyIgeTI9IjM1Mi42NTYzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTguNzU3MyIgeD0iNTk5LjAwNTIiIHk9IjM0Ny41OTAzIj5PSzwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtZW50aXR5LTE9InBhcnQxIiBkYXRhLWVudGl0eS0yPSJwYXJ0MiIgaWQ9Im1zZzkiPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDM0LjAwNTcsMzc3Ljc4OTEsNDQ0LjAwNTcsMzgxLjc4OTEsNDM0LjAwNTcsMzg1Ljc4OTEsNDM4LjAwNTcsMzgxLjc4OTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjguOTk5OCIgeDI9IjQ0MC4wMDU3IiB5MT0iMzgxLjc4OTEiIHkyPSIzODEuNzg5MSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMwMi4wNTk2IiB4PSI3NS45OTk4IiB5PSIzNzYuNzIzMSI+dXBkYXRlUmVjZWl2ZWRRdWFudGl0eShpZCwgcXVhbnRpdHksIHZlcnNpb24pPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDIiIGRhdGEtZW50aXR5LTI9InBhcnQ0IiBpZD0ibXNnMTAiPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNzg1LjgzNjksNDA2LjkyMTksNzk1LjgzNjksNDEwLjkyMTksNzg1LjgzNjksNDE0LjkyMTksNzg5LjgzNjksNDEwLjkyMTkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDQ2LjAwNTciIHgyPSI3OTEuODM2OSIgeTE9IjQxMC45MjE5IiB5Mj0iNDEwLjkyMTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyOTMuMTQ3NSIgeD0iNDUzLjAwNTciIHk9IjQwNS44NTYiPlVQREFURSAuLi4gV0hFUkUgSUQgPSA/IEFORCAmIzEyNDk2OyYjMTI1NDA7JiMxMjQ3MjsmIzEyNTE5OyYjMTI1MzE7ID0gPzwvdGV4dD48L2c+PHBhdGggZD0iTTEwLDQyNS45MjE5IEw3NC40NDI5LDQyNS45MjE5IEw3NC40NDI5LDQzMy4wNTQ3IEw2NC40NDI5LDQ0My4wNTQ3IEwxMCw0NDMuMDU0NyBMMTAsNDI1LjkyMTkiIGZpbGw9IiNFRUVFRUUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMTkwLjYwMTYiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgd2lkdGg9IjgxNS44MzY5IiB4PSIxMCIgeT0iNDI1LjkyMTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTkuNDQyOSIgeD0iMjUiIHk9IjQzOC45ODg4Ij5hbHQ8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg3LjA1NDIiIHg9Ijg5LjQ0MjkiIHk9IjQzOC4xMzIzIj5bJiMxMjQ5NjsmIzEyNTQwOyYjMTI0NzI7JiMxMjUxOTsmIzEyNTMxOyYjMTk5Njg7JiMzMzI2ODtdPC90ZXh0PjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0NCIgZGF0YS1lbnRpdHktMj0icGFydDIiIGlkPSJtc2cxMSI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0NTcuMDA1Nyw0NjAuMTg3NSw0NDcuMDA1Nyw0NjQuMTg3NSw0NTcuMDA1Nyw0NjguMTg3NSw0NTMuMDA1Nyw0NjQuMTg3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjIsMjsiIHgxPSI0NTEuMDA1NyIgeDI9Ijc5Ni44MzY5IiB5MT0iNDY0LjE4NzUiIHkyPSI0NjQuMTg3NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk5LjI3MTEiIHg9IjQ2My4wMDU3IiB5PSI0NTkuMTIxNiI+JiMyNjM1NjsmIzI2MDMyOyYjMjUxMDQ7JiMyMTE1MTsmIzY1Mjg4OzEmIzIwMjE0OyYjNjUyODk7PC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDIiIGRhdGEtZW50aXR5LTI9InBhcnQxIiBpZD0ibXNnMTIiPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNzkuOTk5OCw0ODkuMzIwMyw2OS45OTk4LDQ5My4zMjAzLDc5Ljk5OTgsNDk3LjMyMDMsNzUuOTk5OCw0OTMuMzIwMyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjIsMjsiIHgxPSI3My45OTk4IiB4Mj0iNDQ1LjAwNTciIHkxPSI0OTMuMzIwMyIgeTI9IjQ5My4zMjAzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTguNzU3MyIgeD0iODUuOTk5OCIgeT0iNDg4LjI1NDQiPk9LPC90ZXh0PjwvZz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheToyLDI7IiB4MT0iMTAiIHgyPSI4MjUuODM2OSIgeTE9IjUwMi4zMjAzIiB5Mj0iNTAyLjMyMDMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTguMDU0MSIgeD0iMTUiIHk9IjUxMi41MzA4Ij5bJiMxMjQ5NjsmIzEyNTQwOyYjMTI0NzI7JiMxMjUxOTsmIzEyNTMxOyYjMTk5ODE7JiMxOTk2ODsmIzMzMjY4O108L3RleHQ+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtZW50aXR5LTE9InBhcnQ0IiBkYXRhLWVudGl0eS0yPSJwYXJ0MiIgaWQ9Im1zZzEzIj48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQ1Ny4wMDU3LDUzMy4yNTc4LDQ0Ny4wMDU3LDUzNy4yNTc4LDQ1Ny4wMDU3LDU0MS4yNTc4LDQ1My4wMDU3LDUzNy4yNTc4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjQ1MS4wMDU3IiB4Mj0iNzk2LjgzNjkiIHkxPSI1MzcuMjU3OCIgeTI9IjUzNy4yNTc4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTkuMjcxMSIgeD0iNDYzLjAwNTciIHk9IjUzMi4xOTE5Ij4mIzI2MzU2OyYjMjYwMzI7JiMyMjgzMzsmIzI1OTQzOyYjNjUyODg7MCYjMjAyMTQ7JiM2NTI4OTs8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0MiIgZGF0YS1lbnRpdHktMj0icGFydDEiIGlkPSJtc2cxNCI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI3OS45OTk4LDU2Mi4zOTA2LDY5Ljk5OTgsNTY2LjM5MDYsNzkuOTk5OCw1NzAuMzkwNiw3NS45OTk4LDU2Ni4zOTA2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjczLjk5OTgiIHgyPSI0NDUuMDA1NyIgeTE9IjU2Ni4zOTA2IiB5Mj0iNTY2LjM5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNjAuMTc2OCIgeD0iODUuOTk5OCIgeT0iNTYxLjMyNDciPk9wdGltaXN0aWNMb2NrRXhjZXB0aW9uPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDEiIGRhdGEtZW50aXR5LTI9InBhcnQxIiBpZD0ibXNnMTUiPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI2OC45OTk4IiB4Mj0iMTEwLjk5OTgiIHkxPSI1OTUuNTIzNCIgeTI9IjU5NS41MjM0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjExMC45OTk4IiB4Mj0iMTEwLjk5OTgiIHkxPSI1OTUuNTIzNCIgeTI9IjYwOC41MjM0Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY5Ljk5OTgiIHgyPSIxMTAuOTk5OCIgeTE9IjYwOC41MjM0IiB5Mj0iNjA4LjUyMzQiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijc5Ljk5OTgsNjA0LjUyMzQsNjkuOTk5OCw2MDguNTIzNCw3OS45OTk4LDYxMi41MjM0LDc1Ljk5OTgsNjA4LjUyMzQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC4wMDAxIiB4PSI3NS45OTk4IiB5PSI1OTAuNDU3NSI+JiMxMjUyNTsmIzEyNTQwOyYjMTI1MjM7JiMxMjQ5NjsmIzEyNDgzOyYjMTI0NjM7PC90ZXh0PjwvZz48P3BsYW50dW1sLXNyYyBWTEZWSnpERzU3eGxOdDZvZnY2QzFMLU5nNWJqNHVkQkRoaVBkcWp4YkhqQk16a2thSlZQWkd3Q2kySzZXT1dYOTgwNE95SGkyaWdHRi1Ra05UX3U1eHBoc2xyV2F3VlVVLXV2dHBkVnpfS3VzRDRHVTZ5RVdfS3BJWXh5V3JzbGxrN0xaaGdEanRKYnMzLXkzOHdRYjdvWlhEM2dUdXVwUFNsMTJaUGJ0TzU0TDVOeklLY1JhVy1xLVppMWlXcUlLam9JZ3VwZFRkVi0tQ3JaVnRrWnNwZ2J2OElJcHhId0ppYWdFdVQ1bk84VzhURU9zYzFBVWd6N2NBX0FaaG1Xc21XSTBYLS0yM3A3SEhGMHhCcU9EbUZGaUF4b295TUFmSW9vejhBYjhZa2hncGNpZXdIZnYyakIyeVhBV1NRa19WQ0M1ck5zRzBHLTBvS245cHVlR3BnVFhnU0ZIS2M0RmdGa3ZlYk5GdUV4UzEtb1VJNEExbGxsWHQ1RXU2NXNUOTlIQVF4Ulo1QVpmci1GdFhUQWNpN1ZEYnN2a2N3bDNHVFduSDZaMzhtSDQ5MFpPc3NDeG8wbnJndU1XYnpyQmRWenJTUDRRZHlZTXRQSHFhOEFtWXhNZHl6bXlLbENWSnZWNGdLby12R0I0UXZOdHNBNzBOaENTR1hQVTNKVFhlaDk3NERJczBrZlpvbENQLW1pOXg2UVdmVkg5R0traWNuaXcxQ1VGMmFBc1I4dXVpNnlDNTMtWGVvWHloQmN0OG50cGJ5N2pUUTQ5X3dkYmxfbmIyZGFsVGpaZGpwZk5GcHdobU1DNmpCTzdwVTFsN3VoazdWbW16X1NPazFwanVBUjNieDJEamsxZEE2eTQ1eWZZMEtDVlFoNXVMd29wVmlRSlg4a0FEQkxWbTAwPz48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h4 id="_23">分割入荷時の楽観ロック戦略<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<details>
<summary>ReceivingService.java（楽観ロック対応）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * 入荷処理（楽観ロック対応）</span>
<span class="cm"> */</span>
<span class="nd">@Transactional</span>
<span class="kd">public</span><span class="w"> </span><span class="n">Receiving</span><span class="w"> </span><span class="nf">processReceiving</span><span class="p">(</span><span class="n">ReceivingRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 発注明細を取得</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">detail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">purchaseOrderDetailRepository</span>
<span class="w">            </span><span class="p">.</span><span class="na">findByPurchaseOrderAndLine</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">(),</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;発注明細が見つかりません&quot;</span><span class="p">));</span>

<span class="w">    </span><span class="c1">// 入荷可能数量チェック</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">remainingQuantity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detail</span><span class="p">.</span><span class="na">getOrderQuantity</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">subtract</span><span class="p">(</span><span class="n">detail</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">());</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">().</span><span class="na">compareTo</span><span class="p">(</span><span class="n">remainingQuantity</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span>
<span class="w">                </span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;入荷数量が残数を超えています（残数: %s）&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">remainingQuantity</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 入荷データ作成</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Receiving</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">receivingNumber</span><span class="p">(</span><span class="n">generateReceivingNumber</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">purchaseOrderNumber</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">receivingDate</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getReceivingDate</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">receivingType</span><span class="p">(</span><span class="n">determineReceivingType</span><span class="p">(</span><span class="n">detail</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">receivedQuantity</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">locationCode</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getLocationCode</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="n">receivingRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">receiving</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 発注明細の入荷済数量を更新（楽観ロック）</span>
<span class="w">    </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">purchaseOrderDetailRepository</span><span class="p">.</span><span class="na">updateReceivedQuantity</span><span class="p">(</span>
<span class="w">                </span><span class="n">detail</span><span class="p">.</span><span class="na">getId</span><span class="p">(),</span>
<span class="w">                </span><span class="n">request</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">(),</span>
<span class="w">                </span><span class="n">detail</span><span class="p">.</span><span class="na">getVersion</span><span class="p">()</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">OptimisticLockException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 他ユーザーが先に入荷処理を行った場合</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConcurrentUpdateException</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;他のユーザーが同時に入荷処理を行いました。画面を更新して再度お試しください。&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// 発注ステータス更新</span>
<span class="w">    </span><span class="n">updatePurchaseOrderStatus</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getPurchaseOrderNumber</span><span class="p">());</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">receiving</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">private</span><span class="w"> </span><span class="n">ReceivingType</span><span class="w"> </span><span class="nf">determineReceivingType</span><span class="p">(</span><span class="n">PurchaseOrderDetail</span><span class="w"> </span><span class="n">detail</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">receivedQuantity</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">var</span><span class="w"> </span><span class="n">totalReceived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">detail</span><span class="p">.</span><span class="na">getReceivedQuantity</span><span class="p">().</span><span class="na">add</span><span class="p">(</span><span class="n">receivedQuantity</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">totalReceived</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">detail</span><span class="p">.</span><span class="na">getOrderQuantity</span><span class="p">())</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">SPLIT</span><span class="p">;</span><span class="w"> </span><span class="c1">// 分割入荷</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">ReceivingType</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">;</span><span class="w"> </span><span class="c1">// 通常入荷（全数）</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="_24">楽観ロックのベストプラクティス（購買管理向け）<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ポイント</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>発注明細の数量更新</strong></td>
<td>入荷・検査・検収それぞれで楽観ロックを適用</td>
</tr>
<tr>
<td><strong>分割入荷対応</strong></td>
<td>複数回の入荷でも整合性を保証</td>
</tr>
<tr>
<td><strong>ステータス連動</strong></td>
<td>発注ステータスと明細の完了フラグを連動更新</td>
</tr>
<tr>
<td><strong>エラーメッセージ</strong></td>
<td>ユーザーに再操作を促す明確なメッセージ</td>
</tr>
<tr>
<td><strong>トランザクション境界</strong></td>
<td>入荷→明細更新→ステータス更新を1トランザクションで</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="254">25.4 まとめ<a class="headerlink" href="#254" title="Permanent link">&para;</a></h2>
<p>本章では、購買管理（発注から検収まで）の DB 設計と実装について学びました。</p>
<h3 id="_25">学んだこと<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>発注業務の設計</strong></li>
<li>発注データと発注明細データの親子関係</li>
<li>単価マスタによる価格管理</li>
<li>発注ステータスの状態遷移</li>
<li>
<p>諸口品目（マスタ外品目）の扱い</p>
</li>
<li>
<p><strong>入荷・検収業務の設計</strong></p>
</li>
<li>入荷→検査→検収の業務フロー</li>
<li>分割入荷への対応</li>
<li>良品・不良品の管理</li>
<li>
<p>消費税計算</p>
</li>
<li>
<p><strong>命名規則のパターン</strong></p>
</li>
<li><strong>DB（日本語）</strong>: テーブル名、カラム名、ENUM 型・値は日本語</li>
<li><strong>Java（英語）</strong>: クラス名、フィールド名、enum 値は英語</li>
<li><strong>MyBatis resultMap</strong>: 日本語カラムと英語プロパティのマッピング</li>
<li><strong>TypeHandler</strong>: 日本語 ENUM 値と英語 enum の相互変換</li>
</ol>
<h3 id="_26">テーブル一覧<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>テーブル名（日本語）</th>
<th>Java エンティティ</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>単価マスタ</td>
<td>UnitPrice</td>
<td>品目・取引先ごとの単価情報</td>
</tr>
<tr>
<td>発注データ</td>
<td>PurchaseOrder</td>
<td>発注ヘッダ情報</td>
</tr>
<tr>
<td>発注明細データ</td>
<td>PurchaseOrderDetail</td>
<td>発注明細情報</td>
</tr>
<tr>
<td>諸口品目情報</td>
<td>MiscellaneousItem</td>
<td>マスタ外品目の臨時情報</td>
</tr>
<tr>
<td>入荷受入データ</td>
<td>Receiving</td>
<td>入荷情報</td>
</tr>
<tr>
<td>欠点マスタ</td>
<td>Defect</td>
<td>不良品の欠点コード</td>
</tr>
<tr>
<td>受入検査データ</td>
<td>Inspection</td>
<td>受入検査情報</td>
</tr>
<tr>
<td>検収データ</td>
<td>Acceptance</td>
<td>検収情報</td>
</tr>
</tbody>
</table>
<h3 id="enum">ENUM 一覧<a class="headerlink" href="#enum" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>DB ENUM 型（日本語）</th>
<th>Java Enum</th>
<th>値</th>
</tr>
</thead>
<tbody>
<tr>
<td>発注ステータス</td>
<td>PurchaseOrderStatus</td>
<td>作成中→CREATING, 発注済→ORDERED, 一部入荷→PARTIALLY_RECEIVED, 入荷完了→RECEIVED, 検収完了→ACCEPTED, 取消→CANCELLED</td>
</tr>
<tr>
<td>入荷受入区分</td>
<td>ReceivingType</td>
<td>通常入荷→NORMAL, 分割入荷→SPLIT, 返品入荷→RETURN</td>
</tr>
</tbody>
</table>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/practical-database-design" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>