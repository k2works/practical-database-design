
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="基幹業務システム（販売管理・財務会計・生産管理）のデータベース設計を体系的に解説">
      
      
        <meta name="author" content="k2works">
      
      
      
        <link rel="prev" href="../study2-4/">
      
      
        <link rel="next" href="../study3-2/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>研究1 モノリスサービスの実装 - 実践データベース設計：基幹業務システム編</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1-" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-header__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            実践データベース設計：基幹業務システム編
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              研究1 モノリスサービスの実装
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  実践データベース設計

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-nav__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    実践データベース設計：基幹業務システム編
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    実践データベース設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    実践データベース設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../techstack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    技術スタック
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    アウトライン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    執筆ワークフロー
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第1部 基幹業務システムの全体像
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    第1部 基幹業務システムの全体像
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第1章 基幹業務システムとは
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第2章 基幹業務システムの業務領域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第3章 業務フローの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第2部 販売管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    第2部 販売管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第4章 販売管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第5章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第6章 受注・出荷・売上の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第7章 債権管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第8章 調達管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第9章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第10章 債務管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第11章 共通処理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第12章 販売管理データ設計（B社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第13章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第3部 財務会計システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    第3部 財務会計システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第4部 生産管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    第4部 生産管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章 生産管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第23章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第24章 生産計画の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第25章 購買管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第26章 外注委託管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter27/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第27章 工程管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter28/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第28章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第29章 品質管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter30/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第30章 製造原価管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter31/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第31章 生産管理データ設計（E社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第32章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第5部 エンタープライズインテグレーション
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    第5部 エンタープライズインテグレーション
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter33.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第33章 システム統合の概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter34.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第34章 メッセージングパターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter35.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第35章 システム間連携パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter36.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第36章 マスタデータ管理（MDM）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter37.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第37章 イベント駆動アーキテクチャ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter38.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第38章 API設計とサービス連携
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter39.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第39章 データ連携の実装パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 販売管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 販売管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" checked>
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        はじめに
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      
        第22章：モノリスアーキテクチャの基礎
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第22章：モノリスアーキテクチャの基礎">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.1 モノリスアーキテクチャとは
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-api-vs" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.2 API サーバー vs モノリス
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.3 モノリスを選択すべき場面
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.4 モノリスにおけるヘキサゴナルアーキテクチャ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#225" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.5 ディレクトリ構成
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#226" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.6 技術スタックの導入
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#227-spring-boot-thymeleaf" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.7 基本的な Spring Boot + Thymeleaf アプリケーション
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#228-htmx" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.8 htmx による部分更新
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#229-api-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.9 API サーバー版との Controller の違い
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      
        第23章：マスタ画面の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第23章：マスタ画面の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.1 勘定科目マスタ画面の設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="23.1 勘定科目マスタ画面の設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        画面一覧
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.2 フォームオブジェクトの設計
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233-controller-tdd" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.3 勘定科目 Controller の TDD 実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="23.3 勘定科目 Controller の TDD 実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#red" class="md-nav__link">
    <span class="md-ellipsis">
      
        Red: 失敗するテストを書く
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#green-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        Green: Controller の実装
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      
        第24章：仕訳入力画面の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第24章：仕訳入力画面の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" class="md-nav__link">
    <span class="md-ellipsis">
      
        24.1 仕訳入力画面の設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="24.1 仕訳入力画面の設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        画面一覧
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" class="md-nav__link">
    <span class="md-ellipsis">
      
        24.2 仕訳入力フォームオブジェクト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        24.3 仕訳 Controller の実装
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#25" class="md-nav__link">
    <span class="md-ellipsis">
      
        第25章：帳票出力の実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第25章：帳票出力の実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.1 帳票出力の設計
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#252-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.2 帳票 Controller の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#253-excel" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.3 Excel 帳票生成
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    <span class="md-ellipsis">
      
        第26章：ページネーションの実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第26章：ページネーションの実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#261" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.1 ページネーションの設計
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#262-pageresult" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.2 PageResult クラス
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#263-mapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.3 Mapper 層の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#264-repository" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.4 Repository 層の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#265-usecase-service" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.5 UseCase / Service 層の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#266-controller" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.6 Controller の実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#267" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.7 テンプレートの実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#268" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.8 ページネーションの動作
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#269" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.9 検索条件の保持
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        まとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        学んだこと
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        実装した機能
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vs-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        モノリス vs API サーバー
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        技術的なポイント
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study3-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study3-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study3-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_12" >
        
          
          <label class="md-nav__link" for="__nav_1_12" id="__nav_1_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 生産管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 生産管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_13" >
        
          
          <label class="md-nav__link" for="__nav_1_13" id="__nav_1_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システムORM実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システムORM実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter14-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter15-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter16-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter17-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter18-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter19-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter20-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter21-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_14" >
        
          
          <label class="md-nav__link" for="__nav_1_14" id="__nav_1_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    付録
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    付録
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/er-diagrams.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A 全体ER図
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/table-definitions.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    B テーブル定義一覧
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/glossary.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C 用語集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_15" >
        
          
          <label class="md-nav__link" for="__nav_1_15" id="__nav_1_15_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    データベース
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    データベース
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/schemaspy-output/sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SchemaSpy ER図（SMS）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="1-">実践データベース設計：財務会計システム 研究 1 - モノリスサービスの実装<a class="headerlink" href="#1-" title="Permanent link">&para;</a></h1>
<h2 id="_1">はじめに<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本研究では、API サーバー構成（第21章）とは異なるアプローチとして、<strong>モノリスアーキテクチャ</strong>による財務会計システムを実装します。UI（テンプレートエンジン）、ビジネスロジック、データベースアクセスがすべて同一サーバー内で動作する、伝統的かつ堅実なアーキテクチャです。</p>
<hr />
<h2 id="22">第22章：モノリスアーキテクチャの基礎<a class="headerlink" href="#22" title="Permanent link">&para;</a></h2>
<h3 id="221">22.1 モノリスアーキテクチャとは<a class="headerlink" href="#221" title="Permanent link">&para;</a></h3>
<p><strong>モノリス（Monolith / Monolithic Architecture）</strong>とは、「API」と「UI」と「ビジネスロジック」が <strong>1つの実行ユニット</strong>（1つのプロジェクトやバイナリ）にまとまっているアーキテクチャを指します。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9Ijc2NXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTExM3B4O2hlaWdodDo3NjVweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMTEzIDc2NSIgd2lkdGg9IjExMTNweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMTI1MTQ7JiMxMjQ5NDsmIzEyNTIyOyYjMTI0NzM7JiMxMjQ1MDsmIzEyNTQwOyYjMTI0NjE7JiMxMjQ4NjsmIzEyNDYzOyYjMTI0ODE7JiMxMjUxNTsmIzY1Mjg4OyYjMzYwMDE7JiMyMTIwOTsmIzIwMjUwOyYjMzUzMzY7JiMxMjQ3MTsmIzEyNDczOyYjMTI0ODY7JiMxMjUxMjsmIzY1Mjg5OzwvdGl0bGU+PGRlZnMvPjxnPjxnIGNsYXNzPSJ0aXRsZSIgZGF0YS1zb3VyY2UtbGluZT0iMSI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI5My45OTg3IiB4PSI0MDIuNzA3NCIgeT0iMjIuOTk1MSI+JiMxMjUxNDsmIzEyNDk0OyYjMTI1MjI7JiMxMjQ3MzsmIzEyNDUwOyYjMTI1NDA7JiMxMjQ2MTsmIzEyNDg2OyYjMTI0NjM7JiMxMjQ4MTsmIzEyNTE1OyYjNjUyODg7JiMzNjAwMTsmIzIxMjA5OyYjMjAyNTA7JiMzNTMzNjsmIzEyNDcxOyYjMTI0NzM7JiMxMjQ4NjsmIzEyNTEyOyYjNjUyODk7PC90ZXh0PjwvZz48IS0tY2x1c3RlciA/Pz8/Pz8/PyAoPz8/Pz8/Pz8/KS0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iLi4uLi4uLi4gLi4uLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl8uLi4uLi4uLiAuLi4uLi4uLi4uLiI+PHBhdGggZD0iTTguNSw0My4yOTY5IEwyNjUuMTY5OSw0My4yOTY5IEEzLjc1LDMuNzUgMCAwIDEgMjY3LjY2OTksNDUuNzk2OSBMMjc0LjY2OTksNjUuNTkzOCBMODUxLjUsNjUuNTkzOCBBMi41LDIuNSAwIDAgMSA4NTQsNjguMDkzOCBMODU0LDY0Ni4wOTY5IEEyLjUsMi41IDAgMCAxIDg1MS41LDY0OC41OTY5IEw4LjUsNjQ4LjU5NjkgQTIuNSwyLjUgMCAwIDEgNiw2NDYuMDk2OSBMNiw0NS43OTY5IEEyLjUsMi41IDAgMCAxIDguNSw0My4yOTY5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI2IiB4Mj0iMjc0LjY2OTkiIHkxPSI2NS41OTM4IiB5Mj0iNjUuNTkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNTUuNjY5OSIgeD0iMTAiIHk9IjU4LjI5MiI+JiMxMjUxNDsmIzEyNDk0OyYjMTI1MjI7JiMxMjQ3MzsmIzEyNDY5OyYjMTI1NDA7JiMxMjQ5NjsmIzEyNTQwOyAoJiMyMTMzNjsmIzE5OTY4OyYjMTIzOTg7JiMyMzQ1NTsmIzM0ODkyOyYjMTI1MTg7JiMxMjQ5MTsmIzEyNDgzOyYjMTI0ODg7KTwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgPz8/Pz8/Pz8/Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iLi4uLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJjbHVzdGVyXy4uLi4uLi4uLi4iPjxwYXRoIGQ9Ik00NTUuNSw5NC4yOTY5IEw1OTYuNDk5NCw5NC4yOTY5IEEzLjc1LDMuNzUgMCAwIDEgNTk4Ljk5OTQsOTYuNzk2OSBMNjA1Ljk5OTQsMTE2LjU5MzggTDgxMS41LDExNi41OTM4IEEyLjUsMi41IDAgMCAxIDgxNCwxMTkuMDkzOCBMODE0LDM0NS41MDY5IEEyLjUsMi41IDAgMCAxIDgxMS41LDM0OC4wMDY5IEw0NTUuNSwzNDguMDA2OSBBMi41LDIuNSAwIDAgMSA0NTMsMzQ1LjUwNjkgTDQ1Myw5Ni43OTY5IEEyLjUsMi41IDAgMCAxIDQ1NS41LDk0LjI5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjQ1MyIgeDI9IjYwNS45OTk0IiB5MT0iMTE2LjU5MzgiIHkyPSIxMTYuNTkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzkuOTk5NCIgeD0iNDU3IiB5PSIxMDkuMjkyIj4mIzEyNTAzOyYjMTI1MjQ7JiMxMjQ3NjsmIzEyNTMxOyYjMTI0ODY7JiMxMjU0MDsmIzEyNDcxOyYjMTI1MTk7JiMxMjUzMTsmIzIzNjUyOzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgPz8/Pz8/Pz8/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSIuLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjExIiBkYXRhLXVpZD0iZW50MDAwNyIgaWQ9ImNsdXN0ZXJfLi4uLi4uLi4uIj48cGF0aCBkPSJNNDAuNSwyNTAuNzA2OSBMMTY3LjQ5OTUsMjUwLjcwNjkgQTMuNzUsMy43NSAwIDAgMSAxNjkuOTk5NSwyNTMuMjA2OSBMMTc2Ljk5OTUsMjczLjAwMzggTDQyNi41LDI3My4wMDM4IEEyLjUsMi41IDAgMCAxIDQyOSwyNzUuNTAzOCBMNDI5LDQ5MS44MDY5IEEyLjUsMi41IDAgMCAxIDQyNi41LDQ5NC4zMDY5IEw0MC41LDQ5NC4zMDY5IEEyLjUsMi41IDAgMCAxIDM4LDQ5MS44MDY5IEwzOCwyNTMuMjA2OSBBMi41LDIuNSAwIDAgMSA0MC41LDI1MC43MDY5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIzOCIgeDI9IjE3Ni45OTk1IiB5MT0iMjczLjAwMzgiIHkyPSIyNzMuMDAzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjUuOTk5NSIgeD0iNDIiIHk9IjI2NS43MDIiPiYjMTI0OTk7JiMxMjQ3MjsmIzEyNDkzOyYjMTI0NzM7JiMxMjUyNTsmIzEyNDcyOyYjMTI0ODM7JiMxMjQ2MzsmIzIzNjUyOzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgPz8/Pz8/Pz8tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9Ii4uLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIxNyIgZGF0YS11aWQ9ImVudDAwMTEiIGlkPSJjbHVzdGVyXy4uLi4uLi4uIj48cGF0aCBkPSJNNDU1LjUsMzk3LjAwNjkgTDU2OC40OTk1LDM5Ny4wMDY5IEEzLjc1LDMuNzUgMCAwIDEgNTcwLjk5OTUsMzk5LjUwNjkgTDU3Ny45OTk1LDQxOS4zMDM4IEw2MzQuNSw0MTkuMzAzOCBBMi41LDIuNSAwIDAgMSA2MzcsNDIxLjgwMzggTDYzNyw2MTQuMDk2OSBBMi41LDIuNSAwIDAgMSA2MzQuNSw2MTYuNTk2OSBMNDU1LjUsNjE2LjU5NjkgQTIuNSwyLjUgMCAwIDEgNDUzLDYxNC4wOTY5IEw0NTMsMzk5LjUwNjkgQTIuNSwyLjUgMCAwIDEgNDU1LjUsMzk3LjAwNjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjQ1MyIgeDI9IjU3Ny45OTk1IiB5MT0iNDE5LjMwMzgiIHkyPSI0MTkuMzAzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTEuOTk5NSIgeD0iNDU3IiB5PSI0MTIuMDAyIj4mIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyNDUwOyYjMTI0NjM7JiMxMjQ3NTsmIzEyNDczOyYjMjM2NTI7PC90ZXh0PjwvZz48IS0tZW50aXR5IENvbnRyb2xsZXItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQ29udHJvbGxlciIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfQ29udHJvbGxlciI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMDkuMTcyOSIgeD0iNDY5LjQxIiB5PSIxMjkuMjk2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSI1NTguNTgyOSIgeT0iMTM0LjI5NjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjU1Ni41ODI5IiB5PSIxMzYuMjk2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNTU2LjU4MjkiIHk9IjE0MC4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuMTcyOSIgeD0iNDg0LjQxIiB5PSIxNjIuMjkyIj5Db250cm9sbGVyPC90ZXh0PjwvZz48IS0tZW50aXR5IFRoeW1lbGVhZiA/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iVGh5bWVsZWFmIC4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNyIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfVGh5bWVsZWFmIC4uLi4uLiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDIuNDIxNSIgeD0iNTMxLjc5IiB5PSIyODUuNzA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSI3MTQuMjExNSIgeT0iMjkwLjcwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjcxMi4yMTE1IiB5PSIyOTIuNzA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNzEyLjIxMTUiIHk9IjI5Ni43MDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYyLjQyMTUiIHg9IjU0Ni43OSIgeT0iMzE4LjcwMiI+VGh5bWVsZWFmICYjMTI0ODY7JiMxMjUzMTsmIzEyNTAzOyYjMTI1MjQ7JiMxMjU0MDsmIzEyNDg4OzwvdGV4dD48L2c+PCEtLWVudGl0eSA/Pz8/Pz8gKENTUy9KUyktLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iLi4uLi4uIC5DU1MuSlMuIiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImVudGl0eV8uLi4uLi4gLkNTUy5KUy4iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTg0LjY1NDkiIHg9IjYxMy42NyIgeT0iMTI5LjI5NjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNzc4LjMyNDkiIHk9IjEzNC4yOTY5Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSI3NzYuMzI0OSIgeT0iMTM2LjI5NjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9Ijc3Ni4zMjQ5IiB5PSIxNDAuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0NC42NTQ5IiB4PSI2MjguNjciIHk9IjE2Mi4yOTIiPiYjMzg3NDU7JiMzMDM0MDsmIzEyNTIyOyYjMTI0Nzc7JiMxMjU0MDsmIzEyNDczOyAoQ1NTL0pTKTwvdGV4dD48L2c+PCEtLWVudGl0eSBBcHBsaWNhdGlvbiBTZXJ2aWNlLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkFwcGxpY2F0aW9uIFNlcnZpY2UiIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImVudGl0eV9BcHBsaWNhdGlvbiBTZXJ2aWNlIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE3NC40MTUiIHg9IjUzLjc5IiB5PSIyODUuNzA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSIyMDguMjA1IiB5PSIyOTAuNzA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iMjA2LjIwNSIgeT0iMjkyLjcwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjIwNi4yMDUiIHk9IjI5Ni43MDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM0LjQxNSIgeD0iNjguNzkiIHk9IjMxOC43MDIiPkFwcGxpY2F0aW9uIFNlcnZpY2U8L3RleHQ+PC9nPjwhLS1lbnRpdHkgRG9tYWluIE1vZGVsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkRvbWFpbiBNb2RlbCIgZGF0YS1zb3VyY2UtbGluZT0iMTMiIGRhdGEtdWlkPSJlbnQwMDA5IiBpZD0iZW50aXR5X0RvbWFpbiBNb2RlbCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDAuODA5NiIgeD0iNzAuNiIgeT0iNDMyLjAwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iMTkxLjQwOTYiIHk9IjQzNy4wMDY5Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSIxODkuNDA5NiIgeT0iNDM5LjAwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjE4OS40MDk2IiB5PSI0NDMuMDA2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMC44MDk2IiB4PSI4NS42IiB5PSI0NjUuMDAyIj5Eb21haW4gTW9kZWw8L3RleHQ+PC9nPjwhLS1lbnRpdHkgRG9tYWluIFNlcnZpY2UtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iRG9tYWluIFNlcnZpY2UiIGRhdGEtc291cmNlLWxpbmU9IjE0IiBkYXRhLXVpZD0iZW50MDAxMCIgaWQ9ImVudGl0eV9Eb21haW4gU2VydmljZSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTAuNTE2NiIgeD0iMjYyLjc0IiB5PSIyODUuNzA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSIzOTMuMjU2NiIgeT0iMjkwLjcwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjM5MS4yNTY2IiB5PSIyOTIuNzA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iMzkxLjI1NjYiIHk9IjI5Ni43MDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEwLjUxNjYiIHg9IjI3Ny43NCIgeT0iMzE4LjcwMiI+RG9tYWluIFNlcnZpY2U8L3RleHQ+PC9nPjwhLS1lbnRpdHkgUmVwb3NpdG9yeS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJSZXBvc2l0b3J5IiBkYXRhLXNvdXJjZS1saW5lPSIxOCIgZGF0YS11aWQ9ImVudDAwMTIiIGlkPSJlbnRpdHlfUmVwb3NpdG9yeSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTUuMDcyMyIgeD0iNDc4LjQ2IiB5PSI0MzIuMDA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSI1NzMuNTMyMyIgeT0iNDM3LjAwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjU3MS41MzIzIiB5PSI0MzkuMDA2OSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNTcxLjUzMjMiIHk9IjQ0My4wMDY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzUuMDcyMyIgeD0iNDkzLjQ2IiB5PSI0NjUuMDAyIj5SZXBvc2l0b3J5PC90ZXh0PjwvZz48IS0tZW50aXR5IE15QmF0aXMgTWFwcGVyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9Ik15QmF0aXMgTWFwcGVyIiBkYXRhLXNvdXJjZS1saW5lPSIxOSIgZGF0YS11aWQ9ImVudDAwMTMiIGlkPSJlbnRpdHlfTXlCYXRpcyBNYXBwZXIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTUyLjQ3MTciIHg9IjQ2OC43NiIgeT0iNTU0LjMwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNjAxLjIzMTciIHk9IjU1OS4zMDY5Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSI1OTkuMjMxNyIgeT0iNTYxLjMwNjkiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjU5OS4yMzE3IiB5PSI1NjUuMzA2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMi40NzE3IiB4PSI0ODMuNzYiIHk9IjU4Ny4zMDIiPk15QmF0aXMgTWFwcGVyPC90ZXh0PjwvZz48IS0tZW50aXR5IERCLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkRCIiBkYXRhLXNvdXJjZS1saW5lPSIyMyIgZGF0YS11aWQ9ImVudDAwMTQiIGlkPSJlbnRpdHlfREIiPjxwYXRoIGQ9Ik00OTQuNjIsNzEzLjU5NjkgQzQ5NC42Miw3MDMuNTk2OSA1NDQuOTk2NSw3MDMuNTk2OSA1NDQuOTk2NSw3MDMuNTk2OSBDNTQ0Ljk5NjUsNzAzLjU5NjkgNTk1LjM3MjksNzAzLjU5NjkgNTk1LjM3MjksNzEzLjU5NjkgTDU5NS4zNzI5LDczOC44OTM4IEM1OTUuMzcyOSw3NDguODkzOCA1NDQuOTk2NSw3NDguODkzOCA1NDQuOTk2NSw3NDguODkzOCBDNTQ0Ljk5NjUsNzQ4Ljg5MzggNDk0LjYyLDc0OC44OTM4IDQ5NC42Miw3MzguODkzOCBMNDk0LjYyLDcxMy41OTY5IiBmaWxsPSIjRjFGMUYxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNDk0LjYyLDcxMy41OTY5IEM0OTQuNjIsNzIzLjU5NjkgNTQ0Ljk5NjUsNzIzLjU5NjkgNTQ0Ljk5NjUsNzIzLjU5NjkgQzU0NC45OTY1LDcyMy41OTY5IDU5NS4zNzI5LDcyMy41OTY5IDU5NS4zNzI5LDcxMy41OTY5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4MC43NTI5IiB4PSI1MDQuNjIiIHk9Ijc0MC41OTIiPlBvc3RncmVTUUw8L3RleHQ+PC9nPjwhLS1lbnRpdHkgQnJvd3Nlci0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJCcm93c2VyIiBkYXRhLXNvdXJjZS1saW5lPSIyNSIgZGF0YS11aWQ9ImVudDAwMTUiIGlkPSJlbnRpdHlfQnJvd3NlciI+PGVsbGlwc2UgY3g9IjkwNS45OTk5IiBjeT0iNDI1LjUwNjkiIGZpbGw9IiNGMUYxRjEiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTkwNS45OTk5LDQzMy41MDY5IEw5MDUuOTk5OSw0NjAuNTA2OSBNODkyLjk5OTksNDQxLjUwNjkgTDkxOC45OTk5LDQ0MS41MDY5IE05MDUuOTk5OSw0NjAuNTA2OSBMODkyLjk5OTksNDc1LjUwNjkgTTkwNS45OTk5LDQ2MC41MDY5IEw5MTguOTk5OSw0NzUuNTA2OSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iODc4IiB5PSI0OTAuMDAyIj4mIzEyNTAyOyYjMTI1MjE7JiMxMjQ1NDsmIzEyNDcwOzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkdNTjI0IiBkYXRhLXNvdXJjZS1saW5lPSIzNyIgZGF0YS11aWQ9ImVudDAwMjUiIGlkPSJlbnRpdHlfR01OMjQiPjxwYXRoIGQ9Ik04ODEuNTksMTE3LjE3NjkgTDg4MS41OSwxODcuNzA4MSBMMTEwNi40MTM1LDE4Ny43MDgxIEwxMTA2LjQxMzUsMTI3LjE3NjkgTDEwOTYuNDEzNSwxMTcuMTc2OSBMODgxLjU5LDExNy4xNzY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMTA5Ni40MTM1LDExNy4xNzY5IEwxMDk2LjQxMzUsMTI3LjE3NjkgTDExMDYuNDEzNSwxMjcuMTc2OSBMMTA5Ni40MTM1LDExNy4xNzY5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3LjI3MTIiIHg9Ijg4Ny41OSIgeT0iMTM0LjI0MzgiPiYjMTIzNzc7JiMxMjQwOTsmIzEyMzkwOyYjMTIzNjQ7MSYjMTIzODg7JiMxMjM5ODsmIzEyNTAzOyYjMTI1MjU7JiMxMjQ3NTsmIzEyNDczOyYjMTIzOTE7JiMyMTIwNTsmIzIwMzE2OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny43NjY3IiB4PSI4ODcuNTkiIHk9IjE0OS4zNzY2Ij4tICYjMjE1MTY7JiMxOTk2ODtKVk0mIzEyMzkxOyYjMjM0NTU7JiMzNDg5Mjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM4LjgyMzQiIHg9Ijg4Ny41OSIgeT0iMTY0LjUwOTQiPi0gJiMyMTUxNjsmIzE5OTY4OyYjMTI0ODc7JiMxMjUwMzsmIzEyNTI1OyYjMTI0NTI7JiMxMjUxODsmIzEyNDkxOyYjMTI0ODM7JiMxMjQ4ODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjAzLjgyMzUiIHg9Ijg4Ny41OSIgeT0iMTc5LjY0MjIiPi0gJiMyMzQ5NDsmIzMyMDgwOyYjMjE1MTI7JiMxMjM4NDsmIzEyMzY0OyYjMzgyODM7JiMzMDMzMDsmIzEyNTM5OyYjMzY5Mzk7JiMyOTk5MjsmIzEyMzY0OyYjMTI0NzE7JiMxMjUzMTsmIzEyNTAzOyYjMTI1MjM7PC90ZXh0PjwvZz48IS0tbGluayBCcm93c2VyIHRvIENvbnRyb2xsZXItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQnJvd3NlciIgZGF0YS1lbnRpdHktMj0iQ29udHJvbGxlciIgZGF0YS1zb3VyY2UtbGluZT0iMjciIGRhdGEtdWlkPSJsbmsxNiIgaWQ9ImxpbmtfQnJvd3Nlcl9Db250cm9sbGVyIj48cGF0aCBkPSJNODg3LjgsNDE2LjY4NjkgQzg2My4xOSwzNjkuNjk2OSA4MTUuMDEsMjg5LjYzNjkgNzUyLDI0Mi43MDY5IEM2OTMuMDQsMTk4Ljc5NjkgNjYzLjk1LDIxNS43NjY5IDU5NiwxODcuNzA2OSBDNTg3LjMsMTg0LjExNjkgNTgzLjU3NjYsMTgyLjU1NTIgNTc0LjgxNjYsMTc4LjQ2NTIiIGZpbGw9Im5vbmUiIGlkPSJCcm93c2VyLXRvLUNvbnRyb2xsZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU2OS4zOCwxNzUuOTI2OSw1NzUuODQyNywxODMuMzU4OCw1NzMuOTEwNSwxNzguMDQyMiw1NzkuMjI3MiwxNzYuMTEsNTY5LjM4LDE3NS45MjY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAyLjYyOSIgeD0iODUxLjYxIiB5PSIzMTMuNDIzOCI+SFRUUCAmIzEyNTIyOyYjMTI0NjM7JiMxMjQ1NjsmIzEyNDczOyYjMTI0ODg7PC90ZXh0PjwvZz48IS0tbGluayBDb250cm9sbGVyIHRvIFRoeW1lbGVhZiA/Pz8/Pz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQ29udHJvbGxlciIgZGF0YS1lbnRpdHktMj0iVGh5bWVsZWFmIC4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMjgiIGRhdGEtdWlkPSJsbmsxNyIgaWQ9ImxpbmtfQ29udHJvbGxlcl9UaHltZWxlYWYgLi4uLi4uIj48cGF0aCBkPSJNNTM5Ljg1LDE3NS44OTY5IEM1NjAuNTIsMjA1LjE3NjkgNTkzLjAwMDUsMjUxLjE4NDcgNjEzLjY3MDUsMjgwLjQ3NDciIGZpbGw9Im5vbmUiIGlkPSJDb250cm9sbGVyLXRvLVRoeW1lbGVhZiAmIzEyNDg2OyYjMTI1MzE7JiMxMjUwMzsmIzEyNTI0OyYjMTI1NDA7JiMxMjQ4ODsiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjYxNy4xMywyODUuMzc2OSw2MTUuMjA4OSwyNzUuNzE3Miw2MTQuMjQ3MSwyODEuMjkxNyw2MDguNjcyNiwyODAuMzI5OSw2MTcuMTMsMjg1LjM3NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NS4wMDAxIiB4PSI1NzkuNSIgeT0iMjMwLjc3MzgiPiYjMTI1MTQ7JiMxMjQ4NzsmIzEyNTIzOyYjMjgxOTM7JiMxMjM3NTs8L3RleHQ+PC9nPjwhLS1saW5rIFRoeW1lbGVhZiA/Pz8/Pz8gdG8gQnJvd3Nlci0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJUaHltZWxlYWYgLi4uLi4uIiBkYXRhLWVudGl0eS0yPSJCcm93c2VyIiBkYXRhLXNvdXJjZS1saW5lPSIyOSIgZGF0YS11aWQ9ImxuazE4IiBpZD0ibGlua19UaHltZWxlYWYgLi4uLi4uX0Jyb3dzZXIiPjxwYXRoIGQ9Ik02NTYuODgsMzMyLjE5NjkgQzY3NC4wMywzNDcuNDA2OSA2OTguMjMsMzY3LjE4NjkgNzIyLDM4MS4wMDY5IEM3NzMuODcsNDExLjE0NjkgODM0Ljc5MjcsNDMyLjM5ODUgODcxLjk3MjcsNDQ0LjAwODUiIGZpbGw9Im5vbmUiIGlkPSJUaHltZWxlYWYgJiMxMjQ4NjsmIzEyNTMxOyYjMTI1MDM7JiMxMjUyNDsmIzEyNTQwOyYjMTI0ODg7LXRvLUJyb3dzZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijg3Ny43LDQ0NS43OTY5LDg3MC4zMDE0LDQzOS4yOTYxLDg3Mi45MjczLDQ0NC4zMDY1LDg2Ny45MTY4LDQ0Ni45MzI0LDg3Ny43LDQ0NS43OTY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA1LjMwNzciIHg9IjcyMyIgeT0iMzc3LjA3MzgiPkhUTUwgJiMxMjUyNDsmIzEyNDczOyYjMTI1MDk7JiMxMjUzMTsmIzEyNDczOzwvdGV4dD48L2c+PCEtLWxpbmsgQ29udHJvbGxlciB0byBBcHBsaWNhdGlvbiBTZXJ2aWNlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkNvbnRyb2xsZXIiIGRhdGEtZW50aXR5LTI9IkFwcGxpY2F0aW9uIFNlcnZpY2UiIGRhdGEtc291cmNlLWxpbmU9IjMwIiBkYXRhLXVpZD0ibG5rMTkiIGlkPSJsaW5rX0NvbnRyb2xsZXJfQXBwbGljYXRpb24gU2VydmljZSI+PHBhdGggZD0iTTQ2OSwxNjYuNjc2OSBDNDExLjYsMTgxLjQ4NjkgMzE5LjczLDIwOC4wMTY5IDI0NSwyNDIuNzA2OSBDMjE5LjMsMjU0LjYzNjkgMTk3LjE4NjMsMjY4LjM3NTMgMTc3LjEwNjMsMjgyLjA3NTMiIGZpbGw9Im5vbmUiIGlkPSJDb250cm9sbGVyLXRvLUFwcGxpY2F0aW9uIFNlcnZpY2UiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE3Mi4xNSwyODUuNDU2OSwxODEuODM4OCwyODMuNjg4OCwxNzYuMjgwMywyODIuNjM4OSwxNzcuMzMwMSwyNzcuMDgwMywxNzIuMTUsMjg1LjQ1NjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgQXBwbGljYXRpb24gU2VydmljZSB0byBEb21haW4gTW9kZWwtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQXBwbGljYXRpb24gU2VydmljZSIgZGF0YS1lbnRpdHktMj0iRG9tYWluIE1vZGVsIiBkYXRhLXNvdXJjZS1saW5lPSIzMSIgZGF0YS11aWQ9ImxuazIwIiBpZD0ibGlua19BcHBsaWNhdGlvbiBTZXJ2aWNlX0RvbWFpbiBNb2RlbCI+PHBhdGggZD0iTTE0MSwzMzIuNDA2OSBDMTQxLDM1OS41MTY5IDE0MSwzOTguNzI2OSAxNDEsNDI1Ljc2NjkiIGZpbGw9Im5vbmUiIGlkPSJBcHBsaWNhdGlvbiBTZXJ2aWNlLXRvLURvbWFpbiBNb2RlbCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTQxLDQzMS43NjY5LDE0NSw0MjIuNzY2OSwxNDEsNDI2Ljc2NjksMTM3LDQyMi43NjY5LDE0MSw0MzEuNzY2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBBcHBsaWNhdGlvbiBTZXJ2aWNlIHRvIFJlcG9zaXRvcnktLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQXBwbGljYXRpb24gU2VydmljZSIgZGF0YS1lbnRpdHktMj0iUmVwb3NpdG9yeSIgZGF0YS1zb3VyY2UtbGluZT0iMzIiIGRhdGEtdWlkPSJsbmsyMSIgaWQ9ImxpbmtfQXBwbGljYXRpb24gU2VydmljZV9SZXBvc2l0b3J5Ij48cGF0aCBkPSJNMTg1LjY2LDMzMi40OTY5IEMyMDMuNzEsMzQwLjg5NjkgMjI0Ljk4LDM0OS44NjY5IDI0NSwzNTYuMDA2OSBDMzI0LjQzLDM4MC4zNjY5IDM1MS4zMSwzNTkuNTY2OSA0MjksMzg5LjAwNjkgQzQ1Ni42NiwzOTkuNDg2OSA0ODAuMjAyNiw0MTMuNzkzMyA1MDAuODEyNiw0MjguMTEzMyIgZmlsbD0ibm9uZSIgaWQ9IkFwcGxpY2F0aW9uIFNlcnZpY2UtdG8tUmVwb3NpdG9yeSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNTA1Ljc0LDQzMS41MzY5LDUwMC42MzEzLDQyMy4xMTY2LDUwMS42MzM5LDQyOC42ODM5LDQ5Ni4wNjY1LDQyOS42ODY0LDUwNS43NCw0MzEuNTM2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBSZXBvc2l0b3J5IHRvIE15QmF0aXMgTWFwcGVyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IlJlcG9zaXRvcnkiIGRhdGEtZW50aXR5LTI9Ik15QmF0aXMgTWFwcGVyIiBkYXRhLXNvdXJjZS1saW5lPSIzMyIgZGF0YS11aWQ9ImxuazIyIiBpZD0ibGlua19SZXBvc2l0b3J5X015QmF0aXMgTWFwcGVyIj48cGF0aCBkPSJNNTM3LjY5LDQ3OC43NzY5IEM1MzkuMyw1MDAuMjg2OSA1NDEuMjY0MSw1MjYuNDczNSA1NDIuODY0MSw1NDcuOTQzNSIgZmlsbD0ibm9uZSIgaWQ9IlJlcG9zaXRvcnktdG8tTXlCYXRpcyBNYXBwZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjU0My4zMSw1NTMuOTI2OSw1NDYuNjMwMSw1NDQuNjU0NSw1NDIuOTM4NCw1NDguOTQwNyw1MzguNjUyMiw1NDUuMjQ5LDU0My4zMSw1NTMuOTI2OSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjwvZz48IS0tbGluayBNeUJhdGlzIE1hcHBlciB0byBEQi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJNeUJhdGlzIE1hcHBlciIgZGF0YS1lbnRpdHktMj0iREIiIGRhdGEtc291cmNlLWxpbmU9IjM0IiBkYXRhLXVpZD0ibG5rMjMiIGlkPSJsaW5rX015QmF0aXMgTWFwcGVyX0RCIj48cGF0aCBkPSJNNTQ1LDYwMS4wNjY5IEM1NDUsNjI4Ljg5NjkgNTQ1LDY2OS44MjY5IDU0NSw2OTcuMzI2OSIgZmlsbD0ibm9uZSIgaWQ9Ik15QmF0aXMgTWFwcGVyLXRvLURCIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1NDUsNzAzLjMyNjksNTQ5LDY5NC4zMjY5LDU0NSw2OTguMzI2OSw1NDEsNjk0LjMyNjksNTQ1LDcwMy4zMjY5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rID8/Pz8/Pz8/ICg/Pz8/Pz8/Pz8pIHRvIEdNTjI0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9Ii4uLi4uLi4uIC4uLi4uLi4uLi4uIiBkYXRhLWVudGl0eS0yPSJHTU4yNCIgZGF0YS1zb3VyY2UtbGluZT0iMzciIGRhdGEtdWlkPSJsbmsyNiIgaWQ9ImxpbmtfLi4uLi4uLi4gLi4uLi4uLi4uLi5fR01OMjQiPjxwYXRoIGQ9Ik04NTQuMDAzOCwxNTIuNDQ2OSBDODU0LjA0ODgsMTUyLjQ0NjkgODU0LjA5MzgsMTUyLjQ0NjkgODU0LjEzODgsMTUyLjQ0NjkgQzg1NC40OTg3LDE1Mi40NDY5IDg1NC44NTg2LDE1Mi40NDY5IDg1NS4yMTg0LDE1Mi40NDY5IEM4NTguMDk3NSwxNTIuNDQ2OSA4NjAuOTc2MywxNTIuNDQ2OSA4NjMuODU1LDE1Mi40NDY5IEM4NjkuNjEyNSwxNTIuNDQ2OSA4NzUuMzcsMTUyLjQ0NjkgODgxLjEzLDE1Mi40NDY5IiBmaWxsPSJub25lIiBpZD0iJiMxMjUxNDsmIzEyNDk0OyYjMTI1MjI7JiMxMjQ3MzsmIzEyNDY5OyYjMTI1NDA7JiMxMjQ5NjsmIzEyNTQwOyAoJiMyMTMzNjsmIzE5OTY4OyYjMTIzOTg7JiMyMzQ1NTsmIzM0ODkyOyYjMTI1MTg7JiMxMjQ5MTsmIzEyNDgzOyYjMTI0ODg7KS1HTU4yNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tU1JDPVtkTEQxUW5EMTZCdEZoblhvUVd6MWw3ZUdKN2tHcWEwcm1LbGZPS29jd1Q5alBqYlRiMjA1UHFWZ0liODlMNWpKTWNtcWZENlE1WXRMbkFSdU94d2lJS3h6Mnl4Q0RaS1JlZUFOQ0ZGRC16eHhsbFVvaGs2UTU4RHUxLThiWThfV2pTNkp2bXZ1SkgwUnU5czB1MjNVTnRSeV9mVGdLQW5xRXhselhXX1VEdU1LMDc1bXNOYzFhNEtvZ29IN1NJcEFUQVFPSDVkLXVnYld5cXN0ekhKdVNOM3lqYnlqV1FZM0E4OEc4RnBmNjd1SXVUVzF5R2F5c05nZ0RKZkFKbnBBUV8ydmZoMkJDb3Bsc2ltcWdSczQ1akNoWEpMZ0toQUNEVmhxZ2J6OS1fOXZpNV9meEp4SjhycmVoWlFVY2FjYlJpb2JmZlZHVWFIdDJ4bU1ZNHN6TXJFVlhSSFdBN2g3aWFtWkdybzN2TjZBc2UtQzM5TnFpc29ENjdjU1A1YmdfaHZVbHFTNWRraTFWWVlGZlJOVWtMR1Fpai1kNWRDQ2J6YTVvUDhpOUFJRVd2RjRpaklFd3VlZElycG9hM1lJUTg0dlJpd2NnTmxwQ0ttU0Y5ajBZNkhhZ3ZCTzFsNDFsM2Z1Tl9MUm1jUUY3TWVaVDdOMHlWWGpGRWVWbGVObGZqQ0JNMWlhUHNoZXhWczhuczdKTnRzTUQzZnhrVTdIcHJPTC1DdV9XajZTbXc3SzNDYnZoNkVOd2xpQXhCS2RwMzB2V3FkTDQzLU1wZi0xNFZqN0JrN2hVMXhaMU9ySUNVSVBJeDVqdjVQU3A5Ul8tdEQwbTJsMHN5M2htNGl0V1RTYUpmbE4zRnlwbTAtM3VrbGtuSHdBdXcxU2FhSHAzdkFnZ0Jja1lwZ0RpQWlzQWcwMDlua3ppdDlHemU0Vkk4dDFUaDVOLUd4WVZDMkJsTFNETVQ2Vk45Wk80UUJ2QjVRUl9HODBdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<p><strong>モノリスの主な特徴：</strong></p>
<table>
<thead>
<tr>
<th>特徴</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>単一デプロイ</strong></td>
<td>アプリケーション全体が1つのアーティファクト（JAR/WAR）としてデプロイ</td>
</tr>
<tr>
<td><strong>同一プロセス</strong></td>
<td>UI、ビジネスロジック、データアクセスが同じ JVM で動作</td>
</tr>
<tr>
<td><strong>テンプレートエンジン</strong></td>
<td>サーバーサイドで HTML を生成してブラウザに返却</td>
</tr>
<tr>
<td><strong>セッション管理</strong></td>
<td>サーバーサイドでユーザーセッションを管理</td>
</tr>
<tr>
<td><strong>トランザクション境界</strong></td>
<td>単一プロセス内でのローカルトランザクション</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="222-api-vs">22.2 API サーバー vs モノリス<a class="headerlink" href="#222-api-vs" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjY4NXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6OTcwcHg7aGVpZ2h0OjY4NXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDk3MCA2ODUiIHdpZHRoPSI5NzBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIEFQSSA/Pz8/Pz8/Pz8/Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iQVBJIC4uLi4uLi4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImNsdXN0ZXJfQVBJIC4uLi4uLi4uLi4uIj48cGF0aCBkPSJNMjUzLjQ0LDYgTDQzOS42MTgsNiBBMy43NSwzLjc1IDAgMCAxIDQ0Mi4xMTgsOC41IEw0NDkuMTE4LDI4LjI5NjkgTDk2MS4yNSwyOC4yOTY5IEEyLjUsMi41IDAgMCAxIDk2My43NSwzMC43OTY5IEw5NjMuNzUsMzAwLjUgQTIuNSwyLjUgMCAwIDEgOTYxLjI1LDMwMyBMMjUzLjQ0LDMwMyBBMi41LDIuNSAwIDAgMSAyNTAuOTQsMzAwLjUgTDI1MC45NCw4LjUgQTIuNSwyLjUgMCAwIDEgMjUzLjQ0LDYiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjI1MC45NCIgeDI9IjQ0OS4xMTgiIHkxPSIyOC4yOTY5IiB5Mj0iMjguMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODUuMTc4IiB4PSIyNTQuOTQiIHk9IjIwLjk5NTEiPkFQSSAmIzEyNDY5OyYjMTI1NDA7JiMxMjQ5NjsmIzEyNTQwOyYjMjcwODM7JiMyNTEwNDsmIzY1Mjg4OyYjMzAwOTQ7JiMzMjA4MDsmIzIxNTEyOyYjNjUyODk7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBGRS0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iRkUiIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iY2x1c3Rlcl9GRSI+PHBhdGggZD0iTTI4NS40NCw1NyBMMzg0LjQzOTYsNTcgQTMuNzUsMy43NSAwIDAgMSAzODYuOTM5Niw1OS41IEwzOTMuOTM5Niw3OS4yOTY5IEw0OTkuNDgsNzkuMjk2OSBBMi41LDIuNSAwIDAgMSA1MDEuOTgsODEuNzk2OSBMNTAxLjk4LDI2OC41IEEyLjUsMi41IDAgMCAxIDQ5OS40OCwyNzEgTDI4NS40NCwyNzEgQTIuNSwyLjUgMCAwIDEgMjgyLjk0LDI2OC41IEwyODIuOTQsNTkuNSBBMi41LDIuNSAwIDAgMSAyODUuNDQsNTciIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjI4Mi45NCIgeDI9IjM5My45Mzk2IiB5MT0iNzkuMjk2OSIgeTI9Ijc5LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iMjg2Ljk0IiB5PSI3MS45OTUxIj4mIzEyNTAxOyYjMTI1MjU7JiMxMjUzMTsmIzEyNDg4OyYjMTI0NTY7JiMxMjUzMTsmIzEyNDg5OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgQkUtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9IkJFIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0iZW50MDAwNiIgaWQ9ImNsdXN0ZXJfQkUiPjxwYXRoIGQ9Ik02MjMuNDgsNTcgTDcwOC40Nzk2LDU3IEEzLjc1LDMuNzUgMCAwIDEgNzEwLjk3OTYsNTkuNSBMNzE3Ljk3OTYsNzkuMjk2OSBMODE1LjQzLDc5LjI5NjkgQTIuNSwyLjUgMCAwIDEgODE3LjkzLDgxLjc5NjkgTDgxNy45MywyNjguNSBBMi41LDIuNSAwIDAgMSA4MTUuNDMsMjcxIEw2MjMuNDgsMjcxIEEyLjUsMi41IDAgMCAxIDYyMC45OCwyNjguNSBMNjIwLjk4LDU5LjUgQTIuNSwyLjUgMCAwIDEgNjIzLjQ4LDU3IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI2MjAuOTgiIHgyPSI3MTcuOTc5NiIgeTE9Ijc5LjI5NjkiIHkyPSI3OS4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjYyNC45OCIgeT0iNzEuOTk1MSI+JiMxMjQ5NjsmIzEyNDgzOyYjMTI0NjM7JiMxMjQ1NjsmIzEyNTMxOyYjMTI0ODk7PC90ZXh0PjwvZz48IS0tY2x1c3RlciA/Pz8/Pz8/Pz8/Py0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iLi4uLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjIwIiBkYXRhLXVpZD0iZW50MDAxMiIgaWQ9ImNsdXN0ZXJfLi4uLi4uLi4uLi4iPjxwYXRoIGQ9Ik0yNDguOTYsMzI3IEw0MDMuOTU5MywzMjcgQTMuNzUsMy43NSAwIDAgMSA0MDYuNDU5MywzMjkuNSBMNDEzLjQ1OTMsMzQ5LjI5NjkgTDg0OC45NSwzNDkuMjk2OSBBMi41LDIuNSAwIDAgMSA4NTEuNDUsMzUxLjc5NjkgTDg1MS40NSw2NzUuNSBBMi41LDIuNSAwIDAgMSA4NDguOTUsNjc4IEwyNDguOTYsNjc4IEEyLjUsMi41IDAgMCAxIDI0Ni40Niw2NzUuNSBMMjQ2LjQ2LDMyOS41IEEyLjUsMi41IDAgMCAxIDI0OC45NiwzMjciIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjI0Ni40NiIgeDI9IjQxMy40NTkzIiB5MT0iMzQ5LjI5NjkiIHkyPSIzNDkuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuOTk5MyIgeD0iMjUwLjQ2IiB5PSIzNDEuOTk1MSI+JiMxMjUxNDsmIzEyNDk0OyYjMTI1MjI7JiMxMjQ3MzsmIzI3MDgzOyYjMjUxMDQ7JiM2NTI4ODsmIzIzNDk0OyYjMzIwODA7JiMyMTUxMjsmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgTW9uby0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iTW9ubyIgZGF0YS1zb3VyY2UtbGluZT0iMjEiIGRhdGEtdWlkPSJlbnQwMDEzIiBpZD0iY2x1c3Rlcl9Nb25vIj48cGF0aCBkPSJNMjgwLjk2LDQzMiBMMzkzLjk1OTUsNDMyIEEzLjc1LDMuNzUgMCAwIDEgMzk2LjQ1OTUsNDM0LjUgTDQwMy40NTk1LDQ1NC4yOTY5IEw4MTYuOTUsNDU0LjI5NjkgQTIuNSwyLjUgMCAwIDEgODE5LjQ1LDQ1Ni43OTY5IEw4MTkuNDUsNjQzLjUgQTIuNSwyLjUgMCAwIDEgODE2Ljk1LDY0NiBMMjgwLjk2LDY0NiBBMi41LDIuNSAwIDAgMSAyNzguNDYsNjQzLjUgTDI3OC40Niw0MzQuNSBBMi41LDIuNSAwIDAgMSAyODAuOTYsNDMyIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIyNzguNDYiIHgyPSI0MDMuNDU5NSIgeTE9IjQ1NC4yOTY5IiB5Mj0iNDU0LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTExLjk5OTUiIHg9IjI4Mi40NiIgeT0iNDQ2Ljk5NTEiPiYjMTI1MTQ7JiMxMjQ5NDsmIzEyNTIyOyYjMTI0NzM7JiMxMjQ2OTsmIzEyNTQwOyYjMTI0OTY7JiMxMjU0MDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgREJfQVBJLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkRCX0FQSSIgZGF0YS1zb3VyY2UtbGluZT0iMTQiIGRhdGEtdWlkPSJlbnQwMDA5IiBpZD0iZW50aXR5X0RCX0FQSSI+PHBhdGggZD0iTTg5OC40NSw3MS4zNSBDODk4LjQ1LDYxLjM1IDkyMy4wOTYsNjEuMzUgOTIzLjA5Niw2MS4zNSBDOTIzLjA5Niw2MS4zNSA5NDcuNzQyLDYxLjM1IDk0Ny43NDIsNzEuMzUgTDk0Ny43NDIsOTYuNjQ2OSBDOTQ3Ljc0MiwxMDYuNjQ2OSA5MjMuMDk2LDEwNi42NDY5IDkyMy4wOTYsMTA2LjY0NjkgQzkyMy4wOTYsMTA2LjY0NjkgODk4LjQ1LDEwNi42NDY5IDg5OC40NSw5Ni42NDY5IEw4OTguNDUsNzEuMzUiIGZpbGw9IiNGMUYxRjEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik04OTguNDUsNzEuMzUgQzg5OC40NSw4MS4zNSA5MjMuMDk2LDgxLjM1IDkyMy4wOTYsODEuMzUgQzkyMy4wOTYsODEuMzUgOTQ3Ljc0Miw4MS4zNSA5NDcuNzQyLDcxLjM1IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyOS4yOTIiIHg9IjkwOC40NSIgeT0iOTguMzQ1MSI+REIxPC90ZXh0PjwvZz48IS0tZW50aXR5IFJlYWN0L1Z1ZS9Bbmd1bGFyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IlJlYWN0LlZ1ZS5Bbmd1bGFyIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9SZWFjdC5WdWUuQW5ndWxhciI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNzEuMDM4MSIgeD0iMzA2Ljk0IiB5PSIyMDAuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNDU3Ljk3ODEiIHk9IjIwNS44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNDU1Ljk3ODEiIHk9IjIwNy44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNDU1Ljk3ODEiIHk9IjIxMS44NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMS4wMzgxIiB4PSIzMjEuOTQiIHk9IjIzMy44NDUxIj5SZWFjdC9WdWUvQW5ndWxhcjwvdGV4dD48L2c+PCEtLWVudGl0eSBTUEEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iU1BBIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImVudGl0eV9TUEEiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjYuOTA2MyIgeD0iMzU5IiB5PSIxMTkuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNDA1LjkwNjMiIHk9IjEyNC44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNDAzLjkwNjMiIHk9IjEyNi44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNDAzLjkwNjMiIHk9IjEzMC44NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2LjkwNjMiIHg9IjM3NCIgeT0iMTUyLjg0NTEiPlNQQTwvdGV4dD48L2c+PCEtLWVudGl0eSBSRVNUIEFQSS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJSRVNUIEFQSSIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iZW50aXR5X1JFU1QgQVBJIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjQ2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEwMi42MTA0IiB4PSI2NjguMTUiIHk9IjIwMC44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1IiB4PSI3NTAuNzYwNCIgeT0iMjA1Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSI3NDguNzYwNCIgeT0iMjA3Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSI3NDguNzYwNCIgeT0iMjExLjg1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjIuNjEwNCIgeD0iNjgzLjE1IiB5PSIyMzMuODQ1MSI+UkVTVCBBUEk8L3RleHQ+PC9nPjwhLS1lbnRpdHkgSlNPTiA/Pz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJKU09OIC4uLi4uIiBkYXRhLXNvdXJjZS1saW5lPSIxMSIgZGF0YS11aWQ9ImVudDAwMDgiIGlkPSJlbnRpdHlfSlNPTiAuLi4uLiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNDguOTU3NyIgeD0iNjQ0Ljk4IiB5PSIxMTkuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNzczLjkzNzciIHk9IjEyNC44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNzcxLjkzNzciIHk9IjEyNi44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNzcxLjkzNzciIHk9IjEzMC44NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwOC45NTc3IiB4PSI2NTkuOTgiIHk9IjE1Mi44NDUxIj5KU09OICYjMTI1MjQ7JiMxMjQ3MzsmIzEyNTA5OyYjMTI1MzE7JiMxMjQ3Mzs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgREJfTW9uby0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJEQl9Nb25vIiBkYXRhLXNvdXJjZS1saW5lPSIyOCIgZGF0YS11aWQ9ImVudDAwMTgiIGlkPSJlbnRpdHlfREJfTW9ubyI+PHBhdGggZD0iTTY5NC44MSwzNzIuMzUgQzY5NC44MSwzNjIuMzUgNzE5LjQ1NiwzNjIuMzUgNzE5LjQ1NiwzNjIuMzUgQzcxOS40NTYsMzYyLjM1IDc0NC4xMDIsMzYyLjM1IDc0NC4xMDIsMzcyLjM1IEw3NDQuMTAyLDM5Ny42NDY5IEM3NDQuMTAyLDQwNy42NDY5IDcxOS40NTYsNDA3LjY0NjkgNzE5LjQ1Niw0MDcuNjQ2OSBDNzE5LjQ1Niw0MDcuNjQ2OSA2OTQuODEsNDA3LjY0NjkgNjk0LjgxLDM5Ny42NDY5IEw2OTQuODEsMzcyLjM1IiBmaWxsPSIjRjFGMUYxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNjk0LjgxLDM3Mi4zNSBDNjk0LjgxLDM4Mi4zNSA3MTkuNDU2LDM4Mi4zNSA3MTkuNDU2LDM4Mi4zNSBDNzE5LjQ1NiwzODIuMzUgNzQ0LjEwMiwzODIuMzUgNzQ0LjEwMiwzNzIuMzUiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI5LjI5MiIgeD0iNzA0LjgxIiB5PSIzOTkuMzQ1MSI+REIyPC90ZXh0PjwvZz48IS0tZW50aXR5IENvbnRyb2xsZXIgKyBWaWV3LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkNvbnRyb2xsZXIgLiBWaWV3IiBkYXRhLXNvdXJjZS1saW5lPSIyMiIgZGF0YS11aWQ9ImVudDAwMTQiIGlkPSJlbnRpdHlfQ29udHJvbGxlciAuIFZpZXciPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTYzLjMzNCIgeD0iMzEwLjc5IiB5PSI1NzUuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNDU0LjEyNCIgeT0iNTgwLjg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI0IiB4PSI0NTIuMTI0IiB5PSI1ODIuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjQ1Mi4xMjQiIHk9IjU4Ni44NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyMy4zMzQiIHg9IjMyNS43OSIgeT0iNjA4Ljg0NTEiPkNvbnRyb2xsZXIgKyBWaWV3PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iLi4uLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMjMiIGRhdGEtdWlkPSJlbnQwMDE1IiBpZD0iZW50aXR5Xy4uLi4uLi4uLi4iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTc5Ljk5OTQiIHg9IjMwMi40NiIgeT0iNDk0Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTUiIHg9IjQ2Mi40NTk0IiB5PSI0OTkuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjQ2MC40NTk0IiB5PSI1MDEuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9IjQ2MC40NTk0IiB5PSI1MDUuODUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzkuOTk5NCIgeD0iMzE3LjQ2IiB5PSI1MjcuODQ1MSI+JiMxMjQ4NjsmIzEyNTMxOyYjMTI1MDM7JiMxMjUyNDsmIzEyNTQwOyYjMTI0ODg7JiMxMjQ1NjsmIzEyNTMxOyYjMTI0NzI7JiMxMjUzMTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgPz8/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjI0IiBkYXRhLXVpZD0iZW50MDAxNiIgaWQ9ImVudGl0eV8uLi4uLi4uLiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI0Ni4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNTEuOTk5NSIgeD0iNjQzLjQ1IiB5PSI1NzUuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNSIgeD0iNzc1LjQ0OTUiIHk9IjU4MC44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNzczLjQ0OTUiIHk9IjU4Mi44NSIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNCIgeD0iNzczLjQ0OTUiIHk9IjU4Ni44NSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS45OTk1IiB4PSI2NTguNDUiIHk9IjYwOC44NDUxIj4mIzEyNDk5OyYjMTI0NzI7JiMxMjQ5MzsmIzEyNDczOyYjMTI1MjU7JiMxMjQ3MjsmIzEyNDgzOyYjMTI0NjM7PC90ZXh0PjwvZz48IS0tZW50aXR5ID8/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iMjUiIGRhdGEtdWlkPSJlbnQwMDE3IiBpZD0iZW50aXR5Xy4uLi4uLi4iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTM3Ljk5OTYiIHg9IjY1MC40NSIgeT0iNDk0Ljg1Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTUiIHg9Ijc2OC40NDk2IiB5PSI0OTkuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9Ijc2Ni40NDk2IiB5PSI1MDEuODUiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjQiIHg9Ijc2Ni40NDk2IiB5PSI1MDUuODUiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSI2NjUuNDUiIHk9IjUyNy44NDUxIj4mIzEyNDg3OyYjMTI1NDA7JiMxMjQ3OTsmIzEyNDUwOyYjMTI0NjM7JiMxMjQ3NTsmIzEyNDczOzwvdGV4dD48L2c+PCEtLWVudGl0eSBCcm93c2VyMS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJCcm93c2VyMSIgZGF0YS1zb3VyY2UtbGluZT0iMzMiIGRhdGEtdWlkPSJlbnQwMDIwIiBpZD0iZW50aXR5X0Jyb3dzZXIxIj48ZWxsaXBzZSBjeD0iNjAuNzMxMSIgY3k9IjU0LjM1IiBmaWxsPSIjRjFGMUYxIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik02MC43MzExLDYyLjM1IEw2MC43MzExLDg5LjM1IE00Ny43MzExLDcwLjM1IEw3My43MzExLDcwLjM1IE02MC43MzExLDg5LjM1IEw0Ny43MzExLDEwNC4zNSBNNjAuNzMxMSw4OS4zNSBMNzMuNzMxMSwxMDQuMzUiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkzLjUyMjIiIHg9IjEzLjk3IiB5PSIxMTguODQ1MSI+JiMxMjUwMjsmIzEyNTIxOyYjMTI0NTQ7JiMxMjQ3MDsgKEFQSSk8L3RleHQ+PC9nPjwhLS1lbnRpdHkgQnJvd3NlcjItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQnJvd3NlcjIiIGRhdGEtc291cmNlLWxpbmU9IjM0IiBkYXRhLXVpZD0iZW50MDAyMSIgaWQ9ImVudGl0eV9Ccm93c2VyMiI+PGVsbGlwc2UgY3g9IjYwLjcyODQiIGN5PSI0MjkuMzUiIGZpbGw9IiNGMUYxRjEiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTYwLjcyODQsNDM3LjM1IEw2MC43Mjg0LDQ2NC4zNSBNNDcuNzI4NCw0NDUuMzUgTDczLjcyODQsNDQ1LjM1IE02MC43Mjg0LDQ2NC4zNSBMNDcuNzI4NCw0NzkuMzUgTTYwLjcyODQsNDY0LjM1IEw3My43Mjg0LDQ3OS4zNSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA5LjQ1NjgiIHg9IjYiIHk9IjQ5My44NDUxIj4mIzEyNTAyOyYjMTI1MjE7JiMxMjQ1NDsmIzEyNDcwOyAoTW9ubyk8L3RleHQ+PC9nPjwhLS1saW5rIEZFIHRvIEJFLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkZFIiBkYXRhLWVudGl0eS0yPSJCRSIgZGF0YS1zb3VyY2UtbGluZT0iMTYiIGRhdGEtdWlkPSJsbmsxMCIgaWQ9ImxpbmtfRkVfQkUiPjxwYXRoIGQ9Ik01MDIuNTA4MSw4NCBDNTAzLjEwMTksODQgNTAzLjY5NjgsODQgNTA0LjI5MjcsODQgQzUwNi42NzY0LDg0IDUwOS4wNzY2LDg0IDUxMS40OTA5LDg0IEM1MTYuMzE5Nyw4NCA1MjEuMjA1Miw4NCA1MjYuMTI4Niw4NCBDNTM1Ljk3NTMsODQgNTQ1Ljk3MzMsODQgNTU1Ljk3MTIsODQgQzU3NS45NjcyLDg0IDU5NS45NjI5LDg0IDYxNC43NDcyLDg0IEM2MTUuOTIxMyw4NCA2MTcuMDkwNiw4NCA2MTguMjU0OCw4NCBDNjE4LjgzNyw4NCA2MTkuNDE3OCw4NCA2MTkuOTk3NCw4NCBDNjIwLjI4NzIsODQgNjE0LjU3NjcsODQgNjE0Ljg2NTgsODQiIGZpbGw9Im5vbmUiIGlkPSJGRS10by1CRSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNjIwLjg2NTgsODQsNjExLjg2NTgsODAsNjE1Ljg2NTgsODQsNjExLjg2NTgsODgsNjIwLjg2NTgsODQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45MTk0IiB4PSI1MjYuOTgiIHk9IjgwLjA2NjkiPkhUVFAvSlNPTjwvdGV4dD48L2c+PCEtLWxpbmsgQkUgdG8gREJfQVBJLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkJFIiBkYXRhLWVudGl0eS0yPSJEQl9BUEkiIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0ibG5rMTEiIGlkPSJsaW5rX0JFX0RCX0FQSSI+PHBhdGggZD0iTTgxOC4zMzMyLDg0IEM4MTguOTM4OCw4NCA4MTkuNTQ0NSw4NCA4MjAuMTUwMiw4NCBDODI5Ljg0Miw4NCA4MzkuNTQ3Nyw4NCA4NDguOTA5MSw4NCBDODY3LjYzMTksODQgODc4Ljk3NzUsODQgODkyLjA4LDg0IiBmaWxsPSJub25lIiBpZD0iQkUtdG8tREJfQVBJIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI4OTguMDgsODQsODg5LjA4LDgwLDg5My4wOCw4NCw4ODkuMDgsODgsODk4LjA4LDg0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIE1vbm8gdG8gREJfTW9uby0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJNb25vIiBkYXRhLWVudGl0eS0yPSJEQl9Nb25vIiBkYXRhLXNvdXJjZS1saW5lPSIzMCIgZGF0YS11aWQ9ImxuazE5IiBpZD0ibGlua19Nb25vX0RCX01vbm8iPjxwYXRoIGQ9Ik01MTIuOTgzMSw0NTQuMDgyNyBDNTE0LjAwMDEsNDUzLjg1MTEgNTE2LjU0MzQsNDMwLjk3NTEgNTE3LjU2NSw0MzAuNzQyNSBDNTgyLjk0NSw0MTUuODU1IDY1MS4yNjk4LDQwMC4yOTcyIDY4OC41Mjk4LDM5MS44MTIyIiBmaWxsPSJub25lIiBpZD0iTW9uby10by1EQl9Nb25vIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2OTQuMzgsMzkwLjQ4LDY4NC43MTY1LDM4OC41NzgyLDY4OS41MDQ4LDM5MS41OTAyLDY4Ni40OTI4LDM5Ni4zNzg1LDY5NC4zOCwzOTAuNDgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48L2c+PCEtLWxpbmsgQnJvd3NlcjEgdG8gRkUtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQnJvd3NlcjEiIGRhdGEtZW50aXR5LTI9IkZFIiBkYXRhLXNvdXJjZS1saW5lPSIzNiIgZGF0YS11aWQ9ImxuazIyIiBpZD0ibGlua19Ccm93c2VyMV9GRSI+PHBhdGggZD0iTTEwNy45Miw4NCBDMTUyLjU4NSw4NCAyMjEuOTcsODQgMjgwLjkyMTMsODQgQzI4MS4zODE4LDg0IDI3NS44NDE3LDg0IDI3Ni4zMDEsODQiIGZpbGw9Im5vbmUiIGlkPSJCcm93c2VyMS10by1GRSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjgyLjMwMSw4NCwyNzMuMzAxLDgwLDI3Ny4zMDEsODQsMjczLjMwMSw4OCwyODIuMzAxLDg0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjwhLS1saW5rIEJyb3dzZXIyIHRvIE1vbm8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQnJvd3NlcjIiIGRhdGEtZW50aXR5LTI9Ik1vbm8iIGRhdGEtc291cmNlLWxpbmU9IjM3IiBkYXRhLXVpZD0ibG5rMjMiIGlkPSJsaW5rX0Jyb3dzZXIyX01vbm8iPjxwYXRoIGQ9Ik0xMTUuODEsNDU5IEMxMzguODMsNDU5IDE2Ny4yMTM4LDQ1OSAxOTYuOTI3LDQ1OSBDMjExLjc4MzcsNDU5IDIyNi45NzI3LDQ1OSAyNDEuOTg5OCw0NTkgQzI0OS40OTg0LDQ1OSAyNTYuOTY0LDQ1OSAyNjQuMzIzNiw0NTkgQzI2OC4wMDM0LDQ1OSAyNzEuNjU2Niw0NTkgMjc1LjI3NTYsNDU5IEMyNzYuMTgwMyw0NTkgMjcxLjA4MjksNDU5IDI3MS45ODMyLDQ1OSIgZmlsbD0ibm9uZSIgaWQ9IkJyb3dzZXIyLXRvLU1vbm8iIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjI3Ny45ODMyLDQ1OSwyNjguOTgzMiw0NTUsMjcyLjk4MzIsNDU5LDI2OC45ODMyLDQ2MywyNzcuOTgzMiw0NTkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45NDc4IiB4PSIxNDYuNDYiIHk9IjQ1NS4wNjY5Ij5IVFRQIChIVE1MKTwvdGV4dD48L2c+PCEtLVNSQz1bVEw1RkltOTE3QnRGZm5XeUFJNllubXcxY3VmNWJrSllISUdzdE1uZnNPYnJuS0RxY0c3Ulk2R1hpYkNOM19xWnlIMTZhajI3LVE0VV9HaERwQmdmTzlWWERwRmxsTmRsWlFjVkVEV1hzM1BnZm13azZoUFVTR25ZOE5Ja0xTd3FjZXYzb1ZtRTFaZTBEV0JjeU5Ob1YzRG5sVGQ4ZE5SUXF1NHR6anBQdzNnNEJuT0NPRlYwVWkwLVdCYjBOLUowNExlVFB6OFNMcGhLak9lSkFwUnFNREFnREtwREJnREk4UHlpZXFrcUJDOFZPcTN4Z21nQWh2MGtnOVdSdXlKVG1pNC0xbE9FVDBaaUtJM2ZLMmZMREtTeHJrZlNBZ040OUpVYjc3NEVHam41REJlYmYzUG5MYk5wQ1E2MTVGenEzYmdycVdOTTFsUjZmVl9JWl9ral96OGxxQ2t6SUdpdk9YNEhPOWpPWmFyQ0t4Vm4xWXVRVWZDZDBUUUlHSHo0Nmk0QW9nRFZWOU0wRXBkVm9nbXpFT2s2dkRNTGVEMFZlNXRQc1ZVdzZYOTEzUzg2R2pCQ0ZCQ3l1TjMtQ3lHTThKaDBOZTQtMFZ0NE9MdjhuNl9WOWlzd1JpVk5tdUo2Mll3MUtDMkd4c0pJbUp1WHp6QTBfbVN1ZDVMcFV2NVZdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<table>
<thead>
<tr>
<th>観点</th>
<th>API サーバー構成</th>
<th>モノリス構成</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>結合度</strong></td>
<td>疎結合（フロントエンドとバックエンドが分離）</td>
<td>密結合（すべてが同一サーバー）</td>
</tr>
<tr>
<td><strong>フロントエンド</strong></td>
<td>SPA（React/Vue/Angular）</td>
<td>テンプレートエンジン（Thymeleaf）</td>
</tr>
<tr>
<td><strong>通信方式</strong></td>
<td>REST API（JSON）</td>
<td>サーバーサイドレンダリング（HTML）</td>
</tr>
<tr>
<td><strong>開発チーム</strong></td>
<td>フロント/バックエンドで分業可能</td>
<td>フルスタックで開発</td>
</tr>
<tr>
<td><strong>デプロイ</strong></td>
<td>別々にデプロイ可能</td>
<td>単一アーティファクトをデプロイ</td>
</tr>
<tr>
<td><strong>スケーリング</strong></td>
<td>個別にスケール可能</td>
<td>全体をスケール</td>
</tr>
<tr>
<td><strong>複雑さ</strong></td>
<td>API 設計・認証・CORS などが必要</td>
<td>シンプル、設定が少ない</td>
</tr>
<tr>
<td><strong>初期開発速度</strong></td>
<td>環境構築に時間がかかる</td>
<td>素早く開発開始できる</td>
</tr>
<tr>
<td><strong>SEO</strong></td>
<td>SSR/SSG が必要な場合あり</td>
<td>サーバーサイドレンダリングで SEO フレンドリー</td>
</tr>
</tbody>
</table>
<h3 id="223">22.3 モノリスを選択すべき場面<a class="headerlink" href="#223" title="Permanent link">&para;</a></h3>
<p><strong>モノリスが適している状況：</strong></p>
<ol>
<li><strong>小〜中規模のチーム</strong>：専門のフロントエンドチームがいない場合</li>
<li><strong>社内システム</strong>：SEO 不要、限られたユーザー数</li>
<li><strong>業務アプリケーション</strong>：複雑な業務フローをサーバーサイドで処理</li>
<li><strong>迅速な開発</strong>：MVP やプロトタイプの素早い構築</li>
<li><strong>運用コスト重視</strong>：インフラ構成をシンプルに保ちたい場合</li>
</ol>
<p><strong>財務会計システムにおけるモノリスのメリット：</strong></p>
<div class="highlight"><pre><span></span><code>財務会計システムの特性
├── 社内利用が中心 → SEO 不要、SPA 不要
├── 複雑な業務フロー → サーバーサイドで制御が容易
├── 帳票出力 → サーバーサイドで PDF/Excel 生成
├── 月次締め・決算処理 → バッチ処理との親和性
├── 監査証跡 → サーバーサイドでのログ管理
└── 運用担当者のスキル → シンプルな構成が望ましい
</code></pre></div>
<hr />
<h3 id="224">22.4 モノリスにおけるヘキサゴナルアーキテクチャ<a class="headerlink" href="#224" title="Permanent link">&para;</a></h3>
<p>モノリスであっても、ヘキサゴナルアーキテクチャ（Ports and Adapters）を採用することで、保守性の高い設計を実現できます。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjQ1N3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTA3NHB4O2hlaWdodDo0NTdweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMDc0IDQ1NyIgd2lkdGg9IjEwNzRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIEhleGFnb25hbCBBcmNoaXRlY3R1cmUgKD8/Pz8/Pz8/PyktLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9IkhleGFnb25hbCBBcmNoaXRlY3R1cmUgLi4uLi4uLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl9IZXhhZ29uYWwgQXJjaGl0ZWN0dXJlIC4uLi4uLi4uLi4uIj48cGF0aCBkPSJNOC41LDc3LjcgTDMzOS45MzUsNzcuNyBBMy43NSwzLjc1IDAgMCAxIDM0Mi40MzUsODAuMiBMMzQ5LjQzNSw5OS45OTY5IEwxMDY1LjAyLDk5Ljk5NjkgQTIuNSwyLjUgMCAwIDEgMTA2Ny41MiwxMDIuNDk2OSBMMTA2Ny41MiwzNzYuMiBBMi41LDIuNSAwIDAgMSAxMDY1LjAyLDM3OC43IEw4LjUsMzc4LjcgQTIuNSwyLjUgMCAwIDEgNiwzNzYuMiBMNiw4MC4yIEEyLjUsMi41IDAgMCAxIDguNSw3Ny43IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI2IiB4Mj0iMzQ5LjQzNSIgeTE9Ijk5Ljk5NjkiIHkyPSI5OS45OTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMzMC40MzUiIHg9IjEwIiB5PSI5Mi42OTUxIj5IZXhhZ29uYWwgQXJjaGl0ZWN0dXJlICgmIzM2MDAxOyYjMjEyMDk7JiMyMDI1MDsmIzM1MzM2OyYjMTI1MTQ7JiMxMjQ5NDsmIzEyNTIyOyYjMTI0NzM7JiMyOTI1NjspPC90ZXh0PjwvZz48IS0tY2x1c3RlciBjb3JlLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJjb3JlIiBkYXRhLXNvdXJjZS1saW5lPSI2IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImNsdXN0ZXJfY29yZSI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMTgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyMjEuNSIgeD0iMzkzLjcxIiB5PSIxMjguNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzAuNDYzOSIgeD0iNDM5LjIyODEiIHk9IjE0My42OTUxIj5BcHBsaWNhdGlvbiBDb3JlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNzQuMjY4NiIgeD0iNDE3LjMyNTciIHk9IjE1OS45OTIiPihEb21haW4gKyBVc2UgQ2FzZXMpPC90ZXh0PjwvZz48IS0tY2x1c3RlciBpbnB1dC0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iaW5wdXQiIGRhdGEtc291cmNlLWxpbmU9IjE4IiBkYXRhLXVpZD0iZW50MDAwNSIgaWQ9ImNsdXN0ZXJfaW5wdXQiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMTczIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjE0Ljg4IiB4PSIzOCIgeT0iMTI4LjciLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE4LjQ4MDUiIHg9Ijg2LjE5OTgiIHk9IjE0My42OTUxIj5JbnB1dCBBZGFwdGVyczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA5LjMwNjYiIHg9IjkwLjc4NjciIHk9IjE1OS45OTIiPihEcml2aW5nIFNpZGUpPC90ZXh0PjwvZz48IS0tY2x1c3RlciBvdXRwdXQtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9Im91dHB1dCIgZGF0YS1zb3VyY2UtbGluZT0iMjciIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iY2x1c3Rlcl9vdXRwdXQiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMTczIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjA4LjQ3IiB4PSI4MjcuMDUiIHk9IjEyOC43Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMS44NjUyIiB4PSI4NjUuMzUyNCIgeT0iMTQzLjY5NTEiPk91dHB1dCBBZGFwdGVyczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAzLjk4MTQiIHg9Ijg3OS4yOTQzIiB5PSIxNTkuOTkyIj4oRHJpdmVuIFNpZGUpPC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iY29yZV9saXN0IiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9jb3JlX2xpc3QiPjxwYXRoIGQ9Ik00MTcuNzEsMjA2Ljc0IEw0MTcuNzEsMzIyLjY2OTcgTDU5MS4yMTI0LDMyMi42Njk3IEw1OTEuMjEyNCwyMTYuNzQgTDU4MS4yMTI0LDIwNi43NCBMNDE3LjcxLDIwNi43NCIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTU4MS4yMTI0LDIwNi43NCBMNTgxLjIxMjQsMjE2Ljc0IEw1OTEuMjEyNCwyMTYuNzQgTDU4MS4yMTI0LDIwNi43NCIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNy44MTY1IiB4PSI0MjMuNzEiIHk9IjIyMy44MDY5Ij4tIEFjY291bnQgKCYjMjEyMDg7JiMyMzQ1MDsmIzMxMTg1OyYjMzA0NDY7KTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5NC4yODgxIiB4PSI0MjMuNzEiIHk9IjIzOC45Mzk3Ij4tIEpvdXJuYWwgKCYjMjAxODE7JiMzNTM3OTspPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMC45NDY4IiB4PSI0MjMuNzEiIHk9IjI1NC4wNzI1Ij4tIEJhbGFuY2UgKCYjMjc1MzE7JiMzOTY0MDspPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1Mi41MDI0IiB4PSI0MjMuNzEiIHk9IjI2OS4yMDUzIj4tIEpvdXJuYWxEb21haW5TZXJ2aWNlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy42NDExIiB4PSI0MjMuNzEiIHk9IjI4NC4zMzgxIj4tIEFjY291bnRVc2VDYXNlPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMC4xMTI4IiB4PSI0MjMuNzEiIHk9IjI5OS40NzEiPi0gSm91cm5hbFVzZUNhc2U8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE2Ljc3MTUiIHg9IjQyMy43MSIgeT0iMzE0LjYwMzgiPi0gQmFsYW5jZVVzZUNhc2U8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJpbnB1dF9saXN0IiBkYXRhLXNvdXJjZS1saW5lPSIyMCIgZGF0YS11aWQ9ImVudDAwMDYiIGlkPSJlbnRpdHlfaW5wdXRfbGlzdCI+PHBhdGggZD0iTTYyLDIwNy40NCBMNjIsMjc3Ljk3MTIgTDIyOC44NzU1LDI3Ny45NzEyIEwyMjguODc1NSwyMTcuNDQgTDIxOC44NzU1LDIwNy40NCBMNjIsMjA3LjQ0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMjE4Ljg3NTUsMjA3LjQ0IEwyMTguODc1NSwyMTcuNDQgTDIyOC44NzU1LDIxNy40NCBMMjE4Ljg3NTUsMjA3LjQ0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ1Ljg3NTUiIHg9IjY4IiB5PSIyMjQuNTA2OSI+LSBUaHltZWxlYWYgQ29udHJvbGxlcjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4Ni44MjMzIiB4PSI2OCIgeT0iMjM5LjYzOTciPi0gJiMxMjUwMTsmIzEyNDU3OyYjMTI1NDA7JiMxMjUxMjsmIzIwOTY2OyYjMjk3MDI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk5LjgyMzMiIHg9IjY4IiB5PSIyNTQuNzcyNSI+LSAmIzEyNDc1OyYjMTI0ODM7JiMxMjQ3MTsmIzEyNTE5OyYjMTI1MzE7JiMzMTY0OTsmIzI5NzAyOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5OS44MjMzIiB4PSI2OCIgeT0iMjY5LjkwNTMiPi0gJiMxMjUyMjsmIzEyNDYzOyYjMTI0NTY7JiMxMjQ3MzsmIzEyNDg4OyYjMjY5MDg7JiMzNTM4ODs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJvdXRwdXRfbGlzdCIgZGF0YS1zb3VyY2UtbGluZT0iMjkiIGRhdGEtdWlkPSJlbnQwMDA4IiBpZD0iZW50aXR5X291dHB1dF9saXN0Ij48cGF0aCBkPSJNODUxLjA1LDIwNy40NCBMODUxLjA1LDI3Ny45NzEyIEwxMDExLjUyMDgsMjc3Ljk3MTIgTDEwMTEuNTIwOCwyMTcuNDQgTDEwMDEuNTIwOCwyMDcuNDQgTDg1MS4wNSwyMDcuNDQiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0xMDAxLjUyMDgsMjA3LjQ0IEwxMDAxLjUyMDgsMjE3LjQ0IEwxMDExLjUyMDgsMjE3LjQ0IEwxMDAxLjUyMDgsMjA3LjQ0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMzLjk0MTkiIHg9Ijg1Ny4wNSIgeT0iMjI0LjUwNjkiPi0gTXlCYXRpcyBSZXBvc2l0b3J5PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExOS43MTY4IiB4PSI4NTcuMDUiIHk9IjIzOS42Mzk3Ij4tIERhdGFiYXNlIEFjY2VzczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuNjk3OCIgeD0iODU3LjA1IiB5PSIyNTQuNzcyNSI+LSBFbnRpdHkgTWFwcGluZzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzkuNDcwOCIgeD0iODU3LjA1IiB5PSIyNjkuOTA1MyI+LSAmIzI0MTE1OyYjMzEwODA7JiMyMDk4NjsmIzIxMTQ3OyAoUERGL0V4Y2VsKTwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkdNTjExIiBkYXRhLXNvdXJjZS1saW5lPSI0MyIgZGF0YS11aWQ9ImVudDAwMTIiIGlkPSJlbnRpdHlfR01OMTEiPjxwYXRoIGQ9Ik0zODUuODgsMzk1IEwzODUuODgsNDUwLjM5ODQgTDYyMy4wNDk2LDQ1MC4zOTg0IEw2MjMuMDQ5Niw0MDUgTDYxMy4wNDk2LDM5NSBMMzg1Ljg4LDM5NSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTYxMy4wNDk2LDM5NSBMNjEzLjA0OTYsNDA1IEw2MjMuMDQ5Niw0MDUgTDYxMy4wNDk2LDM5NSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0My4wMDAyIiB4PSIzOTEuODgiIHk9IjQxMi4wNjY5Ij4mIzMyMDIwOyYjMzE4ODM7JiMxMjM5NDsmIzEyNDk5OyYjMTI0NzI7JiMxMjQ5MzsmIzEyNDczOyYjMTI1MjU7JiMxMjQ3MjsmIzEyNDgzOyYjMTI0NjM7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxNi4xNjk2IiB4PSIzOTEuODgiIHk9IjQyNy4xOTk3Ij5VSSAmIzI1MjE2OyYjMzQ4OTk7JiM2NTI4ODtUaHltZWxlYWYmIzY1Mjg5OyYjMTIzOTU7JiMyMDM4MTsmIzIzMzg0OyYjMTIzNzU7JiMxMjM5NDsmIzEyMzU2OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDMuMDAwMiIgeD0iMzkxLjg4IiB5PSI0NDIuMzMyNSI+JiMxMjQ4NjsmIzEyNDczOyYjMTI0ODg7JiMyMTQ4NzsmIzMzMDIxOyYjMTIzOTQ7JiMyOTM2NjsmIzI0OTA3OyYjMTI0MzQ7JiMzMjE3MzsmIzI1MzQ1OzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkdNTjE0IiBkYXRhLXNvdXJjZS1saW5lPSI0OSIgZGF0YS11aWQ9ImVudDAwMTUiIGlkPSJlbnRpdHlfR01OMTQiPjxwYXRoIGQ9Ik01MC40NCw2IEw1MC40NCw2MS4zOTg0IEwyNDAuNDQwMiw2MS4zOTg0IEwyNDAuNDQwMiwxNiBMMjMwLjQ0MDIsNiBMNTAuNDQsNiIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTIzMC40NDAyLDYgTDIzMC40NDAyLDE2IEwyNDAuNDQwMiwxNiBMMjMwLjQ0MDIsNiIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1Ny4zMDc4IiB4PSI1Ni40NCIgeT0iMjMuMDY2OSI+SFRNTCAmIzEyNTAxOyYjMTI0NTc7JiMxMjU0MDsmIzEyNTEyOyYjMTIzNjM7JiMxMjQyNTsmIzEyMzk4OyYjMjA4Mzc7JiMyMTE0Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTY5LjAwMDIiIHg9IjU2LjQ0IiB5PSIzOC4xOTk3Ij4mIzEyNDY5OyYjMTI1NDA7JiMxMjQ5NjsmIzEyNTQwOyYjMTI0Njk7JiMxMjQ1MjsmIzEyNDg5OyYjMTI1MjQ7JiMxMjUzMTsmIzEyNDgwOyYjMTI1MjI7JiMxMjUzMTsmIzEyNDY0OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDMuMDAwMiIgeD0iNTYuNDQiIHk9IjUzLjMzMjUiPiYjMTI0NzU7JiMxMjQ4MzsmIzEyNDcxOyYjMTI1MTk7JiMxMjUzMTsmIzEyNTA1OyYjMTI1NDA7JiMxMjQ3MzsmIzEyMzk4OyYjMzU0Njk7JiMzNTM4ODs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xNyIgZGF0YS1zb3VyY2UtbGluZT0iNTUiIGRhdGEtdWlkPSJlbnQwMDE4IiBpZD0iZW50aXR5X0dNTjE3Ij48cGF0aCBkPSJNODQ4LjA3LDYgTDg0OC4wNyw2MS4zOTg0IEwxMDE0LjQ4ODUsNjEuMzk4NCBMMTAxNC40ODg1LDE2IEwxMDA0LjQ4ODUsNiBMODQ4LjA3LDYiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0xMDA0LjQ4ODUsNiBMMTAwNC40ODg1LDE2IEwxMDE0LjQ4ODUsMTYgTDEwMDQuNDg4NSw2IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ1LjQxODUiIHg9Ijg1NC4wNyIgeT0iMjMuMDY2OSI+UG9zdGdyZVNRTCArIE15QmF0aXM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQyLjM3MTciIHg9Ijg1NC4wNyIgeT0iMzguMTk5NyI+JiMyNDExNTsmIzMxMDgwOyYjMjk5ODM7JiMyNTEwNDsmIzY1Mjg4O1BERi9FeGNlbCYjNjUyODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjAwMDEiIHg9Ijg1NC4wNyIgeT0iNTMuMzMyNSI+JiMxMjUwMTsmIzEyNDQ5OyYjMTI0NTI7JiMxMjUyMzsmIzIwOTg2OyYjMjExNDc7PC90ZXh0PjwvZz48IS0tbGluayBpbnB1dCB0byBjb3JlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImlucHV0IiBkYXRhLWVudGl0eS0yPSJjb3JlIiBkYXRhLXNvdXJjZS1saW5lPSIzNyIgZGF0YS11aWQ9ImxuazkiIGlkPSJsaW5rX2lucHV0X2NvcmUiPjxwYXRoIGNvZGVMaW5lPSIzNyIgZD0iTTI1NC42MjYsMTcxLjcgQzI1NS4yNjI3LDE3MS43IDI1NS45MDA5LDE3MS43IDI1Ni41NDA0LDE3MS43IEMyNTcuODE5NSwxNzEuNyAyNTkuMTA0MSwxNzEuNyAyNjAuMzkzOSwxNzEuNyBDMjgxLjAzMDksMTcxLjcgMzAyLjk5ODEsMTcxLjcgMzI0Ljk2NSwxNzEuNyBDMzQ2LjkzMTksMTcxLjcgMzY4Ljg5ODQsMTcxLjcgMzg5LjUzNDIsMTcxLjcgQzM5MC44MjM5LDE3MS43IDM4Ni4xMDg0LDE3MS43IDM4Ny4zODc1LDE3MS43IiBmaWxsPSJub25lIiBpZD0iaW5wdXQtdG8tY29yZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzkzLjM4NzUsMTcxLjcsMzg0LjM4NzUsMTY3LjcsMzg4LjM4NzUsMTcxLjcsMzg0LjM4NzUsMTc1LjcsMzkzLjM4NzUsMTcxLjciIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MC44MDE4IiB4PSIyODEuMDUzOCIgeT0iMTUyLjc2NjkiPklucHV0IFBvcnRzPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc3LjE0OTQiIHg9IjI3Ny44OCIgeT0iMTY3Ljg5OTciPihVc2UgQ2FzZXMpPC90ZXh0PjwvZz48IS0tbGluayBjb3JlIHRvIG91dHB1dC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJjb3JlIiBkYXRhLWVudGl0eS0yPSJvdXRwdXQiIGRhdGEtc291cmNlLWxpbmU9IjM4IiBkYXRhLXVpZD0ibG5rMTAiIGlkPSJsaW5rX2NvcmVfb3V0cHV0Ij48cGF0aCBjb2RlTGluZT0iMzgiIGQ9Ik02MTYuMzYsMTcxLjcgQzYxNy4wODc1LDE3MS43IDYxNy44MTcsMTcxLjcgNjE4LjU0ODcsMTcxLjcgQzYyMC4wMTE5LDE3MS43IDYyMS40ODMyLDE3MS43IDYyMi45NjIzLDE3MS43IEM2MjguODc4NSwxNzEuNyA2MzQuOTE4NSwxNzEuNyA2NDEuMDU3MywxNzEuNyBDNjY1LjYxMjcsMTcxLjcgNjkxLjc1MDksMTcxLjcgNzE3Ljg4ODgsMTcxLjcgQzc0NC4wMjY2LDE3MS43IDc3MC4xNjQsMTcxLjcgNzk0LjcxNzgsMTcxLjcgQzgwMC44NTYzLDE3MS43IDgwNi44OTU4LDE3MS43IDgxMi44MTE2LDE3MS43IEM4MTUuNzY5NCwxNzEuNyA4MTguNjk2NCwxNzEuNyA4MjEuNTg5NCwxNzEuNyBDODIzLjAzNTgsMTcxLjcgODI0LjQ3MzgsMTcxLjcgODI1LjkwMjksMTcxLjcgQzgyNi4yNjAxLDE3MS43IDgyMC42MTY4LDE3MS43IDgyMC45NzMsMTcxLjciIGZpbGw9Im5vbmUiIGlkPSJjb3JlLXRvLW91dHB1dCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iODI2Ljk3MywxNzEuNyw4MTcuOTczLDE2Ny43LDgyMS45NzMsMTcxLjcsODE3Ljk3MywxNzUuNyw4MjYuOTczLDE3MS43IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODIuMjk3NCIgeD0iNjg3LjM4MTUiIHk9IjE1Mi43NjY5Ij5PdXRwdXQgUG9ydHM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ4Ljk2MDQiIHg9IjY1NC4wNSIgeT0iMTY3Ljg5OTciPihSZXBvc2l0b3J5IEludGVyZmFjZXMpPC90ZXh0PjwvZz48IS0tbGluayBHTU4xMSB0byBjb3JlLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkdNTjExIiBkYXRhLWVudGl0eS0yPSJjb3JlIiBkYXRhLXNvdXJjZS1saW5lPSI0MyIgZGF0YS11aWQ9ImxuazEzIiBpZD0ibGlua19HTU4xMV9jb3JlIj48cGF0aCBkPSJNNDE0LjQ2LDM5NC43IEMzNzkuNjEsMzc4Ljk3IDM0My4zNCwzNTUuNDIgMzIzLjI5LDMyMS4yIEMyOTcuOSwyNzcuODcgMjkzLjcxLDI0OC43OSAzMjMuMjksMjA4LjIgQzMzNS4wMDc1LDE5Mi4xMjUgMzUxLjY3NTYsMTgxLjY5NTYgMzcwLjIwOTIsMTc1LjEyMDIgQzM3NC44NDI2LDE3My40NzYzIDM3OS41OTI2LDE3Mi4wNzMzIDM4NC40MTEsMTcwLjg4MzIgQzM4Ni44MjAyLDE3MC4yODgxIDM4OS4yNDY1LDE2OS43NDYzIDM5MS42ODM4LDE2OS4yNTQxIEMzOTIuMjkzMiwxNjkuMTMxMSAzOTIuOTAzMiwxNjkuMDExMiAzOTMuNTEzOCwxNjguODk0MyIgZmlsbD0ibm9uZSIgaWQ9IkdNTjExLWNvcmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcsNzsiLz48L2c+PCEtLWxpbmsgaW5wdXQgdG8gR01OMTQtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iaW5wdXQiIGRhdGEtZW50aXR5LTI9IkdNTjE0IiBkYXRhLXNvdXJjZS1saW5lPSI0OSIgZGF0YS11aWQ9ImxuazE2IiBpZD0ibGlua19pbnB1dF9HTU4xNCI+PHBhdGggZD0iTTE0NS40NCwxMjguMjkyMyBDMTQ1LjQ0LDEyNy43MjQ0IDE0NS40NCwxMjcuMTU2NCAxNDUuNDQsMTI2LjU4ODQgQzE0NS40NCwxMjUuNDUyNSAxNDUuNDQsMTI0LjMxNjYgMTQ1LjQ0LDEyMy4xODA2IEMxNDUuNDQsMTIwLjkwODcgMTQ1LjQ0LDExOC42MzY5IDE0NS40NCwxMTYuMzY1IEMxNDUuNDQsOTguMTkgMTQ1LjQ0LDgwLjAxNSAxNDUuNDQsNjEuODQiIGZpbGw9Im5vbmUiIGlkPSJpbnB1dC1HTU4xNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tbGluayBvdXRwdXQgdG8gR01OMTctLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0ib3V0cHV0IiBkYXRhLWVudGl0eS0yPSJHTU4xNyIgZGF0YS1zb3VyY2UtbGluZT0iNTUiIGRhdGEtdWlkPSJsbmsxOSIgaWQ9Imxpbmtfb3V0cHV0X0dNTjE3Ij48cGF0aCBkPSJNOTMxLjI4LDEyOC4yOTIzIEM5MzEuMjgsMTI3LjcyNDQgOTMxLjI4LDEyNy4xNTY0IDkzMS4yOCwxMjYuNTg4NCBDOTMxLjI4LDEyNS40NTI1IDkzMS4yOCwxMjQuMzE2NiA5MzEuMjgsMTIzLjE4MDYgQzkzMS4yOCwxMjAuOTA4NyA5MzEuMjgsMTE4LjYzNjkgOTMxLjI4LDExNi4zNjUgQzkzMS4yOCw5OC4xOSA5MzEuMjgsODAuMDE1IDkzMS4yOCw2MS44NCIgZmlsbD0ibm9uZSIgaWQ9Im91dHB1dC1HTU4xNyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tU1JDPVtUTEhUSnpIMDU3c1ZOcDdYWElNNi1DdzNvVjlYbTQxNFdKU0pDdkhYUUlvVGZmcWJSOG05c241T00zdTViMC1EQms1WjFMY0tiR0xheVN5Q1JQU2RfZTl0TWZPNWVzX2pjTmxsZDdGa1FVa25UeEJacEhUYmtZMzVELWJrSU5USmtaaklQQUp4cFlrVlU5YUlDa1dXbnZuWE1xeUNTSm9Xc3JKWkVaQ0hpZVpzWVlHZWhja2Rlb0oxSjZCV2tBcUR3SG1BYVpSNWlTZkhwaWtrTlBSTkFfY0M1OWpJcDRjbjl6c3BPMmhKSzhUVjh3SDY0SkRYbThvdVBIY3dIakhhdEM5aS1pQUNqUjlYZWZsdTBVdnBBNnVYM2RNV1lwWE9Xc0ZlRFhjZHJUVU5Ya3ZtcjhaWmNpUUk5aVNuQnhsZzVUUTN0U0xXZXowMDFxek9xYk80T3ZWZEF2THlLSzdEbjIyYzFaSnpHbFBnVl9MRUxOSG4zeEw3VDh0TWZXOERuUTlNTG1Ea1BiSzFRV3ZXSEctemtRVW5teElJN0NTN1lDTWZ4SVk1alp3WWNtZFNlbV9HSTlpVWJqSjRYVXpMVFJyM2dNNWdLMzg4M2ZkU1BlUDFSTzJiTTk3a0xvZEFLZHBuOWRVMlhHYTVra1RJMkVjVUlCNGhISjRldjZ2bWpPNTN3VVBYM3gxY1Ytalo5TF8tNy02ZElWdUZuakl5R3ZYNTlKTjY0TDJidDlMZ1hmcXctM2NyY0FEcFBnUzBSMk1TejhERm9iWmdFODJxY0xwZEFUbjVCMGx5MEMweEJHUlJVTV9vYnBVeldNRlRoT3lWamVyZ3I2WXVueEdVLXRGUkdNYXpFNWM3azRnbjYyaC1lUG5tSnhzOVNQZFVsbmdWM0l1QUNscjFaZ056enNWVW1ZOUstWkVKNDB1S1VUdE8tMlhBTDVEckdUdEN2YWhoZFRZWGk0QUx0a1hqa1pNZE1ickpZM2pDUzZrR1E2NWRuQkVPbHZoQ201U015T2RDdWlwMlIzMnk3MEtfYnVFWmg0cGxJUjQ0dkFNTzNWVHA0M3czZzRGS3J1N3p3UjVBUmtjd2RCYURtZEx2MmFIVV9seGE3UW1nYVQyVlZla2FjOFlzd3lxVkxpRzVlQzVxb0hfRldsSVdURTNGZjZpa0hhcHc2VVRpTTk0OUZLN2psTHNUenM4YnF6MENMbk15eU10TzI5QmtTTlltNDdmemg3dVNPYWh6R0tISFlaNkxDTlhtbHdFX0tZWjVNalhtMWZDZ1V4RnRhbFN0YXlYZXJDcVNkaDFmcHhERS0xN1NmMGI1d0dZTUZfa1AxUjNaRFh2VzFtZmZ2cTk2LXI1LVJrX3UwbTAwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<p><strong>モノリスでもヘキサゴナルアーキテクチャを適用する理由：</strong></p>
<ol>
<li><strong>テスト容易性</strong>：ドメインロジックを UI から分離してテスト可能</li>
<li><strong>将来の移行</strong>：必要に応じて API 層を追加可能</li>
<li><strong>保守性</strong>：関心の分離により変更影響を局所化</li>
<li><strong>再利用性</strong>：ドメインロジックを複数の UI で共有可能</li>
</ol>
<hr />
<h3 id="225">22.5 ディレクトリ構成<a class="headerlink" href="#225" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>src/main/java/com/example/accounting/
├── domain/                     # ドメイン層（API版と共通）
│   ├── model/
│   │   ├── account/           # 勘定科目
│   │   ├── journal/           # 仕訳
│   │   ├── balance/           # 残高
│   │   └── department/        # 部門
│   └── exception/
│
├── application/               # アプリケーション層（API版と共通）
│   ├── port/
│   │   ├── in/               # Input Port（ユースケース）
│   │   └── out/              # Output Port（リポジトリ）
│   └── service/
│
├── infrastructure/
│   ├── persistence/          # Output Adapter（DB実装）
│   │   ├── mapper/
│   │   └── repository/
│   └── web/                  # Input Adapter（Web実装）
│       ├── controller/       # Thymeleaf Controller
│       ├── form/             # フォームオブジェクト
│       └── helper/           # ビューヘルパー
│
├── config/
│
└── resources/
    ├── templates/            # Thymeleaf テンプレート
    │   ├── layout/           # 共通レイアウト
    │   ├── accounts/         # 勘定科目マスタ画面
    │   ├── journals/         # 仕訳入力画面
    │   ├── balances/         # 残高照会画面
    │   └── reports/          # 帳票出力画面
    ├── static/               # 静的リソース
    │   ├── css/
    │   ├── js/
    │   └── images/
    └── messages.properties   # メッセージリソース
</code></pre></div>
<hr />
<h3 id="226">22.6 技術スタックの導入<a class="headerlink" href="#226" title="Permanent link">&para;</a></h3>
<details>
<summary>build.gradle.kts</summary>

<div class="highlight"><pre><span></span><code><span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;java&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;org.springframework.boot&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;3.2.0&quot;</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;io.spring.dependency-management&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;1.1.4&quot;</span>
<span class="p">}</span>

<span class="n">java</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">toolchain</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">languageVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JavaLanguageVersion</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="m">21</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="n">dependencies</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Spring Boot Web（REST APIではなくMVCとして使用）</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-starter-web&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-starter-validation&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Thymeleaf（テンプレートエンジン）</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-starter-thymeleaf&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;nz.net.ultraq.thymeleaf:thymeleaf-layout-dialect:3.3.0&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Thymeleaf + Spring Security（認証機能を使う場合）</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.thymeleaf.extras:thymeleaf-extras-springsecurity6&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// htmx（モダンなインタラクティブUI）</span>
<span class="w">    </span><span class="c1">// CDN から読み込むため依存関係は不要</span>

<span class="w">    </span><span class="c1">// MyBatis</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.mybatis.spring.boot:mybatis-spring-boot-starter:3.0.3&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// PostgreSQL</span>
<span class="w">    </span><span class="n">runtimeOnly</span><span class="p">(</span><span class="s">&quot;org.postgresql:postgresql&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Flyway</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.flywaydb:flyway-core&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.flywaydb:flyway-database-postgresql&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Webjars（Bootstrap等のフロントエンドライブラリ）</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.webjars:bootstrap:5.3.2&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.webjars:webjars-locator-core:0.55&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// 帳票出力</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;org.apache.poi:poi-ooxml:5.2.5&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// Excel</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;com.itextpdf:itext7-core:8.0.2&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// PDF</span>

<span class="w">    </span><span class="c1">// Test</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="s">&quot;org.springframework.boot:spring-boot-starter-test&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="s">&quot;org.testcontainers:postgresql:1.19.3&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="s">&quot;org.testcontainers:junit-jupiter:1.19.3&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Lombok</span>
<span class="w">    </span><span class="n">compileOnly</span><span class="p">(</span><span class="s">&quot;org.projectlombok:lombok&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">annotationProcessor</span><span class="p">(</span><span class="s">&quot;org.projectlombok:lombok&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>

</details>

<p><strong>パッケージの説明：</strong></p>
<table>
<thead>
<tr>
<th>パッケージ</th>
<th>用途</th>
</tr>
</thead>
<tbody>
<tr>
<td>spring-boot-starter-thymeleaf</td>
<td>サーバーサイドテンプレートエンジン</td>
</tr>
<tr>
<td>thymeleaf-layout-dialect</td>
<td>レイアウト継承（共通ヘッダー・フッター）</td>
</tr>
<tr>
<td>webjars:bootstrap</td>
<td>CSS フレームワーク（サーバーから配信）</td>
</tr>
<tr>
<td>poi-ooxml</td>
<td>Excel ファイル出力（帳票）</td>
</tr>
<tr>
<td>itext7-core</td>
<td>PDF ファイル出力（帳票）</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="227-spring-boot-thymeleaf">22.7 基本的な Spring Boot + Thymeleaf アプリケーション<a class="headerlink" href="#227-spring-boot-thymeleaf" title="Permanent link">&para;</a></h3>
<details>
<summary>アプリケーションクラス</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.SpringApplication</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.autoconfigure.SpringBootApplication</span><span class="p">;</span>

<span class="nd">@SpringBootApplication</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountingApplication</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">AccountingApplication</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>application.yml</summary>

<div class="highlight"><pre><span></span><code><span class="nt">spring</span><span class="p">:</span>
<span class="w">  </span><span class="nt">datasource</span><span class="p">:</span>
<span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jdbc:postgresql://localhost:5432/accounting</span>
<span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>
<span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">postgres</span>

<span class="w">  </span><span class="nt">thymeleaf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class="w">  </span><span class="c1"># 開発時はキャッシュ無効</span>
<span class="w">    </span><span class="nt">prefix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">classpath:/templates/</span>
<span class="w">    </span><span class="nt">suffix</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">.html</span>
<span class="w">    </span><span class="nt">encoding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UTF-8</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">HTML</span>

<span class="w">  </span><span class="nt">messages</span><span class="p">:</span>
<span class="w">    </span><span class="nt">basename</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">messages</span>
<span class="w">    </span><span class="nt">encoding</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">UTF-8</span>

<span class="nt">mybatis</span><span class="p">:</span>
<span class="w">  </span><span class="nt">mapper-locations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">classpath:mapper/*.xml</span>
<span class="w">  </span><span class="nt">configuration</span><span class="p">:</span>
<span class="w">    </span><span class="nt">map-underscore-to-camel-case</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>

<span class="nt">server</span><span class="p">:</span>
<span class="w">  </span><span class="nt">servlet</span><span class="p">:</span>
<span class="w">    </span><span class="nt">session</span><span class="p">:</span>
<span class="w">      </span><span class="nt">timeout</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30m</span><span class="w">  </span><span class="c1"># セッションタイムアウト</span>
</code></pre></div>

</details>

<details>
<summary>共通レイアウト（layout/default.html）</summary>

<div class="highlight"><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span> <span class="na">xmlns:th</span><span class="o">=</span><span class="s">&quot;http://www.thymeleaf.org&quot;</span>
      <span class="na">xmlns:layout</span><span class="o">=</span><span class="s">&quot;http://www.ultraq.net.nz/thymeleaf/layout&quot;</span>
      <span class="na">lang</span><span class="o">=</span><span class="s">&quot;ja&quot;</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span> <span class="na">layout:title-pattern</span><span class="o">=</span><span class="s">&quot;$CONTENT_TITLE - $LAYOUT_TITLE&quot;</span><span class="p">&gt;</span>財務会計システム<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- Bootstrap CSS --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/webjars/bootstrap/css/bootstrap.min.css}&quot;</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- カスタム CSS --&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/css/style.css}&quot;</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- htmx（部分更新用） --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/htmx.org@1.9.10&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="cm">&lt;!-- ナビゲーションバー --&gt;</span>
    <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar navbar-expand-lg navbar-dark bg-primary&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container-fluid&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-brand&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/}&quot;</span><span class="p">&gt;</span>財務会計システム<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-toggler&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">data-bs-toggle</span><span class="o">=</span><span class="s">&quot;collapse&quot;</span>
                    <span class="na">data-bs-target</span><span class="o">=</span><span class="s">&quot;#navbarNav&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-toggler-icon&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;collapse navbar-collapse&quot;</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;navbarNav&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;navbar-nav&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-item dropdown&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-link dropdown-toggle&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span>
                           <span class="na">data-bs-toggle</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>マスタ<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-menu&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/accounts}&quot;</span><span class="p">&gt;</span>勘定科目マスタ<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/account-structures}&quot;</span><span class="p">&gt;</span>勘定科目構成<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/tax-transactions}&quot;</span><span class="p">&gt;</span>課税取引マスタ<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/departments}&quot;</span><span class="p">&gt;</span>部門マスタ<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-item dropdown&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-link dropdown-toggle&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span>
                           <span class="na">data-bs-toggle</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>仕訳<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-menu&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/journals}&quot;</span><span class="p">&gt;</span>仕訳一覧<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/journals/new}&quot;</span><span class="p">&gt;</span>仕訳入力<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/journals/import}&quot;</span><span class="p">&gt;</span>仕訳取込<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-item dropdown&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-link dropdown-toggle&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span>
                           <span class="na">data-bs-toggle</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>照会<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-menu&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/balances/daily}&quot;</span><span class="p">&gt;</span>日次残高照会<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/balances/monthly}&quot;</span><span class="p">&gt;</span>月次残高照会<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-item dropdown&quot;</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;nav-link dropdown-toggle&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;#&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;button&quot;</span>
                           <span class="na">data-bs-toggle</span><span class="o">=</span><span class="s">&quot;dropdown&quot;</span><span class="p">&gt;</span>帳票<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-menu&quot;</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/reports/daily}&quot;</span><span class="p">&gt;</span>日計表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/reports/trial-balance}&quot;</span><span class="p">&gt;</span>合計残高試算表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/reports/ledger}&quot;</span><span class="p">&gt;</span>総勘定元帳<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">hr</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-divider&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/reports/balance-sheet}&quot;</span><span class="p">&gt;</span>貸借対照表<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                            <span class="p">&lt;</span><span class="nt">li</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;dropdown-item&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/reports/income-statement}&quot;</span><span class="p">&gt;</span>損益計算書<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
                    <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- フラッシュメッセージ --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container mt-3&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${successMessage}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;alert alert-success alert-dismissible fade show&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&quot;${successMessage}&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn-close&quot;</span> <span class="na">data-bs-dismiss</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${errorMessage}&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;alert alert-danger alert-dismissible fade show&quot;</span> <span class="na">role</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&quot;${errorMessage}&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;button&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn-close&quot;</span> <span class="na">data-bs-dismiss</span><span class="o">=</span><span class="s">&quot;alert&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- メインコンテンツ --&gt;</span>
    <span class="p">&lt;</span><span class="nt">main</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container mt-4&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">layout:fragment</span><span class="o">=</span><span class="s">&quot;content&quot;</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- 各ページのコンテンツがここに挿入される --&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">main</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- フッター --&gt;</span>
    <span class="p">&lt;</span><span class="nt">footer</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;footer mt-5 py-3 bg-light&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;container text-center&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-muted&quot;</span><span class="p">&gt;</span>財務会計システム <span class="ni">&amp;copy;</span> 2025<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">footer</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- Bootstrap JS --&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">th:src</span><span class="o">=</span><span class="s">&quot;@{/webjars/bootstrap/js/bootstrap.bundle.min.js}&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- ページ固有のスクリプト --&gt;</span>
    <span class="p">&lt;</span><span class="nt">th:block</span> <span class="na">layout:fragment</span><span class="o">=</span><span class="s">&quot;scripts&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">th:block</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>

</details>

<hr />
<h3 id="228-htmx">22.8 htmx による部分更新<a class="headerlink" href="#228-htmx" title="Permanent link">&para;</a></h3>
<p>モノリスアプリケーションでも、<strong>htmx</strong> を使用することで SPA のような操作性を実現できます。ページ全体をリロードせず、必要な部分だけを更新します。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IlNFUVVFTkNFIiBoZWlnaHQ9IjUyMHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDg3cHg7aGVpZ2h0OjUyMHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQ4NyA1MjAiIHdpZHRoPSI0ODdweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPmh0bXggJiMxMjM5NTsmIzEyNDI0OyYjMTI0Mjc7JiMzNzA5NjsmIzIwOTk4OyYjMjYzNTY7JiMyNjAzMjs8L3RpdGxlPjxkZWZzLz48Zz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQzLjE1MDkiIHg9IjE3MS4wMjc4IiB5PSIyNy45OTUxIj5odG14ICYjMTIzOTU7JiMxMjQyNDsmIzEyNDI3OyYjMzcwOTY7JiMyMDk5ODsmIzI2MzU2OyYjMjYwMzI7PC90ZXh0PjxnPjx0aXRsZT4uLi4uPC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iMzIwLjcyNjYiIHdpZHRoPSI4IiB4PSIzMS45OTk5IiB5PSIxMTguNTkzOCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41O3N0cm9rZS1kYXNoYXJyYXk6NSw1OyIgeDE9IjM1IiB4Mj0iMzUiIHkxPSIxMTguNTkzOCIgeTI9IjQzOS4zMjAzIi8+PC9nPjxnPjx0aXRsZT5odG14PC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iMzIwLjcyNjYiIHdpZHRoPSI4IiB4PSIxNTYuNTkxMyIgeT0iMTE4LjU5MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSIxNjAuNDQ4NyIgeDI9IjE2MC40NDg3IiB5MT0iMTE4LjU5MzgiIHkyPSI0MzkuMzIwMyIvPjwvZz48Zz48dGl0bGU+Q29udHJvbGxlcjwvdGl0bGU+PHJlY3QgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwIiBoZWlnaHQ9IjMyMC43MjY2IiB3aWR0aD0iOCIgeD0iMjg1Ljg5OSIgeT0iMTE4LjU5MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSIyODkuMzEyNSIgeDI9IjI4OS4zMTI1IiB5MT0iMTE4LjU5MzgiIHkyPSI0MzkuMzIwMyIvPjwvZz48Zz48dGl0bGU+VGh5bWVsZWFmPC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iMzIwLjcyNjYiIHdpZHRoPSI4IiB4PSI0MjguMjA2NyIgeT0iMTE4LjU5MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSI0MzEuMjA2OCIgeDI9IjQzMS4yMDY4IiB5MT0iMTE4LjU5MzgiIHkyPSI0MzkuMzIwMyIvPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtaGVhZCIgZGF0YS1wYXJ0aWNpcGFudD0iQnJvd3NlciI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iNSIgeT0iMTE1LjI5MiI+JiMxMjUwMjsmIzEyNTIxOyYjMTI0NTQ7JiMxMjQ3MDs8L3RleHQ+PGVsbGlwc2UgY3g9IjM1Ljk5OTkiIGN5PSI1MC43OTY5IiBmaWxsPSIjRTJFMkYwIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0zNS45OTk5LDU4Ljc5NjkgTDM1Ljk5OTksODUuNzk2OSBNMjIuOTk5OSw2Ni43OTY5IEw0OC45OTk5LDY2Ljc5NjkgTTM1Ljk5OTksODUuNzk2OSBMMjIuOTk5OSwxMDAuNzk2OSBNMzUuOTk5OSw4NS43OTY5IEw0OC45OTk5LDEwMC43OTY5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LXRhaWwiIGRhdGEtcGFydGljaXBhbnQ9IkJyb3dzZXIiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjUiIHk9IjQ1MS4zMTU0Ij4mIzEyNTAyOyYjMTI1MjE7JiMxMjQ1NDsmIzEyNDcwOzwvdGV4dD48ZWxsaXBzZSBjeD0iMzUuOTk5OSIgY3k9IjQ2My4xMTcyIiBmaWxsPSIjRTJFMkYwIiByeD0iOCIgcnk9IjgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0zNS45OTk5LDQ3MS4xMTcyIEwzNS45OTk5LDQ5OC4xMTcyIE0yMi45OTk5LDQ3OS4xMTcyIEw0OC45OTk5LDQ3OS4xMTcyIE0zNS45OTk5LDQ5OC4xMTcyIEwyMi45OTk5LDUxMy4xMTcyIE0zNS45OTk5LDQ5OC4xMTcyIEw0OC45OTk5LDUxMy4xMTcyIiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LWhlYWQiIGRhdGEtcGFydGljaXBhbnQ9Imh0bXgiPjxyZWN0IGZpbGw9IiNFMkUyRjAiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTAuMjg1MiIgeD0iMTM1LjQ0ODciIHk9Ijg3LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNi4yODUyIiB4PSIxNDIuNDQ4NyIgeT0iMTA3LjI5MiI+aHRteDwvdGV4dD48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LXRhaWwiIGRhdGEtcGFydGljaXBhbnQ9Imh0bXgiPjxyZWN0IGZpbGw9IiNFMkUyRjAiIGhlaWdodD0iMzAuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNTAuMjg1MiIgeD0iMTM1LjQ0ODciIHk9IjQzOC4zMjAzIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzYuMjg1MiIgeD0iMTQyLjQ0ODciIHk9IjQ1OC4zMTU0Ij5odG14PC90ZXh0PjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtaGVhZCIgZGF0YS1wYXJ0aWNpcGFudD0iQ29udHJvbGxlciI+PHJlY3QgZmlsbD0iI0UyRTJGMCIgaGVpZ2h0PSIzMC4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI4My4xNzI5IiB4PSIyNDguMzEyNSIgeT0iODcuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5LjE3MjkiIHg9IjI1NS4zMTI1IiB5PSIxMDcuMjkyIj5Db250cm9sbGVyPC90ZXh0PjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1wYXJ0aWNpcGFudD0iQ29udHJvbGxlciI+PHJlY3QgZmlsbD0iI0UyRTJGMCIgaGVpZ2h0PSIzMC4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI4My4xNzI5IiB4PSIyNDguMzEyNSIgeT0iNDM4LjMyMDMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS4xNzI5IiB4PSIyNTUuMzEyNSIgeT0iNDU4LjMxNTQiPkNvbnRyb2xsZXI8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLXBhcnRpY2lwYW50PSJGcmFnbWVudCI+PHJlY3QgZmlsbD0iI0UyRTJGMCIgaGVpZ2h0PSI0Ni41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI5Ny45OTk2IiB4PSIzODMuMjA2OCIgeT0iNzEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3My45NzE3IiB4PSIzOTUuMjIwOCIgeT0iOTAuOTk1MSI+VGh5bWVsZWFmPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjM5MC4yMDY4IiB5PSIxMDcuMjkyIj4mIzEyNTAxOyYjMTI1MjE7JiMxMjQ2NDsmIzEyNTEzOyYjMTI1MzE7JiMxMjQ4ODs8L3RleHQ+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC10YWlsIiBkYXRhLXBhcnRpY2lwYW50PSJGcmFnbWVudCI+PHJlY3QgZmlsbD0iI0UyRTJGMCIgaGVpZ2h0PSI0Ni41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI5Ny45OTk2IiB4PSIzODMuMjA2OCIgeT0iNDM4LjMyMDMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3My45NzE3IiB4PSIzOTUuMjIwOCIgeT0iNDU4LjMxNTQiPlRoeW1lbGVhZjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSIzOTAuMjA2OCIgeT0iNDc0LjYxMjMiPiYjMTI1MDE7JiMxMjUyMTsmIzEyNDY0OyYjMTI1MTM7JiMxMjUzMTsmIzEyNDg4OzwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtcGFydGljaXBhbnQtMT0iQnJvd3NlciIgZGF0YS1wYXJ0aWNpcGFudC0yPSJodG14Ij48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE0OC41OTEzLDE0NS43MjY2LDE1OC41OTEzLDE0OS43MjY2LDE0OC41OTEzLDE1My43MjY2LDE1Mi41OTEzLDE0OS43MjY2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjM1Ljk5OTkiIHgyPSIxNTQuNTkxMyIgeTE9IjE0OS43MjY2IiB5Mj0iMTQ5LjcyNjYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MS4wMDAxIiB4PSI0Mi45OTk5IiB5PSIxNDQuNjYwNiI+JiMxMjUwODsmIzEyNDc5OyYjMTI1MzE7JiMxMjQ2MzsmIzEyNTIyOyYjMTI0ODM7JiMxMjQ2Mzs8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLXBhcnRpY2lwYW50LTE9Imh0bXgiIGRhdGEtcGFydGljaXBhbnQtMj0iQ29udHJvbGxlciI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyNzcuODk5LDE4OS45OTIyLDI4Ny44OTksMTkzLjk5MjIsMjc3Ljg5OSwxOTcuOTkyMiwyODEuODk5LDE5My45OTIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE2MC41OTEzIiB4Mj0iMjgzLjg5OSIgeTE9IjE5My45OTIyIiB5Mj0iMTkzLjk5MjIiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5OS42NTgzIiB4PSIxNjcuNTkxMyIgeT0iMTczLjc5MzUiPkFKQVggJiMxMjUyMjsmIzEyNDYzOyYjMTI0NTY7JiMxMjQ3MzsmIzEyNDg4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDUuMTkzNCIgeD0iMTY3LjU5MTMiIHk9IjE4OC45MjYzIj4oaHgtZ2V0L2h4LXBvc3QpPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1wYXJ0aWNpcGFudC0xPSJDb250cm9sbGVyIiBkYXRhLXBhcnRpY2lwYW50LTI9IkZyYWdtZW50Ij48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQyMC4yMDY3LDIzNC4yNTc4LDQzMC4yMDY3LDIzOC4yNTc4LDQyMC4yMDY3LDI0Mi4yNTc4LDQyNC4yMDY3LDIzOC4yNTc4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI4OS44OTkiIHgyPSI0MjYuMjA2NyIgeTE9IjIzOC4yNTc4IiB5Mj0iMjM4LjI1NzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MS4wMDAxIiB4PSIyOTYuODk5IiB5PSIyMTguMDU5MSI+JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7JiMxMjUxMzsmIzEyNTMxOyYjMTI0ODg7JiMxMjQzNDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzguMDAwMSIgeD0iMjk2Ljg5OSIgeT0iMjMzLjE5MTkiPiYjMTI1MjQ7JiMxMjUzMTsmIzEyNDgwOyYjMTI1MjI7JiMxMjUzMTsmIzEyNDY0OzwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtcGFydGljaXBhbnQtMT0iRnJhZ21lbnQiIGRhdGEtcGFydGljaXBhbnQtMj0iQ29udHJvbGxlciI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzMDAuODk5LDI2My4zOTA2LDI5MC44OTksMjY3LjM5MDYsMzAwLjg5OSwyNzEuMzkwNiwyOTYuODk5LDI2Ny4zOTA2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjI5NC44OTkiIHgyPSI0MzEuMjA2NyIgeTE9IjI2Ny4zOTA2IiB5Mj0iMjY3LjM5MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTguMzA3NyIgeD0iMzA2Ljg5OSIgeT0iMjYyLjMyNDciPkhUTUwgJiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7JiMxMjUxMzsmIzEyNTMxOyYjMTI0ODg7PC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1wYXJ0aWNpcGFudC0xPSJDb250cm9sbGVyIiBkYXRhLXBhcnRpY2lwYW50LTI9Imh0bXgiPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTcxLjU5MTMsMjkyLjUyMzQsMTYxLjU5MTMsMjk2LjUyMzQsMTcxLjU5MTMsMzAwLjUyMzQsMTY3LjU5MTMsMjk2LjUyMzQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheToyLDI7IiB4MT0iMTY1LjU5MTMiIHgyPSIyODguODk5IiB5MT0iMjk2LjUyMzQiIHkyPSIyOTYuNTIzNCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNS4zMDc3IiB4PSIxNzcuNTkxMyIgeT0iMjkxLjQ1NzUiPkhUTUwgJiMxMjUyNDsmIzEyNDczOyYjMTI1MDk7JiMxMjUzMTsmIzEyNDczOzwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtcGFydGljaXBhbnQtMT0iaHRteCIgZGF0YS1wYXJ0aWNpcGFudC0yPSJCcm93c2VyIj48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQ2Ljk5OTksMzM2Ljc4OTEsMzYuOTk5OSwzNDAuNzg5MSw0Ni45OTk5LDM0NC43ODkxLDQyLjk5OTksMzQwLjc4OTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDAuOTk5OSIgeDI9IjE1OS41OTEzIiB5MT0iMzQwLjc4OTEiIHkyPSIzNDAuNzg5MSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMC41OTE0IiB4PSI1Mi45OTk5IiB5PSIzMjAuNTkwMyI+RE9NICYjMTI0MzQ7JiMzNzA5NjsmIzIwOTk4OyYjMjYzNTY7JiMyNjAzMjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzAuNTIyNSIgeD0iNTIuOTk5OSIgeT0iMzM1LjcyMzEiPihoeC10YXJnZXQpPC90ZXh0PjwvZz48cGF0aCBkPSJNMTY1LDM1My43ODkxIEwxNjUsNDIzLjc4OTEgTDM2Nyw0MjMuNzg5MSBMMzY3LDM2My43ODkxIEwzNTcsMzUzLjc4OTEgTDE2NSwzNTMuNzg5MSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTM1NywzNTMuNzg5MSBMMzU3LDM2My43ODkxIEwzNjcsMzYzLjc4OTEgTDM1NywzNTMuNzg5MSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgxLjk0OTQiIHg9IjE3MSIgeT0iMzcwLjg1NiI+aHRteCAmIzEyMzk5OyYjMjkzMDU7JiMyMTAyOTsmIzEyMzk0OyYjMjM2NDY7JiMyNDYxNTsmIzY1Mjg4O2h4LSomIzY1Mjg5OyYjMTI0MzQ7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0Mi43OTA2IiB4PSIxNzEiIHk9IjM4NS45ODg4Ij4mIzIwMzUxOyYjMTIzODc7JiMxMjM5MDsgQUpBWCAmIzM2ODkwOyYjMjA0NDk7JiMxMjQzNDsmIzM0ODkyOyYjMTIzNTg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzNC4yOTc0IiB4PSIxNzEiIHk9IjQwMS4xMjE2Ij5KYXZhU2NyaXB0ICYjMTI0MzQ7JiMyNjM2MDsmIzEyMzYzOyYjMTIzNzg7JiMxMjM5NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3LjYxNCIgeD0iMTcxIiB5PSI0MTYuMjU0NCI+JiMxMjQ1MjsmIzEyNTMxOyYjMTI0Nzk7JiMxMjUyMTsmIzEyNDYzOyYjMTI0ODY7JiMxMjQ1MTsmIzEyNTAyOyYjMTIzOTQ7IFVJICYjMTI0MzQ7JiMyMzQ1NTsmIzI5Njk0OzwvdGV4dD48IS0tU1JDPVtSTDlCSXE5MTVEeEZoblhTUEkzak5HSE1INGRIOGVDTVJHUVJ6OEJVVW5jNzdabGwzQ1lEV1kyZUhLXzRDWkQ5ZXVZNHdsd09hdmVoX3E4cGVzTDZndmRYVkVUeHAzZFN1WGNBcXBveFpTNngwLTYzc0VsQUlpaWxqNC1Wc2lTRFg0WUlFbW83RzF3M2wwTEgxbDRTbVlJN2Z2WXBiUUNDa09IbkFzY3ZuRU91ZjhiQ0xMejZJekVFcFBjSm9MMWMwQ0ZkQTJvSHRpZEkzMktSUXBSODhvRlAwNWE0LUdaSUR2c3BaQUlvckVPODNJcFdvNkdfR0hJM0YwQ0hRQjJlV3dvMmJFZzJKNTYxWGZlQTZlbDdMaDc2QUFJZVc2V2dfWkx4QkJxVElMNC1lR3hOb1Y0bS1qTVo2QndyWlRIVlRvMEVqVWNRVVVNRGxGQkhHM3pEYVJ5VXZYQUIyX3lHWk9XRW1tdEdEVUZydDkwdFZ4OXpfcUtLcG9tak9jTmJ6bkp4a0pYWEFiZU84VGxYNTNDaGJVUk9zVVlGUWgwMXpTdmtpLUxWV3JUakZMb3F5cFV6THJ5clpsVFVUbktaLWRXQm0yazFMLXZfTlpUX3lYNEtMVTZwazB6VTBTTjk5YmJFQ2lsYk1oenotV0JVN2RXZFFneUdZMmxaRHAxOXJNV0E4NGZ3ZlJtZ05mZE55RFJ6UFVWVzdMNXg3TWp4Tm0wMF0tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<details>
<summary>htmx の基本的な使い方</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- 勘定科目検索（部分更新） --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;mb-3&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text&quot;</span>
           <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-control&quot;</span>
           <span class="na">name</span><span class="o">=</span><span class="s">&quot;keyword&quot;</span>
           <span class="na">placeholder</span><span class="o">=</span><span class="s">&quot;勘定科目コードまたは勘定科目名で検索&quot;</span>
           <span class="na">hx-get</span><span class="o">=</span><span class="s">&quot;/accounts/search&quot;</span>
           <span class="na">hx-trigger</span><span class="o">=</span><span class="s">&quot;keyup changed delay:300ms&quot;</span>
           <span class="na">hx-target</span><span class="o">=</span><span class="s">&quot;#search-results&quot;</span>
           <span class="na">hx-indicator</span><span class="o">=</span><span class="s">&quot;#loading&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;loading&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;htmx-indicator&quot;</span><span class="p">&gt;</span>検索中...<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- 検索結果がここに挿入される --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;search-results&quot;</span><span class="p">&gt;</span>
    <span class="cm">&lt;!-- Controller から返される HTML フラグメント --&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

</details>

<details>
<summary>部分更新用 Controller</summary>

<div class="highlight"><pre><span></span><code><span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// ... コンストラクタ省略</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * htmx 用の検索エンドポイント（フラグメントを返す）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/search&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">searchAccounts</span><span class="p">(</span><span class="n">keyword</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;accounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accounts</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// フラグメントのみを返す</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/search-results :: results&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="229-api-controller">22.9 API サーバー版との Controller の違い<a class="headerlink" href="#229-api-controller" title="Permanent link">&para;</a></h3>
<details>
<summary>API サーバー版（REST Controller）</summary>

<div class="highlight"><pre><span></span><code><span class="nd">@RestController</span><span class="w">  </span><span class="c1">// JSON を返す</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/api/accounts&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountApiController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@GetMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">List</span><span class="o">&lt;</span><span class="n">AccountResponse</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">getAllAccounts</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAllAccounts</span><span class="p">();</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">(</span><span class="n">accounts</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">AccountResponse</span><span class="p">::</span><span class="n">from</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@PostMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="n">AccountResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">createAccount</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Valid</span><span class="w"> </span><span class="nd">@RequestBody</span><span class="w"> </span><span class="n">CreateAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// JSON リクエスト</span>
<span class="w">        </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">createAccount</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">toCommand</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">status</span><span class="p">(</span><span class="n">HttpStatus</span><span class="p">.</span><span class="na">CREATED</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">AccountResponse</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">account</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>モノリス版（MVC Controller）</summary>

<div class="highlight"><pre><span></span><code><span class="nd">@Controller</span><span class="w">  </span><span class="c1">// HTML を返す</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@GetMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAllAccounts</span><span class="p">();</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;accounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accounts</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/list&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// Thymeleaf テンプレート</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@PostMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Valid</span><span class="w"> </span><span class="nd">@ModelAttribute</span><span class="p">(</span><span class="s">&quot;form&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">AccountForm</span><span class="w"> </span><span class="n">form</span><span class="p">,</span><span class="w">  </span><span class="c1">// フォームデータ</span>
<span class="w">            </span><span class="n">BindingResult</span><span class="w"> </span><span class="n">bindingResult</span><span class="p">,</span>
<span class="w">            </span><span class="n">RedirectAttributes</span><span class="w"> </span><span class="n">redirectAttributes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bindingResult</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/new&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// バリデーションエラー時は入力画面に戻る</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">createAccount</span><span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="na">toCommand</span><span class="p">());</span>
<span class="w">        </span><span class="n">redirectAttributes</span><span class="p">.</span><span class="na">addFlashAttribute</span><span class="p">(</span><span class="s">&quot;successMessage&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;勘定科目を登録しました&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;redirect:/accounts&quot;</span><span class="p">;</span><span class="w">  </span><span class="c1">// PRG パターン</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<p><strong>主な違い：</strong></p>
<table>
<thead>
<tr>
<th>観点</th>
<th>API サーバー版</th>
<th>モノリス版</th>
</tr>
</thead>
<tbody>
<tr>
<td>アノテーション</td>
<td><code>@RestController</code></td>
<td><code>@Controller</code></td>
</tr>
<tr>
<td>戻り値</td>
<td><code>ResponseEntity&lt;T&gt;</code></td>
<td>テンプレート名（String）</td>
</tr>
<tr>
<td>リクエスト</td>
<td><code>@RequestBody</code>（JSON）</td>
<td><code>@ModelAttribute</code>（フォーム）</td>
</tr>
<tr>
<td>バリデーション</td>
<td>例外ハンドラで処理</td>
<td><code>BindingResult</code> で処理</td>
</tr>
<tr>
<td>レスポンス</td>
<td>JSON</td>
<td>HTML（Thymeleaf）</td>
</tr>
<tr>
<td>リダイレクト</td>
<td>不要</td>
<td>PRG パターン</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="23">第23章：マスタ画面の実装<a class="headerlink" href="#23" title="Permanent link">&para;</a></h2>
<h3 id="231">23.1 勘定科目マスタ画面の設計<a class="headerlink" href="#231" title="Permanent link">&para;</a></h3>
<h4 id="_2">画面一覧<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>画面</th>
<th>URL</th>
<th>メソッド</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>勘定科目一覧</td>
<td>/accounts</td>
<td>GET</td>
<td>勘定科目の検索・一覧表示</td>
</tr>
<tr>
<td>勘定科目詳細</td>
<td>/accounts/{accountCode}</td>
<td>GET</td>
<td>勘定科目の詳細表示</td>
</tr>
<tr>
<td>勘定科目登録</td>
<td>/accounts/new</td>
<td>GET</td>
<td>登録フォーム表示</td>
</tr>
<tr>
<td>勘定科目登録処理</td>
<td>/accounts</td>
<td>POST</td>
<td>登録処理</td>
</tr>
<tr>
<td>勘定科目編集</td>
<td>/accounts/{accountCode}/edit</td>
<td>GET</td>
<td>編集フォーム表示</td>
</tr>
<tr>
<td>勘定科目更新処理</td>
<td>/accounts/{accountCode}</td>
<td>POST</td>
<td>更新処理（PUT 代替）</td>
</tr>
<tr>
<td>勘定科目削除処理</td>
<td>/accounts/{accountCode}/delete</td>
<td>POST</td>
<td>削除処理（DELETE 代替）</td>
</tr>
</tbody>
</table>
<p><strong>注意</strong>: HTML フォームは GET/POST のみ対応のため、PUT/DELETE は POST で代替します。</p>
<hr />
<h3 id="232">23.2 フォームオブジェクトの設計<a class="headerlink" href="#232" title="Permanent link">&para;</a></h3>
<details>
<summary>AccountForm.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.form</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.CreateAccountCommand</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotBlank</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.Size</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 勘定科目登録・編集フォーム</span>
<span class="cm"> */</span>
<span class="nd">@Data</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountForm</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@NotBlank</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目コードは必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@Size</span><span class="p">(</span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目コードは5文字以内で入力してください&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotBlank</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目名は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@Size</span><span class="p">(</span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目名は40文字以内で入力してください&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountName</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Size</span><span class="p">(</span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目略名は10文字以内で入力してください&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountShortName</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Size</span><span class="p">(</span><span class="n">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">40</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目カナは40文字以内で入力してください&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountNameKana</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;BSPL区分は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BsplType</span><span class="w"> </span><span class="n">bsplType</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;貸借区分は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;取引要素区分は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TransactionElementType</span><span class="w"> </span><span class="n">transactionElementType</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;集計区分は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AggregationType</span><span class="w"> </span><span class="n">aggregationType</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ManagementAccountType</span><span class="w"> </span><span class="n">managementAccountType</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ExpenseType</span><span class="w"> </span><span class="n">expenseType</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">SubsidiaryType</span><span class="w"> </span><span class="n">subsidiaryType</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TaxCalculationType</span><span class="w"> </span><span class="n">taxCalculationType</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">taxTransactionCode</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * フォームをコマンドに変換</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">CreateAccountCommand</span><span class="w"> </span><span class="nf">toCommand</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">CreateAccountCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">accountCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">accountName</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountShortName</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">accountShortName</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountNameKana</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">accountNameKana</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">bsplType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">bsplType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">transactionElementType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">transactionElementType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">aggregationType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">aggregationType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">managementAccountType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">managementAccountType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">expenseType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">expenseType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">subsidiaryType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">subsidiaryType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">taxCalculationType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">taxCalculationType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">taxTransactionCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">taxTransactionCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * エンティティからフォームを生成</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">AccountForm</span><span class="w"> </span><span class="nf">from</span><span class="p">(</span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AccountForm</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AccountForm</span><span class="p">();</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setAccountCode</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setAccountName</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setAccountShortName</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getAccountShortName</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setAccountNameKana</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getAccountNameKana</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setBsplType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setDebitCreditType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setTransactionElementType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getTransactionElementType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setAggregationType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getAggregationType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setManagementAccountType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getManagementAccountType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setExpenseType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getExpenseType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setSubsidiaryType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getSubsidiaryType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setTaxCalculationType</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getTaxCalculationType</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setTaxTransactionCode</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getTaxTransactionCode</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">form</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="233-controller-tdd">23.3 勘定科目 Controller の TDD 実装<a class="headerlink" href="#233-controller-tdd" title="Permanent link">&para;</a></h3>
<h4 id="red">Red: 失敗するテストを書く<a class="headerlink" href="#red" title="Permanent link">&para;</a></h4>
<details>
<summary>AccountControllerTest.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.controller</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.persistence.mapper.AccountMapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertyRegistry</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.DynamicPropertySource</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.web.servlet.MockMvc</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.containers.PostgreSQLContainer</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Container</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.testcontainers.junit.jupiter.Testcontainers</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.hamcrest.Matchers.*</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.springframework.test.web.servlet.request.MockMvcRequestBuilders.*</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.springframework.test.web.servlet.result.MockMvcResultMatchers.*</span><span class="p">;</span>

<span class="nd">@SpringBootTest</span>
<span class="nd">@AutoConfigureMockMvc</span>
<span class="nd">@Testcontainers</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目マスタ画面&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">AccountControllerTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Container</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">postgres</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PostgreSQLContainer</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="s">&quot;postgres:16&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withDatabaseName</span><span class="p">(</span><span class="s">&quot;accounting_test&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withUsername</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">withPassword</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@DynamicPropertySource</span>
<span class="w">    </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureProperties</span><span class="p">(</span><span class="n">DynamicPropertyRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.url&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getJdbcUrl</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.username&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getUsername</span><span class="p">);</span>
<span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;spring.datasource.password&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">postgres</span><span class="p">::</span><span class="n">getPassword</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">MockMvc</span><span class="w"> </span><span class="n">mockMvc</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AccountMapper</span><span class="w"> </span><span class="n">accountMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">accountMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;GET /accounts - 勘定科目一覧&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">AccountList</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目一覧画面を表示できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldDisplayAccountList</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="n">insertTestAccount</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;現金&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BsplType</span><span class="p">.</span><span class="na">BS</span><span class="p">,</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act &amp; Assert</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">view</span><span class="p">().</span><span class="na">name</span><span class="p">(</span><span class="s">&quot;accounts/list&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">model</span><span class="p">().</span><span class="na">attributeExists</span><span class="p">(</span><span class="s">&quot;accounts&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">content</span><span class="p">().</span><span class="na">string</span><span class="p">(</span><span class="n">containsString</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">)))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">content</span><span class="p">().</span><span class="na">string</span><span class="p">(</span><span class="n">containsString</span><span class="p">(</span><span class="s">&quot;現金&quot;</span><span class="p">)));</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;BSPL区分でフィルタリングできる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldFilterByBsplType</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="n">insertTestAccount</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;現金&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BsplType</span><span class="p">.</span><span class="na">BS</span><span class="p">,</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">);</span>
<span class="w">            </span><span class="n">insertTestAccount</span><span class="p">(</span><span class="s">&quot;41100&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;売上高&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BsplType</span><span class="p">.</span><span class="na">PL</span><span class="p">,</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act &amp; Assert</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">).</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;bsplType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BS&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">model</span><span class="p">().</span><span class="na">attribute</span><span class="p">(</span><span class="s">&quot;accounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">hasSize</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">content</span><span class="p">().</span><span class="na">string</span><span class="p">(</span><span class="n">containsString</span><span class="p">(</span><span class="s">&quot;現金&quot;</span><span class="p">)))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">content</span><span class="p">().</span><span class="na">string</span><span class="p">(</span><span class="n">not</span><span class="p">(</span><span class="n">containsString</span><span class="p">(</span><span class="s">&quot;売上高&quot;</span><span class="p">))));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;POST /accounts - 勘定科目登録処理&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">CreateAccount</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目を登録できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldCreateAccount</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">post</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;accountCode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;11120&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;accountName&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;当座預金&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;bsplType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BS&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;debitCreditType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;DEBIT&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;transactionElementType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;ASSET&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;aggregationType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POSTING&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">is3xxRedirection</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">redirectedUrl</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">flash</span><span class="p">().</span><span class="na">attribute</span><span class="p">(</span><span class="s">&quot;successMessage&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">containsString</span><span class="p">(</span><span class="s">&quot;登録&quot;</span><span class="p">)));</span>

<span class="w">            </span><span class="c1">// データベースに保存されていることを確認</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">saved</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountMapper</span><span class="p">.</span><span class="na">findByCode</span><span class="p">(</span><span class="s">&quot;11120&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">Assertions</span><span class="p">.</span><span class="na">assertNotNull</span><span class="p">(</span><span class="n">saved</span><span class="p">);</span>
<span class="w">            </span><span class="n">Assertions</span><span class="p">.</span><span class="na">assertEquals</span><span class="p">(</span><span class="s">&quot;当座預金&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">saved</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;バリデーションエラー時は入力画面に戻る&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldReturnFormOnValidationError</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">mockMvc</span><span class="p">.</span><span class="na">perform</span><span class="p">(</span><span class="n">post</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;accountCode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 必須項目が空</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;accountName&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">param</span><span class="p">(</span><span class="s">&quot;bsplType&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;BS&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">status</span><span class="p">().</span><span class="na">isOk</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">view</span><span class="p">().</span><span class="na">name</span><span class="p">(</span><span class="s">&quot;accounts/new&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">andExpect</span><span class="p">(</span><span class="n">model</span><span class="p">().</span><span class="na">attributeHasFieldErrors</span><span class="p">(</span><span class="s">&quot;form&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;accountCode&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;accountName&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">insertTestAccount</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">code</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">BsplType</span><span class="w"> </span><span class="n">bsplType</span><span class="p">,</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">accountMapper</span><span class="p">.</span><span class="na">insert</span><span class="p">(</span><span class="n">Account</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountShortName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountNameKana</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">bsplType</span><span class="p">(</span><span class="n">bsplType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">debitCreditType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">transactionElementType</span><span class="p">(</span><span class="n">TransactionElementType</span><span class="p">.</span><span class="na">ASSET</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">aggregationType</span><span class="p">(</span><span class="n">AggregationType</span><span class="p">.</span><span class="na">POSTING</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="green-controller">Green: Controller の実装<a class="headerlink" href="#green-controller" title="Permanent link">&para;</a></h4>
<details>
<summary>AccountController.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.controller</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.AccountInUseException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.AccountNotFoundException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.DuplicateAccountException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.form.AccountForm</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.servlet.mvc.support.RedirectAttributes</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 勘定科目マスタ Controller</span>
<span class="cm"> */</span>
<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/accounts&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">AccountController</span><span class="p">(</span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">accountUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目一覧画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">BsplType</span><span class="w"> </span><span class="n">bsplType</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="p">;</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">keyword</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">bsplType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">debitCreditType</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">searchAccounts</span><span class="p">(</span><span class="n">keyword</span><span class="p">,</span><span class="w"> </span><span class="n">bsplType</span><span class="p">,</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAllAccounts</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;accounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accounts</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;keyword&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;selectedBsplType&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">bsplType</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;selectedDebitCreditType&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">);</span>
<span class="w">        </span><span class="n">addEnumsToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/list&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目登録画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/new&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">newForm</span><span class="p">(</span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;form&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AccountForm</span><span class="p">());</span>
<span class="w">        </span><span class="n">addEnumsToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/new&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目登録処理</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@PostMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Valid</span><span class="w"> </span><span class="nd">@ModelAttribute</span><span class="p">(</span><span class="s">&quot;form&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">AccountForm</span><span class="w"> </span><span class="n">form</span><span class="p">,</span>
<span class="w">            </span><span class="n">BindingResult</span><span class="w"> </span><span class="n">bindingResult</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<span class="w">            </span><span class="n">RedirectAttributes</span><span class="w"> </span><span class="n">redirectAttributes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bindingResult</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">addEnumsToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/new&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">createAccount</span><span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="na">toCommand</span><span class="p">());</span>
<span class="w">            </span><span class="n">redirectAttributes</span><span class="p">.</span><span class="na">addFlashAttribute</span><span class="p">(</span><span class="s">&quot;successMessage&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;勘定科目「&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">form</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;」を登録しました&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;redirect:/accounts&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">DuplicateAccountException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;errorMessage&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;勘定科目コード「&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">form</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;」は既に存在します&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">addEnumsToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/new&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目詳細画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/{accountCode}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">detail</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAccount</span><span class="p">(</span><span class="n">accountCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AccountNotFoundException</span><span class="p">(</span><span class="n">accountCode</span><span class="p">));</span>

<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;account&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">account</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/detail&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目削除処理</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">&quot;/{accountCode}/delete&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<span class="w">            </span><span class="n">RedirectAttributes</span><span class="w"> </span><span class="n">redirectAttributes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAccount</span><span class="p">(</span><span class="n">accountCode</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AccountNotFoundException</span><span class="p">(</span><span class="n">accountCode</span><span class="p">));</span>

<span class="w">            </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">deleteAccount</span><span class="p">(</span><span class="n">accountCode</span><span class="p">);</span>
<span class="w">            </span><span class="n">redirectAttributes</span><span class="p">.</span><span class="na">addFlashAttribute</span><span class="p">(</span><span class="s">&quot;successMessage&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;勘定科目「&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">account</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;」を削除しました&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;redirect:/accounts&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">AccountInUseException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAccount</span><span class="p">(</span><span class="n">accountCode</span><span class="p">).</span><span class="na">orElseThrow</span><span class="p">();</span>
<span class="w">            </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;account&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">account</span><span class="p">);</span>
<span class="w">            </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;errorMessage&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;この勘定科目は仕訳で使用中のため削除できません&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;accounts/detail&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 列挙型をモデルに追加</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addEnumsToModel</span><span class="p">(</span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;bsplTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">BsplType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;debitCreditTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;transactionElementTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">TransactionElementType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;aggregationTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">AggregationType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;managementAccountTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ManagementAccountType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;expenseTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ExpenseType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;subsidiaryTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SubsidiaryType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;taxCalculationTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">TaxCalculationType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 404 エラーハンドリング</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@ExceptionHandler</span><span class="p">(</span><span class="n">AccountNotFoundException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@ResponseStatus</span><span class="p">(</span><span class="n">org</span><span class="p">.</span><span class="na">springframework</span><span class="p">.</span><span class="na">http</span><span class="p">.</span><span class="na">HttpStatus</span><span class="p">.</span><span class="na">NOT_FOUND</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">handleNotFound</span><span class="p">(</span><span class="n">AccountNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;errorMessage&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;error/404&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="24">第24章：仕訳入力画面の実装<a class="headerlink" href="#24" title="Permanent link">&para;</a></h2>
<h3 id="241">24.1 仕訳入力画面の設計<a class="headerlink" href="#241" title="Permanent link">&para;</a></h3>
<h4 id="_3">画面一覧<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>画面</th>
<th>URL</th>
<th>メソッド</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>仕訳一覧</td>
<td>/journals</td>
<td>GET</td>
<td>仕訳の検索・一覧表示</td>
</tr>
<tr>
<td>仕訳詳細</td>
<td>/journals/{journalNumber}</td>
<td>GET</td>
<td>仕訳の詳細表示</td>
</tr>
<tr>
<td>仕訳入力</td>
<td>/journals/new</td>
<td>GET</td>
<td>入力フォーム表示</td>
</tr>
<tr>
<td>仕訳登録処理</td>
<td>/journals</td>
<td>POST</td>
<td>登録処理</td>
</tr>
<tr>
<td>仕訳取消</td>
<td>/journals/{journalNumber}/cancel</td>
<td>POST</td>
<td>赤黒処理</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="242">24.2 仕訳入力フォームオブジェクト<a class="headerlink" href="#242" title="Permanent link">&para;</a></h3>
<details>
<summary>JournalForm.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.form</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.CreateJournalCommand</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.journal.SingleComplexType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotEmpty</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 仕訳入力フォーム</span>
<span class="cm"> */</span>
<span class="nd">@Data</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalForm</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;起票日は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">journalDate</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">description</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">closingJournal</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;単複区分は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">SingleComplexType</span><span class="w"> </span><span class="n">singleComplexType</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Valid</span>
<span class="w">    </span><span class="nd">@NotEmpty</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;仕訳明細は1行以上必要です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">JournalLineForm</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * フォームをコマンドに変換</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">CreateJournalCommand</span><span class="w"> </span><span class="nf">toCommand</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">CreateJournalCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalDate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">journalDate</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">description</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">closingJournal</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">closingJournal</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">singleComplexType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">singleComplexType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lines</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">lines</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">JournalLineForm</span><span class="p">::</span><span class="n">toCommand</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">toList</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 初期化（空の明細行を追加）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">initializeLines</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">lines</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// 借方1行、貸方1行を追加</span>
<span class="w">            </span><span class="n">JournalLineForm</span><span class="w"> </span><span class="n">debitLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JournalLineForm</span><span class="p">();</span>
<span class="w">            </span><span class="n">debitLine</span><span class="p">.</span><span class="na">setDebitCredit</span><span class="p">(</span><span class="s">&quot;DEBIT&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lines</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">debitLine</span><span class="p">);</span>

<span class="w">            </span><span class="n">JournalLineForm</span><span class="w"> </span><span class="n">creditLine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JournalLineForm</span><span class="p">();</span>
<span class="w">            </span><span class="n">creditLine</span><span class="p">.</span><span class="na">setDebitCredit</span><span class="p">(</span><span class="s">&quot;CREDIT&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">lines</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">creditLine</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>JournalLineForm.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.form</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.CreateJournalLineCommand</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotBlank</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.NotNull</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.constraints.Positive</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 仕訳明細行フォーム</span>
<span class="cm"> */</span>
<span class="nd">@Data</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalLineForm</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@NotBlank</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;貸借区分は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">debitCredit</span><span class="p">;</span><span class="w">  </span><span class="c1">// &quot;DEBIT&quot; or &quot;CREDIT&quot;</span>

<span class="w">    </span><span class="nd">@NotBlank</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;勘定科目コードは必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">subsidiaryCode</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@NotNull</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;金額は必須です&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nd">@Positive</span><span class="p">(</span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;金額は正の数で入力してください&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">taxType</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">taxRate</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">projectCode</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">lineDescription</span><span class="p">;</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * フォームをコマンドに変換</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">CreateJournalLineCommand</span><span class="w"> </span><span class="nf">toCommand</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">CreateJournalLineCommand</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCredit</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">debitCredit</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">accountCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">subsidiaryCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">subsidiaryCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">amount</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">taxType</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">taxType</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">taxRate</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">taxRate</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">departmentCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">departmentCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">projectCode</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">projectCode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineDescription</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">lineDescription</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="243-controller">24.3 仕訳 Controller の実装<a class="headerlink" href="#243-controller" title="Permanent link">&para;</a></h3>
<details>
<summary>JournalController.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.controller</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.DebitCreditImbalanceException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.JournalNotFoundException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.journal.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.form.JournalForm</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jakarta.validation.Valid</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.format.annotation.DateTimeFormat</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.validation.BindingResult</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.servlet.mvc.support.RedirectAttributes</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 仕訳 Controller</span>
<span class="cm"> */</span>
<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/journals&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">JournalUseCase</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">DepartmentUseCase</span><span class="w"> </span><span class="n">departmentUseCase</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">JournalController</span><span class="p">(</span>
<span class="w">            </span><span class="n">JournalUseCase</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">,</span>
<span class="w">            </span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">,</span>
<span class="w">            </span><span class="n">DepartmentUseCase</span><span class="w"> </span><span class="n">departmentUseCase</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">journalUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">accountUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">departmentUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">departmentUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 仕訳一覧画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">JournalStatus</span><span class="w"> </span><span class="n">status</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// デフォルトは当月</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fromDate</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">fromDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">().</span><span class="na">withDayOfMonth</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">toDate</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">toDate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">journals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">searchJournals</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">,</span><span class="w"> </span><span class="n">accountCode</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>

<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;journals&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">journals</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;fromDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">fromDate</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;toDate&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;accountCode&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accountCode</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;status&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;statuses&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">JournalStatus</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;journals/list&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 仕訳入力画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/new&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">newForm</span><span class="p">(</span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">JournalForm</span><span class="w"> </span><span class="n">form</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JournalForm</span><span class="p">();</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setJournalDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">());</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">setSingleComplexType</span><span class="p">(</span><span class="n">SingleComplexType</span><span class="p">.</span><span class="na">SINGLE</span><span class="p">);</span>
<span class="w">        </span><span class="n">form</span><span class="p">.</span><span class="na">initializeLines</span><span class="p">();</span>

<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;form&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="p">);</span>
<span class="w">        </span><span class="n">addMasterDataToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;journals/new&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 仕訳登録処理</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@PostMapping</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@Valid</span><span class="w"> </span><span class="nd">@ModelAttribute</span><span class="p">(</span><span class="s">&quot;form&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">JournalForm</span><span class="w"> </span><span class="n">form</span><span class="p">,</span>
<span class="w">            </span><span class="n">BindingResult</span><span class="w"> </span><span class="n">bindingResult</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">,</span>
<span class="w">            </span><span class="n">RedirectAttributes</span><span class="w"> </span><span class="n">redirectAttributes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bindingResult</span><span class="p">.</span><span class="na">hasErrors</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">addMasterDataToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;journals/new&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">createJournal</span><span class="p">(</span><span class="n">form</span><span class="p">.</span><span class="na">toCommand</span><span class="p">());</span>
<span class="w">            </span><span class="n">redirectAttributes</span><span class="p">.</span><span class="na">addFlashAttribute</span><span class="p">(</span><span class="s">&quot;successMessage&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;仕訳「&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">journal</span><span class="p">.</span><span class="na">getJournalNumber</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;」を登録しました&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;redirect:/journals/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">journal</span><span class="p">.</span><span class="na">getJournalNumber</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">DebitCreditImbalanceException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;errorMessage&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借方・貸方の合計が一致しません&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">addMasterDataToModel</span><span class="p">(</span><span class="n">model</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;journals/new&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 仕訳詳細画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/{journalNumber}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">detail</span><span class="p">(</span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">journalNumber</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">getJournal</span><span class="p">(</span><span class="n">journalNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">JournalNotFoundException</span><span class="p">(</span><span class="n">journalNumber</span><span class="p">));</span>

<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">journal</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;journals/detail&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 仕訳取消処理（赤黒処理）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">&quot;/{journalNumber}/cancel&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">cancel</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@PathVariable</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">journalNumber</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">reason</span><span class="p">,</span>
<span class="w">            </span><span class="n">RedirectAttributes</span><span class="w"> </span><span class="n">redirectAttributes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">Journal</span><span class="w"> </span><span class="n">cancelJournal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">cancelJournal</span><span class="p">(</span><span class="n">journalNumber</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="p">);</span>
<span class="w">        </span><span class="n">redirectAttributes</span><span class="p">.</span><span class="na">addFlashAttribute</span><span class="p">(</span><span class="s">&quot;successMessage&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="s">&quot;仕訳「&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">journalNumber</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;」を取消しました。&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">            </span><span class="s">&quot;取消仕訳「&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cancelJournal</span><span class="p">.</span><span class="na">getJournalNumber</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;」を作成しました。&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;redirect:/journals/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">cancelJournal</span><span class="p">.</span><span class="na">getJournalNumber</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * マスタデータをモデルに追加</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addMasterDataToModel</span><span class="p">(</span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;accounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getPostingAccounts</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;departments&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">departmentUseCase</span><span class="p">.</span><span class="na">getAllDepartments</span><span class="p">());</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;singleComplexTypes&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">SingleComplexType</span><span class="p">.</span><span class="na">values</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="25">第25章：帳票出力の実装<a class="headerlink" href="#25" title="Permanent link">&para;</a></h2>
<h3 id="251">25.1 帳票出力の設計<a class="headerlink" href="#251" title="Permanent link">&para;</a></h3>
<p>財務会計システムでは、以下の帳票を出力します。</p>
<table>
<thead>
<tr>
<th>帳票名</th>
<th>説明</th>
<th>出力形式</th>
</tr>
</thead>
<tbody>
<tr>
<td>日計表</td>
<td>日次の仕訳合計</td>
<td>HTML / Excel / PDF</td>
</tr>
<tr>
<td>合計残高試算表</td>
<td>月次の勘定科目残高</td>
<td>HTML / Excel / PDF</td>
</tr>
<tr>
<td>総勘定元帳</td>
<td>勘定科目別の仕訳明細</td>
<td>HTML / Excel / PDF</td>
</tr>
<tr>
<td>貸借対照表</td>
<td>資産・負債・資本の状況</td>
<td>HTML / Excel / PDF</td>
</tr>
<tr>
<td>損益計算書</td>
<td>収益・費用の状況</td>
<td>HTML / Excel / PDF</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="252-controller">25.2 帳票 Controller の実装<a class="headerlink" href="#252-controller" title="Permanent link">&para;</a></h3>
<details>
<summary>ReportController.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.web.controller</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.report.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.report.ExcelReportGenerator</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.report.PdfReportGenerator</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.format.annotation.DateTimeFormat</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.http.HttpHeaders</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.http.MediaType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.http.ResponseEntity</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.*</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.YearMonth</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 帳票出力 Controller</span>
<span class="cm"> */</span>
<span class="nd">@Controller</span>
<span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&quot;/reports&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ReportController</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ReportUseCase</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ExcelReportGenerator</span><span class="w"> </span><span class="n">excelGenerator</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">PdfReportGenerator</span><span class="w"> </span><span class="n">pdfGenerator</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">ReportController</span><span class="p">(</span>
<span class="w">            </span><span class="n">ReportUseCase</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">,</span>
<span class="w">            </span><span class="n">ExcelReportGenerator</span><span class="w"> </span><span class="n">excelGenerator</span><span class="p">,</span>
<span class="w">            </span><span class="n">PdfReportGenerator</span><span class="w"> </span><span class="n">pdfGenerator</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">reportUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">excelGenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">excelGenerator</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">pdfGenerator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdfGenerator</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 日計表画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/daily&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">dailyReport</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">DailyReport</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getDailyReport</span><span class="p">(</span><span class="n">date</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;report&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">report</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">date</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;reports/daily&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 日計表 Excel 出力</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/daily/excel&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="nf">dailyReportExcel</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">DailyReport</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getDailyReport</span><span class="p">(</span><span class="n">date</span><span class="p">);</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">excelData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">excelGenerator</span><span class="p">.</span><span class="na">generateDailyReport</span><span class="p">(</span><span class="n">report</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">HttpHeaders</span><span class="p">.</span><span class="na">CONTENT_DISPOSITION</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;attachment; filename=\&quot;daily_report_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;.xlsx\&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">parseMediaType</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">excelData</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 日計表 PDF 出力</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/daily/pdf&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="nf">dailyReportPdf</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">DailyReport</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getDailyReport</span><span class="p">(</span><span class="n">date</span><span class="p">);</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">pdfData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pdfGenerator</span><span class="p">.</span><span class="na">generateDailyReport</span><span class="p">(</span><span class="n">report</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">HttpHeaders</span><span class="p">.</span><span class="na">CONTENT_DISPOSITION</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;attachment; filename=\&quot;daily_report_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;.pdf\&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_PDF</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">pdfData</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 合計残高試算表画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/trial-balance&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">trialBalance</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">YearMonth</span><span class="w"> </span><span class="n">yearMonth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">month</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">),</span><span class="w"> </span><span class="n">month</span><span class="p">)</span>
<span class="w">            </span><span class="p">:</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>

<span class="w">        </span><span class="n">TrialBalance</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getTrialBalance</span><span class="p">(</span><span class="n">yearMonth</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;report&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">report</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;yearMonth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">yearMonth</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;reports/trial-balance&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 合計残高試算表 Excel 出力</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/trial-balance/excel&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="o">&lt;</span><span class="kt">byte</span><span class="o">[]&gt;</span><span class="w"> </span><span class="nf">trialBalanceExcel</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">month</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">YearMonth</span><span class="w"> </span><span class="n">yearMonth</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">),</span><span class="w"> </span><span class="n">month</span><span class="p">);</span>
<span class="w">        </span><span class="n">TrialBalance</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getTrialBalance</span><span class="p">(</span><span class="n">yearMonth</span><span class="p">);</span>
<span class="w">        </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="n">excelData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">excelGenerator</span><span class="p">.</span><span class="na">generateTrialBalance</span><span class="p">(</span><span class="n">report</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ResponseEntity</span><span class="p">.</span><span class="na">ok</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">header</span><span class="p">(</span><span class="n">HttpHeaders</span><span class="p">.</span><span class="na">CONTENT_DISPOSITION</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;attachment; filename=\&quot;trial_balance_&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">yearMonth</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;.xlsx\&quot;&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">contentType</span><span class="p">(</span><span class="n">MediaType</span><span class="p">.</span><span class="na">parseMediaType</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;application/vnd.openxmlformats-officedocument.spreadsheetml.sheet&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">body</span><span class="p">(</span><span class="n">excelData</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 貸借対照表画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/balance-sheet&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">balanceSheet</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="nd">@DateTimeFormat</span><span class="p">(</span><span class="n">iso</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DateTimeFormat</span><span class="p">.</span><span class="na">ISO</span><span class="p">.</span><span class="na">DATE</span><span class="p">)</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">date</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">date</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="n">BalanceSheet</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getBalanceSheet</span><span class="p">(</span><span class="n">date</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;report&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">report</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;date&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">date</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;reports/balance-sheet&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 損益計算書画面</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/income-statement&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">incomeStatement</span><span class="p">(</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">fiscalYear</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">fromMonth</span><span class="p">,</span>
<span class="w">            </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">toMonth</span><span class="p">,</span>
<span class="w">            </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">YearMonth</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">fromMonth</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">),</span><span class="w"> </span><span class="n">fromMonth</span><span class="p">)</span>
<span class="w">            </span><span class="p">:</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">now</span><span class="p">().</span><span class="na">withMonth</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span><span class="w">  </span><span class="c1">// 期首（4月）</span>

<span class="w">        </span><span class="n">YearMonth</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">fiscalYear</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">toMonth</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="o">?</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">fiscalYear</span><span class="p">),</span><span class="w"> </span><span class="n">toMonth</span><span class="p">)</span>
<span class="w">            </span><span class="p">:</span><span class="w"> </span><span class="n">YearMonth</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>

<span class="w">        </span><span class="n">IncomeStatement</span><span class="w"> </span><span class="n">report</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reportUseCase</span><span class="p">.</span><span class="na">getIncomeStatement</span><span class="p">(</span><span class="n">from</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;report&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">report</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;fromMonth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;toMonth&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">to</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;reports/income-statement&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="253-excel">25.3 Excel 帳票生成<a class="headerlink" href="#253-excel" title="Permanent link">&para;</a></h3>
<details>
<summary>ExcelReportGenerator.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.report</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.report.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.poi.ss.usermodel.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.poi.ss.util.CellRangeAddress</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.poi.xssf.usermodel.XSSFWorkbook</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.ByteArrayOutputStream</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.format.DateTimeFormatter</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Excel 帳票生成</span>
<span class="cm"> */</span>
<span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ExcelReportGenerator</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 日計表 Excel 生成</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">generateDailyReport</span><span class="p">(</span><span class="n">DailyReport</span><span class="w"> </span><span class="n">report</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Workbook</span><span class="w"> </span><span class="n">workbook</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">XSSFWorkbook</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Sheet</span><span class="w"> </span><span class="n">sheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workbook</span><span class="p">.</span><span class="na">createSheet</span><span class="p">(</span><span class="s">&quot;日計表&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// スタイル設定</span>
<span class="w">            </span><span class="n">CellStyle</span><span class="w"> </span><span class="n">headerStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createHeaderStyle</span><span class="p">(</span><span class="n">workbook</span><span class="p">);</span>
<span class="w">            </span><span class="n">CellStyle</span><span class="w"> </span><span class="n">amountStyle</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createAmountStyle</span><span class="p">(</span><span class="n">workbook</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// タイトル</span>
<span class="w">            </span><span class="n">Row</span><span class="w"> </span><span class="n">titleRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">Cell</span><span class="w"> </span><span class="n">titleCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">titleRow</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">            </span><span class="n">titleCell</span><span class="p">.</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&quot;日 計 表&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">sheet</span><span class="p">.</span><span class="na">addMergedRegion</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">CellRangeAddress</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">));</span>

<span class="w">            </span><span class="c1">// 日付</span>
<span class="w">            </span><span class="n">Row</span><span class="w"> </span><span class="n">dateRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">            </span><span class="n">dateRow</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span>
<span class="w">                </span><span class="n">report</span><span class="p">.</span><span class="na">getDate</span><span class="p">().</span><span class="na">format</span><span class="p">(</span><span class="n">DateTimeFormatter</span><span class="p">.</span><span class="na">ofPattern</span><span class="p">(</span><span class="s">&quot;yyyy年MM月dd日&quot;</span><span class="p">)));</span>

<span class="w">            </span><span class="c1">// ヘッダー</span>
<span class="w">            </span><span class="n">Row</span><span class="w"> </span><span class="n">headerRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">            </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;勘定科目コード&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;勘定科目名&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;借方金額&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;貸方金額&quot;</span><span class="p">};</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">headers</span><span class="p">.</span><span class="na">length</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Cell</span><span class="w"> </span><span class="n">cell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">headerRow</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">                </span><span class="n">cell</span><span class="p">.</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">headers</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">);</span>
<span class="w">                </span><span class="n">cell</span><span class="p">.</span><span class="na">setCellStyle</span><span class="p">(</span><span class="n">headerStyle</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// データ行</span>
<span class="w">            </span><span class="kt">int</span><span class="w"> </span><span class="n">rowNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">DailyReportLine</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">report</span><span class="p">.</span><span class="na">getLines</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Row</span><span class="w"> </span><span class="n">row</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="n">rowNum</span><span class="o">++</span><span class="p">);</span>
<span class="w">                </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>
<span class="w">                </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">());</span>

<span class="w">                </span><span class="n">Cell</span><span class="w"> </span><span class="n">debitCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">                </span><span class="n">debitCell</span><span class="p">.</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">getDebitAmount</span><span class="p">().</span><span class="na">doubleValue</span><span class="p">());</span>
<span class="w">                </span><span class="n">debitCell</span><span class="p">.</span><span class="na">setCellStyle</span><span class="p">(</span><span class="n">amountStyle</span><span class="p">);</span>

<span class="w">                </span><span class="n">Cell</span><span class="w"> </span><span class="n">creditCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">row</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">                </span><span class="n">creditCell</span><span class="p">.</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">line</span><span class="p">.</span><span class="na">getCreditAmount</span><span class="p">().</span><span class="na">doubleValue</span><span class="p">());</span>
<span class="w">                </span><span class="n">creditCell</span><span class="p">.</span><span class="na">setCellStyle</span><span class="p">(</span><span class="n">amountStyle</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// 合計行</span>
<span class="w">            </span><span class="n">Row</span><span class="w"> </span><span class="n">totalRow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sheet</span><span class="p">.</span><span class="na">createRow</span><span class="p">(</span><span class="n">rowNum</span><span class="p">);</span>
<span class="w">            </span><span class="n">totalRow</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="na">setCellValue</span><span class="p">(</span><span class="s">&quot;合計&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="n">Cell</span><span class="w"> </span><span class="n">totalDebitCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalRow</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">            </span><span class="n">totalDebitCell</span><span class="p">.</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">report</span><span class="p">.</span><span class="na">getTotalDebit</span><span class="p">().</span><span class="na">doubleValue</span><span class="p">());</span>
<span class="w">            </span><span class="n">totalDebitCell</span><span class="p">.</span><span class="na">setCellStyle</span><span class="p">(</span><span class="n">amountStyle</span><span class="p">);</span>

<span class="w">            </span><span class="n">Cell</span><span class="w"> </span><span class="n">totalCreditCell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalRow</span><span class="p">.</span><span class="na">createCell</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
<span class="w">            </span><span class="n">totalCreditCell</span><span class="p">.</span><span class="na">setCellValue</span><span class="p">(</span><span class="n">report</span><span class="p">.</span><span class="na">getTotalCredit</span><span class="p">().</span><span class="na">doubleValue</span><span class="p">());</span>
<span class="w">            </span><span class="n">totalCreditCell</span><span class="p">.</span><span class="na">setCellStyle</span><span class="p">(</span><span class="n">amountStyle</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// 列幅調整</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">sheet</span><span class="p">.</span><span class="na">autoSizeColumn</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">ByteArrayOutputStream</span><span class="w"> </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteArrayOutputStream</span><span class="p">();</span>
<span class="w">            </span><span class="n">workbook</span><span class="p">.</span><span class="na">write</span><span class="p">(</span><span class="n">out</span><span class="p">);</span>
<span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="n">out</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="s">&quot;Excel 生成エラー&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CellStyle</span><span class="w"> </span><span class="nf">createHeaderStyle</span><span class="p">(</span><span class="n">Workbook</span><span class="w"> </span><span class="n">workbook</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">CellStyle</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workbook</span><span class="p">.</span><span class="na">createCellStyle</span><span class="p">();</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setFillForegroundColor</span><span class="p">(</span><span class="n">IndexedColors</span><span class="p">.</span><span class="na">GREY_25_PERCENT</span><span class="p">.</span><span class="na">getIndex</span><span class="p">());</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setFillPattern</span><span class="p">(</span><span class="n">FillPatternType</span><span class="p">.</span><span class="na">SOLID_FOREGROUND</span><span class="p">);</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setBorderBottom</span><span class="p">(</span><span class="n">BorderStyle</span><span class="p">.</span><span class="na">THIN</span><span class="p">);</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setBorderTop</span><span class="p">(</span><span class="n">BorderStyle</span><span class="p">.</span><span class="na">THIN</span><span class="p">);</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setBorderLeft</span><span class="p">(</span><span class="n">BorderStyle</span><span class="p">.</span><span class="na">THIN</span><span class="p">);</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setBorderRight</span><span class="p">(</span><span class="n">BorderStyle</span><span class="p">.</span><span class="na">THIN</span><span class="p">);</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setAlignment</span><span class="p">(</span><span class="n">HorizontalAlignment</span><span class="p">.</span><span class="na">CENTER</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">style</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">CellStyle</span><span class="w"> </span><span class="nf">createAmountStyle</span><span class="p">(</span><span class="n">Workbook</span><span class="w"> </span><span class="n">workbook</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">CellStyle</span><span class="w"> </span><span class="n">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workbook</span><span class="p">.</span><span class="na">createCellStyle</span><span class="p">();</span>
<span class="w">        </span><span class="n">DataFormat</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">workbook</span><span class="p">.</span><span class="na">createDataFormat</span><span class="p">();</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setDataFormat</span><span class="p">(</span><span class="n">format</span><span class="p">.</span><span class="na">getFormat</span><span class="p">(</span><span class="s">&quot;#,##0&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">style</span><span class="p">.</span><span class="na">setAlignment</span><span class="p">(</span><span class="n">HorizontalAlignment</span><span class="p">.</span><span class="na">RIGHT</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">style</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="26">第26章：ページネーションの実装<a class="headerlink" href="#26" title="Permanent link">&para;</a></h2>
<h3 id="261">26.1 ページネーションの設計<a class="headerlink" href="#261" title="Permanent link">&para;</a></h3>
<p>一覧画面でデータ量が多い場合、すべてのデータを一度に表示するとパフォーマンスが低下します。ページネーションを実装して、データを分割して表示します。</p>
<table>
<thead>
<tr>
<th>要素</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>PageResult<T></strong></td>
<td>ページネーション結果を表す汎用クラス</td>
</tr>
<tr>
<td><strong>LIMIT/OFFSET</strong></td>
<td>SQL でのページ分割</td>
</tr>
<tr>
<td><strong>表示件数</strong></td>
<td>ユーザーが選択可能（10/25/50/100件）</td>
</tr>
<tr>
<td><strong>ページナビゲーション</strong></td>
<td>最初/前/ページ番号/次/最後</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="262-pageresult">26.2 PageResult クラス<a class="headerlink" href="#262-pageresult" title="Permanent link">&para;</a></h3>
<details>
<summary>PageResult.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.sms.domain.model.common</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * ページネーション結果を表す汎用クラス.</span>
<span class="cm"> *</span>
<span class="cm"> * @param &lt;T&gt; コンテンツの型</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PageResult</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">content</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">totalElements</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">totalPages</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">PageResult</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">content</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="n">totalElements</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">content</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">page</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">totalElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">totalElements</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">totalPages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">Math</span><span class="p">.</span><span class="na">ceil</span><span class="p">((</span><span class="kt">double</span><span class="p">)</span><span class="w"> </span><span class="n">totalElements</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">size</span><span class="p">)</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getContent</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">content</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getPage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">page</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getSize</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">long</span><span class="w"> </span><span class="nf">getTotalElements</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">totalElements</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">getTotalPages</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">totalPages</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isFirst</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isLast</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">totalPages</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasPrevious</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasNext</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">totalPages</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="263-mapper">26.3 Mapper 層の実装<a class="headerlink" href="#263-mapper" title="Permanent link">&para;</a></h3>
<p>ページネーション用のクエリと件数取得クエリを追加します。</p>
<details>
<summary>PartnerMapper.java（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * ページネーション付きで取引先を検索.</span>
<span class="cm"> */</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findWithPagination</span><span class="p">(</span>
<span class="w">    </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;offset&quot;</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">offset</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;limit&quot;</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">limit</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span>
<span class="w">    </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;keyword&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>

<span class="cm">/**</span>
<span class="cm"> * 検索条件に一致する取引先の件数を取得.</span>
<span class="cm"> */</span>
<span class="kt">long</span><span class="w"> </span><span class="nf">count</span><span class="p">(</span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;type&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="nd">@Param</span><span class="p">(</span><span class="s">&quot;keyword&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
</code></pre></div>

</details>

<details>
<summary>PartnerMapper.xml（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findWithPagination&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;PartnerResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;取引先マスタ&quot;
<span class="w">    </span><span class="nt">&lt;where&gt;</span>
<span class="w">        </span><span class="nt">&lt;if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;type == &#39;customer&#39;&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span>&quot;顧客区分&quot;<span class="w"> </span>=<span class="w"> </span>TRUE
<span class="w">        </span><span class="nt">&lt;/if&gt;</span>
<span class="w">        </span><span class="nt">&lt;if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;type == &#39;supplier&#39;&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span>&quot;仕入先区分&quot;<span class="w"> </span>=<span class="w"> </span>TRUE
<span class="w">        </span><span class="nt">&lt;/if&gt;</span>
<span class="w">        </span><span class="nt">&lt;if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;keyword != null and keyword != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span>AND<span class="w"> </span>(LOWER(&quot;取引先コード&quot;)<span class="w"> </span>LIKE<span class="w"> </span>LOWER(&#39;%&#39;<span class="w"> </span>||<span class="w"> </span>#{keyword}<span class="w"> </span>||<span class="w"> </span>&#39;%&#39;)
<span class="w">                 </span>OR<span class="w"> </span>LOWER(&quot;取引先名&quot;)<span class="w"> </span>LIKE<span class="w"> </span>LOWER(&#39;%&#39;<span class="w"> </span>||<span class="w"> </span>#{keyword}<span class="w"> </span>||<span class="w"> </span>&#39;%&#39;))
<span class="w">        </span><span class="nt">&lt;/if&gt;</span>
<span class="w">    </span><span class="nt">&lt;/where&gt;</span>
<span class="w">    </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;取引先コード&quot;
<span class="w">    </span>LIMIT<span class="w"> </span>#{limit}<span class="w"> </span>OFFSET<span class="w"> </span>#{offset}
<span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;count&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;long&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>SELECT<span class="w"> </span>COUNT(*)<span class="w"> </span>FROM<span class="w"> </span>&quot;取引先マスタ&quot;
<span class="w">    </span><span class="nt">&lt;where&gt;</span>
<span class="w">        </span><span class="nt">&lt;if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;type == &#39;customer&#39;&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span>&quot;顧客区分&quot;<span class="w"> </span>=<span class="w"> </span>TRUE
<span class="w">        </span><span class="nt">&lt;/if&gt;</span>
<span class="w">        </span><span class="nt">&lt;if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;type == &#39;supplier&#39;&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span>&quot;仕入先区分&quot;<span class="w"> </span>=<span class="w"> </span>TRUE
<span class="w">        </span><span class="nt">&lt;/if&gt;</span>
<span class="w">        </span><span class="nt">&lt;if</span><span class="w"> </span><span class="na">test=</span><span class="s">&quot;keyword != null and keyword != &#39;&#39;&quot;</span><span class="nt">&gt;</span>
<span class="w">            </span>AND<span class="w"> </span>(LOWER(&quot;取引先コード&quot;)<span class="w"> </span>LIKE<span class="w"> </span>LOWER(&#39;%&#39;<span class="w"> </span>||<span class="w"> </span>#{keyword}<span class="w"> </span>||<span class="w"> </span>&#39;%&#39;)
<span class="w">                 </span>OR<span class="w"> </span>LOWER(&quot;取引先名&quot;)<span class="w"> </span>LIKE<span class="w"> </span>LOWER(&#39;%&#39;<span class="w"> </span>||<span class="w"> </span>#{keyword}<span class="w"> </span>||<span class="w"> </span>&#39;%&#39;))
<span class="w">        </span><span class="nt">&lt;/if&gt;</span>
<span class="w">    </span><span class="nt">&lt;/where&gt;</span>
<span class="nt">&lt;/select&gt;</span>
</code></pre></div>

</details>

<hr />
<h3 id="264-repository">26.4 Repository 層の実装<a class="headerlink" href="#264-repository" title="Permanent link">&para;</a></h3>
<details>
<summary>PartnerRepository.java（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * ページネーション付きで取引先を検索.</span>
<span class="cm"> */</span>
<span class="n">PageResult</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findWithPagination</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
</code></pre></div>

</details>

<details>
<summary>PartnerRepositoryImpl.java（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span><span class="w"> </span><span class="n">PageResult</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findWithPagination</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">size</span><span class="p">;</span>
<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="n">partners</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">partnerMapper</span><span class="p">.</span><span class="na">findWithPagination</span><span class="p">(</span><span class="n">offset</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
<span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">totalElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">partnerMapper</span><span class="p">.</span><span class="na">count</span><span class="p">(</span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PageResult</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">partners</span><span class="p">,</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">totalElements</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="265-usecase-service">26.5 UseCase / Service 層の実装<a class="headerlink" href="#265-usecase-service" title="Permanent link">&para;</a></h3>
<details>
<summary>PartnerUseCase.java（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * ページネーション付きで取引先を取得.</span>
<span class="cm"> */</span>
<span class="n">PageResult</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getPartners</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
</code></pre></div>

</details>

<details>
<summary>PartnerService.java（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="nd">@Transactional</span><span class="p">(</span><span class="n">readOnly</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="n">PageResult</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getPartners</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">partnerRepository</span><span class="p">.</span><span class="na">findWithPagination</span><span class="p">(</span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="266-controller">26.6 Controller の実装<a class="headerlink" href="#266-controller" title="Permanent link">&para;</a></h3>
<details>
<summary>PartnerWebController.java（抜粋）</summary>

<div class="highlight"><pre><span></span><code><span class="nd">@GetMapping</span>
<span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span>
<span class="w">        </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">page</span><span class="p">,</span>
<span class="w">        </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">defaultValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;10&quot;</span><span class="p">)</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">size</span><span class="p">,</span>
<span class="w">        </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">type</span><span class="p">,</span>
<span class="w">        </span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">required</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">keyword</span><span class="p">,</span>
<span class="w">        </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">PageResult</span><span class="o">&lt;</span><span class="n">Partner</span><span class="o">&gt;</span><span class="w"> </span><span class="n">partnerPage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">partnerUseCase</span><span class="p">.</span><span class="na">getPartners</span><span class="p">(</span><span class="n">page</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>

<span class="w">    </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;partners&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">partnerPage</span><span class="p">.</span><span class="na">getContent</span><span class="p">());</span>
<span class="w">    </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;page&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">partnerPage</span><span class="p">);</span>
<span class="w">    </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;selectedType&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="p">);</span>
<span class="w">    </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;keyword&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">keyword</span><span class="p">);</span>
<span class="w">    </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;currentSize&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;partners/list&quot;</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h3 id="267">26.7 テンプレートの実装<a class="headerlink" href="#267" title="Permanent link">&para;</a></h3>
<details>
<summary>list.html ページネーション部分</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- 検索フォーム --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;search-form&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">form</span> <span class="na">th:action</span><span class="o">=</span><span class="s">&quot;@{/partners}&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">&quot;get&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;row g-3&quot;</span><span class="p">&gt;</span>
        <span class="cm">&lt;!-- 表示件数 --&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-2&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">label</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-label&quot;</span><span class="p">&gt;</span>表示件数<span class="p">&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">select</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;size&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;form-select&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;10&quot;</span> <span class="na">th:selected</span><span class="o">=</span><span class="s">&quot;${currentSize == 10}&quot;</span><span class="p">&gt;</span>10件<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;25&quot;</span> <span class="na">th:selected</span><span class="o">=</span><span class="s">&quot;${currentSize == 25}&quot;</span><span class="p">&gt;</span>25件<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;50&quot;</span> <span class="na">th:selected</span><span class="o">=</span><span class="s">&quot;${currentSize == 50}&quot;</span><span class="p">&gt;</span>50件<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;100&quot;</span> <span class="na">th:selected</span><span class="o">=</span><span class="s">&quot;${currentSize == 100}&quot;</span><span class="p">&gt;</span>100件<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;col-md-2 d-flex align-items-end&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">button</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;submit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;btn btn-secondary&quot;</span><span class="p">&gt;</span>検索<span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

<span class="cm">&lt;!-- ページネーション --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;mt-3&quot;</span><span class="p">&gt;</span>
    <span class="cm">&lt;!-- 件数表示 --&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-muted text-center mb-2&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${page.totalElements &gt; 0}&quot;</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&quot;${page.page * page.size + 1}&quot;</span><span class="p">&gt;</span>1<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> -
            <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&quot;${page.page * page.size + #lists.size(partners)}&quot;</span><span class="p">&gt;</span>10<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> 件
            （全 <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:text</span><span class="o">=</span><span class="s">&quot;${page.totalElements}&quot;</span><span class="p">&gt;</span>0<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span> 件）
        <span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">span</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${page.totalElements == 0}&quot;</span><span class="p">&gt;</span>0 件<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>

    <span class="cm">&lt;!-- ページナビゲーション --&gt;</span>
    <span class="p">&lt;</span><span class="nt">nav</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${page.totalPages &gt; 1}&quot;</span> <span class="na">aria-label</span><span class="o">=</span><span class="s">&quot;ページナビゲーション&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">ul</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;pagination justify-content-center mb-0&quot;</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- 最初のページへ --&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span> <span class="na">th:classappend</span><span class="o">=</span><span class="s">&quot;${page.first} ? &#39;disabled&#39;&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/partners(page=0, size=${currentSize})}&quot;</span><span class="p">&gt;</span><span class="ni">&amp;laquo;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- 前のページへ --&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span> <span class="na">th:classappend</span><span class="o">=</span><span class="s">&quot;${!page.hasPrevious()} ? &#39;disabled&#39;&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/partners(page=${page.page - 1}, size=${currentSize})}&quot;</span><span class="p">&gt;</span><span class="ni">&amp;lsaquo;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>

            <span class="cm">&lt;!-- ページ番号 --&gt;</span>
            <span class="p">&lt;</span><span class="nt">th:block</span> <span class="na">th:with</span><span class="o">=</span><span class="s">&quot;startPage=${page.page &gt; 2 ? page.page - 2 : 0},</span>
<span class="s">                               endPage=${page.page + 2 &lt; page.totalPages - 1 ? page.page + 2 : page.totalPages - 1}&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${startPage &gt; 0}&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">th:each</span><span class="o">=</span><span class="s">&quot;i : ${#numbers.sequence(startPage, endPage)}&quot;</span>
                    <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span>
                    <span class="na">th:classappend</span><span class="o">=</span><span class="s">&quot;${i == page.page} ? &#39;active&#39;&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span>
                       <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/partners(page=${i}, size=${currentSize})}&quot;</span>
                       <span class="na">th:text</span><span class="o">=</span><span class="s">&quot;${i + 1}&quot;</span><span class="p">&gt;</span>1<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span> <span class="na">th:if</span><span class="o">=</span><span class="s">&quot;${endPage &lt; page.totalPages - 1}&quot;</span><span class="p">&gt;</span>
                    <span class="p">&lt;</span><span class="nt">span</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span><span class="p">&gt;</span>...<span class="p">&lt;/</span><span class="nt">span</span><span class="p">&gt;</span>
                <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">th:block</span><span class="p">&gt;</span>

            <span class="cm">&lt;!-- 次のページへ --&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span> <span class="na">th:classappend</span><span class="o">=</span><span class="s">&quot;${!page.hasNext()} ? &#39;disabled&#39;&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/partners(page=${page.page + 1}, size=${currentSize})}&quot;</span><span class="p">&gt;</span><span class="ni">&amp;rsaquo;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
            <span class="cm">&lt;!-- 最後のページへ --&gt;</span>
            <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-item&quot;</span> <span class="na">th:classappend</span><span class="o">=</span><span class="s">&quot;${page.last} ? &#39;disabled&#39;&quot;</span><span class="p">&gt;</span>
                <span class="p">&lt;</span><span class="nt">a</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;page-link&quot;</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/partners(page=${page.totalPages - 1}, size=${currentSize})}&quot;</span><span class="p">&gt;</span><span class="ni">&amp;raquo;</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
            <span class="p">&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
        <span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">nav</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div>

</details>

<hr />
<h3 id="268">26.8 ページネーションの動作<a class="headerlink" href="#268" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>                    ページネーション処理フロー
┌─────────────────────────────────────────────────────────────┐
│  ブラウザ                                                    │
│  /partners?page=2&amp;size=10&amp;keyword=xxx                       │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Controller                                                  │
│  - page, size, keyword パラメータを受け取る                   │
│  - UseCase.getPartners(page, size, keyword) を呼び出す       │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  Service / Repository                                        │
│  - offset = page * size を計算                               │
│  - findWithPagination(offset, size, keyword) を実行          │
│  - count(keyword) で総件数を取得                             │
│  - PageResult&lt;T&gt; を生成して返却                              │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  SQL (MyBatis)                                               │
│  SELECT * FROM &quot;テーブル&quot;                                    │
│  WHERE ... LIMIT 10 OFFSET 20                               │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│  PageResult&lt;T&gt;                                               │
│  - content: データリスト (10件)                               │
│  - page: 2                                                   │
│  - size: 10                                                  │
│  - totalElements: 57                                         │
│  - totalPages: 6                                             │
│  - isFirst/isLast/hasPrevious/hasNext メソッド               │
└─────────────────────────────────────────────────────────────┘
</code></pre></div>
<hr />
<h3 id="269">26.9 検索条件の保持<a class="headerlink" href="#269" title="Permanent link">&para;</a></h3>
<p>ページ遷移時に検索条件を保持するため、すべてのリンクに検索パラメータを含めます。</p>
<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- 検索条件付きページネーションリンク --&gt;</span>
<span class="p">&lt;</span><span class="nt">a</span> <span class="na">th:href</span><span class="o">=</span><span class="s">&quot;@{/partners(</span>
<span class="s">    page=${i},</span>
<span class="s">    size=${currentSize},</span>
<span class="s">    type=${selectedType},</span>
<span class="s">    keyword=${keyword}</span>
<span class="s">)}&quot;</span><span class="p">&gt;</span>
</code></pre></div>
<hr />
<h2 id="_4">まとめ<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h2>
<h3 id="_5">学んだこと<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>帳票の種類</strong>: 日計表、試算表、元帳、財務諸表</li>
<li><strong>HTML 表示</strong>: Thymeleaf による帳票画面の実装</li>
<li><strong>Excel 出力</strong>: Apache POI による Excel ファイル生成</li>
<li><strong>PDF 出力</strong>: iText による PDF ファイル生成</li>
<li><strong>ダウンロード</strong>: ResponseEntity による添付ファイル返却</li>
<li><strong>ページネーション</strong>: PageResult<T> による一覧画面のページ分割</li>
</ol>
<hr />
<h3 id="_6">実装した機能<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>機能</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ホーム画面</strong></td>
<td>ダッシュボード、クイックアクセス</td>
</tr>
<tr>
<td><strong>勘定科目マスタ</strong></td>
<td>一覧・登録・編集・削除・検索</td>
</tr>
<tr>
<td><strong>仕訳入力</strong></td>
<td>複合仕訳対応、貸借チェック</td>
</tr>
<tr>
<td><strong>帳票出力</strong></td>
<td>日計表、試算表、財務諸表</td>
</tr>
</tbody>
</table>
<h3 id="vs-api">モノリス vs API サーバー<a class="headerlink" href="#vs-api" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>観点</th>
<th>モノリス</th>
<th>API サーバー</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>適用場面</strong></td>
<td>社内システム、小〜中規模</td>
<td>大規模、SPA 連携</td>
</tr>
<tr>
<td><strong>開発速度</strong></td>
<td>高速</td>
<td>環境構築に時間</td>
</tr>
<tr>
<td><strong>保守性</strong></td>
<td>適切な設計で高い</td>
<td>高い</td>
</tr>
<tr>
<td><strong>チーム構成</strong></td>
<td>フルスタック</td>
<td>フロント/バック分離</td>
</tr>
</tbody>
</table>
<h3 id="_7">技術的なポイント<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>ヘキサゴナルアーキテクチャ</strong>: モノリスでも適用可能</li>
<li><strong>Thymeleaf</strong>: サーバーサイドレンダリング</li>
<li><strong>htmx</strong>: JavaScript 不要の部分更新</li>
<li><strong>PRG パターン</strong>: フォーム二重送信防止</li>
<li><strong>帳票生成</strong>: POI（Excel）、iText（PDF）</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/practical-database-design" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>