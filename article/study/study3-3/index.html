
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="基幹業務システム（販売管理・財務会計・生産管理）のデータベース設計を体系的に解説">
      
      
        <meta name="author" content="k2works">
      
      
      
        <link rel="prev" href="../study3-2/">
      
      
        <link rel="next" href="../study3-4/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>研究3 gRPCサービスの実装 - 実践データベース設計：基幹業務システム編</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#3grpc" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-header__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            実践データベース設計：基幹業務システム編
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              研究3 gRPCサービスの実装
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  実践データベース設計

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-nav__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    実践データベース設計：基幹業務システム編
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    実践データベース設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    実践データベース設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../techstack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    技術スタック
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    アウトライン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    執筆ワークフロー
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_5" >
        
          
          <label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第1部 基幹業務システムの全体像
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    第1部 基幹業務システムの全体像
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第1章 基幹業務システムとは
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第2章 基幹業務システムの業務領域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第3章 業務フローの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第2部 販売管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    第2部 販売管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第4章 販売管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第5章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第6章 受注・出荷・売上の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第7章 債権管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第8章 調達管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第9章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第10章 債務管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第11章 共通処理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第12章 販売管理データ設計（B社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第13章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第3部 財務会計システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    第3部 財務会計システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3/chapter21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第4部 生産管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    第4部 生産管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章 生産管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第23章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第24章 生産計画の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第25章 購買管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第26章 外注委託管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter27/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第27章 工程管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter28/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第28章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第29章 品質管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter30/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第30章 製造原価管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter31/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第31章 生産管理データ設計（E社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第32章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第5部 エンタープライズインテグレーション
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    第5部 エンタープライズインテグレーション
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter33.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第33章 システム統合の概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter34.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第34章 メッセージングパターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter35.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第35章 システム間連携パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter36.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第36章 マスタデータ管理（MDM）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter37.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第37章 イベント駆動アーキテクチャ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter38.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第38章 API設計とサービス連携
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter39.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第39章 データ連携の実装パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 販売管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 販売管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study2-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" checked>
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study3-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study3-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        はじめに
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#22-grpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        第 22 章：gRPC サーバーの基礎
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第 22 章：gRPC サーバーの基礎">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#221-grpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.1 gRPC とは
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#222-rest-api-graphql" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.2 REST API / GraphQL との比較
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#223-4-rpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.3 4 つの RPC パターン
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#224-grpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.4 gRPC におけるヘキサゴナルアーキテクチャ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#225" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.5 ディレクトリ構成
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#226" class="md-nav__link">
    <span class="md-ellipsis">
      
        22.6 技術スタックの追加
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#23-protocol-buffers" class="md-nav__link">
    <span class="md-ellipsis">
      
        第 23 章：Protocol Buffers 定義
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第 23 章：Protocol Buffers 定義">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.1 共通メッセージ定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232-protocol-buffers" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.2 勘定科目 Protocol Buffers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#233-protocol-buffers" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.3 仕訳 Protocol Buffers
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#234-protocol-buffers" class="md-nav__link">
    <span class="md-ellipsis">
      
        23.4 残高 Protocol Buffers
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#24-grpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        第 24 章：gRPC サービス実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第 24 章：gRPC サービス実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241" class="md-nav__link">
    <span class="md-ellipsis">
      
        24.1 勘定科目サービス実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" class="md-nav__link">
    <span class="md-ellipsis">
      
        24.2 仕訳サービス実装
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#243" class="md-nav__link">
    <span class="md-ellipsis">
      
        24.3 コンバーター実装
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#25-grpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        第 25 章：gRPC インターセプター
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第 25 章：gRPC インターセプター">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#251" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.1 ログインターセプター
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#252" class="md-nav__link">
    <span class="md-ellipsis">
      
        25.2 例外インターセプター
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#26" class="md-nav__link">
    <span class="md-ellipsis">
      
        第 26 章：動作確認とテスト
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第 26 章：動作確認とテスト">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#261-grpcurl" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.1 grpcurl による動作確認
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#262" class="md-nav__link">
    <span class="md-ellipsis">
      
        26.2 統合テスト
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#27" class="md-nav__link">
    <span class="md-ellipsis">
      
        第 27 章：まとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第 27 章：まとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#271" class="md-nav__link">
    <span class="md-ellipsis">
      
        27.1 学習した内容
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#272-grpc" class="md-nav__link">
    <span class="md-ellipsis">
      
        27.2 gRPC が適するユースケース
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#273-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        27.3 API アーキテクチャ選択ガイド
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#274" class="md-nav__link">
    <span class="md-ellipsis">
      
        27.4 次のステップ
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study3-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_12" >
        
          
          <label class="md-nav__link" for="__nav_1_12" id="__nav_1_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 生産管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 生産管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../study4-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_13" >
        
          
          <label class="md-nav__link" for="__nav_1_13" id="__nav_1_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システムORM実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システムORM実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter14-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter15-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter16-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter17-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter18-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter19-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter20-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter21-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_14" >
        
          
          <label class="md-nav__link" for="__nav_1_14" id="__nav_1_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    付録
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    付録
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/er-diagrams.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A 全体ER図
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/table-definitions.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    B テーブル定義一覧
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/glossary.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C 用語集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_15" >
        
          
          <label class="md-nav__link" for="__nav_1_15" id="__nav_1_15_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    データベース
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    データベース
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/schemaspy-output/sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SchemaSpy ER図（SMS）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="3grpc">研究 3：gRPC サービスの実装<a class="headerlink" href="#3grpc" title="Permanent link">&para;</a></h1>
<h2 id="_1">はじめに<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>本パートでは、API サーバー構成とは異なるアプローチとして、<strong>gRPC</strong> による財務会計システムを実装します。Protocol Buffers による高効率なバイナリシリアライゼーションと、HTTP/2 によるストリーミング通信を活用し、高性能なマイクロサービス間通信を実現します。</p>
<p>ヘキサゴナルアーキテクチャ（ドメイン層・アプリケーション層）はそのまま共有し、<strong>Input Adapter として gRPC サービス層のみを追加</strong>します。</p>
<hr />
<h2 id="22-grpc">第 22 章：gRPC サーバーの基礎<a class="headerlink" href="#22-grpc" title="Permanent link">&para;</a></h2>
<h3 id="221-grpc">22.1 gRPC とは<a class="headerlink" href="#221-grpc" title="Permanent link">&para;</a></h3>
<p>gRPC は Google が開発したオープンソースの高性能 RPC（Remote Procedure Call）フレームワークです。HTTP/2 プロトコルと Protocol Buffers を基盤とし、マイクロサービス間通信に最適化されています。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjgxOXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDg5cHg7aGVpZ2h0OjgxOXB4O2JhY2tncm91bmQ6I0ZFRkVGRTsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQ4OSA4MTkiIHdpZHRoPSI0ODlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxyZWN0IGZpbGw9IiNGRUZFRkUiIGhlaWdodD0iODE5IiBzdHlsZT0ic3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNDg5IiB4PSIwIiB5PSIwIi8+PCEtLWNsdXN0ZXIgZ1JQQyBBcmNoaXRlY3R1cmUgKD8/Pz8/Pz8/KS0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iZ1JQQyBBcmNoaXRlY3R1cmUgLi4uLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyX2dSUEMgQXJjaGl0ZWN0dXJlIC4uLi4uLi4uLi4iPjxwYXRoIGQ9Ik04LjUsNiBMMjgzLjczLDYgQTMuNzUsMy43NSAwIDAgMSAyODYuMjMsOC41IEwyOTMuMjMsMjguMjk2OSBMNDc2LjUsMjguMjk2OSBBMi41LDIuNSAwIDAgMSA0NzksMzAuNzk2OSBMNDc5LDcwNy44NCBBMi41LDIuNSAwIDAgMSA0NzYuNSw3MTAuMzQgTDguNSw3MTAuMzQgQTIuNSwyLjUgMCAwIDEgNiw3MDcuODQgTDYsOC41IEEyLjUsMi41IDAgMCAxIDguNSw2IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI2IiB4Mj0iMjkzLjIzIiB5MT0iMjguMjk2OSIgeTI9IjI4LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjc0LjIzIiB4PSIxMCIgeT0iMjAuOTk1MSI+Z1JQQyBBcmNoaXRlY3R1cmUgKCYjMzYwMDE7JiMyMTIwOTsmIzIwMjUwOyYjMzUzMzY7JiMxMjQ3MTsmIzEyNDczOyYjMTI0ODY7JiMxMjUxMjspPC90ZXh0PjwvZz48IS0tY2x1c3RlciBDbGllbnQgU2lkZS0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iQ2xpZW50IFNpZGUiIGRhdGEtc291cmNlLWxpbmU9IjciIGRhdGEtdWlkPSJlbnQwMDAzIiBpZD0iY2x1c3Rlcl9DbGllbnQgU2lkZSI+PHBhdGggZD0iTTE1Mi41LDQ5IEwyMzguNzk4OCw0OSBBMy43NSwzLjc1IDAgMCAxIDI0MS4yOTg4LDUxLjUgTDI0OC4yOTg4LDcxLjI5NjkgTDM4Ny41LDcxLjI5NjkgQTIuNSwyLjUgMCAwIDEgMzkwLDczLjc5NjkgTDM5MCwyMjEuMjggQTIuNSwyLjUgMCAwIDEgMzg3LjUsMjIzLjc4IEwxNTIuNSwyMjMuNzggQTIuNSwyLjUgMCAwIDEgMTUwLDIyMS4yOCBMMTUwLDUxLjUgQTIuNSwyLjUgMCAwIDEgMTUyLjUsNDkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjE1MCIgeDI9IjI0OC4yOTg4IiB5MT0iNzEuMjk2OSIgeTI9IjcxLjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODUuMjk4OCIgeD0iMTU0IiB5PSI2My45OTUxIj5DbGllbnQgU2lkZTwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgU2VydmVyIFNpZGUtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9IlNlcnZlciBTaWRlIiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJjbHVzdGVyX1NlcnZlciBTaWRlIj48cGF0aCBkPSJNMzIuNSwyODcuNzggTDEyNC43ODAzLDI4Ny43OCBBMy43NSwzLjc1IDAgMCAxIDEyNy4yODAzLDI5MC4yOCBMMTM0LjI4MDMsMzEwLjA3NjkgTDI3MS41LDMxMC4wNzY5IEEyLjUsMi41IDAgMCAxIDI3NCwzMTIuNTc2OSBMMjc0LDQ2MC4wNiBBMi41LDIuNSAwIDAgMSAyNzEuNSw0NjIuNTYgTDMyLjUsNDYyLjU2IEEyLjUsMi41IDAgMCAxIDMwLDQ2MC4wNiBMMzAsMjkwLjI4IEEyLjUsMi41IDAgMCAxIDMyLjUsMjg3Ljc4IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIzMCIgeDI9IjEzNC4yODAzIiB5MT0iMzEwLjA3NjkiIHkyPSIzMTAuMDc2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MS4yODAzIiB4PSIzNCIgeT0iMzAyLjc3NTEiPlNlcnZlciBTaWRlPC90ZXh0PjwvZz48IS0tY2x1c3RlciBTaGFyZWQtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9IlNoYXJlZCIgZGF0YS1zb3VyY2UtbGluZT0iMjUiIGRhdGEtdWlkPSJlbnQwMDA3IiBpZD0iY2x1c3Rlcl9TaGFyZWQiPjxwYXRoIGQ9Ik0xNTguNSw1MTEuNTYgTDIxNS40MTgsNTExLjU2IEEzLjc1LDMuNzUgMCAwIDEgMjE3LjkxOCw1MTQuMDYgTDIyNC45MTgsNTMzLjg1NjkgTDMyOS41LDUzMy44NTY5IEEyLjUsMi41IDAgMCAxIDMzMiw1MzYuMzU2OSBMMzMyLDY4My44NCBBMi41LDIuNSAwIDAgMSAzMjkuNSw2ODYuMzQgTDE1OC41LDY4Ni4zNCBBMi41LDIuNSAwIDAgMSAxNTYsNjgzLjg0IEwxNTYsNTE0LjA2IEEyLjUsMi41IDAgMCAxIDE1OC41LDUxMS41NiIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMTU2IiB4Mj0iMjI0LjkxOCIgeTE9IjUzMy44NTY5IiB5Mj0iNTMzLjg1NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTE4IiB4PSIxNjAiIHk9IjUyNi41NTUxIj5TaGFyZWQ8L3RleHQ+PC9nPjwhLS1jbGFzcyBjbGllbnQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iY2xpZW50IiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwNCIgaWQ9ImVudGl0eV9jbGllbnQiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTIzLjc4MTMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjIwNy45OTkyIiB4PSIxNjYiIHk9Ijg0Ii8+PGVsbGlwc2UgY3g9IjIwNS4zOTc2IiBjeT0iMTA1LjI5NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTIwOC4zNjY0LDExMC45Mzc1IFEyMDcuNzg4MywxMTEuMjM0NCAyMDcuMTQ3NiwxMTEuMzc1IFEyMDYuNTA3LDExMS41MzEzIDIwNS44MDM5LDExMS41MzEzIFEyMDMuMzAzOSwxMTEuNTMxMyAyMDEuOTc1OCwxMDkuODkwNiBRMjAwLjY2MzMsMTA4LjIzNDQgMjAwLjY2MzMsMTA1LjEwOTQgUTIwMC42NjMzLDEwMS45ODQ0IDIwMS45NzU4LDEwMC4zMjgxIFEyMDMuMzAzOSw5OC42NzE5IDIwNS44MDM5LDk4LjY3MTkgUTIwNi41MDcsOTguNjcxOSAyMDcuMTQ3Niw5OC44MjgxIFEyMDcuODAzOSw5OC45ODQ0IDIwOC4zNjY0LDk5LjI4MTMgTDIwOC4zNjY0LDEwMiBRMjA3Ljc0MTQsMTAxLjQyMTkgMjA3LjE0NzYsMTAxLjE1NjMgUTIwNi41NTM5LDEwMC44NzUgMjA1LjkyODksMTAwLjg3NSBRMjA0LjU4NTEsMTAwLjg3NSAyMDMuODk3NiwxMDEuOTUzMSBRMjAzLjIxMDEsMTAzLjAxNTYgMjAzLjIxMDEsMTA1LjEwOTQgUTIwMy4yMTAxLDEwNy4yMDMxIDIwMy44OTc2LDEwOC4yODEzIFEyMDQuNTg1MSwxMDkuMzQzOCAyMDUuOTI4OSwxMDkuMzQzOCBRMjA2LjU1MzksMTA5LjM0MzggMjA3LjE0NzYsMTA5LjA3ODEgUTIwNy43NDE0LDEwOC43OTY5IDIwOC4zNjY0LDEwOC4yMTg4IEwyMDguMzY2NCwxMTAuOTM3NSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgxLjgxMjUiIHg9IjI0NC44MDQyIiB5PSIxMDEuOTk1MSI+Z1JQQyBDbGllbnQ8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIxLjc4MjIiIHg9IjIyNC44MTkzIiB5PSIxMTguMjkyIj4oR2VuZXJhdGVkIFN0dWIpPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjE2NyIgeDI9IjM3Mi45OTkyIiB5MT0iMTI2LjU5MzgiIHkyPSIxMjYuNTkzOCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjE3NCIgeT0iMTM3LjI0MjIiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2MC4zOTU0IiB4PSIxODYiIHk9IjE0My41ODg5Ij4mIzIxMzM2OyYjMzg5MTc7IFJQQzwvdGV4dD48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIxNzQiIHk9IjE1My41MzkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTUzLjk5OTMiIHg9IjE4NiIgeT0iMTU5Ljg4NTciPiYjMTI0Njk7JiMxMjU0MDsmIzEyNDk2OyYjMTI1NDA7JiMxMjQ3MzsmIzEyNDg4OyYjMTI1MjI7JiMxMjU0MDsmIzEyNTExOyYjMTI1MzE7JiMxMjQ2NDs8L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMTc0IiB5PSIxNjkuODM1OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4MS45OTkyIiB4PSIxODYiIHk9IjE3Ni4xODI2Ij4mIzEyNDYzOyYjMTI1MjE7JiMxMjQ1MjsmIzEyNDUwOyYjMTI1MzE7JiMxMjQ4ODsmIzEyNDczOyYjMTI0ODg7JiMxMjUyMjsmIzEyNTQwOyYjMTI1MTE7JiMxMjUzMTsmIzEyNDY0OzwvdGV4dD48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIxNzQiIHk9IjE4Ni4xMzI4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM5Ljk5OTQiIHg9IjE4NiIgeT0iMTkyLjQ3OTUiPiYjMjE0NTI7JiMyNjA0MTsmIzIxNTIxOyYjMTI0NzM7JiMxMjQ4ODsmIzEyNTIyOyYjMTI1NDA7JiMxMjUxMTsmIzEyNTMxOyYjMTI0NjQ7PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjE2NyIgeDI9IjM3Mi45OTkyIiB5MT0iMTk5Ljc4MTMiIHkyPSIxOTkuNzgxMyIvPjwvZz48IS0tY2xhc3Mgc2VydmVyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InNlcnZlciIgZGF0YS1zb3VyY2UtbGluZT0iMTciIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iZW50aXR5X3NlcnZlciI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMjMuNzgxMyIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMjExLjM3NSIgeD0iNDYuMzEiIHk9IjMyMi43OCIvPjxlbGxpcHNlIGN4PSI2MS4zMSIgY3k9IjM0NC4wNzY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik02NC4yNzg4LDM0OS43MTc1IFE2My43MDA2LDM1MC4wMTQ0IDYzLjA2LDM1MC4xNTUgUTYyLjQxOTQsMzUwLjMxMTMgNjEuNzE2MywzNTAuMzExMyBRNTkuMjE2MywzNTAuMzExMyA1Ny44ODgxLDM0OC42NzA2IFE1Ni41NzU2LDM0Ny4wMTQ0IDU2LjU3NTYsMzQzLjg4OTQgUTU2LjU3NTYsMzQwLjc2NDQgNTcuODg4MSwzMzkuMTA4MSBRNTkuMjE2MywzMzcuNDUxOSA2MS43MTYzLDMzNy40NTE5IFE2Mi40MTk0LDMzNy40NTE5IDYzLjA2LDMzNy42MDgxIFE2My43MTYzLDMzNy43NjQ0IDY0LjI3ODgsMzM4LjA2MTMgTDY0LjI3ODgsMzQwLjc4IFE2My42NTM4LDM0MC4yMDE5IDYzLjA2LDMzOS45MzYzIFE2Mi40NjYzLDMzOS42NTUgNjEuODQxMywzMzkuNjU1IFE2MC40OTc1LDMzOS42NTUgNTkuODEsMzQwLjczMzEgUTU5LjEyMjUsMzQxLjc5NTYgNTkuMTIyNSwzNDMuODg5NCBRNTkuMTIyNSwzNDUuOTgzMSA1OS44MSwzNDcuMDYxMyBRNjAuNDk3NSwzNDguMTIzOCA2MS44NDEzLDM0OC4xMjM4IFE2Mi40NjYzLDM0OC4xMjM4IDYzLjA2LDM0Ny44NTgxIFE2My42NTM4LDM0Ny41NzY5IDY0LjI3ODgsMzQ2Ljk5ODggTDY0LjI3ODgsMzQ5LjcxNzUgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4Ny4xOTI0IiB4PSIxMjEuNDAxMyIgeT0iMzQwLjc3NTEiPmdSUEMgU2VydmVyPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE3OS4zNzUiIHg9Ijc1LjMxIiB5PSIzNTcuMDcyIj4oZ3JwYy1zcHJpbmctYm9vdC1zdGFydGVyKTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI0Ny4zMSIgeDI9IjI1Ni42ODUiIHkxPSIzNjUuMzczOCIgeTI9IjM2NS4zNzM4Ii8+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iNTQuMzEiIHk9IjM3Ni4wMjIyIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA4LjUxMzciIHg9IjY2LjMxIiB5PSIzODIuMzY4OSI+QWNjb3VudFNlcnZpY2U8L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iNTQuMzEiIHk9IjM5Mi4zMTkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAwLjQwNjMiIHg9IjY2LjMxIiB5PSIzOTguNjY1NyI+Sm91cm5hbFNlcnZpY2U8L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iNTQuMzEiIHk9IjQwOC42MTU5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA3LjU3NzEiIHg9IjY2LjMxIiB5PSI0MTQuOTYyNiI+QmFsYW5jZVNlcnZpY2U8L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iNTQuMzEiIHk9IjQyNC45MTI4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTguNzc5MyIgeD0iNjYuMzEiIHk9IjQzMS4yNTk1Ij5SZXBvcnRTZXJ2aWNlPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjQ3LjMxIiB4Mj0iMjU2LjY4NSIgeTE9IjQzOC41NjEzIiB5Mj0iNDM4LjU2MTMiLz48L2c+PCEtLWNsYXNzIHByb3RvLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9InByb3RvIiBkYXRhLXNvdXJjZS1saW5lPSIyNiIgZGF0YS11aWQ9ImVudDAwMDgiIGlkPSJlbnRpdHlfcHJvdG8iPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMTIzLjc4MTMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE0My40MTg5IiB4PSIxNzIuMjkiIHk9IjU0Ni41NiIvPjxlbGxpcHNlIGN4PSIxODcuMjkiIGN5PSI1NjcuODU2OSIgZmlsbD0iI0FERDFCMiIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cGF0aCBkPSJNMTkwLjI1ODgsNTczLjQ5NzUgUTE4OS42ODA2LDU3My43OTQ0IDE4OS4wNCw1NzMuOTM1IFExODguMzk5NCw1NzQuMDkxMyAxODcuNjk2Myw1NzQuMDkxMyBRMTg1LjE5NjMsNTc0LjA5MTMgMTgzLjg2ODEsNTcyLjQ1MDYgUTE4Mi41NTU2LDU3MC43OTQ0IDE4Mi41NTU2LDU2Ny42Njk0IFExODIuNTU1Niw1NjQuNTQ0NCAxODMuODY4MSw1NjIuODg4MSBRMTg1LjE5NjMsNTYxLjIzMTkgMTg3LjY5NjMsNTYxLjIzMTkgUTE4OC4zOTk0LDU2MS4yMzE5IDE4OS4wNCw1NjEuMzg4MSBRMTg5LjY5NjMsNTYxLjU0NDQgMTkwLjI1ODgsNTYxLjg0MTMgTDE5MC4yNTg4LDU2NC41NiBRMTg5LjYzMzgsNTYzLjk4MTkgMTg5LjA0LDU2My43MTYzIFExODguNDQ2Myw1NjMuNDM1IDE4Ny44MjEzLDU2My40MzUgUTE4Ni40Nzc1LDU2My40MzUgMTg1Ljc5LDU2NC41MTMxIFExODUuMTAyNSw1NjUuNTc1NiAxODUuMTAyNSw1NjcuNjY5NCBRMTg1LjEwMjUsNTY5Ljc2MzEgMTg1Ljc5LDU3MC44NDEzIFExODYuNDc3NSw1NzEuOTAzOCAxODcuODIxMyw1NzEuOTAzOCBRMTg4LjQ0NjMsNTcxLjkwMzggMTg5LjA0LDU3MS42MzgxIFExODkuNjMzOCw1NzEuMzU2OSAxOTAuMjU4OCw1NzAuNzc4OCBMMTkwLjI1ODgsNTczLjQ5NzUgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTEuNDE4OSIgeD0iMjAxLjI5IiB5PSI1NjQuNTU1MSI+UHJvdG9jb2wgQnVmZmVyczwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4NS43MDIxIiB4PSIyMTQuMTQ4NCIgeT0iNTgwLjg1MiI+KC5wcm90byBmaWxlcyk8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTczLjI5IiB4Mj0iMzE0LjcwODkiIHkxPSI1ODkuMTUzOCIgeTI9IjU4OS4xNTM4Ii8+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMTgwLjI5IiB5PSI1OTkuODAyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3LjQ4NzMiIHg9IjE5Mi4yOSIgeT0iNjA2LjE0ODkiPmFjY291bnQucHJvdG88L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMTgwLjI5IiB5PSI2MTYuMDk5MSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkwLjEzODciIHg9IjE5Mi4yOSIgeT0iNjIyLjQ0NTciPmpvdXJuYWwucHJvdG88L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMTgwLjI5IiB5PSI2MzIuMzk1OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk2LjgzMTEiIHg9IjE5Mi4yOSIgeT0iNjM4Ljc0MjYiPmJhbGFuY2UucHJvdG88L3RleHQ+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMTgwLjI5IiB5PSI2NDguNjkyOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMi42ODk1IiB4PSIxOTIuMjkiIHk9IjY1NS4wMzk1Ij5jb21tb24ucHJvdG88L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTczLjI5IiB4Mj0iMzE0LjcwODkiIHkxPSI2NjIuMzQxMyIgeTI9IjY2Mi4zNDEzIi8+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xMiIgZGF0YS1zb3VyY2UtbGluZT0iNDAiIGRhdGEtdWlkPSJlbnQwMDEzIiBpZD0iZW50aXR5X0dNTjEyIj48cGF0aCBkPSJNMTE2LjUsNzU3LjM0IEwxMTYuNSw4MTIuNzM4NCBBMCwwIDAgMCAwIDExNi41LDgxMi43Mzg0IEwzNzEuNTAwMyw4MTIuNzM4NCBBMCwwIDAgMCAwIDM3MS41MDAzLDgxMi43Mzg0IEwzNzEuNTAwMyw3NjcuMzQgTDM2MS41MDAzLDc1Ny4zNCBMMjQ4LDc1Ny4zNCBMMjQ0LDY3MC41MSBMMjQwLDc1Ny4zNCBMMTE2LjUsNzU3LjM0IEEwLDAgMCAwIDAgMTE2LjUsNzU3LjM0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNMzYxLjUwMDMsNzU3LjM0IEwzNjEuNTAwMyw3NjcuMzQgTDM3MS41MDAzLDc2Ny4zNCBMMzYxLjUwMDMsNzU3LjM0IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDQuMDAwMSIgeD0iMTIyLjUiIHk9Ijc3NC40MDY5Ij4mIzEyNDczOyYjMTI0NjE7JiMxMjU0MDsmIzEyNTEwOyYjMzkzNjY7JiMyMTIwNTsmIzM4MjgzOyYjMzAzMzA7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE5NS4wMDAyIiB4PSIxMjIuNSIgeT0iNzg5LjUzOTciPiYjMzUzMjg7JiMzNTQ4NjsmIzIwMDEzOyYjMzE0MzU7JiMxMjM5NDsmIzEyNDUyOyYjMTI1MzE7JiMxMjQ3OTsmIzEyNTQwOyYjMTI1MDE7JiMxMjQ1NTsmIzEyNTQwOyYjMTI0NzM7JiMyMzQ1MDsmIzMyNjgxOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMzQuMDAwMyIgeD0iMTIyLjUiIHk9IjgwNC42NzI1Ij4mIzM5NjQwOyYjMjExNzc7JiMyOTU3NTsmIzEyMzk0OyYjMTI0OTY7JiMxMjQ1MjsmIzEyNDkwOyYjMTI1MjI7JiMxMjQ3MTsmIzEyNTIyOyYjMTI0NTA7JiMxMjUyMTsmIzEyNDUyOyYjMTI0NzY7JiMxMjU0MDsmIzEyNDcxOyYjMTI1MTk7JiMxMjUzMTs8L3RleHQ+PC9nPjwhLS1saW5rIGNsaWVudCB0byBwcm90by0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJjbGllbnQiIGRhdGEtZW50aXR5LTI9InByb3RvIiBkYXRhLXNvdXJjZS1saW5lPSIzNSIgZGF0YS11aWQ9ImxuazkiIGlkPSJsaW5rX2NsaWVudF9wcm90byI+PHBhdGggY29kZUxpbmU9IjM1IiBkPSJNMzEwLjc0LDIwOC4xOCBDMzE1Ljc5LDIxOC4zNyAzMjAuMTcsMjI5LjEgMzIzLDIzOS43OCBDMzUyLjE0LDM0OS42NiAzNTcuNCwzODcuMjEgMzIzLDQ5NS41NiBDMzE3LjM1LDUxMy4zNSAzMTEuMTE3Myw1MjUuNzkwOCAzMDAuNTA3Myw1NDEuMzcwOCIgZmlsbD0ibm9uZSIgaWQ9ImNsaWVudC10by1wcm90byIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjk3LjEzLDU0Ni4zMywzMDUuNTAyLDU0MS4xNDI2LDI5OS45NDQ0LDU0Mi4xOTczLDI5OC44ODk3LDUzNi42Mzk2LDI5Ny4xMyw1NDYuMzMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzMuODY1OCIgeD0iMzQ3Ljg3IiB5PSIzODkuMjM2OSI+LnByb3RvICYjMTIzNjM7JiMxMjQyNTsmIzEyNDczOyYjMTI0Nzk7JiMxMjUwMjsmIzI5OTgzOyYjMjUxMDQ7PC90ZXh0PjwvZz48IS0tbGluayBzZXJ2ZXIgdG8gcHJvdG8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0ic2VydmVyIiBkYXRhLWVudGl0eS0yPSJwcm90byIgZGF0YS1zb3VyY2UtbGluZT0iMzYiIGRhdGEtdWlkPSJsbmsxMCIgaWQ9Imxpbmtfc2VydmVyX3Byb3RvIj48cGF0aCBjb2RlTGluZT0iMzYiIGQ9Ik0xNDguOSw0NDYuODggQzE0OS44LDQ2My4xIDE1Mi4zNiw0ODAuMzMgMTU4LDQ5NS41NiBDMTY0LjYsNTEzLjM2IDE3MS41MTIxLDUyNS44MTYxIDE4Mi45MzIxLDU0MS4yNTYxIiBmaWxsPSJub25lIiBpZD0ic2VydmVyLXRvLXByb3RvIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxODYuNSw1NDYuMDgsMTg0LjM2NCw1MzYuNDY1NSwxODMuNTI2Nyw1NDIuMDYwMSwxNzcuOTMyMiw1NDEuMjIyOCwxODYuNSw1NDYuMDgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTkuODY1OSIgeD0iMTU5IiB5PSI0OTEuNjI2OSI+LnByb3RvICYjMTIzNjM7JiMxMjQyNTsmIzEyNDczOyYjMTI0NjU7JiMxMjUyMzsmIzEyNDg4OyYjMTI1MzE7JiMyOTk4MzsmIzI1MTA0OzwvdGV4dD48L2c+PCEtLWxpbmsgY2xpZW50IHRvIHNlcnZlci0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJjbGllbnQiIGRhdGEtZW50aXR5LTI9InNlcnZlciIgZGF0YS1zb3VyY2UtbGluZT0iMzciIGRhdGEtdWlkPSJsbmsxMSIgaWQ9ImxpbmtfY2xpZW50X3NlcnZlciI+PHBhdGggY29kZUxpbmU9IjM3IiBkPSJNMjI0LjE1MjEsMjEzLjEyMyBDMjE3LjY0MjEsMjIzLjUwMyAyMTQuNDcsMjI5LjI1IDIwOSwyMzkuNzggQzE5NS4zMSwyNjYuMTMgMTg0LjkyODIsMjkwLjkyMjYgMTc1LjE0ODIsMzE2Ljk4MjYiIGZpbGw9Im5vbmUiIGlkPSJjbGllbnQtc2VydmVyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMjcuMzQsMjA4LjA0LDIxOS4xNjk0LDIxMy41MzkzLDIyNC42ODM0LDIxMi4yNzU5LDIyNS45NDY4LDIxNy43ODk4LDIyNy4zNCwyMDguMDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE3My4wNCwzMjIuNiwxNzkuOTQ3MiwzMTUuNTc5MywxNzQuNzk2OCwzMTcuOTE4OCwxNzIuNDU3MywzMTIuNzY4NCwxNzMuMDQsMzIyLjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0Ni4xNDc1IiB4PSIyNDEuNDAxOSIgeT0iMjUyLjg0NjkiPkhUVFAvMjwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDguOTUxMiIgeD0iMjEwIiB5PSIyNjcuOTc5NyI+KEJpbmFyeSBQcm90b2NvbCk8L3RleHQ+PC9nPjwhLS1TUkM9W1hMRFRRbkQxNTdzVk5wNzZiX1BYNU5tSzRQOEdBbzhJYVpwd0NmY1RmRGprUGZSUFlJMmJPN1VubmdQZ1gzUXFWTVhoNFRlY3JBeVc2V2RzbnFvdElWdzVDcGtSSDhmNTVXUmtrVVZTVS14Q3RIaXNnSllLbTQ4a01xZV9NTllTV3pYNWxXLTBsLW5HM3Q1S1dzTTRid2tTclFjVFBJeFp5RVEzZEZ1MHk1RzJMR2JDTEdsdkI0bnBsRVc4V2FNVDRwV3QtbE9YUWt2VTNGUDY5bXFQXzkxMU51UmhDWm9TSnk2TGx2SFBybzVLbUE5WjR2c09rSjBySlZlZmRMaVdiNzBhWTBzQmVidk1IUDJsWkNSUTVNMzF3Q3RFLUYwYkwxOExvRTJ4MzBTb1JFYkp6c3Q4aTFDWjFwQmlvVTFCcEZhaW1yQ1BWOUoxYUdPTHZuZmN6NnhwaWpzRk1rX19KTFhMdHNvUzhrN0YyQnpzNzlETXVySXZYb3RWdW13ak1jTjZYRUtCbjBOWFBaM1ZMRDYzZko1TTVvLXFxQzU0ME96T2RMRmFwZTBDU1g3NVAwT0tZQ1Z1TDc3NXRvQlluQnZZQlMtUE85WXZDNUVsTDBadGJSelJkaVBXbk42OVJwbVBHNWoybmZBWGc3WjlFOWg2UE1EZTZjRE1ncDZRWEFsNktGOXFiZEtfQU5tTmZmQVVTZ3FmV3pWd2llRHA2UlE3TW1VTlpMT0E5N1ZvN3lMTjZOUlpILWZEVDRjZFVyZ09yNTNBWHdMSV9sT1RETVo2ZU9XX1h2Q2hjNHkxRzlhV2lDbzRPM044QWdPUllBa1ZuSS1fRnB2VVp2aFJ1dFBwa0ZpQlo0dlVaM2h4NXBfRlhqc2NORWxlWlRBQlNIdkpqc0xtUjlPbS1oR3RfN3FBbmpzVFFBQ19WRmpBS3pNMlFsUTZOWWRyWC1acFFCQUtXclljR0FObDBLOWpnNnR6MEcwMF0tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<p><strong>gRPC の主な特徴：</strong></p>
<table>
<thead>
<tr>
<th>特徴</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td>HTTP/2</td>
<td>多重化、ヘッダー圧縮、バイナリフレーミング</td>
</tr>
<tr>
<td>Protocol Buffers</td>
<td>高速なバイナリシリアライゼーション</td>
</tr>
<tr>
<td>多言語サポート</td>
<td>Java, Go, Python, C#, Node.js 等</td>
</tr>
<tr>
<td>ストリーミング</td>
<td>4 つの RPC パターンをサポート</td>
</tr>
<tr>
<td>デッドライン</td>
<td>タイムアウト管理の組み込みサポート</td>
</tr>
<tr>
<td>認証</td>
<td>TLS/SSL、トークンベース認証のサポート</td>
</tr>
</tbody>
</table>
<h3 id="222-rest-api-graphql">22.2 REST API / GraphQL との比較<a class="headerlink" href="#222-rest-api-graphql" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjIxNXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTI1NnB4O2hlaWdodDoyMTVweDtiYWNrZ3JvdW5kOiNGRUZFRkU7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMjU2IDIxNSIgd2lkdGg9IjEyNTZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxyZWN0IGZpbGw9IiNGRUZFRkUiIGhlaWdodD0iMjE1IiBzdHlsZT0ic3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTI1NiIgeD0iMCIgeT0iMCIvPjwhLS1jbHVzdGVyIHJlc3QtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9InJlc3QiIGRhdGEtc291cmNlLWxpbmU9IjMiIGRhdGEtdWlkPSJlbnQwMDAyIiBpZD0iY2x1c3Rlcl9yZXN0Ij48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjIwMS41NiIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjMzNyIgeD0iNyIgeT0iOC4yNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MS4xNTUzIiB4PSIxMzkuOTIyNCIgeT0iMjMuMjY1MSI+UkVTVCBBUEk8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGdycGMtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9ImdycGMiIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJlbnQwMDA2IiBpZD0iY2x1c3Rlcl9ncnBjIj48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjIwMi44MyIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjMyMiIgeD0iNTcwIiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjMzNjkiIHg9IjcxMC4zMzE1IiB5PSIyMS45OTUxIj5nUlBDPC90ZXh0PjwvZz48IS0tY2x1c3RlciBncmFwaHFsLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJncmFwaHFsIiBkYXRhLXNvdXJjZS1saW5lPSIxNSIgZGF0YS11aWQ9ImVudDAwMTAiIGlkPSJjbHVzdGVyX2dyYXBocWwiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iOTYuMDUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIyNTYiIHg9IjkzMiIgeT0iOS4yOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OC42NTMzIiB4PSIxMDI1LjY3MzMiIHk9IjI0LjI3NTEiPkdyYXBoUUw8L3RleHQ+PC9nPjwhLS1lbnRpdHkgSFRUUC8xLjEgb3IgMi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJIVFRQLjEuMSBvciAyIiBkYXRhLXNvdXJjZS1saW5lPSI0IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9IVFRQLjEuMSBvciAyIj48ZWxsaXBzZSBjeD0iOTYuOTk5MSIgY3k9IjY2Ljc5OTgiIGZpbGw9IiNGMUYxRjEiIHJ4PSI2NS42NDkxIiByeT0iMTUuNTI5OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTUuMTgzNiIgeD0iNDkuNDA3MyIgeT0iNzEuNDQ4MiI+SFRUUC8xLjEgb3IgMjwvdGV4dD48L2c+PCEtLWVudGl0eSBKU09OL1hNTC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJKU09OLlhNTCIgZGF0YS1zb3VyY2UtbGluZT0iNSIgZGF0YS11aWQ9ImVudDAwMDQiIGlkPSJlbnRpdHlfSlNPTi5YTUwiPjxlbGxpcHNlIGN4PSIyNDkuMDA0MiIgY3k9IjY2LjgwMzYiIGZpbGw9IiNGMUYxRjEiIHJ4PSI1MS41NzQyIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjguNjk0MyIgeD0iMjE0LjY1NzEiIHk9IjcxLjQ1MjEiPkpTT04vWE1MPC90ZXh0PjwvZz48IS0tZW50aXR5IE9wZW5BUEktLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iT3BlbkFQSSIgZGF0YS1zb3VyY2UtbGluZT0iNiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfT3BlbkFQSSI+PGVsbGlwc2UgY3g9Ijk3LjAwMTkiIGN5PSIxNzEuMzEzNiIgZmlsbD0iI0YxRjFGMSIgcng9IjQ1LjEwMTkiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1OS41NDEiIHg9IjY3LjIzMTMiIHk9IjE3NS45NjIxIj5PcGVuQVBJPC90ZXh0PjwvZz48IS0tZW50aXR5IEhUVFAvMi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJIVFRQLjIiIGRhdGEtc291cmNlLWxpbmU9IjEwIiBkYXRhLXVpZD0iZW50MDAwNyIgaWQ9ImVudGl0eV9IVFRQLjIiPjxlbGxpcHNlIGN4PSI2MzIuMDAxMyIgY3k9IjY2LjgwMzYiIGZpbGw9IiNGMUYxRjEiIHJ4PSIzOC4xNDEzIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkuNjk3MyIgeD0iNjA3LjE1MjYiIHk9IjcxLjQ1MjEiPkhUVFAvMjwvdGV4dD48L2c+PCEtLWVudGl0eSBQcm90b2NvbCBCdWZmZXJzLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IlByb3RvY29sIEJ1ZmZlcnMiIGRhdGEtc291cmNlLWxpbmU9IjExIiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImVudGl0eV9Qcm90b2NvbCBCdWZmZXJzIj48ZWxsaXBzZSBjeD0iNzc2Ljk5NzkiIGN5PSI2Ni44MDM2IiBmaWxsPSIjRjFGMUYxIiByeD0iNzIuMDE3OSIgcnk9IjE2LjgwMzYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS40MTg5IiB4PSI3MjEuMjg4NCIgeT0iNzEuNDUyIj5Qcm90b2NvbCBCdWZmZXJzPC90ZXh0PjwvZz48IS0tZW50aXR5IC5wcm90by0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSIucHJvdG8iIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0iZW50MDAwOSIgaWQ9ImVudGl0eV8ucHJvdG8iPjxlbGxpcHNlIGN4PSI2MzEuOTk1NSIgY3k9IjE3MS4zMTM2IiBmaWxsPSIjRjFGMUYxIiByeD0iMzIuNDk1NSIgcnk9IjE0LjUyMzYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjcxMjkiIHg9IjYxMS4xMzkiIHk9IjE3NS45NjIxIj4ucHJvdG88L3RleHQ+PC9nPjwhLS1lbnRpdHkgSlNPTi0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJKU09OIiBkYXRhLXNvdXJjZS1saW5lPSIxNyIgZGF0YS11aWQ9ImVudDAwMTEiIGlkPSJlbnRpdHlfSlNPTiI+PGVsbGlwc2UgY3g9Ijk4My4wMDA3IiBjeT0iNjYuODAzNiIgZmlsbD0iI0YxRjFGMSIgcng9IjI3LjQwMDciIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIzNC41MDc4IiB4PSI5NjUuNzQ2OCIgeT0iNzEuNDUyMSI+SlNPTjwvdGV4dD48L2c+PCEtLWVudGl0eSAuZ3JhcGhxbHMtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iLmdyYXBocWxzIiBkYXRhLXNvdXJjZS1saW5lPSIxOCIgZGF0YS11aWQ9ImVudDAwMTIiIGlkPSJlbnRpdHlfLmdyYXBocWxzIj48ZWxsaXBzZSBjeD0iMTA5NC45OTY5IiBjeT0iNjYuODAzNiIgZmlsbD0iI0YxRjFGMSIgcng9IjQ5LjMxNjkiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NS41MDIiIHg9IjEwNjIuMjQ1OSIgeT0iNzEuNDUyMSI+LmdyYXBocWxzPC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iR01OMTMiIGRhdGEtc291cmNlLWxpbmU9IjIyIiBkYXRhLXVpZD0iZW50MDAxNCIgaWQ9ImVudGl0eV9HTU4xMyI+PHBhdGggZD0iTTM2OC41LDE0My42MSBMMzY4LjUsMTk5LjAwODQgTDU0NS41MDAyLDE5OS4wMDg0IEw1NDUuNTAwMiwxNTMuNjEgTDUzNS41MDAyLDE0My42MSBMMzY4LjUsMTQzLjYxIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNTM1LjUwMDIsMTQzLjYxIEw1MzUuNTAwMiwxNTMuNjEgTDU0NS41MDAyLDE1My42MSBMNTM1LjUwMDIsMTQzLjYxIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzguMDAwMSIgeD0iMzc0LjUiIHk9IjE2MC42NzY5Ij4mIzI3NzI2OyYjMjk5OTI7JiMyNDYxNTsmIzEyMzY0OyYjMzk2NDA7JiMxMjM1Njs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU2LjAwMDIiIHg9IjM3NC41IiB5PSIxNzUuODA5NyI+JiMxMjUwMjsmIzEyNTIxOyYjMTI0NTQ7JiMxMjQ3MDsmIzMwNDUyOyYjMjU1MDk7JiMxMjQ1MDsmIzEyNDYzOyYjMTI0NzU7JiMxMjQ3MzsmIzIxNDg3OyYjMzMwMjE7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNC4wMDAxIiB4PSIzNzQuNSIgeT0iMTkwLjk0MjUiPiYjMjAxNTQ7JiMzODI5MTsmIzEyMzY0OyYjMzU1MDE7JiMxMjQxNTsmIzEyNDIwOyYjMTIzNzc7JiMxMjM1Njs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xNiIgZGF0YS1zb3VyY2UtbGluZT0iMjgiIGRhdGEtdWlkPSJlbnQwMDE3IiBpZD0iZW50aXR5X0dNTjE2Ij48cGF0aCBkPSJNOTE2LjUsMTQzLjYxIEw5MTYuNSwxOTkuMDA4NCBMMTA2Ny41MDAyLDE5OS4wMDg0IEwxMDY3LjUwMDIsMTUzLjYxIEwxMDU3LjUwMDIsMTQzLjYxIEw5MTYuNSwxNDMuNjEiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0xMDU3LjUwMDIsMTQzLjYxIEwxMDU3LjUwMDIsMTUzLjYxIEwxMDY3LjUwMDIsMTUzLjYxIEwxMDU3LjUwMDIsMTQzLjYxIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzkiIHg9IjkyMi41IiB5PSIxNjAuNjc2OSI+JiMzOTY0MDsmIzI0NjE1OyYjMzMwMjE7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMC4wMDAyIiB4PSI5MjIuNSIgeT0iMTc1LjgwOTciPiYjMTI1MTA7JiMxMjQ1MjsmIzEyNDYzOyYjMTI1MjU7JiMxMjQ2OTsmIzEyNTQwOyYjMTI0OTk7JiMxMjQ3MzsmIzIxNTIxOyYjMTIzNjk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjM5IiB4PSI5MjIuNSIgeT0iMTkwLjk0MjUiPiYjMjI0MTE7JiMyMzQzMzsmIzIwODQwOzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkdNTjE5IiBkYXRhLXNvdXJjZS1saW5lPSIzNCIgZGF0YS11aWQ9ImVudDAwMjAiIGlkPSJlbnRpdHlfR01OMTkiPjxwYXRoIGQ9Ik0xMTExLDE0My42MSBMMTExMSwxOTkuMDA4NCBMMTI0OS4wMDAxLDE5OS4wMDg0IEwxMjQ5LjAwMDEsMTUzLjYxIEwxMjM5LjAwMDEsMTQzLjYxIEwxMTExLDE0My42MSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEyMzkuMDAwMSwxNDMuNjEgTDEyMzkuMDAwMSwxNTMuNjEgTDEyNDkuMDAwMSwxNTMuNjEgTDEyMzkuMDAwMSwxNDMuNjEiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC4wMDAxIiB4PSIxMTE3IiB5PSIxNjAuNjc2OSI+JiMyNjU4MDsmIzM2NTc1OyYjMTIzOTQ7JiMxMjQ2MzsmIzEyNDU2OyYjMTI1MjI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy4wMDAxIiB4PSIxMTE3IiB5PSIxNzUuODA5NyI+JiMxMjUwMTsmIzEyNTI1OyYjMTI1MzE7JiMxMjQ4ODsmIzEyNDU2OyYjMTI1MzE7JiMxMjQ4OTsmIzIxNTIxOyYjMTIzNjk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy4wMDAxIiB4PSIxMTE3IiB5PSIxOTAuOTQyNSI+JiMyMTMzNjsmIzE5OTY4OyYjMTI0NTY7JiMxMjUzMTsmIzEyNDg5OyYjMTI1MDk7JiMxMjQ1MjsmIzEyNTMxOyYjMTI0ODg7PC90ZXh0PjwvZz48IS0tbGluayByZXN0IHRvIEdNTjEzLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9InJlc3QiIGRhdGEtZW50aXR5LTI9IkdNTjEzIiBkYXRhLXNvdXJjZS1saW5lPSIyMiIgZGF0YS11aWQ9ImxuazE1IiBpZD0ibGlua19yZXN0X0dNTjEzIj48cGF0aCBkPSJNMzQ0LjA0NjgsNzQuNjE5OCBDMzQ0LjY5NjUsNzUuMTcwMSAzNDUuMzgwMSw3NS43NDkyIDM0Ni4wOTU4LDc2LjM1NTUgQzM1MS44MjA5LDgxLjIwNTMgMzU5LjU5MzEsODcuNzg5NCAzNjguMzgzOCw5NS4yMzYzIEMzODUuOTY1LDExMC4xMyA0MDcuNjIsMTI4LjQ3NSA0MjUuMTIsMTQzLjMiIGZpbGw9Im5vbmUiIGlkPSJyZXN0LUdNTjEzIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheTo3LDc7Ii8+PC9nPjwhLS1saW5rIGdycGMgdG8gR01OMTYtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZ3JwYyIgZGF0YS1lbnRpdHktMj0iR01OMTYiIGRhdGEtc291cmNlLWxpbmU9IjI4IiBkYXRhLXVpZD0ibG5rMTgiIGlkPSJsaW5rX2dycGNfR01OMTYiPjxwYXRoIGQ9Ik04OTIuMDc3Myw3NS41NjA1IEM4OTIuMTM3Myw3NS42MTgxIDg5Mi4xOTc2LDc1LjY3NiA4OTIuMjU4Miw3NS43MzQxIEM4OTIuNTAwNiw3NS45NjY3IDg5Mi43NDc0LDc2LjIwMzUgODkyLjk5ODUsNzYuNDQ0MyBDODk0LjAwMjcsNzcuNDA3OCA4OTUuMDc1Myw3OC40MzY2IDg5Ni4yMDgsNzkuNTIyNyBDODk4LjQ3MzQsODEuNjk0OSA5MDAuOTc5NCw4NC4wOTY2IDkwMy42Niw4Ni42NjM4IEM5MTQuMzgyNSw5Ni45MzI1IDkyNy45LDEwOS44NSA5NDAsMTIxLjMzIEM5NDcuNDcsMTI4LjQxIDk1NS41NiwxMzYuMDUgOTYzLjA4LDE0My4xNCIgZmlsbD0ibm9uZSIgaWQ9ImdycGMtR01OMTYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcsNzsiLz48L2c+PCEtLWxpbmsgZ3JhcGhxbCB0byBHTU4xOS0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJncmFwaHFsIiBkYXRhLWVudGl0eS0yPSJHTU4xOSIgZGF0YS1zb3VyY2UtbGluZT0iMzQiIGRhdGEtdWlkPSJsbmsyMSIgaWQ9ImxpbmtfZ3JhcGhxbF9HTU4xOSI+PHBhdGggZD0iTTExODAsMTA1LjQzMjcgQzExODAsMTA1LjkzNDkgMTE4MCwxMDYuNDM5IDExODAsMTA2Ljk0NDcgQzExODAsMTEwLjk5MDcgMTE4MCwxMTUuMTQzNCAxMTgwLDExOS4yOTM5IEMxMTgwLDEyNy41OTUgMTE4MCwxMzUuODg3NSAxMTgwLDE0My4zIiBmaWxsPSJub25lIiBpZD0iZ3JhcGhxbC1HTU4xOSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjwvZz48IS0tU1JDPVtWT19SSVc5SDU4Umx6ckRpd2FQbGI3ZzNhZXZPY2RoSHhRWVpISmZ4c1pEVEhVM2lSUDFLYmNYWUgwaEhtR29KdzQxZnFTRWlGQnI1VW15Y0wxSmhQbDZwX2tfX2J4NnNna2FBTFA4dWg0Sk11ZkhpUTU0RklIMkFId1VkdjIxNHJPWWZRRjY0WWFTMkt5NEdkbDNGWk0zNW01R3JKQm85N0JFWGFEeXp2WGgzbVpKa0g4eHZlNl9IbFJwVzVRakZMcExueGFIUnRwM25XRHpaOC05S1ptbUhxa2tkbjJHSGFpMko2eDZPSVdxWGtOSWZfS0pDSzRMVk1WOEVBNjlWSl9wTEhKODY5dVFEcU9ZZnVaMG5KUEI0OTZSX1dKZnRzTXdYc2FiVFdSTk5sb2MxYktSMFl5MmxXTHEyVS1nVUY3SW81eTNFVzNNMGpPMnpqMHlRRlZ3NkZmaERWWjRsSkJyUTdRbnRPNmNtWmdMUnJROU8xbHNBYXB5WjRJNm85MDF1NlRZdm5GOHdpNFZXaHkzcGFkLU8wb2s3c2tOVHpjc2NsTHR6M3NaX1haZ0xHZ3pMMFFqY1R3bTJobWR1YVNKb1UtMHhqWUlNcDFUdmxfSm5kMWdnbTR6YjNfanFjRks5XS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<p><strong>詳細比較表：</strong></p>
<table>
<thead>
<tr>
<th>特徴</th>
<th>REST API</th>
<th>gRPC</th>
<th>GraphQL</th>
</tr>
</thead>
<tbody>
<tr>
<td>プロトコル</td>
<td>HTTP/1.1</td>
<td>HTTP/2</td>
<td>HTTP/1.1 or HTTP/2</td>
</tr>
<tr>
<td>データ形式</td>
<td>JSON</td>
<td>Protocol Buffers</td>
<td>JSON</td>
</tr>
<tr>
<td>スキーマ</td>
<td>OpenAPI (任意)</td>
<td>.proto (必須)</td>
<td>.graphqls (必須)</td>
</tr>
<tr>
<td>シリアライゼーション</td>
<td>テキスト</td>
<td>バイナリ</td>
<td>テキスト</td>
</tr>
<tr>
<td>パフォーマンス</td>
<td>中</td>
<td>高</td>
<td>中</td>
</tr>
<tr>
<td>ストリーミング</td>
<td>WebSocket 別実装</td>
<td>ネイティブサポート</td>
<td>Subscription</td>
</tr>
<tr>
<td>ブラウザ対応</td>
<td>◎</td>
<td>△ (gRPC-Web)</td>
<td>◎</td>
</tr>
<tr>
<td>学習コスト</td>
<td>低</td>
<td>中</td>
<td>中</td>
</tr>
<tr>
<td>主な用途</td>
<td>汎用 API</td>
<td>マイクロサービス</td>
<td>フロントエンド向け</td>
</tr>
</tbody>
</table>
<p><strong>財務会計システムで gRPC を選択する場面：</strong></p>
<ol>
<li><strong>基幹システム間連携</strong>: 販売管理・購買管理との高性能な内部通信</li>
<li><strong>リアルタイム残高更新</strong>: ストリーミングによる即時反映通知</li>
<li><strong>一括仕訳処理</strong>: クライアントストリーミングによる大量データ転送</li>
<li><strong>月次締め処理</strong>: 長時間処理の進捗通知</li>
</ol>
<h3 id="223-4-rpc">22.3 4 つの RPC パターン<a class="headerlink" href="#223-4-rpc" title="Permanent link">&para;</a></h3>
<p>gRPC は 4 つの RPC パターンをサポートします。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjExMnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTM1MHB4O2hlaWdodDoxMTJweDtiYWNrZ3JvdW5kOiNGRUZFRkU7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMzUwIDExMiIgd2lkdGg9IjEzNTBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxyZWN0IGZpbGw9IiNGRUZFRkUiIGhlaWdodD0iMTEyIiBzdHlsZT0ic3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMTM1MCIgeD0iMCIgeT0iMCIvPjwhLS1jbHVzdGVyIHVuYXJ5LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJ1bmFyeSIgZGF0YS1zb3VyY2UtbGluZT0iMyIgZGF0YS11aWQ9ImVudDAwMDIiIGlkPSJjbHVzdGVyX3VuYXJ5Ij48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjgwLjA1IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjY2IiB4PSI3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0OC42MDYzIiB4PSI2NS42OTY4IiB5PSIyMS45OTUxIj4xLiAmIzIxMzM2OyYjMzg5MTc7IFJQQyAoVW5hcnkpPC90ZXh0PjwvZz48IS0tY2x1c3RlciBzZXJ2ZXJfc3RyZWFtLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJzZXJ2ZXJfc3RyZWFtIiBkYXRhLXNvdXJjZS1saW5lPSI4IiBkYXRhLXVpZD0iZW50MDAwOCIgaWQ9ImNsdXN0ZXJfc2VydmVyX3N0cmVhbSI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI4MC4wNSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjMwNCIgeD0iMjk3IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxMC4xMjI0IiB4PSIzNDMuOTM4OCIgeT0iMjEuOTk1MSI+Mi4gJiMxMjQ2OTsmIzEyNTQwOyYjMTI0OTY7JiMxMjU0MDsmIzEyNDczOyYjMTI0ODg7JiMxMjUyMjsmIzEyNTQwOyYjMTI1MTE7JiMxMjUzMTsmIzEyNDY0OyBSUEM8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGNsaWVudF9zdHJlYW0tLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1lbnRpdHk9ImNsaWVudF9zdHJlYW0iIGRhdGEtc291cmNlLWxpbmU9IjE1IiBkYXRhLXVpZD0iZW50MDAxOCIgaWQ9ImNsdXN0ZXJfY2xpZW50X3N0cmVhbSI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI4MC4wNSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjI5NSIgeD0iNjI1IiB5PSI3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIzOC4xMjIzIiB4PSI2NTMuNDM4OSIgeT0iMjEuOTk1MSI+My4gJiMxMjQ2MzsmIzEyNTIxOyYjMTI0NTI7JiMxMjQ1MDsmIzEyNTMxOyYjMTI0ODg7JiMxMjQ3MzsmIzEyNDg4OyYjMTI1MjI7JiMxMjU0MDsmIzEyNTExOyYjMTI1MzE7JiMxMjQ2NDsgUlBDPC90ZXh0PjwvZz48IS0tY2x1c3RlciBiaWRpcmVjdGlvbmFsLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtZW50aXR5PSJiaWRpcmVjdGlvbmFsIiBkYXRhLXNvdXJjZS1saW5lPSIyMiIgZGF0YS11aWQ9ImVudDAwMjYiIGlkPSJjbHVzdGVyX2JpZGlyZWN0aW9uYWwiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iODAuMDUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI0MDAiIHg9Ijk0NCIgeT0iNyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxOTYuMTIyNCIgeD0iMTA0NS45Mzg4IiB5PSIyMS45OTUxIj40LiAmIzIxNDUyOyYjMjYwNDE7JiMyMTUyMTsmIzEyNDczOyYjMTI0ODg7JiMxMjUyMjsmIzEyNTQwOyYjMTI1MTE7JiMxMjUzMTsmIzEyNDY0OyBSUEM8L3RleHQ+PC9nPjwhLS1lbnRpdHkgQ2xpZW50LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IkNsaWVudCIgZGF0YS1zb3VyY2UtbGluZT0iNCIgZGF0YS11aWQ9ImVudDAwMDMiIGlkPSJlbnRpdHlfQ2xpZW50Ij48ZWxsaXBzZSBjeD0iNTQuOTk5MiIgY3k9IjU2LjUzMzYiIGZpbGw9IiNGMUYxRjEiIHJ4PSIzMS42NTkyIiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDAuNTMwMyIgeD0iMzQuNzM0MSIgeT0iNjEuMTgyMSI+Q2xpZW50PC90ZXh0PjwvZz48IS0tZW50aXR5IFNlcnZlci0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJTZXJ2ZXIiIGRhdGEtc291cmNlLWxpbmU9IjQiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X1NlcnZlciI+PGVsbGlwc2UgY3g9IjIyMi4wMDM0IiBjeT0iNTYuNTMzNiIgZmlsbD0iI0YxRjFGMSIgcng9IjM1LjQ2MzQiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0NS45MTAyIiB4PSIxOTkuMDQ4MyIgeT0iNjEuMTgyMSI+U2VydmVyPC90ZXh0PjwvZz48IS0tZW50aXR5IENsaWVudDItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQ2xpZW50MiIgZGF0YS1zb3VyY2UtbGluZT0iOSIgZGF0YS11aWQ9ImVudDAwMDkiIGlkPSJlbnRpdHlfQ2xpZW50MiI+PGVsbGlwc2UgY3g9IjM1MC45OTc2IiBjeT0iNTYuNTMzNiIgZmlsbD0iI0YxRjFGMSIgcng9IjM3Ljk1NzYiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OS40Mzc1IiB4PSIzMjYuMjc4OCIgeT0iNjEuMTgyMSI+Q2xpZW50MjwvdGV4dD48L2c+PCEtLWVudGl0eSBTZXJ2ZXIyLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IlNlcnZlcjIiIGRhdGEtc291cmNlLWxpbmU9IjkiIGRhdGEtdWlkPSJlbnQwMDEwIiBpZD0iZW50aXR5X1NlcnZlcjIiPjxlbGxpcHNlIGN4PSI1NDMuMDAxNyIgY3k9IjU2LjUzMzYiIGZpbGw9IiNGMUYxRjEiIHJ4PSI0MS43NjE3IiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTQuODE3NCIgeD0iNTE1LjU5MzEiIHk9IjYxLjE4MjEiPlNlcnZlcjI8L3RleHQ+PC9nPjwhLS1lbnRpdHkgQ2xpZW50My0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJDbGllbnQzIiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgZGF0YS11aWQ9ImVudDAwMTkiIGlkPSJlbnRpdHlfQ2xpZW50MyI+PGVsbGlwc2UgY3g9IjY3OC45OTc2IiBjeT0iNTYuNTMzNiIgZmlsbD0iI0YxRjFGMSIgcng9IjM3Ljk1NzYiIHJ5PSIxNC41MjM2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OS40Mzc1IiB4PSI2NTQuMjc4OCIgeT0iNjEuMTgyMSI+Q2xpZW50MzwvdGV4dD48L2c+PCEtLWVudGl0eSBTZXJ2ZXIzLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1lbnRpdHk9IlNlcnZlcjMiIGRhdGEtc291cmNlLWxpbmU9IjE2IiBkYXRhLXVpZD0iZW50MDAyMCIgaWQ9ImVudGl0eV9TZXJ2ZXIzIj48ZWxsaXBzZSBjeD0iODYyLjAwMTciIGN5PSI1Ni41MzM2IiBmaWxsPSIjRjFGMUYxIiByeD0iNDEuNzYxNyIgcnk9IjE0LjUyMzYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU0LjgxNzQiIHg9IjgzNC41OTMxIiB5PSI2MS4xODIxIj5TZXJ2ZXIzPC90ZXh0PjwvZz48IS0tZW50aXR5IENsaWVudDQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0iQ2xpZW50NCIgZGF0YS1zb3VyY2UtbGluZT0iMjMiIGRhdGEtdWlkPSJlbnQwMDI3IiBpZD0iZW50aXR5X0NsaWVudDQiPjxlbGxpcHNlIGN4PSI5OTcuOTk3NiIgY3k9IjU2LjUzMzYiIGZpbGw9IiNGMUYxRjEiIHJ4PSIzNy45NTc2IiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDkuNDM3NSIgeD0iOTczLjI3ODgiIHk9IjYxLjE4MjEiPkNsaWVudDQ8L3RleHQ+PC9nPjwhLS1lbnRpdHkgU2VydmVyNC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJTZXJ2ZXI0IiBkYXRhLXNvdXJjZS1saW5lPSIyMyIgZGF0YS11aWQ9ImVudDAwMjgiIGlkPSJlbnRpdHlfU2VydmVyNCI+PGVsbGlwc2UgY3g9IjEyODYuMDAxNyIgY3k9IjU2LjUzMzYiIGZpbGw9IiNGMUYxRjEiIHJ4PSI0MS43NjE3IiByeT0iMTQuNTIzNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTQuODE3NCIgeD0iMTI1OC41OTMxIiB5PSI2MS4xODIxIj5TZXJ2ZXI0PC90ZXh0PjwvZz48IS0tbGluayBDbGllbnQgdG8gU2VydmVyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkNsaWVudCIgZGF0YS1lbnRpdHktMj0iU2VydmVyIiBkYXRhLXNvdXJjZS1saW5lPSI0IiBkYXRhLXVpZD0ibG5rNSIgaWQ9ImxpbmtfQ2xpZW50X1NlcnZlciI+PHBhdGggZD0iTTc3LjkzLDY3LjA1IEM4Ny4zNyw3MC44NCA5OC41NSw3NC42NCAxMDkuMSw3Ni41MyBDMTMzLjE2LDgwLjgzIDEzOS45OSw4MC41NyAxNjQuMSw3Ni41MyBDMTc1LjIyLDc0LjY2IDE4MS40Mjc5LDczLjAwNTcgMTkxLjQ4NzksNjkuMjU1NyIgZmlsbD0ibm9uZSIgaWQ9IkNsaWVudC10by1TZXJ2ZXIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjE5Ny4xMSw2Ny4xNiwxODcuMjc5Nyw2Ni41NTU1LDE5Mi40MjQ5LDY4LjkwNjQsMTkwLjA3NCw3NC4wNTE2LDE5Ny4xMSw2Ny4xNiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjUzLjM5MDEiIHg9IjExMC4xIiB5PSI3Mi41OTY5Ij5SZXF1ZXN0PC90ZXh0PjwvZz48IS0tcmV2ZXJzZSBsaW5rIENsaWVudCB0byBTZXJ2ZXItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQ2xpZW50IiBkYXRhLWVudGl0eS0yPSJTZXJ2ZXIiIGRhdGEtc291cmNlLWxpbmU9IjUiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19DbGllbnRfU2VydmVyIj48cGF0aCBkPSJNOTIuOCw1Ni41MyBDMTIxLjIsNTYuNTMgMTU2LjczLDU2LjUzIDE4Ni4yNiw1Ni41MyIgZmlsbD0ibm9uZSIgaWQ9IkNsaWVudC1iYWNrdG8tU2VydmVyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI4Ni44LDU2LjUzLDk1LjgsNjAuNTMsOTEuOCw1Ni41Myw5NS44LDUyLjUzLDg2LjgsNTYuNTMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2My4wMTk1IiB4PSIxMDUuMSIgeT0iNDkuNTk2OSI+UmVzcG9uc2U8L3RleHQ+PC9nPjwhLS1saW5rIENsaWVudDIgdG8gU2VydmVyMi0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDbGllbnQyIiBkYXRhLWVudGl0eS0yPSJTZXJ2ZXIyIiBkYXRhLXNvdXJjZS1saW5lPSI5IiBkYXRhLXVpZD0ibG5rMTEiIGlkPSJsaW5rX0NsaWVudDJfU2VydmVyMiI+PHBhdGggZD0iTTM2My42NCw3MC4zMyBDMzc0LjAzLDgwLjU5IDM4OS43NCw5My43NyA0MDYuNiw5OS41MyBDNDIyLjc5LDEwNS4wNiA0NjcuMzIsMTA0LjggNDgzLjYsOTkuNTMgQzUwMS4yOCw5My44IDUxMy42OTc3LDg0LjY3NTEgNTI0Ljg5NzcsNzQuNDA1MSIgZmlsbD0ibm9uZSIgaWQ9IkNsaWVudDItdG8tU2VydmVyMiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNTI5LjMyLDcwLjM1LDUxOS45ODMyLDczLjQ4NDQsNTI1LjYzNDgsNzMuNzI5Miw1MjUuMzksNzkuMzgwOCw1MjkuMzIsNzAuMzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1My4zOTAxIiB4PSI0MTguNiIgeT0iOTUuNTk2OSI+UmVxdWVzdDwvdGV4dD48L2c+PCEtLXJldmVyc2UgbGluayBDbGllbnQyIHRvIFNlcnZlcjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQ2xpZW50MiIgZGF0YS1lbnRpdHktMj0iU2VydmVyMiIgZGF0YS1zb3VyY2UtbGluZT0iMTAiIGRhdGEtdWlkPSJsbmsxMyIgaWQ9ImxpbmtfQ2xpZW50Ml9TZXJ2ZXIyIj48cGF0aCBkPSJNMzgxLjg0NDUsNjkuODMyMiBDMzkxLjE4NDUsNzMuNDAyMiAzOTYuMzksNzQuNzUgNDA2LjYsNzYuNTMgQzQ0MC4zMSw4Mi40MSA0NDkuODMsODIuMDYgNDgzLjYsNzYuNTMgQzQ5NC4zNCw3NC43NyA1MDUuNzUsNzEuMzMgNTE1LjY3LDY3LjgiIGZpbGw9Im5vbmUiIGlkPSJDbGllbnQyLWJhY2t0by1TZXJ2ZXIyIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNzYuMjQsNjcuNjksMzgzLjIxODcsNzQuNjM5NywzODAuOTEwNSw2OS40NzUyLDM4Ni4wNzUsNjcuMTY2OSwzNzYuMjQsNjcuNjkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3NS40MjI5IiB4PSI0MDcuNiIgeT0iNzIuNTk2OSI+UmVzcG9uc2UgMTwvdGV4dD48L2c+PCEtLXJldmVyc2UgbGluayBDbGllbnQyIHRvIFNlcnZlcjItLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iQ2xpZW50MiIgZGF0YS1lbnRpdHktMj0iU2VydmVyMiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGRhdGEtdWlkPSJsbmsxNSIgaWQ9ImxpbmtfQ2xpZW50Ml9TZXJ2ZXIyIj48cGF0aCBkPSJNMzgxLjg4MTgsNDMuMTEwNiBDMzkxLjA4MTgsMzkuNTgwNiAzOTYuMDgsMzguMjkgNDA2LjEsMzYuNTMgQzQ0MC4yNCwzMC41MiA0NDkuODksMzAuODggNDg0LjEsMzYuNTMgQzQ5NC42NSwzOC4yNyA1MDUuODUsNDEuNjUgNTE1LjYxLDQ1LjE1IiBmaWxsPSJub25lIiBpZD0iQ2xpZW50Mi1iYWNrdG8tU2VydmVyMi0xIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNzYuMjgsNDUuMjYsMzg2LjExNTYsNDUuNzcwNSwzODAuOTQ4Miw0My40Njg4LDM4My4yNDk4LDM4LjMwMTQsMzc2LjI4LDQ1LjI2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzUuNDIyOSIgeD0iNDA3LjYiIHk9IjI2LjU5NjkiPlJlc3BvbnNlIDI8L3RleHQ+PC9nPjwhLS1yZXZlcnNlIGxpbmsgQ2xpZW50MiB0byBTZXJ2ZXIyLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkNsaWVudDIiIGRhdGEtZW50aXR5LTI9IlNlcnZlcjIiIGRhdGEtc291cmNlLWxpbmU9IjEyIiBkYXRhLXVpZD0ibG5rMTciIGlkPSJsaW5rX0NsaWVudDJfU2VydmVyMiI+PHBhdGggZD0iTTM5NS4zOSw1Ni41MyBDNDI3LjY4LDU2LjUzIDQ2Ny43NSw1Ni41MyA1MDEuMDEsNTYuNTMiIGZpbGw9Im5vbmUiIGlkPSJDbGllbnQyLWJhY2t0by1TZXJ2ZXIyLTIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM4OS4zOSw1Ni41MywzOTguMzksNjAuNTMsMzk0LjM5LDU2LjUzLDM5OC4zOSw1Mi41MywzODkuMzksNTYuNTMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3Ni44NzY1IiB4PSI0MDcuMSIgeT0iNDkuNTk2OSI+UmVzcG9uc2UgTjwvdGV4dD48L2c+PCEtLWxpbmsgQ2xpZW50MyB0byBTZXJ2ZXIzLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkNsaWVudDMiIGRhdGEtZW50aXR5LTI9IlNlcnZlcjMiIGRhdGEtc291cmNlLWxpbmU9IjE2IiBkYXRhLXVpZD0ibG5rMjEiIGlkPSJsaW5rX0NsaWVudDNfU2VydmVyMyI+PHBhdGggZD0iTTcwNC40OCw2Ny42OSBDNzEzLjkxLDcxLjI2IDcyNC44MSw3NC43NSA3MzUuMSw3Ni41MyBDNzY0LjQ0LDgxLjYgNzcyLjcxLDgxLjMgODAyLjEsNzYuNTMgQzgxMi45Miw3NC43NyA4MTguNzcyMiw3My4zMjcyIDgyOC43NzIyLDY5Ljc5NzIiIGZpbGw9Im5vbmUiIGlkPSJDbGllbnQzLXRvLVNlcnZlcjMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjgzNC40Myw2Ny44LDgyNC42MTE4LDY3LjAyMzksODI5LjcxNTEsNjkuNDY0Myw4MjcuMjc0Nyw3NC41Njc3LDgzNC40Myw2Ny44IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjUuNzkzNSIgeD0iNzM2LjEiIHk9IjcyLjU5NjkiPlJlcXVlc3QgMTwvdGV4dD48L2c+PCEtLWxpbmsgQ2xpZW50MyB0byBTZXJ2ZXIzLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9IkNsaWVudDMiIGRhdGEtZW50aXR5LTI9IlNlcnZlcjMiIGRhdGEtc291cmNlLWxpbmU9IjE3IiBkYXRhLXVpZD0ibG5rMjIiIGlkPSJsaW5rX0NsaWVudDNfU2VydmVyMyI+PHBhdGggZD0iTTcwNC4yOCw0NS4yNiBDNzEzLjQ4LDQxLjczIDcyNC4wOCwzOC4yOSA3MzQuMSwzNi41MyBDNzY0LjMsMzEuMjEgNzcyLjg0LDMxLjUzIDgwMy4xLDM2LjUzIEM4MTMuNjUsMzguMjcgODE5LjIwMjIsMzkuNjI0NyA4MjguOTYyMiw0My4xMjQ3IiBmaWxsPSJub25lIiBpZD0iQ2xpZW50My10by1TZXJ2ZXIzLTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjgzNC42MSw0NS4xNSw4MjcuNDg4NSwzOC4zNDY4LDgyOS45MDM1LDQzLjQ2MjIsODI0Ljc4OCw0NS44NzcyLDgzNC42MSw0NS4xNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY1Ljc5MzUiIHg9IjczNi4xIiB5PSIyNi41OTY5Ij5SZXF1ZXN0IDI8L3RleHQ+PC9nPjwhLS1saW5rIENsaWVudDMgdG8gU2VydmVyMy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDbGllbnQzIiBkYXRhLWVudGl0eS0yPSJTZXJ2ZXIzIiBkYXRhLXNvdXJjZS1saW5lPSIxOCIgZGF0YS11aWQ9ImxuazIzIiBpZD0ibGlua19DbGllbnQzX1NlcnZlcjMiPjxwYXRoIGQ9Ik03MTcuMzYsNTYuNTMgQzc0Ny4zNCw1Ni41MyA3ODIuOTYsNTYuNTMgODEzLjg2LDU2LjUzIiBmaWxsPSJub25lIiBpZD0iQ2xpZW50My10by1TZXJ2ZXIzLTIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjgxOS44Niw1Ni41Myw4MTAuODYsNTIuNTMsODE0Ljg2LDU2LjUzLDgxMC44Niw2MC41Myw4MTkuODYsNTYuNTMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2Ny4yNDcxIiB4PSI3MzUuMSIgeT0iNDkuNTk2OSI+UmVxdWVzdCBOPC90ZXh0PjwvZz48IS0tcmV2ZXJzZSBsaW5rIENsaWVudDMgdG8gU2VydmVyMy0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDbGllbnQzIiBkYXRhLWVudGl0eS0yPSJTZXJ2ZXIzIiBkYXRhLXNvdXJjZS1saW5lPSIxOSIgZGF0YS11aWQ9ImxuazI1IiBpZD0ibGlua19DbGllbnQzX1NlcnZlcjMiPjxwYXRoIGQ9Ik02OTYuMDYxNCw3NC41MjMzIEM3MDYuNTYxNCw4NC43ODMzIDcxOC4xMyw5My43NyA3MzUuMSw5OS41MyBDNzQ5LjIsMTA0LjMxIDc4Ny45MiwxMDQuMDkgODAyLjEsOTkuNTMgQzgxOS44OSw5My44IDgzNi44Nyw4MC42MiA4NDguMTgsNzAuMzUiIGZpbGw9Im5vbmUiIGlkPSJDbGllbnQzLWJhY2t0by1TZXJ2ZXIzIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2OTEuNzcsNzAuMzMsNjk1LjQxMTYsNzkuNDgwOSw2OTUuMzQ2Miw3My44MjQ0LDcwMS4wMDI2LDczLjc1OSw2OTEuNzcsNzAuMzMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2My4wMTk1IiB4PSI3MzcuMSIgeT0iOTUuNTk2OSI+UmVzcG9uc2U8L3RleHQ+PC9nPjwhLS1saW5rIENsaWVudDQgdG8gU2VydmVyNC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJDbGllbnQ0IiBkYXRhLWVudGl0eS0yPSJTZXJ2ZXI0IiBkYXRhLXNvdXJjZS1saW5lPSIyMyIgZGF0YS11aWQ9ImxuazI5IiBpZD0ibGlua19DbGllbnQ0X1NlcnZlcjQiPjxwYXRoIGQ9Ik0xMDQyLjI0LDU2LjUzIEMxMDk2LjEsNTYuNTMgMTE4MS45Niw1Ni41MyAxMjM3Ljg1LDU2LjUzIiBmaWxsPSJub25lIiBpZD0iQ2xpZW50NC1TZXJ2ZXI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMDM2LjI0LDU2LjUzLDEwNDUuMjQsNjAuNTMsMTA0MS4yNCw1Ni41MywxMDQ1LjI0LDUyLjUzLDEwMzYuMjQsNTYuNTMiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjEyNDMuODUsNTYuNTMsMTIzNC44NSw1Mi41MywxMjM4Ljg1LDU2LjUzLDEyMzQuODUsNjAuNTMsMTI0My44NSw1Ni41MyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE3Mi4yNDM3IiB4PSIxMDU0LjEiIHk9IjQ5LjU5NjkiPlJlcXVlc3QvUmVzcG9uc2UgU3RyZWFtPC90ZXh0PjwvZz48IS0tU1JDPVtaUDkxSXlDbTY4UmxfSEtWelQ4VURiZFFhdVlOZWlTWDZ2dWJ3czhEZy1iQ01hNzRJdUZXR041VW45aVlrLVg1R0ptQ18zVFhXbF8yOWMzVExZYWI0NDl1bC1IdmxhSUNBMWpaWmV6V1dDREhuOUVDM09DYUpaWWl4TXBoT0xjU1gyYmNLS3AweGhIWFZkdF9fTlcxbFRxMGQzczYtUWJoMG5RR3dJTVNNS3VHS3k5STVyZ1NIZVRmUW1rU0ZrNGRYQmttME5RRjc2VDRmQlBMUmhQWVNjMUlsdEtjOVNPOTR5SXNwZlRrSHNyRy1PVUlkcWZFejlwRmJCbkt5aU5pRjJadmhsOHQzTVEwWEJiV053SVM1NzhiNkFnSWVOX0hLOEtEQlM1MWZ0YUtET3pzTHdLekJWc2d2QkZBZm9mX3FmUTVUQXJ3UTB3a2c3akxUTXpIdEhXclpBQmNxTXVmeHJOYWxUaHR6ZWxWVGRGclRKVVJKc3hoWkdUcUk3S1hKSFlFX3VuejVwUE51Vm41a0ZNb3h0dEpoOEJXMW0wMF0tLT48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<p><strong>各パターンの用途（財務会計システム）：</strong></p>
<table>
<thead>
<tr>
<th>パターン</th>
<th>用途例</th>
</tr>
</thead>
<tbody>
<tr>
<td>単項 RPC</td>
<td>勘定科目取得、仕訳登録</td>
</tr>
<tr>
<td>サーバーストリーミング</td>
<td>仕訳一覧取得、残高照会</td>
</tr>
<tr>
<td>クライアントストリーミング</td>
<td>仕訳明細の一括登録</td>
</tr>
<tr>
<td>双方向ストリーミング</td>
<td>リアルタイム残高同期</td>
</tr>
</tbody>
</table>
<h3 id="224-grpc">22.4 gRPC におけるヘキサゴナルアーキテクチャ<a class="headerlink" href="#224-grpc" title="Permanent link">&para;</a></h3>
<p>gRPC を導入しても、ヘキサゴナルアーキテクチャ（ドメイン層・アプリケーション層）はそのまま共有し、<strong>Input Adapter として gRPC サービス層のみを追加</strong>します。</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjY1MXB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NzAycHg7aGVpZ2h0OjY1MXB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDcwMiA2NTEiIHdpZHRoPSI3MDJweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbHVzdGVyIEhleGFnb25hbCBBcmNoaXRlY3R1cmUgKGdSUEM/KS0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLWVudGl0eT0iSGV4YWdvbmFsIEFyY2hpdGVjdHVyZSAuZ1JQQy4uIiBkYXRhLXNvdXJjZS1saW5lPSIzIiBkYXRhLXVpZD0iZW50MDAwMiIgaWQ9ImNsdXN0ZXJfSGV4YWdvbmFsIEFyY2hpdGVjdHVyZSAuZ1JQQy4uIj48cGF0aCBkPSJNMjA0LjM2LDYgTDQ2NS4xMzI0LDYgQTMuNzUsMy43NSAwIDAgMSA0NjcuNjMyNCw4LjUgTDQ3NC42MzI0LDI4LjI5NjkgTDQ3NC4zNiwyOC4yOTY5IEEyLjUsMi41IDAgMCAxIDQ3Ni44NiwzMC43OTY5IEw0NzYuODYsNjQyLjQ0IEEyLjUsMi41IDAgMCAxIDQ3NC4zNiw2NDQuOTQgTDIwNC4zNiw2NDQuOTQgQTIuNSwyLjUgMCAwIDEgMjAxLjg2LDY0Mi40NCBMMjAxLjg2LDguNSBBMi41LDIuNSAwIDAgMSAyMDQuMzYsNiIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxLjU7IiB4MT0iMjAxLjg2IiB4Mj0iNDc0LjYzMjQiIHkxPSIyOC4yOTY5IiB5Mj0iMjguMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNTkuNzcyNCIgeD0iMjA1Ljg2IiB5PSIyMC45OTUxIj5IZXhhZ29uYWwgQXJjaGl0ZWN0dXJlIChnUlBDJiMyOTI1NjspPC90ZXh0PjwvZz48IS0tY2xhc3MgY29yZS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJjb3JlIiBkYXRhLXNvdXJjZS1saW5lPSI1IiBkYXRhLXVpZD0iZW50MDAwMyIgaWQ9ImVudGl0eV9jb3JlIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjE3Mi42NzE5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDkuMjY0NCIgeD0iMjUxLjIzIiB5PSIyNTYuNzgiLz48ZWxsaXBzZSBjeD0iMjc0Ljg4MSIgY3k9IjI3OC4wNzY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yNzcuODQ5NywyODMuNzE3NSBRMjc3LjI3MTYsMjg0LjAxNDQgMjc2LjYzMSwyODQuMTU1IFEyNzUuOTkwMywyODQuMzExMyAyNzUuMjg3MiwyODQuMzExMyBRMjcyLjc4NzIsMjg0LjMxMTMgMjcxLjQ1OTEsMjgyLjY3MDYgUTI3MC4xNDY2LDI4MS4wMTQ0IDI3MC4xNDY2LDI3Ny44ODk0IFEyNzAuMTQ2NiwyNzQuNzY0NCAyNzEuNDU5MSwyNzMuMTA4MSBRMjcyLjc4NzIsMjcxLjQ1MTkgMjc1LjI4NzIsMjcxLjQ1MTkgUTI3NS45OTAzLDI3MS40NTE5IDI3Ni42MzEsMjcxLjYwODEgUTI3Ny4yODcyLDI3MS43NjQ0IDI3Ny44NDk3LDI3Mi4wNjEzIEwyNzcuODQ5NywyNzQuNzggUTI3Ny4yMjQ3LDI3NC4yMDE5IDI3Ni42MzEsMjczLjkzNjMgUTI3Ni4wMzcyLDI3My42NTUgMjc1LjQxMjIsMjczLjY1NSBRMjc0LjA2ODUsMjczLjY1NSAyNzMuMzgxLDI3NC43MzMxIFEyNzIuNjkzNSwyNzUuNzk1NiAyNzIuNjkzNSwyNzcuODg5NCBRMjcyLjY5MzUsMjc5Ljk4MzEgMjczLjM4MSwyODEuMDYxMyBRMjc0LjA2ODUsMjgyLjEyMzggMjc1LjQxMjIsMjgyLjEyMzggUTI3Ni4wMzcyLDI4Mi4xMjM4IDI3Ni42MzEsMjgxLjg1ODEgUTI3Ny4yMjQ3LDI4MS41NzY5IDI3Ny44NDk3LDI4MC45OTg4IEwyNzcuODQ5NywyODMuNzE3NSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNS4zODM4IiB4PSIzMTIuMTMxNSIgeT0iMjc0Ljc3NTEiPkFwcGxpY2F0aW9uIENvcmU8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU4LjA0IiB4PSIyOTAuODAzNCIgeT0iMjkxLjA3MiI+KERvbWFpbiArIFVzZSBDYXNlcyk8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjUyLjIzIiB4Mj0iNDU5LjQ5NDQiIHkxPSIyOTkuMzczOCIgeTI9IjI5OS4zNzM4Ii8+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMjU5LjIzIiB5PSIzMTAuMDIyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy4xODg1IiB4PSIyNzEuMjMiIHk9IjMxNi4zNjg5Ij5BY2NvdW50VXNlQ2FzZTwvdGV4dD48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIyNTkuMjMiIHk9IjMyNi4zMTkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA5LjA4MTEiIHg9IjI3MS4yMyIgeT0iMzMyLjY2NTciPkpvdXJuYWxVc2VDYXNlPC90ZXh0PjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjI1OS4yMyIgeT0iMzQyLjYxNTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTYuMjUyIiB4PSIyNzEuMjMiIHk9IjM0OC45NjI2Ij5CYWxhbmNlVXNlQ2FzZTwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIyNTIuMjMiIHgyPSI0NTkuNDk0NCIgeTE9IjM1Ni4yNjQ0IiB5Mj0iMzU2LjI2NDQiLz48cmVjdCBmaWxsPSIjRjI0RDVDIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIyNTkuMjMiIHk9IjM2Ni45MTI4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI4LjE0NjIiIHg9IjI3MS4yMyIgeT0iMzczLjI1OTUiPkFjY291bnQgKCYjMjEyMDg7JiMyMzQ1MDsmIzMxMTg1OyYjMzA0NDY7KTwvdGV4dD48cmVjdCBmaWxsPSIjRjI0RDVDIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIyNTkuMjMiIHk9IjM4My4yMDk3Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTIuMDM4OSIgeD0iMjcxLjIzIiB5PSIzODkuNTU2NCI+Sm91cm5hbCAoJiMyMDE4MTsmIzM1Mzc5Oyk8L3RleHQ+PHJlY3QgZmlsbD0iI0YyNEQ1QyIgaGVpZ2h0PSI2IiBzdHlsZT0ic3Ryb2tlOiNDODI5MzA7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNiIgeD0iMjU5LjIzIiB5PSIzOTkuNTA2NiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2Mi42MzM1IiB4PSIyNzEuMjMiIHk9IjQwNS44NTMyIj5EYWlseUJhbGFuY2UgKCYjMjYwODU7JiMyNzQyNTsmIzI3NTMxOyYjMzk2NDA7KTwvdGV4dD48cmVjdCBmaWxsPSIjRjI0RDVDIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIyNTkuMjMiIHk9IjQxNS44MDM0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTgzLjI2NDQiIHg9IjI3MS4yMyIgeT0iNDIyLjE1MDEiPk1vbnRobHlCYWxhbmNlICgmIzI2Mzc2OyYjMjc0MjU7JiMyNzUzMTsmIzM5NjQwOyk8L3RleHQ+PC9nPjwhLS1jbGFzcyBpbnB1dC0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJpbnB1dCIgZGF0YS1zb3VyY2UtbGluZT0iMTUiIGRhdGEtdWlkPSJlbnQwMDA0IiBpZD0iZW50aXR5X2lucHV0Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEyMy43ODEzIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyMDMuMDIzMSIgeD0iMjUzLjM1IiB5PSI0MSIvPjxlbGxpcHNlIGN4PSIyOTguNzE5OSIgY3k9IjYyLjI5NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTMwMS42ODg3LDY3LjkzNzUgUTMwMS4xMTA2LDY4LjIzNDQgMzAwLjQ2OTksNjguMzc1IFEyOTkuODI5Myw2OC41MzEzIDI5OS4xMjYyLDY4LjUzMTMgUTI5Ni42MjYyLDY4LjUzMTMgMjk1LjI5ODEsNjYuODkwNiBRMjkzLjk4NTYsNjUuMjM0NCAyOTMuOTg1Niw2Mi4xMDk0IFEyOTMuOTg1Niw1OC45ODQ0IDI5NS4yOTgxLDU3LjMyODEgUTI5Ni42MjYyLDU1LjY3MTkgMjk5LjEyNjIsNTUuNjcxOSBRMjk5LjgyOTMsNTUuNjcxOSAzMDAuNDY5OSw1NS44MjgxIFEzMDEuMTI2Miw1NS45ODQ0IDMwMS42ODg3LDU2LjI4MTMgTDMwMS42ODg3LDU5IFEzMDEuMDYzNyw1OC40MjE5IDMwMC40Njk5LDU4LjE1NjMgUTI5OS44NzYyLDU3Ljg3NSAyOTkuMjUxMiw1Ny44NzUgUTI5Ny45MDc0LDU3Ljg3NSAyOTcuMjE5OSw1OC45NTMxIFEyOTYuNTMyNCw2MC4wMTU2IDI5Ni41MzI0LDYyLjEwOTQgUTI5Ni41MzI0LDY0LjIwMzEgMjk3LjIxOTksNjUuMjgxMyBRMjk3LjkwNzQsNjYuMzQzOCAyOTkuMjUxMiw2Ni4zNDM4IFEyOTkuODc2Miw2Ni4zNDM4IDMwMC40Njk5LDY2LjA3ODEgUTMwMS4wNjM3LDY1Ljc5NjkgMzAxLjY4ODcsNjUuMjE4OCBMMzAxLjY4ODcsNjcuOTM3NSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwMy43ODMyIiB4PSIzMTkuMjE5OSIgeT0iNTguOTk1MSI+SW5wdXQgQWRhcHRlcnM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTYuMDEwNyIgeD0iMzIzLjEwNjIiIHk9Ijc1LjI5MiI+KERyaXZpbmcgU2lkZSk8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjU0LjM1IiB4Mj0iNDU1LjM3MzEiIHkxPSI4My41OTM4IiB5Mj0iODMuNTkzOCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjI2MS4zNSIgeT0iOTQuMjQyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2NS42MzQ1IiB4PSIyNzMuMzUiIHk9IjEwMC41ODg5Ij5SRVNUIENvbnRyb2xsZXImIzY1Mjg4OyYjMjYwODI7JiMyMzM4NDsmIzY1Mjg5OzwvdGV4dD48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIyNjEuMzUiIHk9IjExMC41MzkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc3LjAyMzEiIHg9IjI3My4zNSIgeT0iMTE2Ljg4NTciPmdSUEMgU2VydmljZSYjNjUyODg7JiMyNjAzMjsmIzM1MjE1OyYjMzY4NjE7JiMyMTE1MjsmIzY1Mjg5OzwvdGV4dD48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9IjYiIHN0eWxlPSJzdHJva2U6I0M4MjkzMDtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSI2IiB4PSIyNjEuMzUiIHk9IjEyNi44MzU5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE1LjE4NTUiIHg9IjI3My4zNSIgeT0iMTMzLjE4MjYiPlN0cmVhbU9ic2VydmVyPC90ZXh0PjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjI2MS4zNSIgeT0iMTQzLjEzMjgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjMuNzc4MyIgeD0iMjczLjM1IiB5PSIxNDkuNDc5NSI+U2VydmVySW50ZXJjZXB0b3I8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjU0LjM1IiB4Mj0iNDU1LjM3MzEiIHkxPSIxNTYuNzgxMyIgeTI9IjE1Ni43ODEzIi8+PC9nPjwhLS1jbGFzcyBvdXRwdXQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLWVudGl0eT0ib3V0cHV0IiBkYXRhLXNvdXJjZS1saW5lPSIyMiIgZGF0YS11aWQ9ImVudDAwMDUiIGlkPSJlbnRpdHlfb3V0cHV0Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEwNy40ODQ0IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNjAuNzQzMiIgeD0iMjczLjQ5IiB5PSI1MjEuNDYiLz48ZWxsaXBzZSBjeD0iMjk0LjE1MSIgY3k9IjU0Mi43NTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yOTcuMTE5OCw1NDguMzk3NSBRMjk2LjU0MTcsNTQ4LjY5NDQgMjk1LjkwMSw1NDguODM1IFEyOTUuMjYwNCw1NDguOTkxMyAyOTQuNTU3Myw1NDguOTkxMyBRMjkyLjA1NzMsNTQ4Ljk5MTMgMjkwLjcyOTIsNTQ3LjM1MDYgUTI4OS40MTY3LDU0NS42OTQ0IDI4OS40MTY3LDU0Mi41Njk0IFEyODkuNDE2Nyw1MzkuNDQ0NCAyOTAuNzI5Miw1MzcuNzg4MSBRMjkyLjA1NzMsNTM2LjEzMTkgMjk0LjU1NzMsNTM2LjEzMTkgUTI5NS4yNjA0LDUzNi4xMzE5IDI5NS45MDEsNTM2LjI4ODEgUTI5Ni41NTczLDUzNi40NDQ0IDI5Ny4xMTk4LDUzNi43NDEzIEwyOTcuMTE5OCw1MzkuNDYgUTI5Ni40OTQ4LDUzOC44ODE5IDI5NS45MDEsNTM4LjYxNjMgUTI5NS4zMDczLDUzOC4zMzUgMjk0LjY4MjMsNTM4LjMzNSBRMjkzLjMzODUsNTM4LjMzNSAyOTIuNjUxLDUzOS40MTMxIFEyOTEuOTYzNSw1NDAuNDc1NiAyOTEuOTYzNSw1NDIuNTY5NCBRMjkxLjk2MzUsNTQ0LjY2MzEgMjkyLjY1MSw1NDUuNzQxMyBRMjkzLjMzODUsNTQ2LjgwMzggMjk0LjY4MjMsNTQ2LjgwMzggUTI5NS4zMDczLDU0Ni44MDM4IDI5NS45MDEsNTQ2LjUzODEgUTI5Ni40OTQ4LDU0Ni4yNTY5IDI5Ny4xMTk4LDU0NS42Nzg4IEwyOTcuMTE5OCw1NDguMzk3NSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNi4xNjMxIiB4PSIzMDkuNDA5IiB5PSI1MzkuNDU1MSI+T3V0cHV0IEFkYXB0ZXJzPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkxLjg0NzciIHg9IjMyMS41NjY4IiB5PSI1NTUuNzUyIj4oRHJpdmVuIFNpZGUpPC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjI3NC40OSIgeDI9IjQzMy4yMzMyIiB5MT0iNTY0LjA1MzgiIHkyPSI1NjQuMDUzOCIvPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjI4MS40OSIgeT0iNTc0LjcwMjIiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzQuNzQzMiIgeD0iMjkzLjQ5IiB5PSI1ODEuMDQ4OSI+TXlCYXRpcyBSZXBvc2l0b3J5PC90ZXh0PjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjI4MS40OSIgeT0iNTkwLjk5OTEiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTkuNDIzOCIgeD0iMjkzLjQ5IiB5PSI1OTcuMzQ1NyI+RGF0YWJhc2UgQWNjZXNzPC90ZXh0PjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iNiIgc3R5bGU9InN0cm9rZTojQzgyOTMwO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjYiIHg9IjI4MS40OSIgeT0iNjA3LjI5NTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDUuNDAzMyIgeD0iMjkzLjQ5IiB5PSI2MTMuNjQyNiI+RW50aXR5IE1hcHBpbmc8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjc0LjQ5IiB4Mj0iNDMzLjIzMzIiIHkxPSI2MjAuOTQ0NCIgeTI9IjYyMC45NDQ0Ii8+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU44IiBkYXRhLXNvdXJjZS1saW5lPSIzMyIgZGF0YS11aWQ9ImVudDAwMDkiIGlkPSJlbnRpdHlfR01OOCI+PHBhdGggZD0iTTQ5Mi43LDc1LjE5IEw0OTIuNywxMzAuNTg4NCBBMCwwIDAgMCAwIDQ5Mi43LDEzMC41ODg0IEw1NjMuMDMsMTMwLjU4ODQgTDQ0MS41NSwyNTYuMzYgTDU3MS4wMywxMzAuNTg4NCBMNjk1LjAzMzcsMTMwLjU4ODQgQTAsMCAwIDAgMCA2OTUuMDMzNywxMzAuNTg4NCBMNjk1LjAzMzcsODUuMTkgTDY4NS4wMzM3LDc1LjE5IEw0OTIuNyw3NS4xOSBBMCwwIDAgMCAwIDQ5Mi43LDc1LjE5IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNjg1LjAzMzcsNzUuMTkgTDY4NS4wMzM3LDg1LjE5IEw2OTUuMDMzNyw4NS4xOSBMNjg1LjAzMzcsNzUuMTkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0My4wMDAyIiB4PSI0OTguNyIgeT0iOTIuMjU2OSI+JiMyNjA4MjsmIzIzMzg0OyYjMTIzOTg7JiMxMjQ5OTsmIzEyNDcyOyYjMTI0OTM7JiMxMjQ3MzsmIzEyNTI1OyYjMTI0NzI7JiMxMjQ4MzsmIzEyNDYzOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNTMuMjcwNiIgeD0iNDk4LjciIHk9IjEwNy4zODk3Ij5SRVNUIEFQSSAmIzI5MjU2OyYjMTIzOTI7JiMyMzQzNjsmIzIwODQwOyYjMTIzOTU7JiMyMDg0OTsmIzI2Mzc3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxODEuMzMzNyIgeD0iNDk4LjciIHk9IjEyMi41MjI1Ij5nUlBDICYjMjIyNjY7JiMyNjM3NzsmIzEyMzk4OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OyYjMTIzOTk7JiMyMTU0NzsmIzEyNDE0OyYjMTIzOTQ7JiMxMjM1Njs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xMSIgZGF0YS1zb3VyY2UtbGluZT0iMzkiIGRhdGEtdWlkPSJlbnQwMDEyIiBpZD0iZW50aXR5X0dNTjExIj48cGF0aCBkPSJNNiw3NS4xOSBMNiwxMzAuNTg4NCBBMCwwIDAgMCAwIDYsMTMwLjU4ODQgTDE4NS43Mjk2LDEzMC41ODg0IEEwLDAgMCAwIDAgMTg1LjcyOTYsMTMwLjU4ODQgTDE4NS43Mjk2LDEwNi44OSBMMjUzLjA1LDEwMi44OSBMMTg1LjcyOTYsOTguODkgTDE4NS43Mjk2LDg1LjE5IEwxNzUuNzI5Niw3NS4xOSBMNiw3NS4xOSBBMCwwIDAgMCAwIDYsNzUuMTkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0xNzUuNzI5Niw3NS4xOSBMMTc1LjcyOTYsODUuMTkgTDE4NS43Mjk2LDg1LjE5IEwxNzUuNzI5Niw3NS4xOSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTAzLjMzMzYiIHg9IjEyIiB5PSI5Mi4yNTY5Ij5nUlBDICYjMTI0Njk7JiMxMjU0MDsmIzEyNDk5OyYjMTI0NzM7JiMxMjQzNDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTU4LjcyOTYiIHg9IjEyIiB5PSIxMDcuMzg5NyI+SW5wdXQgQWRhcHRlciAmIzEyMzkyOyYjMTIzNzU7JiMxMjM5MDsmIzM2ODYxOyYjMjExNTI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0NS43MDQyIiB4PSIxMiIgeT0iMTIyLjUyMjUiPiYjMjYwODI7JiMyMzM4NDsmIzEyMzk4OyBSRVNUICYjMTIzOTI7JiMyMDg0OTsmIzIzMzg0OyYjMjE0ODc7JiMzMzAyMTs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtZW50aXR5PSJHTU4xNCIgZGF0YS1zb3VyY2UtbGluZT0iNDUiIGRhdGEtdWlkPSJlbnQwMDE1IiBpZD0iZW50aXR5X0dNTjE0Ij48cGF0aCBkPSJNNDkyLjM4LDU0Ny41IEw0OTIuMzgsNTcxLjIgTDQzNC41Myw1NzUuMiBMNDkyLjM4LDU3OS4yIEw0OTIuMzgsNjAyLjg5ODQgQTAsMCAwIDAgMCA0OTIuMzgsNjAyLjg5ODQgTDY0My4zNTQ3LDYwMi44OTg0IEEwLDAgMCAwIDAgNjQzLjM1NDcsNjAyLjg5ODQgTDY0My4zNTQ3LDU1Ny41IEw2MzMuMzU0Nyw1NDcuNSBMNDkyLjM4LDU0Ny41IEEwLDAgMCAwIDAgNDkyLjM4LDU0Ny41IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNjMzLjM1NDcsNTQ3LjUgTDYzMy4zNTQ3LDU1Ny41IEw2NDMuMzU0Nyw1NTcuNSBMNjMzLjM1NDcsNTQ3LjUiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyOS45NzQ3IiB4PSI0OTguMzgiIHk9IjU2NC41NjY5Ij4mIzI2MDgyOyYjMjMzODQ7JiMxMjM5ODsgUmVwb3NpdG9yeSAmIzEyNDM0OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC4wMDAxIiB4PSI0OTguMzgiIHk9IjU3OS42OTk3Ij4mIzEyMzgxOyYjMTIzOTg7JiMxMjQxNDsmIzEyNDE0OyYjMjAzNTE7JiMyOTk5Mjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTIuMDAwMSIgeD0iNDk4LjM4IiB5PSI1OTQuODMyNSI+JiMyMjc5MzsmIzI2MzU2OyYjMTk5ODE7JiMzNTIwMTs8L3RleHQ+PC9nPjwhLS1saW5rIGlucHV0IHRvIGNvcmUtLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iaW5wdXQiIGRhdGEtZW50aXR5LTI9ImNvcmUiIGRhdGEtc291cmNlLWxpbmU9IjI5IiBkYXRhLXVpZD0ibG5rNiIgaWQ9ImxpbmtfaW5wdXRfY29yZSI+PHBhdGggY29kZUxpbmU9IjI5IiBkPSJNMzU1LjEyLDE2NS4yNCBDMzU1LjI0LDE5Mi45NSAzNTUuMzU2MSwyMjAuMTcgMzU1LjQ3NjEsMjUwLjI5IiBmaWxsPSJub25lIiBpZD0iaW5wdXQtdG8tY29yZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzU1LjUsMjU2LjI5LDM1OS40NjQxLDI0Ny4yNzQxLDM1NS40ODAxLDI1MS4yOSwzNTEuNDY0MiwyNDcuMzA2LDM1NS41LDI1Ni4yOSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcwLjgwMTgiIHg9IjM1OS41MzM4IiB5PSIyMDcuODQ2OSI+SW5wdXQgUG9ydHM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzcuMTQ5NCIgeD0iMzU2LjM2IiB5PSIyMjIuOTc5NyI+KFVzZSBDYXNlcyk8L3RleHQ+PC9nPjwhLS1saW5rIGNvcmUgdG8gb3V0cHV0LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImNvcmUiIGRhdGEtZW50aXR5LTI9Im91dHB1dCIgZGF0YS1zb3VyY2UtbGluZT0iMzAiIGRhdGEtdWlkPSJsbms3IiBpZD0ibGlua19jb3JlX291dHB1dCI+PHBhdGggY29kZUxpbmU9IjMwIiBkPSJNMzU1LjEyLDQyOS43OSBDMzU0Ljg1LDQ2MC40NiAzNTQuNjEwOSw0ODguMTAwMiAzNTQuMzgwOSw1MTUuMjAwMiIgZmlsbD0ibm9uZSIgaWQ9ImNvcmUtdG8tb3V0cHV0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzNTQuMzMsNTIxLjIsMzU4LjQwNjIsNTEyLjIzNDMsMzU0LjM3MjQsNTE2LjIwMDIsMzUwLjQwNjUsNTEyLjE2NjQsMzU0LjMzLDUyMS4yIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODIuMjk3NCIgeD0iMzg5LjEzMTUiIHk9IjQ3Mi41MjY5Ij5PdXRwdXQgUG9ydHM8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ4Ljk2MDQiIHg9IjM1NS44IiB5PSI0ODcuNjU5NyI+KFJlcG9zaXRvcnkgSW50ZXJmYWNlcyk8L3RleHQ+PC9nPjwhLS1TUkM9W1JMOUZSbjkxNUJfbGZ0WnNINkZ1MFpzTzgyTUE0VGowbE5jUEJXRVRrOXRQcDB3RFpWNm1oNHNBak1jckFldEtIOHFZNEdpc3JRR2dqMXpjTUMxSmx1OHBpcjFldS10Yl9WbHpVVXpRN1hTOG5QMUQ5UFNJenN4VEpPN2o4Qy1wQjFWUDNyNEhteW5qXzBXTDZLS0U5Qll6R1dJc0hPYlpZMU1wWXliMVBORHMxWHZScmNIeTlrNnczaDZIODhuMmFkN3lXQ1Jjc0llWTVBeDNWR3ozNGRkT0tyRjgwcmtMck5HUzRoUkRJYkgwQkRwUTNyamwxcnpVMzZnak1MTXVtcWZTR3lUd1ZydUY2eVN3RE8tOGl0dUpFT1pRWWFNXy1oZF94S0VfalZNdGtRLWg2S1I1b2RKek9GRElWT0lhWTZXVTR1SDlPWkd3SlpvdjkydkR0UEEwSDF3djBkREZJLURhWlQwWXY0V1VId0E4UVQ2Z2lnZFNhaEEwMml1UzFfRnBwY1FfLVo0eXQzX2xMNUhMLW1TdnBEVThaTk5mcFZUWFZNVHVyV3NWbE95UVNlOVpqQmdteEFhVXA3TjIxNmNnZTZ0aTJpUWxhNWllWVYtbW10SUE3OGpRREJrQ0NhYUczeEJPUEh2SHN6UURrRzhqQXpkUTl3cFU4MHVmQWVYT1htbm9OUUxKOEloQ0k2OHlWWUV3dURwT2JxTjZYT1FURWhEYkVkSmgyN2hrV2tVdVVxODBaQk8yaWlzYUhQZDA4OVdCaDYyMGhDVy13UlRhaTJWQjlwQk9ia0xWQ1pXcVNJM0JSU2pPZGJYQ1dfZkN3SlYycmxEbWVvN3pQaFhucjMtZU1DUnBpRlBSbk5mQi1MVzY3SGNlazF0a0RnTF9BbHNscWR6Z09QZTczSndZdUUyMnExb0N4Nlk3QkZ5cWV0a1FHRmNiVFVhbEcyNUJsb2h6VWRKRTJVX2U5SkluWklFTDJOVlFtdzF4NU93SnVlaDFZbm9SZGZ1dWZLNmJfcXdocUJIRlV6c3BtUWs2NU53Z3o2aV9VWVZSbXhmX2lWU1ZdLS0+PC9nPjwvc3ZnPg==" class="uml" alt="uml diagram" title="" /></p>
<h3 id="225">22.5 ディレクトリ構成<a class="headerlink" href="#225" title="Permanent link">&para;</a></h3>
<p>既存の構成に <code>infrastructure/in/grpc/</code> を追加するだけです。</p>
<div class="highlight"><pre><span></span><code>src/main/java/com/example/accounting/
├── domain/                     # ドメイン層（API版と共通）
│   ├── model/
│   │   ├── account/           # 勘定科目ドメイン
│   │   ├── journal/           # 仕訳ドメイン
│   │   ├── balance/           # 残高ドメイン
│   │   └── tax/               # 課税取引ドメイン
│   └── exception/
│
├── application/               # アプリケーション層（API版と共通）
│   ├── port/
│   │   ├── in/               # Input Port（ユースケース）
│   │   └── out/              # Output Port（リポジトリ）
│   └── service/
│
├── infrastructure/
│   ├── in/
│   │   ├── api/              # Input Adapter（REST実装）- 既存
│   │   └── grpc/             # Input Adapter（gRPC実装）- 新規追加
│   │       ├── service/      # gRPC サービス実装
│   │       ├── interceptor/  # インターセプター
│   │       └── converter/    # ドメイン ↔ Proto 変換
│   └── out/
│       └── persistence/      # Output Adapter（DB実装）- 既存
│           ├── mapper/
│           └── repository/
│
├── config/
│
└── src/main/proto/           # Protocol Buffers 定義
    ├── common.proto
    ├── account.proto
    ├── journal.proto
    ├── balance.proto
    └── report.proto
</code></pre></div>
<h3 id="226">22.6 技術スタックの追加<a class="headerlink" href="#226" title="Permanent link">&para;</a></h3>
<p>既存の <code>build.gradle.kts</code> に gRPC 関連の依存関係を追加します。</p>
<details>
<summary>build.gradle.kts（差分）</summary>

<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="nn">com.google.protobuf.gradle.*</span>

<span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 既存のプラグイン</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;java&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;org.springframework.boot&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;3.2.0&quot;</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;io.spring.dependency-management&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;1.1.4&quot;</span>

<span class="w">    </span><span class="c1">// gRPC 関連を追加</span>
<span class="w">    </span><span class="n">id</span><span class="p">(</span><span class="s">&quot;com.google.protobuf&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="s">&quot;0.9.4&quot;</span>
<span class="p">}</span>

<span class="n">dependencies</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 既存の依存関係（Spring Boot, MyBatis, PostgreSQL等）はそのまま</span>

<span class="w">    </span><span class="c1">// gRPC 関連を追加</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;net.devh:grpc-spring-boot-starter:3.1.0.RELEASE&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;io.grpc:grpc-protobuf:1.62.2&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;io.grpc:grpc-stub:1.62.2&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;io.grpc:grpc-services:1.62.2&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// ヘルスチェック、リフレクション</span>

<span class="w">    </span><span class="c1">// Protocol Buffers</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;com.google.protobuf:protobuf-java:3.25.3&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">implementation</span><span class="p">(</span><span class="s">&quot;com.google.protobuf:protobuf-java-util:3.25.3&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// JSON 変換</span>

<span class="w">    </span><span class="c1">// Jakarta Annotation (gRPC generated code で必要)</span>
<span class="w">    </span><span class="n">compileOnly</span><span class="p">(</span><span class="s">&quot;jakarta.annotation:jakarta.annotation-api:2.1.1&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="c1">// Test</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="s">&quot;io.grpc:grpc-testing:1.62.2&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="n">testImplementation</span><span class="p">(</span><span class="s">&quot;net.devh:grpc-client-spring-boot-starter:3.1.0.RELEASE&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">protobuf</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">protoc</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">artifact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.google.protobuf:protoc:3.25.3&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">plugins</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">create</span><span class="p">(</span><span class="s">&quot;grpc&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">artifact</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;io.grpc:protoc-gen-grpc-java:1.62.2&quot;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">generateProtoTasks</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">all</span><span class="p">().</span><span class="na">forEach</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">            </span><span class="n">task</span><span class="p">.</span><span class="na">plugins</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">create</span><span class="p">(</span><span class="s">&quot;grpc&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// 生成コードのソースパス追加</span>
<span class="n">sourceSets</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">main</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">java</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">srcDirs</span><span class="p">(</span>
<span class="w">                </span><span class="s">&quot;build/generated/source/proto/main/java&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="s">&quot;build/generated/source/proto/main/grpc&quot;</span>
<span class="w">            </span><span class="p">)</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>application.yml（差分）</summary>

<div class="highlight"><pre><span></span><code><span class="c1"># 既存の設定はそのまま</span>

<span class="c1"># gRPC サーバー設定</span>
<span class="nt">grpc</span><span class="p">:</span>
<span class="w">  </span><span class="nt">server</span><span class="p">:</span>
<span class="w">    </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9090</span>
<span class="w">    </span><span class="nt">reflection-service-enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">  </span><span class="c1"># gRPC リフレクション有効化</span>
<span class="w">    </span><span class="nt">health-service-enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w">      </span><span class="c1"># ヘルスチェック有効化</span>
<span class="w">    </span><span class="nt">max-inbound-message-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4194304</span><span class="w">  </span><span class="c1"># 4MB</span>
<span class="w">    </span><span class="nt">max-inbound-metadata-size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8192</span><span class="w">    </span><span class="c1"># 8KB</span>

<span class="c1"># ログ設定</span>
<span class="nt">logging</span><span class="p">:</span>
<span class="w">  </span><span class="nt">level</span><span class="p">:</span>
<span class="w">    </span><span class="nt">net.devh.boot.grpc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEBUG</span>
<span class="w">    </span><span class="nt">io.grpc</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">INFO</span>
</code></pre></div>

</details>

<hr />
<h2 id="23-protocol-buffers">第 23 章：Protocol Buffers 定義<a class="headerlink" href="#23-protocol-buffers" title="Permanent link">&para;</a></h2>
<h3 id="231">23.1 共通メッセージ定義<a class="headerlink" href="#231" title="Permanent link">&para;</a></h3>
<details>
<summary>src/main/proto/common.proto</summary>

<div class="highlight"><pre><span></span><code><span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="kn">package</span><span class="w"> </span><span class="nn">com</span><span class="o">.</span><span class="n">example.accounting</span><span class="p">;</span>

<span class="k">option</span><span class="w"> </span><span class="na">java_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.example.accounting.infrastructure.in.grpc.proto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_outer_classname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;CommonProto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_multiple_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s">&quot;google/protobuf/timestamp.proto&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s">&quot;google/protobuf/wrappers.proto&quot;</span><span class="p">;</span>

<span class="c1">// 共通のページネーション</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">PageRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">PageInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">total_elements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">total_pages</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">has_next</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">has_previous</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 共通のエラー応答</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ErrorDetail</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">field</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="kd">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ErrorResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="kd">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">ErrorDetail</span><span class="w"> </span><span class="na">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 金額型（Decimal 相当）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">Money</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int64</span><span class="w"> </span><span class="na">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">      </span><span class="c1">// 整数部</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">nanos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">      </span><span class="c1">// 小数部（10億分の1単位）</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">currency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">  </span><span class="c1">// 通貨コード（JPY等）</span>
<span class="p">}</span>

<span class="c1">// 日付型（Date 相当）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">Date</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">day</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 年月型</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">YearMonth</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 決算期</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">FiscalPeriod</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">fiscal_year</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">    </span><span class="c1">// 決算年度</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">fiscal_month</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">   </span><span class="c1">// 決算月度（1-12）</span>
<span class="p">}</span>

<span class="c1">// 監査情報</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">AuditInfo</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">google.protobuf.Timestamp</span><span class="w"> </span><span class="na">created_at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">created_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">google.protobuf.Timestamp</span><span class="w"> </span><span class="na">updated_at</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">updated_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="232-protocol-buffers">23.2 勘定科目 Protocol Buffers<a class="headerlink" href="#232-protocol-buffers" title="Permanent link">&para;</a></h3>
<details>
<summary>src/main/proto/account.proto</summary>

<div class="highlight"><pre><span></span><code><span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="kn">package</span><span class="w"> </span><span class="nn">com</span><span class="o">.</span><span class="n">example.accounting</span><span class="p">;</span>

<span class="k">option</span><span class="w"> </span><span class="na">java_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.example.accounting.infrastructure.in.grpc.proto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_outer_classname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;AccountProto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_multiple_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s">&quot;common.proto&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s">&quot;google/protobuf/empty.proto&quot;</span><span class="p">;</span>

<span class="c1">// BSPL区分</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">BsplType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">BSPL_TYPE_UNSPECIFIED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="na">BSPL_TYPE_BS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">            </span><span class="c1">// 貸借対照表</span>
<span class="w">    </span><span class="na">BSPL_TYPE_PL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">            </span><span class="c1">// 損益計算書</span>
<span class="p">}</span>

<span class="c1">// 貸借区分</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">DEBIT_CREDIT_TYPE_UNSPECIFIED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="na">DEBIT_CREDIT_TYPE_DEBIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">     </span><span class="c1">// 借方</span>
<span class="w">    </span><span class="na">DEBIT_CREDIT_TYPE_CREDIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">    </span><span class="c1">// 貸方</span>
<span class="p">}</span>

<span class="c1">// 取引要素区分</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">ElementType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">ELEMENT_TYPE_UNSPECIFIED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="na">ELEMENT_TYPE_ASSET</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">          </span><span class="c1">// 資産</span>
<span class="w">    </span><span class="na">ELEMENT_TYPE_LIABILITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">      </span><span class="c1">// 負債</span>
<span class="w">    </span><span class="na">ELEMENT_TYPE_EQUITY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">         </span><span class="c1">// 資本</span>
<span class="w">    </span><span class="na">ELEMENT_TYPE_REVENUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">        </span><span class="c1">// 収益</span>
<span class="w">    </span><span class="na">ELEMENT_TYPE_EXPENSE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">        </span><span class="c1">// 費用</span>
<span class="p">}</span>

<span class="c1">// 集計区分</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">AggregationType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">AGGREGATION_TYPE_UNSPECIFIED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="na">AGGREGATION_TYPE_HEADING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">    </span><span class="c1">// 見出科目</span>
<span class="w">    </span><span class="na">AGGREGATION_TYPE_SUMMARY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">    </span><span class="c1">// 集計科目</span>
<span class="w">    </span><span class="na">AGGREGATION_TYPE_POSTING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">    </span><span class="c1">// 計上科目</span>
<span class="p">}</span>

<span class="c1">// 勘定科目メッセージ</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">Account</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目名</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">              </span><span class="c1">// BSPL区分</span>
<span class="w">    </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="na">debit_credit_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">  </span><span class="c1">// 貸借区分</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">        </span><span class="c1">// 取引要素区分</span>
<span class="w">    </span><span class="n">AggregationType</span><span class="w"> </span><span class="na">aggregation_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">   </span><span class="c1">// 集計区分</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">parent_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">      </span><span class="c1">// 親勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目パス</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">display_order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w">             </span><span class="c1">// 表示順</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 有効フラグ</span>
<span class="w">    </span><span class="n">AuditInfo</span><span class="w"> </span><span class="na">audit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w">                </span><span class="c1">// 監査情報</span>
<span class="p">}</span>

<span class="c1">// 勘定科目構成メッセージ</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">AccountStructure</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目パス（~区切り）</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">                     </span><span class="c1">// 階層レベル</span>
<span class="p">}</span>

<span class="c1">// 課税取引マスタ</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">TaxTransaction</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">tax_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 課税取引コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">tax_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 課税取引名</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">tax_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 税率（パーセント * 100）</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">effective_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">             </span><span class="c1">// 適用開始日</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">effective_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">               </span><span class="c1">// 適用終了日</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 有効フラグ</span>
<span class="p">}</span>

<span class="c1">// === リクエスト/レスポンス ===</span>

<span class="c1">// 勘定科目取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetAccountRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetAccountResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Account</span><span class="w"> </span><span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目一覧取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ListAccountsRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">PageRequest</span><span class="w"> </span><span class="na">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">              </span><span class="c1">// フィルタ（オプション）</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">        </span><span class="c1">// フィルタ（オプション）</span>
<span class="w">    </span><span class="n">AggregationType</span><span class="w"> </span><span class="na">aggregation_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w"> </span><span class="c1">// フィルタ（オプション）</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">keyword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 検索キーワード</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">active_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">                </span><span class="c1">// 有効のみ</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ListAccountsResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">Account</span><span class="w"> </span><span class="na">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">PageInfo</span><span class="w"> </span><span class="na">page_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目登録</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">CreateAccountRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="na">debit_credit_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">AggregationType</span><span class="w"> </span><span class="na">aggregation_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">parent_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">display_order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">CreateAccountResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Account</span><span class="w"> </span><span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目更新</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">UpdateAccountRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="na">debit_credit_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">AggregationType</span><span class="w"> </span><span class="na">aggregation_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">parent_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">display_order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_active</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">UpdateAccountResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Account</span><span class="w"> </span><span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目削除</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">DeleteAccountRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">DeleteAccountResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目一括登録（クライアントストリーミング）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">BulkCreateAccountRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">CreateAccountRequest</span><span class="w"> </span><span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">BulkCreateAccountResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">success_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">failure_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">ErrorDetail</span><span class="w"> </span><span class="na">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目ツリー取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetAccountTreeRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// BS または PL</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetAccountTreeResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">AccountNode</span><span class="w"> </span><span class="na">nodes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">AccountNode</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Account</span><span class="w"> </span><span class="na">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">AccountNode</span><span class="w"> </span><span class="na">children</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 課税取引マスタ取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetTaxTransactionRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">tax_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetTaxTransactionResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TaxTransaction</span><span class="w"> </span><span class="na">tax_transaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 課税取引マスタ一覧</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ListTaxTransactionsRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">as_of_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">     </span><span class="c1">// 適用日（オプション）</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">active_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ListTaxTransactionsResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">TaxTransaction</span><span class="w"> </span><span class="na">tax_transactions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// === サービス定義 ===</span>

<span class="kd">service</span><span class="w"> </span><span class="n">AccountService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 単項 RPC</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetAccount</span><span class="p">(</span><span class="n">GetAccountRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetAccountResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">CreateAccount</span><span class="p">(</span><span class="n">CreateAccountRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">CreateAccountResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">UpdateAccount</span><span class="p">(</span><span class="n">UpdateAccountRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">UpdateAccountResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">DeleteAccount</span><span class="p">(</span><span class="n">DeleteAccountRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">DeleteAccountResponse</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// サーバーストリーミング RPC（大量データ取得）</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ListAccounts</span><span class="p">(</span><span class="n">ListAccountsRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">Account</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// クライアントストリーミング RPC（一括登録）</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">BulkCreateAccounts</span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">BulkCreateAccountRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">BulkCreateAccountResponse</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 勘定科目構成</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetAccountTree</span><span class="p">(</span><span class="n">GetAccountTreeRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetAccountTreeResponse</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 課税取引マスタ</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetTaxTransaction</span><span class="p">(</span><span class="n">GetTaxTransactionRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetTaxTransactionResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ListTaxTransactions</span><span class="p">(</span><span class="n">ListTaxTransactionsRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">ListTaxTransactionsResponse</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="233-protocol-buffers">23.3 仕訳 Protocol Buffers<a class="headerlink" href="#233-protocol-buffers" title="Permanent link">&para;</a></h3>
<details>
<summary>src/main/proto/journal.proto</summary>

<div class="highlight"><pre><span></span><code><span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="kn">package</span><span class="w"> </span><span class="nn">com</span><span class="o">.</span><span class="n">example.accounting</span><span class="p">;</span>

<span class="k">option</span><span class="w"> </span><span class="na">java_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.example.accounting.infrastructure.in.grpc.proto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_outer_classname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;JournalProto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_multiple_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s">&quot;common.proto&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s">&quot;account.proto&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s">&quot;google/protobuf/empty.proto&quot;</span><span class="p">;</span>

<span class="c1">// 仕訳伝票区分</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">JournalType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">JOURNAL_TYPE_UNSPECIFIED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="na">JOURNAL_TYPE_NORMAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">         </span><span class="c1">// 通常仕訳</span>
<span class="w">    </span><span class="na">JOURNAL_TYPE_CLOSING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">        </span><span class="c1">// 決算仕訳</span>
<span class="w">    </span><span class="na">JOURNAL_TYPE_ADJUSTMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">     </span><span class="c1">// 調整仕訳</span>
<span class="w">    </span><span class="na">JOURNAL_TYPE_REVERSAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">       </span><span class="c1">// 取消仕訳</span>
<span class="p">}</span>

<span class="c1">// 仕訳ステータス</span>
<span class="kd">enum</span><span class="w"> </span><span class="n">JournalStatus</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="na">JOURNAL_STATUS_UNSPECIFIED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="na">JOURNAL_STATUS_DRAFT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">        </span><span class="c1">// 下書き</span>
<span class="w">    </span><span class="na">JOURNAL_STATUS_PENDING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">      </span><span class="c1">// 承認待ち</span>
<span class="w">    </span><span class="na">JOURNAL_STATUS_APPROVED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">     </span><span class="c1">// 承認済み</span>
<span class="w">    </span><span class="na">JOURNAL_STATUS_POSTED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">       </span><span class="c1">// 転記済み</span>
<span class="w">    </span><span class="na">JOURNAL_STATUS_CANCELED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">     </span><span class="c1">// 取消済み</span>
<span class="p">}</span>

<span class="c1">// 仕訳伝票メッセージ</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">Journal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">              </span><span class="c1">// 伝票番号</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">journal_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">               </span><span class="c1">// 起票日</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">input_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 入力日</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 伝票摘要</span>
<span class="w">    </span><span class="n">JournalType</span><span class="w"> </span><span class="na">journal_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">        </span><span class="c1">// 仕訳伝票区分</span>
<span class="w">    </span><span class="n">JournalStatus</span><span class="w"> </span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">            </span><span class="c1">// ステータス</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_closing_journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">         </span><span class="c1">// 決算仕訳フラグ</span>
<span class="w">    </span><span class="n">FiscalPeriod</span><span class="w"> </span><span class="na">fiscal_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">      </span><span class="c1">// 決算期</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w">               </span><span class="c1">// 借方合計</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">             </span><span class="c1">// 貸方合計</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">JournalDetail</span><span class="w"> </span><span class="na">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w"> </span><span class="c1">// 仕訳明細</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">reversal_slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="p">;</span><span class="w">    </span><span class="c1">// 取消元伝票番号</span>
<span class="w">    </span><span class="n">AuditInfo</span><span class="w"> </span><span class="na">audit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">13</span><span class="p">;</span><span class="w">                </span><span class="c1">// 監査情報</span>
<span class="p">}</span>

<span class="c1">// 仕訳明細メッセージ</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">JournalDetail</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">line_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">               </span><span class="c1">// 行番号</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">line_summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c1">// 行摘要</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="w"> </span><span class="na">debit_credit_details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c1">// 貸借明細</span>
<span class="p">}</span>

<span class="c1">// 仕訳貸借明細メッセージ</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">JournalDebitCreditDetail</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="na">debit_credit_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">  </span><span class="c1">// 借方/貸方</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目名（参照用）</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">         </span><span class="c1">// 補助科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">          </span><span class="c1">// 部門コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">project_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">             </span><span class="c1">// プロジェクトコード</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">                    </span><span class="c1">// 金額</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">base_currency_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">      </span><span class="c1">// 基軸通貨金額</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">tax_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 課税取引コード</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">tax_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">                 </span><span class="c1">// 税率</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">tax_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w">               </span><span class="c1">// 消費税額</span>
<span class="p">}</span>

<span class="c1">// === リクエスト/レスポンス ===</span>

<span class="c1">// 仕訳取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetJournalRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetJournalResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Journal</span><span class="w"> </span><span class="na">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 仕訳一覧取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ListJournalsRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">PageRequest</span><span class="w"> </span><span class="na">page</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">date_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 起票日From</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">date_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">                    </span><span class="c1">// 起票日To</span>
<span class="w">    </span><span class="n">FiscalPeriod</span><span class="w"> </span><span class="na">fiscal_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">      </span><span class="c1">// 決算期</span>
<span class="w">    </span><span class="n">JournalType</span><span class="w"> </span><span class="na">journal_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">        </span><span class="c1">// 仕訳伝票区分</span>
<span class="w">    </span><span class="n">JournalStatus</span><span class="w"> </span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">            </span><span class="c1">// ステータス</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">keyword</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 検索キーワード</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ListJournalsResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="na">journals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">PageInfo</span><span class="w"> </span><span class="na">page_info</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 仕訳登録</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">CreateJournalRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">journal_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">JournalType</span><span class="w"> </span><span class="na">journal_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_closing_journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">CreateJournalDetailRequest</span><span class="w"> </span><span class="na">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">CreateJournalDetailRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">line_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">line_summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">CreateJournalDebitCreditRequest</span><span class="w"> </span><span class="na">debit_credit_details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">CreateJournalDebitCreditRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="na">debit_credit_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">project_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">tax_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">CreateJournalResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Journal</span><span class="w"> </span><span class="na">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 仕訳更新</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">UpdateJournalRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">journal_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">summary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">JournalType</span><span class="w"> </span><span class="na">journal_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_closing_journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">CreateJournalDetailRequest</span><span class="w"> </span><span class="na">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">UpdateJournalResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Journal</span><span class="w"> </span><span class="na">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 仕訳取消（赤黒処理）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">CancelJournalRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">cancel_reason</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">CancelJournalResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Journal</span><span class="w"> </span><span class="na">original_journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">        </span><span class="c1">// 元の仕訳</span>
<span class="w">    </span><span class="n">Journal</span><span class="w"> </span><span class="na">reversal_journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">        </span><span class="c1">// 取消仕訳</span>
<span class="p">}</span>

<span class="c1">// 仕訳承認</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ApproveJournalRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">approver_comment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ApproveJournalResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Journal</span><span class="w"> </span><span class="na">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 仕訳一括登録（クライアントストリーミング）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">BulkCreateJournalRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">CreateJournalRequest</span><span class="w"> </span><span class="na">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">BulkCreateJournalResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">success_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">failure_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">ErrorDetail</span><span class="w"> </span><span class="na">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="na">created_slip_numbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 貸借バランスチェック</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ValidateBalanceRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">CreateJournalDetailRequest</span><span class="w"> </span><span class="na">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ValidateBalanceResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_balanced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">difference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// === サービス定義 ===</span>

<span class="kd">service</span><span class="w"> </span><span class="n">JournalService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 単項 RPC</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetJournal</span><span class="p">(</span><span class="n">GetJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetJournalResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">CreateJournal</span><span class="p">(</span><span class="n">CreateJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">CreateJournalResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">UpdateJournal</span><span class="p">(</span><span class="n">UpdateJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">UpdateJournalResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">CancelJournal</span><span class="p">(</span><span class="n">CancelJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">CancelJournalResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ApproveJournal</span><span class="p">(</span><span class="n">ApproveJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">ApproveJournalResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ValidateBalance</span><span class="p">(</span><span class="n">ValidateBalanceRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">ValidateBalanceResponse</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// サーバーストリーミング RPC</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ListJournals</span><span class="p">(</span><span class="n">ListJournalsRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">Journal</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// クライアントストリーミング RPC</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">BulkCreateJournals</span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">BulkCreateJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">BulkCreateJournalResponse</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 双方向ストリーミング RPC（リアルタイム仕訳入力）</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">StreamJournalEntry</span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">CreateJournalRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">CreateJournalResponse</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="234-protocol-buffers">23.4 残高 Protocol Buffers<a class="headerlink" href="#234-protocol-buffers" title="Permanent link">&para;</a></h3>
<details>
<summary>src/main/proto/balance.proto</summary>

<div class="highlight"><pre><span></span><code><span class="k">syntax</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;proto3&quot;</span><span class="p">;</span>

<span class="kn">package</span><span class="w"> </span><span class="nn">com</span><span class="o">.</span><span class="n">example.accounting</span><span class="p">;</span>

<span class="k">option</span><span class="w"> </span><span class="na">java_package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;com.example.accounting.infrastructure.in.grpc.proto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_outer_classname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;BalanceProto&quot;</span><span class="p">;</span>
<span class="k">option</span><span class="w"> </span><span class="na">java_multiple_files</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>

<span class="k">import</span><span class="w"> </span><span class="s">&quot;common.proto&quot;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="s">&quot;account.proto&quot;</span><span class="p">;</span>

<span class="c1">// 日次勘定科目残高</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">DailyBalance</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">balance_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">               </span><span class="c1">// 残高日</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目名</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">         </span><span class="c1">// 補助科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">          </span><span class="c1">// 部門コード</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">previous_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">          </span><span class="c1">// 前日残高</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">debit_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">              </span><span class="c1">// 借方金額</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">credit_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">             </span><span class="c1">// 貸方金額</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">current_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w">           </span><span class="c1">// 当日残高</span>
<span class="p">}</span>

<span class="c1">// 月次勘定科目残高</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">MonthlyBalance</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">FiscalPeriod</span><span class="w"> </span><span class="na">fiscal_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">      </span><span class="c1">// 決算期</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">             </span><span class="c1">// 勘定科目名</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">         </span><span class="c1">// 補助科目コード</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">          </span><span class="c1">// 部門コード</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">opening_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">           </span><span class="c1">// 月初残高</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">debit_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">              </span><span class="c1">// 借方金額</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">credit_amount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="p">;</span><span class="w">             </span><span class="c1">// 貸方金額</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">closing_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="p">;</span><span class="w">           </span><span class="c1">// 月末残高</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">closing_debit_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w">    </span><span class="c1">// 決算借方金額</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">closing_credit_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="p">;</span><span class="w">   </span><span class="c1">// 決算貸方金額</span>
<span class="p">}</span>

<span class="c1">// 残高サマリー</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">BalanceSummary</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">level</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">is_leaf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// === リクエスト/レスポンス ===</span>

<span class="c1">// 日次残高取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetDailyBalanceRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">balance_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetDailyBalanceResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">DailyBalance</span><span class="w"> </span><span class="na">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 日次残高一覧取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ListDailyBalancesRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">balance_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">posting_accounts_only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">      </span><span class="c1">// 計上科目のみ</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ListDailyBalancesResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">DailyBalance</span><span class="w"> </span><span class="na">balances</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 月次残高取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetMonthlyBalanceRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">FiscalPeriod</span><span class="w"> </span><span class="na">fiscal_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetMonthlyBalanceResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">MonthlyBalance</span><span class="w"> </span><span class="na">balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 月次残高一覧取得</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">ListMonthlyBalancesRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">FiscalPeriod</span><span class="w"> </span><span class="na">fiscal_period</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">ElementType</span><span class="w"> </span><span class="na">element_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">include_closing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">            </span><span class="c1">// 決算仕訳含む</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">ListMonthlyBalancesResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">MonthlyBalance</span><span class="w"> </span><span class="na">balances</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 勘定科目別残高照会</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetAccountBalanceRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">date_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">date_to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">sub_account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">department_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetAccountBalanceResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">account_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">opening_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">           </span><span class="c1">// 期首残高</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">               </span><span class="c1">// 期間借方合計</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">              </span><span class="c1">// 期間貸方合計</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">closing_balance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="p">;</span><span class="w">           </span><span class="c1">// 期末残高</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">DailyBalance</span><span class="w"> </span><span class="na">daily_movements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">7</span><span class="p">;</span><span class="w">  </span><span class="c1">// 日別推移</span>
<span class="p">}</span>

<span class="c1">// 残高サマリー取得（試算表用）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">GetBalanceSummaryRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Date</span><span class="w"> </span><span class="na">as_of_date</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">BsplType</span><span class="w"> </span><span class="na">bspl_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">include_sub_accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">GetBalanceSummaryResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">repeated</span><span class="w"> </span><span class="n">BalanceSummary</span><span class="w"> </span><span class="na">summaries</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">bs_total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w">            </span><span class="c1">// BS借方合計</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">bs_total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w">           </span><span class="c1">// BS貸方合計</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">pl_total_debit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span><span class="w">            </span><span class="c1">// PL借方合計</span>
<span class="w">    </span><span class="n">Money</span><span class="w"> </span><span class="na">pl_total_credit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span><span class="w">           </span><span class="c1">// PL貸方合計</span>
<span class="p">}</span>

<span class="c1">// 残高更新（仕訳転記時）</span>
<span class="kd">message</span><span class="w"> </span><span class="nc">UpdateBalanceRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">string</span><span class="w"> </span><span class="na">slip_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">message</span><span class="w"> </span><span class="nc">UpdateBalanceResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">bool</span><span class="w"> </span><span class="na">success</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">updated_daily_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int32</span><span class="w"> </span><span class="na">updated_monthly_records</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// === サービス定義 ===</span>

<span class="kd">service</span><span class="w"> </span><span class="n">BalanceService</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 単項 RPC</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetDailyBalance</span><span class="p">(</span><span class="n">GetDailyBalanceRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetDailyBalanceResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetMonthlyBalance</span><span class="p">(</span><span class="n">GetMonthlyBalanceRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetMonthlyBalanceResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetAccountBalance</span><span class="p">(</span><span class="n">GetAccountBalanceRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetAccountBalanceResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">GetBalanceSummary</span><span class="p">(</span><span class="n">GetBalanceSummaryRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">GetBalanceSummaryResponse</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">UpdateBalance</span><span class="p">(</span><span class="n">UpdateBalanceRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">UpdateBalanceResponse</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// サーバーストリーミング RPC</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ListDailyBalances</span><span class="p">(</span><span class="n">ListDailyBalancesRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">DailyBalance</span><span class="p">);</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">ListMonthlyBalances</span><span class="p">(</span><span class="n">ListMonthlyBalancesRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">MonthlyBalance</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 双方向ストリーミング（リアルタイム残高監視）</span>
<span class="w">    </span><span class="k">rpc</span><span class="w"> </span><span class="n">WatchBalance</span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">GetAccountBalanceRequest</span><span class="p">)</span><span class="w"> </span><span class="k">returns</span><span class="w"> </span><span class="p">(</span><span class="n">stream</span><span class="w"> </span><span class="n">GetAccountBalanceResponse</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="24-grpc">第 24 章：gRPC サービス実装<a class="headerlink" href="#24-grpc" title="Permanent link">&para;</a></h2>
<h3 id="241">24.1 勘定科目サービス実装<a class="headerlink" href="#241" title="Permanent link">&para;</a></h3>
<details>
<summary>GrpcAccountService.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.AccountUseCase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.Account</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.AccountCode</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.ResourceNotFoundException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.converter.AccountConverter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.proto.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.Status</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.stub.StreamObserver</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">net.devh.boot.grpc.server.service.GrpcService</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.atomic.AtomicInteger</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 勘定科目 gRPC サービス実装</span>
<span class="cm"> */</span>
<span class="nd">@GrpcService</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">GrpcAccountService</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">AccountServiceGrpc</span><span class="p">.</span><span class="na">AccountServiceImplBase</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">GrpcAccountService</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">AccountConverter</span><span class="w"> </span><span class="n">converter</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">GrpcAccountService</span><span class="p">(</span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">,</span><span class="w"> </span><span class="n">AccountConverter</span><span class="w"> </span><span class="n">converter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">accountUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">converter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">converter</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 単項 RPC: 勘定科目取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">getAccount</span><span class="p">(</span><span class="n">GetAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                           </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">GetAccountResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;getAccount: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">AccountCode</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AccountCode</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>
<span class="w">            </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">findByCode</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResourceNotFoundException</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;勘定科目&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">()));</span>

<span class="w">            </span><span class="n">GetAccountResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetAccountResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">setAccount</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">account</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ResourceNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Account not found: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">NOT_FOUND</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;勘定科目が見つかりません: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error getting account&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withCause</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 単項 RPC: 勘定科目登録</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">createAccount</span><span class="p">(</span><span class="n">CreateAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                              </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">CreateAccountResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;createAccount: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">converter</span><span class="p">.</span><span class="na">toDomain</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
<span class="w">            </span><span class="n">Account</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">account</span><span class="p">);</span>

<span class="w">            </span><span class="n">CreateAccountResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateAccountResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">setAccount</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">created</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalArgumentException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Invalid request: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INVALID_ARGUMENT</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error creating account&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * サーバーストリーミング RPC: 勘定科目一覧取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">listAccounts</span><span class="p">(</span><span class="n">ListAccountsRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                             </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">infrastructure</span><span class="p">.</span><span class="na">in</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">proto</span><span class="p">.</span><span class="na">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;listAccounts: bsplType={}, keyword={}&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="n">request</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">(),</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getKeyword</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">findAll</span><span class="p">(</span>
<span class="w">                </span><span class="n">converter</span><span class="p">.</span><span class="na">toCriteria</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="c1">// ストリーミングで勘定科目を1件ずつ送信</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">accounts</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">account</span><span class="p">));</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;listAccounts completed: {} items&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accounts</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error listing accounts&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * クライアントストリーミング RPC: 勘定科目一括登録</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">BulkCreateAccountRequest</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">bulkCreateAccounts</span><span class="p">(</span>
<span class="w">            </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">BulkCreateAccountResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;bulkCreateAccounts: started&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">successCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">failureCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ErrorDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">BulkCreateAccountRequest</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onNext</span><span class="p">(</span><span class="n">BulkCreateAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">CreateAccountRequest</span><span class="w"> </span><span class="n">accountRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getAccount</span><span class="p">();</span>
<span class="w">                    </span><span class="n">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">converter</span><span class="p">.</span><span class="na">toDomain</span><span class="p">(</span><span class="n">accountRequest</span><span class="p">);</span>
<span class="w">                    </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">account</span><span class="p">);</span>
<span class="w">                    </span><span class="n">successCount</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span>
<span class="w">                    </span><span class="n">log</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Created account: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">accountRequest</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">());</span>

<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">failureCount</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span>
<span class="w">                    </span><span class="n">errors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ErrorDetail</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">setField</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getAccount</span><span class="p">().</span><span class="na">getAccountCode</span><span class="p">())</span>
<span class="w">                        </span><span class="p">.</span><span class="na">setMessage</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">())</span>
<span class="w">                        </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>
<span class="w">                    </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Failed to create account: {}&quot;</span><span class="p">,</span>
<span class="w">                             </span><span class="n">request</span><span class="p">.</span><span class="na">getAccount</span><span class="p">().</span><span class="na">getAccountCode</span><span class="p">(),</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onError</span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;bulkCreateAccounts error&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCompleted</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">BulkCreateAccountResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BulkCreateAccountResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">setSuccessCount</span><span class="p">(</span><span class="n">successCount</span><span class="p">.</span><span class="na">get</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">setFailureCount</span><span class="p">(</span><span class="n">failureCount</span><span class="p">.</span><span class="na">get</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">addAllErrors</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">                </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">                </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;bulkCreateAccounts completed: success={}, failure={}&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="n">successCount</span><span class="p">.</span><span class="na">get</span><span class="p">(),</span><span class="w"> </span><span class="n">failureCount</span><span class="p">.</span><span class="na">get</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 勘定科目ツリー取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">getAccountTree</span><span class="p">(</span><span class="n">GetAccountTreeRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                               </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">GetAccountTreeResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;getAccountTree: bsplType={}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">getAccountTree</span><span class="p">(</span>
<span class="w">                </span><span class="n">converter</span><span class="p">.</span><span class="na">toDomainBsplType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">())</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="n">GetAccountTreeResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetAccountTreeResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">addAllNodes</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProtoTree</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error getting account tree&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="242">24.2 仕訳サービス実装<a class="headerlink" href="#242" title="Permanent link">&para;</a></h3>
<details>
<summary>GrpcJournalService.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.JournalUseCase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.journal.Journal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.journal.SlipNumber</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.ResourceNotFoundException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.BalanceNotMatchException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.converter.JournalConverter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.proto.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.Status</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.stub.StreamObserver</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">net.devh.boot.grpc.server.service.GrpcService</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.concurrent.atomic.AtomicInteger</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 仕訳 gRPC サービス実装</span>
<span class="cm"> */</span>
<span class="nd">@GrpcService</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">GrpcJournalService</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">JournalServiceGrpc</span><span class="p">.</span><span class="na">JournalServiceImplBase</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">GrpcJournalService</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">JournalUseCase</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">JournalConverter</span><span class="w"> </span><span class="n">converter</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">GrpcJournalService</span><span class="p">(</span><span class="n">JournalUseCase</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">,</span><span class="w"> </span><span class="n">JournalConverter</span><span class="w"> </span><span class="n">converter</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">journalUseCase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">converter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">converter</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 単項 RPC: 仕訳取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">getJournal</span><span class="p">(</span><span class="n">GetJournalRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                           </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">GetJournalResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;getJournal: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SlipNumber</span><span class="w"> </span><span class="n">slipNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SlipNumber</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">());</span>
<span class="w">            </span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">findBySlipNumber</span><span class="p">(</span><span class="n">slipNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">orElseThrow</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ResourceNotFoundException</span><span class="p">(</span>
<span class="w">                    </span><span class="s">&quot;仕訳&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">()));</span>

<span class="w">            </span><span class="n">GetJournalResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetJournalResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">setJournal</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">journal</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ResourceNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Journal not found: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">());</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">NOT_FOUND</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;仕訳が見つかりません: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error getting journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 単項 RPC: 仕訳登録</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">createJournal</span><span class="p">(</span><span class="n">CreateJournalRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                              </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">CreateJournalResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;createJournal: date={}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getJournalDate</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">converter</span><span class="p">.</span><span class="na">toDomain</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>
<span class="w">            </span><span class="n">Journal</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">            </span><span class="n">CreateJournalResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateJournalResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">setJournal</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">created</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">BalanceNotMatchException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Balance not match: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">FAILED_PRECONDITION</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;貸借が一致しません: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IllegalArgumentException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Invalid request: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">());</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INVALID_ARGUMENT</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error creating journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 単項 RPC: 仕訳取消（赤黒処理）</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">cancelJournal</span><span class="p">(</span><span class="n">CancelJournalRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                              </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">CancelJournalResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;cancelJournal: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">SlipNumber</span><span class="w"> </span><span class="n">slipNumber</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SlipNumber</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">());</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">cancel</span><span class="p">(</span><span class="n">slipNumber</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getCancelReason</span><span class="p">());</span>

<span class="w">            </span><span class="n">CancelJournalResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CancelJournalResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">setOriginalJournal</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getOriginal</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">setReversalJournal</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getReversal</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">ResourceNotFoundException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Journal not found for cancel: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">());</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">NOT_FOUND</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;取消対象の仕訳が見つかりません: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error canceling journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * サーバーストリーミング RPC: 仕訳一覧取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">listJournals</span><span class="p">(</span><span class="n">ListJournalsRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                             </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">infrastructure</span><span class="p">.</span><span class="na">in</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">proto</span><span class="p">.</span><span class="na">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;listJournals: dateFrom={}, dateTo={}&quot;</span><span class="p">,</span>
<span class="w">                 </span><span class="n">request</span><span class="p">.</span><span class="na">getDateFrom</span><span class="p">(),</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getDateTo</span><span class="p">());</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="n">journals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">findAll</span><span class="p">(</span>
<span class="w">                </span><span class="n">converter</span><span class="p">.</span><span class="na">toCriteria</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="c1">// ストリーミングで仕訳を1件ずつ送信</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">journals</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProto</span><span class="p">(</span><span class="n">journal</span><span class="p">));</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;listJournals completed: {} items&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">journals</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error listing journals&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * クライアントストリーミング RPC: 仕訳一括登録</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">BulkCreateJournalRequest</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">bulkCreateJournals</span><span class="p">(</span>
<span class="w">            </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">BulkCreateJournalResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;bulkCreateJournals: started&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">successCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">AtomicInteger</span><span class="w"> </span><span class="n">failureCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AtomicInteger</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">ErrorDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">createdSlipNumbers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="na">util</span><span class="p">.</span><span class="na">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">BulkCreateJournalRequest</span><span class="o">&gt;</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onNext</span><span class="p">(</span><span class="n">BulkCreateJournalRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">CreateJournalRequest</span><span class="w"> </span><span class="n">journalRequest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getJournal</span><span class="p">();</span>
<span class="w">                    </span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">converter</span><span class="p">.</span><span class="na">toDomain</span><span class="p">(</span><span class="n">journalRequest</span><span class="p">);</span>
<span class="w">                    </span><span class="n">Journal</span><span class="w"> </span><span class="n">created</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">create</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>
<span class="w">                    </span><span class="n">successCount</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span>
<span class="w">                    </span><span class="n">createdSlipNumbers</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">created</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">().</span><span class="na">getValue</span><span class="p">());</span>
<span class="w">                    </span><span class="n">log</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;Created journal: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">created</span><span class="p">.</span><span class="na">getSlipNumber</span><span class="p">().</span><span class="na">getValue</span><span class="p">());</span>

<span class="w">                </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="n">failureCount</span><span class="p">.</span><span class="na">incrementAndGet</span><span class="p">();</span>
<span class="w">                    </span><span class="n">errors</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">ErrorDetail</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                        </span><span class="p">.</span><span class="na">setField</span><span class="p">(</span><span class="s">&quot;journal&quot;</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="na">setMessage</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">())</span>
<span class="w">                        </span><span class="p">.</span><span class="na">build</span><span class="p">());</span>
<span class="w">                    </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Failed to create journal&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onError</span><span class="p">(</span><span class="n">Throwable</span><span class="w"> </span><span class="n">t</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;bulkCreateJournals error&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onCompleted</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">BulkCreateJournalResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BulkCreateJournalResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">setSuccessCount</span><span class="p">(</span><span class="n">successCount</span><span class="p">.</span><span class="na">get</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">setFailureCount</span><span class="p">(</span><span class="n">failureCount</span><span class="p">.</span><span class="na">get</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">addAllErrors</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">addAllCreatedSlipNumbers</span><span class="p">(</span><span class="n">createdSlipNumbers</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">                </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">                </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;bulkCreateJournals completed: success={}, failure={}&quot;</span><span class="p">,</span>
<span class="w">                         </span><span class="n">successCount</span><span class="p">.</span><span class="na">get</span><span class="p">(),</span><span class="w"> </span><span class="n">failureCount</span><span class="p">.</span><span class="na">get</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 単項 RPC: 貸借バランスチェック</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">validateBalance</span><span class="p">(</span><span class="n">ValidateBalanceRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span>
<span class="w">                                </span><span class="n">StreamObserver</span><span class="o">&lt;</span><span class="n">ValidateBalanceResponse</span><span class="o">&gt;</span><span class="w"> </span><span class="n">responseObserver</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;validateBalance&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalUseCase</span><span class="p">.</span><span class="na">validateBalance</span><span class="p">(</span>
<span class="w">                </span><span class="n">converter</span><span class="p">.</span><span class="na">toDetailDomainList</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getDetailsList</span><span class="p">())</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="n">ValidateBalanceResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ValidateBalanceResponse</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">setIsBalanced</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">isBalanced</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">setTotalDebit</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProtoMoney</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getTotalDebit</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">setTotalCredit</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProtoMoney</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getTotalCredit</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">setDifference</span><span class="p">(</span><span class="n">converter</span><span class="p">.</span><span class="na">toProtoMoney</span><span class="p">(</span><span class="n">result</span><span class="p">.</span><span class="na">getDifference</span><span class="p">()))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onNext</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onCompleted</span><span class="p">();</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Error validating balance&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="n">responseObserver</span><span class="p">.</span><span class="na">onError</span><span class="p">(</span>
<span class="w">                </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span>
<span class="w">                    </span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">asRuntimeException</span><span class="p">()</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="243">24.3 コンバーター実装<a class="headerlink" href="#243" title="Permanent link">&para;</a></h3>
<details>
<summary>AccountConverter.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.converter</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.proto.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Component</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 勘定科目ドメインモデル ⇔ Protocol Buffers 変換</span>
<span class="cm"> */</span>
<span class="nd">@Component</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">AccountConverter</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * ドメインモデル → Proto</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">infrastructure</span><span class="p">.</span><span class="na">in</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">proto</span><span class="p">.</span><span class="na">Account</span><span class="w"> </span><span class="nf">toProto</span><span class="p">(</span><span class="n">Account</span><span class="w"> </span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">infrastructure</span><span class="p">.</span><span class="na">in</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">proto</span><span class="p">.</span><span class="na">Account</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAccountCode</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">().</span><span class="na">getValue</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAccountName</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">setBsplType</span><span class="p">(</span><span class="n">toProtoBsplType</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">setDebitCreditType</span><span class="p">(</span><span class="n">toProtoDebitCreditType</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">setElementType</span><span class="p">(</span><span class="n">toProtoElementType</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getElementType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAggregationType</span><span class="p">(</span><span class="n">toProtoAggregationType</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getAggregationType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">setParentAccountCode</span><span class="p">(</span><span class="n">nullToEmpty</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getParentAccountCode</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAccountPath</span><span class="p">(</span><span class="n">nullToEmpty</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getAccountPath</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">setDisplayOrder</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">getDisplayOrder</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">setIsActive</span><span class="p">(</span><span class="n">domain</span><span class="p">.</span><span class="na">isActive</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * CreateAccountRequest → ドメインモデル</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Account</span><span class="w"> </span><span class="nf">toDomain</span><span class="p">(</span><span class="n">CreateAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Account</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AccountCode</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountName</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getAccountName</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">bsplType</span><span class="p">(</span><span class="n">toDomainBsplType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">toDomainDebitCreditType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">elementType</span><span class="p">(</span><span class="n">toDomainElementType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getElementType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">aggregationType</span><span class="p">(</span><span class="n">toDomainAggregationType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getAggregationType</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">parentAccountCode</span><span class="p">(</span><span class="n">emptyToNull</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getParentAccountCode</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">displayOrder</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getDisplayOrder</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">isActive</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * ListAccountsRequest → 検索条件</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">AccountSearchCriteria</span><span class="w"> </span><span class="nf">toCriteria</span><span class="p">(</span><span class="n">ListAccountsRequest</span><span class="w"> </span><span class="n">request</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">AccountSearchCriteria</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">bsplType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">hasBsplType</span><span class="p">()</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">toDomainBsplType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getBsplType</span><span class="p">())</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">elementType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">hasElementType</span><span class="p">()</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">toDomainElementType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getElementType</span><span class="p">())</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">aggregationType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">hasAggregationType</span><span class="p">()</span>
<span class="w">                </span><span class="o">?</span><span class="w"> </span><span class="n">toDomainAggregationType</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getAggregationType</span><span class="p">())</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">keyword</span><span class="p">(</span><span class="n">emptyToNull</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getKeyword</span><span class="p">()))</span>
<span class="w">            </span><span class="p">.</span><span class="na">activeOnly</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">getActiveOnly</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">page</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">hasPage</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getPage</span><span class="p">().</span><span class="na">getPage</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">size</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="na">hasPage</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getPage</span><span class="p">().</span><span class="na">getSize</span><span class="p">()</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * ツリー構造を Proto に変換</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">AccountNode</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">toProtoTree</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">AccountTreeNode</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">tree</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">toProtoNode</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AccountNode</span><span class="w"> </span><span class="nf">toProtoNode</span><span class="p">(</span><span class="n">AccountTreeNode</span><span class="w"> </span><span class="n">node</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">AccountNode</span><span class="p">.</span><span class="na">Builder</span><span class="w"> </span><span class="n">builder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AccountNode</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAccount</span><span class="p">(</span><span class="n">toProto</span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="na">getAccount</span><span class="p">()));</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">node</span><span class="p">.</span><span class="na">getChildren</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">node</span><span class="p">.</span><span class="na">getChildren</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">builder</span><span class="p">.</span><span class="na">addAllChildren</span><span class="p">(</span>
<span class="w">                </span><span class="n">node</span><span class="p">.</span><span class="na">getChildren</span><span class="p">().</span><span class="na">stream</span><span class="p">()</span>
<span class="w">                    </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">toProtoNode</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">())</span>
<span class="w">            </span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// === 区分変換 ===</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BsplType</span><span class="w"> </span><span class="nf">toProtoBsplType</span><span class="p">(</span>
<span class="w">            </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">BsplType</span><span class="w"> </span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">BS</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">BsplType</span><span class="p">.</span><span class="na">BSPL_TYPE_BS</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">PL</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">BsplType</span><span class="p">.</span><span class="na">BSPL_TYPE_PL</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">BsplType</span><span class="w"> </span><span class="nf">toDomainBsplType</span><span class="p">(</span>
<span class="w">            </span><span class="n">BsplType</span><span class="w"> </span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">BSPL_TYPE_BS</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">BsplType</span><span class="p">.</span><span class="na">BS</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">BSPL_TYPE_PL</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">BsplType</span><span class="p">.</span><span class="na">PL</span><span class="p">;</span>
<span class="w">            </span><span class="k">default</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unknown BSPL type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">proto</span><span class="p">);</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="nf">toProtoDebitCreditType</span><span class="p">(</span>
<span class="w">            </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">DebitCreditType</span><span class="w"> </span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">DEBIT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT_CREDIT_TYPE_DEBIT</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">CREDIT</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT_CREDIT_TYPE_CREDIT</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">DebitCreditType</span><span class="w"> </span><span class="nf">toDomainDebitCreditType</span><span class="p">(</span>
<span class="w">            </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">DEBIT_CREDIT_TYPE_DEBIT</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">DEBIT_CREDIT_TYPE_CREDIT</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">;</span>
<span class="w">            </span><span class="k">default</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unknown debit/credit type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">proto</span><span class="p">);</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">ElementType</span><span class="w"> </span><span class="nf">toProtoElementType</span><span class="p">(</span>
<span class="w">            </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="w"> </span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">ASSET</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ElementType</span><span class="p">.</span><span class="na">ELEMENT_TYPE_ASSET</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">LIABILITY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ElementType</span><span class="p">.</span><span class="na">ELEMENT_TYPE_LIABILITY</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">EQUITY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ElementType</span><span class="p">.</span><span class="na">ELEMENT_TYPE_EQUITY</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">REVENUE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ElementType</span><span class="p">.</span><span class="na">ELEMENT_TYPE_REVENUE</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">EXPENSE</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">ElementType</span><span class="p">.</span><span class="na">ELEMENT_TYPE_EXPENSE</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="w"> </span><span class="nf">toDomainElementType</span><span class="p">(</span>
<span class="w">            </span><span class="n">ElementType</span><span class="w"> </span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">ELEMENT_TYPE_ASSET</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">ASSET</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">ELEMENT_TYPE_LIABILITY</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">LIABILITY</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">ELEMENT_TYPE_EQUITY</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">EQUITY</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">ELEMENT_TYPE_REVENUE</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">REVENUE</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">ELEMENT_TYPE_EXPENSE</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">EXPENSE</span><span class="p">;</span>
<span class="w">            </span><span class="k">default</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unknown element type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">proto</span><span class="p">);</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AggregationType</span><span class="w"> </span><span class="nf">toProtoAggregationType</span><span class="p">(</span>
<span class="w">            </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="w"> </span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">domain</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">HEADING</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">AggregationType</span><span class="p">.</span><span class="na">AGGREGATION_TYPE_HEADING</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">SUMMARY</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">AggregationType</span><span class="p">.</span><span class="na">AGGREGATION_TYPE_SUMMARY</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">POSTING</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">AggregationType</span><span class="p">.</span><span class="na">AGGREGATION_TYPE_POSTING</span><span class="p">;</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="w"> </span><span class="nf">toDomainAggregationType</span><span class="p">(</span>
<span class="w">            </span><span class="n">AggregationType</span><span class="w"> </span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">proto</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">AGGREGATION_TYPE_HEADING</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="p">.</span><span class="na">HEADING</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">AGGREGATION_TYPE_SUMMARY</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="p">.</span><span class="na">SUMMARY</span><span class="p">;</span>
<span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="n">AGGREGATION_TYPE_POSTING</span><span class="w"> </span><span class="o">-&gt;</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="p">.</span><span class="na">POSTING</span><span class="p">;</span>
<span class="w">            </span><span class="k">default</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;Unknown aggregation type: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">proto</span><span class="p">);</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// === ユーティリティ ===</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">nullToEmpty</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">emptyToNull</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">value</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="25-grpc">第 25 章：gRPC インターセプター<a class="headerlink" href="#25-grpc" title="Permanent link">&para;</a></h2>
<h3 id="251">25.1 ログインターセプター<a class="headerlink" href="#251" title="Permanent link">&para;</a></h3>
<details>
<summary>LoggingInterceptor.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.interceptor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">net.devh.boot.grpc.server.interceptor.GrpcGlobalServerInterceptor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.MDC</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.UUID</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * gRPC ログインターセプター</span>
<span class="cm"> */</span>
<span class="nd">@GrpcGlobalServerInterceptor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">LoggingInterceptor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ServerInterceptor</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">LoggingInterceptor</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ServerCall</span><span class="p">.</span><span class="na">Listener</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">interceptCall</span><span class="p">(</span>
<span class="w">            </span><span class="n">ServerCall</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">call</span><span class="p">,</span>
<span class="w">            </span><span class="n">Metadata</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span>
<span class="w">            </span><span class="n">ServerCallHandler</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">requestId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">UUID</span><span class="p">.</span><span class="na">randomUUID</span><span class="p">().</span><span class="na">toString</span><span class="p">();</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">methodName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">call</span><span class="p">.</span><span class="na">getMethodDescriptor</span><span class="p">().</span><span class="na">getFullMethodName</span><span class="p">();</span>
<span class="w">        </span><span class="kt">long</span><span class="w"> </span><span class="n">startTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">();</span>

<span class="w">        </span><span class="n">MDC</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;requestId&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">requestId</span><span class="p">);</span>
<span class="w">        </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;gRPC Request: method={}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">methodName</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ForwardingServerCallListener</span><span class="p">.</span><span class="na">SimpleForwardingServerCallListener</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="o">&gt;</span><span class="p">(</span>
<span class="w">                </span><span class="n">next</span><span class="p">.</span><span class="na">startCall</span><span class="p">(</span>
<span class="w">                    </span><span class="k">new</span><span class="w"> </span><span class="n">ForwardingServerCall</span><span class="p">.</span><span class="na">SimpleForwardingServerCall</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="p">(</span><span class="n">call</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="nd">@Override</span>
<span class="w">                        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">close</span><span class="p">(</span><span class="n">Status</span><span class="w"> </span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">Metadata</span><span class="w"> </span><span class="n">trailers</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                            </span><span class="kt">long</span><span class="w"> </span><span class="n">duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">currentTimeMillis</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">startTime</span><span class="p">;</span>
<span class="w">                            </span><span class="n">log</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;gRPC Response: method={}, status={}, duration={}ms&quot;</span><span class="p">,</span>
<span class="w">                                     </span><span class="n">methodName</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="p">.</span><span class="na">getCode</span><span class="p">(),</span><span class="w"> </span><span class="n">duration</span><span class="p">);</span>
<span class="w">                            </span><span class="n">MDC</span><span class="p">.</span><span class="na">clear</span><span class="p">();</span>
<span class="w">                            </span><span class="kd">super</span><span class="p">.</span><span class="na">close</span><span class="p">(</span><span class="n">status</span><span class="p">,</span><span class="w"> </span><span class="n">trailers</span><span class="p">);</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                    </span><span class="p">},</span>
<span class="w">                    </span><span class="n">headers</span>
<span class="w">                </span><span class="p">)</span>
<span class="w">        </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nd">@Override</span>
<span class="w">            </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onMessage</span><span class="p">(</span><span class="n">ReqT</span><span class="w"> </span><span class="n">message</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&quot;gRPC Request message: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>
<span class="w">                </span><span class="kd">super</span><span class="p">.</span><span class="na">onMessage</span><span class="p">(</span><span class="n">message</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h3 id="252">25.2 例外インターセプター<a class="headerlink" href="#252" title="Permanent link">&para;</a></h3>
<details>
<summary>ExceptionInterceptor.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.interceptor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.BusinessException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.ResourceNotFoundException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.ValidationException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.exception.BalanceNotMatchException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">net.devh.boot.grpc.server.interceptor.GrpcGlobalServerInterceptor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.Logger</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.slf4j.LoggerFactory</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * gRPC 例外インターセプター</span>
<span class="cm"> */</span>
<span class="nd">@GrpcGlobalServerInterceptor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ExceptionInterceptor</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ServerInterceptor</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">ExceptionInterceptor</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">ServerCall</span><span class="p">.</span><span class="na">Listener</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">interceptCall</span><span class="p">(</span>
<span class="w">            </span><span class="n">ServerCall</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">call</span><span class="p">,</span>
<span class="w">            </span><span class="n">Metadata</span><span class="w"> </span><span class="n">headers</span><span class="p">,</span>
<span class="w">            </span><span class="n">ServerCallHandler</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">next</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ExceptionHandlingListener</span><span class="o">&lt;&gt;</span><span class="p">(</span>
<span class="w">            </span><span class="n">next</span><span class="p">.</span><span class="na">startCall</span><span class="p">(</span><span class="n">call</span><span class="p">,</span><span class="w"> </span><span class="n">headers</span><span class="p">),</span>
<span class="w">            </span><span class="n">call</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ExceptionHandlingListener</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span>
<span class="w">            </span><span class="kd">extends</span><span class="w"> </span><span class="n">ForwardingServerCallListener</span><span class="p">.</span><span class="na">SimpleForwardingServerCallListener</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ServerCall</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">call</span><span class="p">;</span>

<span class="w">        </span><span class="kd">protected</span><span class="w"> </span><span class="nf">ExceptionHandlingListener</span><span class="p">(</span>
<span class="w">                </span><span class="n">ServerCall</span><span class="p">.</span><span class="na">Listener</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">delegate</span><span class="p">,</span>
<span class="w">                </span><span class="n">ServerCall</span><span class="o">&lt;</span><span class="n">ReqT</span><span class="p">,</span><span class="w"> </span><span class="n">RespT</span><span class="o">&gt;</span><span class="w"> </span><span class="n">call</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="kd">super</span><span class="p">(</span><span class="n">delegate</span><span class="p">);</span>
<span class="w">            </span><span class="k">this</span><span class="p">.</span><span class="na">call</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">call</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Override</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onHalfClose</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">super</span><span class="p">.</span><span class="na">onHalfClose</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">handleException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">handleException</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Status</span><span class="w"> </span><span class="n">status</span><span class="p">;</span>
<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">message</span><span class="p">;</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ResourceNotFoundException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Status</span><span class="p">.</span><span class="na">NOT_FOUND</span><span class="p">;</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Resource not found: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>

<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ValidationException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Status</span><span class="p">.</span><span class="na">INVALID_ARGUMENT</span><span class="p">;</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Validation error: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>

<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BalanceNotMatchException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Status</span><span class="p">.</span><span class="na">FAILED_PRECONDITION</span><span class="p">;</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Balance not match: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>

<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">BusinessException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Status</span><span class="p">.</span><span class="na">FAILED_PRECONDITION</span><span class="p">;</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Business rule violation: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>

<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Status</span><span class="p">.</span><span class="na">INVALID_ARGUMENT</span><span class="p">;</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">warn</span><span class="p">(</span><span class="s">&quot;Invalid argument: {}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">message</span><span class="p">);</span>

<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Status</span><span class="p">.</span><span class="na">INTERNAL</span><span class="p">;</span>
<span class="w">                </span><span class="n">message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;内部エラーが発生しました&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="n">log</span><span class="p">.</span><span class="na">error</span><span class="p">(</span><span class="s">&quot;Internal error&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="n">call</span><span class="p">.</span><span class="na">close</span><span class="p">(</span><span class="n">status</span><span class="p">.</span><span class="na">withDescription</span><span class="p">(</span><span class="n">message</span><span class="p">),</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Metadata</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="26">第 26 章：動作確認とテスト<a class="headerlink" href="#26" title="Permanent link">&para;</a></h2>
<h3 id="261-grpcurl">26.1 grpcurl による動作確認<a class="headerlink" href="#261-grpcurl" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># サーバー起動確認（リフレクションサービス経由）</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>localhost:9090<span class="w"> </span>list

<span class="c1"># 勘定科目サービスのメソッド一覧</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>localhost:9090<span class="w"> </span>list<span class="w"> </span>com.example.accounting.AccountService

<span class="c1"># 勘定科目取得</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;account_code&quot;: &quot;1110&quot;}&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>localhost:9090<span class="w"> </span>com.example.accounting.AccountService/GetAccount

<span class="c1"># 勘定科目登録</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;account_code&quot;: &quot;1111&quot;,</span>
<span class="s1">  &quot;account_name&quot;: &quot;普通預金（みずほ銀行）&quot;,</span>
<span class="s1">  &quot;bspl_type&quot;: &quot;BSPL_TYPE_BS&quot;,</span>
<span class="s1">  &quot;debit_credit_type&quot;: &quot;DEBIT_CREDIT_TYPE_DEBIT&quot;,</span>
<span class="s1">  &quot;element_type&quot;: &quot;ELEMENT_TYPE_ASSET&quot;,</span>
<span class="s1">  &quot;aggregation_type&quot;: &quot;AGGREGATION_TYPE_POSTING&quot;,</span>
<span class="s1">  &quot;parent_account_code&quot;: &quot;1110&quot;,</span>
<span class="s1">  &quot;display_order&quot;: 10</span>
<span class="s1">}&#39;</span><span class="w"> </span>localhost:9090<span class="w"> </span>com.example.accounting.AccountService/CreateAccount

<span class="c1"># 勘定科目一覧取得（ストリーミング）</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;bspl_type&quot;: &quot;BSPL_TYPE_BS&quot;,</span>
<span class="s1">  &quot;active_only&quot;: true</span>
<span class="s1">}&#39;</span><span class="w"> </span>localhost:9090<span class="w"> </span>com.example.accounting.AccountService/ListAccounts

<span class="c1"># 仕訳登録</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;journal_date&quot;: {&quot;year&quot;: 2025, &quot;month&quot;: 1, &quot;day&quot;: 15},</span>
<span class="s1">  &quot;summary&quot;: &quot;売上計上&quot;,</span>
<span class="s1">  &quot;journal_type&quot;: &quot;JOURNAL_TYPE_NORMAL&quot;,</span>
<span class="s1">  &quot;details&quot;: [{</span>
<span class="s1">    &quot;line_number&quot;: 1,</span>
<span class="s1">    &quot;line_summary&quot;: &quot;A社への売上&quot;,</span>
<span class="s1">    &quot;debit_credit_details&quot;: [</span>
<span class="s1">      {</span>
<span class="s1">        &quot;debit_credit_type&quot;: &quot;DEBIT_CREDIT_TYPE_DEBIT&quot;,</span>
<span class="s1">        &quot;account_code&quot;: &quot;1310&quot;,</span>
<span class="s1">        &quot;amount&quot;: {&quot;units&quot;: 110000, &quot;currency&quot;: &quot;JPY&quot;}</span>
<span class="s1">      },</span>
<span class="s1">      {</span>
<span class="s1">        &quot;debit_credit_type&quot;: &quot;DEBIT_CREDIT_TYPE_CREDIT&quot;,</span>
<span class="s1">        &quot;account_code&quot;: &quot;4100&quot;,</span>
<span class="s1">        &quot;amount&quot;: {&quot;units&quot;: 100000, &quot;currency&quot;: &quot;JPY&quot;}</span>
<span class="s1">      },</span>
<span class="s1">      {</span>
<span class="s1">        &quot;debit_credit_type&quot;: &quot;DEBIT_CREDIT_TYPE_CREDIT&quot;,</span>
<span class="s1">        &quot;account_code&quot;: &quot;2110&quot;,</span>
<span class="s1">        &quot;amount&quot;: {&quot;units&quot;: 10000, &quot;currency&quot;: &quot;JPY&quot;}</span>
<span class="s1">      }</span>
<span class="s1">    ]</span>
<span class="s1">  }]</span>
<span class="s1">}&#39;</span><span class="w"> </span>localhost:9090<span class="w"> </span>com.example.accounting.JournalService/CreateJournal

<span class="c1"># ヘルスチェック</span>
grpcurl<span class="w"> </span>-plaintext<span class="w"> </span>localhost:9090<span class="w"> </span>grpc.health.v1.Health/Check
</code></pre></div>
<h3 id="262">26.2 統合テスト<a class="headerlink" href="#262" title="Permanent link">&para;</a></h3>
<details>
<summary>GrpcAccountServiceTest.java</summary>

<div class="highlight"><pre><span></span><code><span class="kn">package</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.service</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.application.port.in.AccountUseCase</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.domain.model.account.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.converter.AccountConverter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.accounting.infrastructure.in.grpc.proto.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io.grpc.StatusRuntimeException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">net.devh.boot.grpc.client.inject.GrpcClient</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.context.SpringBootTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.boot.test.mock.mockito.MockBean</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.test.context.ActiveProfiles</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Iterator</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Optional</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.*</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.mockito.ArgumentMatchers.any</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.mockito.Mockito.*</span><span class="p">;</span>

<span class="nd">@SpringBootTest</span><span class="p">(</span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;grpc.server.port=9091&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;grpc.server.in-process-name=test&quot;</span>
<span class="p">})</span>
<span class="nd">@ActiveProfiles</span><span class="p">(</span><span class="s">&quot;test&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">GrpcAccountServiceTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@MockBean</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AccountUseCase</span><span class="w"> </span><span class="n">accountUseCase</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@GrpcClient</span><span class="p">(</span><span class="s">&quot;inProcess&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">AccountServiceGrpc</span><span class="p">.</span><span class="na">AccountServiceBlockingStub</span><span class="w"> </span><span class="n">blockingStub</span><span class="p">;</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Account</span><span class="w"> </span><span class="n">sampleAccount</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">sampleAccount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Account</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AccountCode</span><span class="p">(</span><span class="s">&quot;1110&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountName</span><span class="p">(</span><span class="s">&quot;現金&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">bsplType</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">BsplType</span><span class="p">.</span><span class="na">BS</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">elementType</span><span class="p">(</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">ASSET</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">aggregationType</span><span class="p">(</span>
<span class="w">                </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="p">.</span><span class="na">POSTING</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">isActive</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目取得 - 存在する科目を取得できること&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">getAccount_found</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Given</span>
<span class="w">        </span><span class="n">when</span><span class="p">(</span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">findByCode</span><span class="p">(</span><span class="n">any</span><span class="p">(</span><span class="n">AccountCode</span><span class="p">.</span><span class="na">class</span><span class="p">)))</span>
<span class="w">            </span><span class="p">.</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">Optional</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">sampleAccount</span><span class="p">));</span>

<span class="w">        </span><span class="n">GetAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetAccountRequest</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAccountCode</span><span class="p">(</span><span class="s">&quot;1110&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// When</span>
<span class="w">        </span><span class="n">GetAccountResponse</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blockingStub</span><span class="p">.</span><span class="na">getAccount</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Then</span>
<span class="w">        </span><span class="n">assertThat</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">getAccount</span><span class="p">().</span><span class="na">getAccountCode</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="s">&quot;1110&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">assertThat</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">getAccount</span><span class="p">().</span><span class="na">getAccountName</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="s">&quot;現金&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">assertThat</span><span class="p">(</span><span class="n">response</span><span class="p">.</span><span class="na">getAccount</span><span class="p">().</span><span class="na">getBsplType</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">BsplType</span><span class="p">.</span><span class="na">BSPL_TYPE_BS</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目取得 - 存在しない科目は NOT_FOUND&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">getAccount_notFound</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Given</span>
<span class="w">        </span><span class="n">when</span><span class="p">(</span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">findByCode</span><span class="p">(</span><span class="n">any</span><span class="p">(</span><span class="n">AccountCode</span><span class="p">.</span><span class="na">class</span><span class="p">)))</span>
<span class="w">            </span><span class="p">.</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">Optional</span><span class="p">.</span><span class="na">empty</span><span class="p">());</span>

<span class="w">        </span><span class="n">GetAccountRequest</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">GetAccountRequest</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">setAccountCode</span><span class="p">(</span><span class="s">&quot;9999&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// When &amp; Then</span>
<span class="w">        </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">blockingStub</span><span class="p">.</span><span class="na">getAccount</span><span class="p">(</span><span class="n">request</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">StatusRuntimeException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">satisfies</span><span class="p">(</span><span class="n">e</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">StatusRuntimeException</span><span class="w"> </span><span class="n">sre</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">StatusRuntimeException</span><span class="p">)</span><span class="w"> </span><span class="n">e</span><span class="p">;</span>
<span class="w">                </span><span class="n">assertThat</span><span class="p">(</span><span class="n">sre</span><span class="p">.</span><span class="na">getStatus</span><span class="p">().</span><span class="na">getCode</span><span class="p">())</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">io</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">Status</span><span class="p">.</span><span class="na">NOT_FOUND</span><span class="p">.</span><span class="na">getCode</span><span class="p">());</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目一覧取得 - ストリーミングで取得できること&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">listAccounts_streaming</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Given</span>
<span class="w">        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">accounts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">            </span><span class="n">sampleAccount</span><span class="p">,</span>
<span class="w">            </span><span class="n">Account</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">AccountCode</span><span class="p">(</span><span class="s">&quot;1120&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">accountName</span><span class="p">(</span><span class="s">&quot;普通預金&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">bsplType</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">BsplType</span><span class="p">.</span><span class="na">BS</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span>
<span class="w">                    </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">elementType</span><span class="p">(</span>
<span class="w">                    </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">ElementType</span><span class="p">.</span><span class="na">ASSET</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">aggregationType</span><span class="p">(</span>
<span class="w">                    </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">domain</span><span class="p">.</span><span class="na">model</span><span class="p">.</span><span class="na">account</span><span class="p">.</span><span class="na">AggregationType</span><span class="p">.</span><span class="na">POSTING</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">isActive</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">()</span>
<span class="w">        </span><span class="p">);</span>
<span class="w">        </span><span class="n">when</span><span class="p">(</span><span class="n">accountUseCase</span><span class="p">.</span><span class="na">findAll</span><span class="p">(</span><span class="n">any</span><span class="p">())).</span><span class="na">thenReturn</span><span class="p">(</span><span class="n">accounts</span><span class="p">);</span>

<span class="w">        </span><span class="n">ListAccountsRequest</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ListAccountsRequest</span><span class="p">.</span><span class="na">newBuilder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">setBsplType</span><span class="p">(</span><span class="n">BsplType</span><span class="p">.</span><span class="na">BSPL_TYPE_BS</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">setActiveOnly</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="c1">// When</span>
<span class="w">        </span><span class="n">Iterator</span><span class="o">&lt;</span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">infrastructure</span><span class="p">.</span><span class="na">in</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">proto</span><span class="p">.</span><span class="na">Account</span><span class="o">&gt;</span><span class="w"> </span><span class="n">iterator</span><span class="w"> </span><span class="o">=</span>
<span class="w">            </span><span class="n">blockingStub</span><span class="p">.</span><span class="na">listAccounts</span><span class="p">(</span><span class="n">request</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Then</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">        </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">iterator</span><span class="p">.</span><span class="na">hasNext</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">com</span><span class="p">.</span><span class="na">example</span><span class="p">.</span><span class="na">accounting</span><span class="p">.</span><span class="na">infrastructure</span><span class="p">.</span><span class="na">in</span><span class="p">.</span><span class="na">grpc</span><span class="p">.</span><span class="na">proto</span><span class="p">.</span><span class="na">Account</span><span class="w"> </span><span class="n">account</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iterator</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">account</span><span class="p">.</span><span class="na">getAccountCode</span><span class="p">()).</span><span class="na">matches</span><span class="p">(</span><span class="s">&quot;11\\d+&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">count</span><span class="o">++</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">assertThat</span><span class="p">(</span><span class="n">count</span><span class="p">).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="27">第 27 章：まとめ<a class="headerlink" href="#27" title="Permanent link">&para;</a></h2>
<h3 id="271">27.1 学習した内容<a class="headerlink" href="#271" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>gRPC の基本概念</strong>: Protocol Buffers、HTTP/2、4 つの RPC パターン</li>
<li><strong>REST/GraphQL との比較</strong>: 用途に応じた適切な選択</li>
<li><strong>ヘキサゴナルアーキテクチャとの統合</strong>: Input Adapter として gRPC サービスを追加</li>
<li><strong>技術スタック</strong>: grpc-spring-boot-starter、Protocol Buffers</li>
<li><strong>Protocol Buffers 定義</strong>: 共通型、勘定科目、仕訳、残高のメッセージとサービス定義</li>
<li><strong>gRPC サービス実装</strong>: 単項 RPC、ストリーミング RPC</li>
<li><strong>インターセプター</strong>: ログ、例外ハンドリング</li>
<li><strong>テスト</strong>: gRPC クライアントを使用した統合テスト</li>
</ol>
<h3 id="272-grpc">27.2 gRPC が適するユースケース<a class="headerlink" href="#272-grpc" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>ユースケース</th>
<th>理由</th>
</tr>
</thead>
<tbody>
<tr>
<td>基幹システム連携</td>
<td>高性能なバイナリ通信</td>
</tr>
<tr>
<td>大量仕訳一括登録</td>
<td>クライアントストリーミング</td>
</tr>
<tr>
<td>リアルタイム残高監視</td>
<td>双方向ストリーミング</td>
</tr>
<tr>
<td>月次締め進捗通知</td>
<td>サーバーストリーミング</td>
</tr>
<tr>
<td>マイクロサービス間通信</td>
<td>型安全な API 定義</td>
</tr>
</tbody>
</table>
<h3 id="273-api">27.3 API アーキテクチャ選択ガイド<a class="headerlink" href="#273-api" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkFDVElWSVRZIiBoZWlnaHQ9IjM4MnB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NTg4cHg7aGVpZ2h0OjM4MnB4O2JhY2tncm91bmQ6I0ZFRkVGRTsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDU4OCAzODIiIHdpZHRoPSI1ODhweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjxyZWN0IGZpbGw9IiNGRUZFRkUiIGhlaWdodD0iMzgyIiBzdHlsZT0ic3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iNTg4IiB4PSIwIiB5PSIwIi8+PGVsbGlwc2UgY3g9IjI1MC43Nzk0IiBjeT0iMjAiIGZpbGw9IiMyMjIyMjIiIHJ4PSIxMCIgcnk9IjEwIiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9Ijc4Ljc5OTEiIHg9IjIxMS4zNzk4IiB5PSI1MCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU4Ljc5OTEiIHg9IjIyMS4zNzk4IiB5PSI3MS4xMzg3Ij5BUEkgJiMxMjM2NDsmIzI0NTE3OyYjMzUyMDE7PC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNGMUYxRjEiIHBvaW50cz0iMTgxLjg2MDYsMTAzLjk2ODgsMzE5LjY5ODEsMTAzLjk2ODgsMzMxLjY5ODEsMTE1Ljk2ODgsMzE5LjY5ODEsMTI3Ljk2ODgsMTgxLjg2MDYsMTI3Ljk2ODgsMTY5Ljg2MDYsMTE1Ljk2ODgsMTgxLjg2MDYsMTAzLjk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzNy44Mzc1IiB4PSIxODEuODYwNiIgeT0iMTE5Ljc3NjkiPiYjMTI1MDI7JiMxMjUyMTsmIzEyNDU0OyYjMTI0NzA7JiMxMjM2MzsmIzEyNDI1OyYjMzA0NTI7JiMyNTUwOTsmIzEyNDUwOyYjMTI0NjM7JiMxMjQ3NTsmIzEyNDczOz88L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjEuOTk5OCIgeD0iMTQ3Ljg2MDgiIHk9IjExMy4zNzQ1Ij4mIzEyMzk5OyYjMTIzNTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMyLjk5OTgiIHg9IjMzMS42OTgxIiB5PSIxMTMuMzc0NSI+JiMxMjM1NjsmIzEyMzU2OyYjMTIzNjA7PC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNGMUYxRjEiIHBvaW50cz0iNjkuNDY5NywxMzcuOTY4OCwxNzQuMzA3NCwxMzcuOTY4OCwxODYuMzA3NCwxNDkuOTY4OCwxNzQuMzA3NCwxNjEuOTY4OCw2OS40Njk3LDE2MS45Njg4LDU3LjQ2OTcsMTQ5Ljk2ODgsNjkuNDY5NywxMzcuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA0LjgzNzciIHg9IjY5LjQ2OTciIHk9IjE1My43NzY5Ij4mIzI2NTgwOyYjMzY1NzU7JiMxMjM5NDsmIzEyNDYzOyYjMTI0NTY7JiMxMjUyMjsmIzEyMzY0OyYjMjQ1MTc7JiMzNTIwMTs/PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIxLjk5OTgiIHg9IjM1LjQ2OTkiIHk9IjE0Ny4zNzQ1Ij4mIzEyMzk5OyYjMTIzNTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMyLjk5OTgiIHg9IjE4Ni4zMDc0IiB5PSIxNDcuMzc0NSI+JiMxMjM1NjsmIzEyMzU2OyYjMTIzNjA7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI3Mi45Mzk1IiB4PSIxMSIgeT0iMTcxLjk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1Mi45Mzk1IiB4PSIyMSIgeT0iMTkzLjEwNzQiPkdyYXBoUUw8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjczLjY2NiIgeD0iMTU5LjQ3NDQiIHk9IjE3MS45Njg4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTMuNjY2IiB4PSIxNjkuNDc0NCIgeT0iMTkzLjEwNzQiPlJFU1QgQVBJPC90ZXh0Pjxwb2x5Z29uIGZpbGw9IiNGMUYxRjEiIHBvaW50cz0iMTIxLjg4ODYsMjExLjkzNzUsMTMzLjg4ODYsMjIzLjkzNzUsMTIxLjg4ODYsMjM1LjkzNzUsMTA5Ljg4ODYsMjIzLjkzNzUsMTIxLjg4ODYsMjExLjkzNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwb2x5Z29uIGZpbGw9IiNGMUYxRjEiIHBvaW50cz0iMzQzLjc1MTIsMTM3Ljk2ODgsNDE1LjU4OTEsMTM3Ljk2ODgsNDI3LjU4OTEsMTQ5Ljk2ODgsNDE1LjU4OTEsMTYxLjk2ODgsMzQzLjc1MTIsMTYxLjk2ODgsMzMxLjc1MTIsMTQ5Ljk2ODgsMzQzLjc1MTIsMTM3Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcxLjgzNzkiIHg9IjM0My43NTEyIiB5PSIxNTMuNzc2OSI+JiMzOTY0MDsmIzI0NjE1OyYjMzMwMjE7JiMxMjM2NDsmIzI0NTE3OyYjMzUyMDE7PzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMS45OTk4IiB4PSIzMDkuNzUxMyIgeT0iMTQ3LjM3NDUiPiYjMTIzOTk7JiMxMjM1Njs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzIuOTk5OCIgeD0iNDI3LjU4OTEiIHk9IjE0Ny4zNzQ1Ij4mIzEyMzU2OyYjMTIzNTY7JiMxMjM2MDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjUxLjU3MDMiIHg9IjI3My4xNDA0IiB5PSIxNzEuOTY4OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMxLjU3MDMiIHg9IjI4My4xNDA0IiB5PSIxOTMuMTA3NCI+Z1JQQzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9IjQwMi40OTU5LDE3MS45Njg4LDUxOC4zMzM1LDE3MS45Njg4LDUzMC4zMzM1LDE4My45Njg4LDUxOC4zMzM1LDE5NS45Njg4LDQwMi40OTU5LDE5NS45Njg4LDM5MC40OTU5LDE4My45Njg4LDQwMi40OTU5LDE3MS45Njg4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTUuODM3NiIgeD0iNDAyLjQ5NTkiIHk9IjE4Ny43NzY5Ij4mIzEyNDczOyYjMTI0ODg7JiMxMjUyMjsmIzEyNTQwOyYjMTI1MTE7JiMxMjUzMTsmIzEyNDY0OyYjMTIzNjQ7JiMyNDUxNzsmIzM1MjAxOz88L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjEuOTk5OCIgeD0iMzY4LjQ5NiIgeT0iMTgxLjM3NDUiPiYjMTIzOTk7JiMxMjM1Njs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMzIuOTk5OCIgeD0iNTMwLjMzMzUiIHk9IjE4MS4zNzQ1Ij4mIzEyMzU2OyYjMTIzNTY7JiMxMjM2MDs8L3RleHQ+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjUxLjU3MDMiIHg9IjM1NC43MTA3IiB5PSIyMDUuOTY4OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMxLjU3MDMiIHg9IjM2NC43MTA3IiB5PSIyMjcuMTA3NCI+Z1JQQzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNzMuNjY2IiB4PSI1MDMuNTAwNSIgeT0iMjA1Ljk2ODgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1My42NjYiIHg9IjUxMy41MDA1IiB5PSIyMjcuMTA3NCI+UkVTVCBBUEk8L3RleHQ+PHBvbHlnb24gZmlsbD0iI0YxRjFGMSIgcG9pbnRzPSI0NjAuNDE0NywyNDUuOTM3NSw0NzIuNDE0NywyNTcuOTM3NSw0NjAuNDE0NywyNjkuOTM3NSw0NDguNDE0NywyNTcuOTM3NSw0NjAuNDE0NywyNDUuOTM3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBvbHlnb24gZmlsbD0iI0YxRjFGMSIgcG9pbnRzPSIzNzkuNjcwMSwyNzUuOTM3NSwzOTEuNjcwMSwyODcuOTM3NSwzNzkuNjcwMSwyOTkuOTM3NSwzNjcuNjcwMSwyODcuOTM3NSwzNzkuNjcwMSwyNzUuOTM3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBvbHlnb24gZmlsbD0iI0YxRjFGMSIgcG9pbnRzPSIyNTAuNzc5NCwzMDUuOTM3NSwyNjIuNzc5NCwzMTcuOTM3NSwyNTAuNzc5NCwzMjkuOTM3NSwyMzguNzc5NCwzMTcuOTM3NSwyNTAuNzc5NCwzMDUuOTM3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PGVsbGlwc2UgY3g9IjI1MC43Nzk0IiBjeT0iMzYwLjkzNzUiIGZpbGw9Im5vbmUiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PGVsbGlwc2UgY3g9IjI1MC43Nzk0IiBjeT0iMzYwLjkzNzUiIGZpbGw9IiMyMjIyMjIiIHJ4PSI2IiByeT0iNiIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyNTAuNzc5NCIgeDI9IjI1MC43Nzk0IiB5MT0iMzAiIHkyPSI1MCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjQ2Ljc3OTQsNDAsMjUwLjc3OTQsNTAsMjU0Ljc3OTQsNDAsMjUwLjc3OTQsNDQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTcuNDY5NyIgeDI9IjQ3LjQ2OTciIHkxPSIxNDkuOTY4OCIgeTI9IjE0OS45Njg4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ3LjQ2OTciIHgyPSI0Ny40Njk3IiB5MT0iMTQ5Ljk2ODgiIHkyPSIxNzEuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDMuNDY5NywxNjEuOTY4OCw0Ny40Njk3LDE3MS45Njg4LDUxLjQ2OTcsMTYxLjk2ODgsNDcuNDY5NywxNjUuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxODYuMzA3NCIgeDI9IjE5Ni4zMDc0IiB5MT0iMTQ5Ljk2ODgiIHkyPSIxNDkuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOTYuMzA3NCIgeDI9IjE5Ni4zMDc0IiB5MT0iMTQ5Ljk2ODgiIHkyPSIxNzEuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTkyLjMwNzQsMTYxLjk2ODgsMTk2LjMwNzQsMTcxLjk2ODgsMjAwLjMwNzQsMTYxLjk2ODgsMTk2LjMwNzQsMTY1Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDcuNDY5NyIgeDI9IjQ3LjQ2OTciIHkxPSIyMDUuOTM3NSIgeTI9IjIyMy45Mzc1Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ3LjQ2OTciIHgyPSIxMDkuODg4NiIgeTE9IjIyMy45Mzc1IiB5Mj0iMjIzLjkzNzUiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9Ijk5Ljg4ODYsMjE5LjkzNzUsMTA5Ljg4ODYsMjIzLjkzNzUsOTkuODg4NiwyMjcuOTM3NSwxMDMuODg4NiwyMjMuOTM3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOTYuMzA3NCIgeDI9IjE5Ni4zMDc0IiB5MT0iMjA1LjkzNzUiIHkyPSIyMjMuOTM3NSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOTYuMzA3NCIgeDI9IjEzMy44ODg2IiB5MT0iMjIzLjkzNzUiIHkyPSIyMjMuOTM3NSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTQzLjg4ODYsMjE5LjkzNzUsMTMzLjg4ODYsMjIzLjkzNzUsMTQzLjg4ODYsMjI3LjkzNzUsMTM5Ljg4ODYsMjIzLjkzNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzkwLjQ5NTkiIHgyPSIzODAuNDk1OSIgeTE9IjE4My45Njg4IiB5Mj0iMTgzLjk2ODgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzgwLjQ5NTkiIHgyPSIzODAuNDk1OSIgeTE9IjE4My45Njg4IiB5Mj0iMjA1Ljk2ODgiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM3Ni40OTU5LDE5NS45Njg4LDM4MC40OTU5LDIwNS45Njg4LDM4NC40OTU5LDE5NS45Njg4LDM4MC40OTU5LDE5OS45Njg4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjUzMC4zMzM1IiB4Mj0iNTQwLjMzMzUiIHkxPSIxODMuOTY4OCIgeTI9IjE4My45Njg4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjU0MC4zMzM1IiB4Mj0iNTQwLjMzMzUiIHkxPSIxODMuOTY4OCIgeTI9IjIwNS45Njg4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1MzYuMzMzNSwxOTUuOTY4OCw1NDAuMzMzNSwyMDUuOTY4OCw1NDQuMzMzNSwxOTUuOTY4OCw1NDAuMzMzNSwxOTkuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzODAuNDk1OSIgeDI9IjM4MC40OTU5IiB5MT0iMjM5LjkzNzUiIHkyPSIyNTcuOTM3NSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzODAuNDk1OSIgeDI9IjQ0OC40MTQ3IiB5MT0iMjU3LjkzNzUiIHkyPSIyNTcuOTM3NSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDM4LjQxNDcsMjUzLjkzNzUsNDQ4LjQxNDcsMjU3LjkzNzUsNDM4LjQxNDcsMjYxLjkzNzUsNDQyLjQxNDcsMjU3LjkzNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTQwLjMzMzUiIHgyPSI1NDAuMzMzNSIgeTE9IjIzOS45Mzc1IiB5Mj0iMjU3LjkzNzUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNTQwLjMzMzUiIHgyPSI0NzIuNDE0NyIgeTE9IjI1Ny45Mzc1IiB5Mj0iMjU3LjkzNzUiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjQ4Mi40MTQ3LDI1My45Mzc1LDQ3Mi40MTQ3LDI1Ny45Mzc1LDQ4Mi40MTQ3LDI2MS45Mzc1LDQ3OC40MTQ3LDI1Ny45Mzc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjMzMS43NTEyIiB4Mj0iMjk4LjkyNTYiIHkxPSIxNDkuOTY4OCIgeTI9IjE0OS45Njg4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI5OC45MjU2IiB4Mj0iMjk4LjkyNTYiIHkxPSIxNDkuOTY4OCIgeTI9IjE3MS45Njg4Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyOTQuOTI1NiwxNjEuOTY4OCwyOTguOTI1NiwxNzEuOTY4OCwzMDIuOTI1NiwxNjEuOTY4OCwyOTguOTI1NiwxNjUuOTY4OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI0MjcuNTg5MSIgeDI9IjQ2MC40MTQ3IiB5MT0iMTQ5Ljk2ODgiIHkyPSIxNDkuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI0NjAuNDE0NyIgeDI9IjQ2MC40MTQ3IiB5MT0iMTQ5Ljk2ODgiIHkyPSIxNzEuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iNDU2LjQxNDcsMTYxLjk2ODgsNDYwLjQxNDcsMTcxLjk2ODgsNDY0LjQxNDcsMTYxLjk2ODgsNDYwLjQxNDcsMTY1Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjk4LjkyNTYiIHgyPSIyOTguOTI1NiIgeTE9IjIwNS45Mzc1IiB5Mj0iMjg3LjkzNzUiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjk4LjkyNTYiIHgyPSIzNjcuNjcwMSIgeTE9IjI4Ny45Mzc1IiB5Mj0iMjg3LjkzNzUiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM1Ny42NzAxLDI4My45Mzc1LDM2Ny42NzAxLDI4Ny45Mzc1LDM1Ny42NzAxLDI5MS45Mzc1LDM2MS42NzAxLDI4Ny45Mzc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ2MC40MTQ3IiB4Mj0iNDYwLjQxNDciIHkxPSIyNjkuOTM3NSIgeTI9IjI4Ny45Mzc1Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQ2MC40MTQ3IiB4Mj0iMzkxLjY3MDEiIHkxPSIyODcuOTM3NSIgeTI9IjI4Ny45Mzc1Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI0MDEuNjcwMSwyODMuOTM3NSwzOTEuNjcwMSwyODcuOTM3NSw0MDEuNjcwMSwyOTEuOTM3NSwzOTcuNjcwMSwyODcuOTM3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNjkuODYwNiIgeDI9IjEyMS44ODg2IiB5MT0iMTE1Ljk2ODgiIHkyPSIxMTUuOTY4OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjEuODg4NiIgeDI9IjEyMS44ODg2IiB5MT0iMTE1Ljk2ODgiIHkyPSIxMzcuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTE3Ljg4ODYsMTI3Ljk2ODgsMTIxLjg4ODYsMTM3Ljk2ODgsMTI1Ljg4ODYsMTI3Ljk2ODgsMTIxLjg4ODYsMTMxLjk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzMxLjY5ODEiIHgyPSIzNzkuNjcwMSIgeTE9IjExNS45Njg4IiB5Mj0iMTE1Ljk2ODgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzc5LjY3MDEiIHgyPSIzNzkuNjcwMSIgeTE9IjExNS45Njg4IiB5Mj0iMTM3Ljk2ODgiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjM3NS42NzAxLDEyNy45Njg4LDM3OS42NzAxLDEzNy45Njg4LDM4My42NzAxLDEyNy45Njg4LDM3OS42NzAxLDEzMS45Njg4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMS44ODg2IiB4Mj0iMTIxLjg4ODYiIHkxPSIyMzUuOTM3NSIgeTI9IjMxNy45Mzc1Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMS44ODg2IiB4Mj0iMjM4Ljc3OTQiIHkxPSIzMTcuOTM3NSIgeTI9IjMxNy45Mzc1Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMjguNzc5NCwzMTMuOTM3NSwyMzguNzc5NCwzMTcuOTM3NSwyMjguNzc5NCwzMjEuOTM3NSwyMzIuNzc5NCwzMTcuOTM3NSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzNzkuNjcwMSIgeDI9IjM3OS42NzAxIiB5MT0iMjk5LjkzNzUiIHkyPSIzMTcuOTM3NSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzNzkuNjcwMSIgeDI9IjI2Mi43Nzk0IiB5MT0iMzE3LjkzNzUiIHkyPSIzMTcuOTM3NSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjcyLjc3OTQsMzEzLjkzNzUsMjYyLjc3OTQsMzE3LjkzNzUsMjcyLjc3OTQsMzIxLjkzNzUsMjY4Ljc3OTQsMzE3LjkzNzUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjUwLjc3OTQiIHgyPSIyNTAuNzc5NCIgeTE9IjgzLjk2ODgiIHkyPSIxMDMuOTY4OCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjQ2Ljc3OTQsOTMuOTY4OCwyNTAuNzc5NCwxMDMuOTY4OCwyNTQuNzc5NCw5My45Njg4LDI1MC43Nzk0LDk3Ljk2ODgiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjUwLjc3OTQiIHgyPSIyNTAuNzc5NCIgeTE9IjMyOS45Mzc1IiB5Mj0iMzQ5LjkzNzUiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjI0Ni43Nzk0LDMzOS45Mzc1LDI1MC43Nzk0LDM0OS45Mzc1LDI1NC43Nzk0LDMzOS45Mzc1LDI1MC43Nzk0LDM0My45Mzc1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PCEtLVNSQz1bS3FuOUpTbENJcks4U2RLRVNWSHB6dDVMSUN2OUIyeGN1WWhFcGltaEkybkFwNUw4SWFwRUpZX0FCeXJCU1N4Rm9JeklLN1BwMUs2V2FmQjRlWDhrQllsNzA0LTVudXF6Sl9VdGxiWk1RQ3Q1YlBjY2VGNnVVVGhadmZNRmN2T3pSamhza0I3eFNMRmR5emJSZGxLalZUb3F3NzdKLWlURGtueXR4UkpOTDJaOUlDcTNBY3ZTX3hZbkhIRWl5VGR5QUl6c3B0X1NrMGdpUkNOWnZiTG1lcDdLTXhhTjlIUGExRmZPU3dOYzVBVTJuNWwwZzBDZTVVR1E3QTgwVDFiR0JZeWJDbXJKMVNZb2J3amRGNmpPX2c5dkJudXhxZUMyZEFzblFtVnd1TjVwMXlZOXBOaVVEeXpfdEJwdlNUQzZxZXQyVDJpSTJHcGJfMDgwXS0tPjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="274">27.4 次のステップ<a class="headerlink" href="#274" title="Permanent link">&para;</a></h3>
<ul>
<li>gRPC-Web による Web フロントエンド対応</li>
<li>認証・認可（JWT トークン検証）</li>
<li>ロードバランシングとサービスメッシュ</li>
<li>Observability（メトリクス、トレーシング）</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/practical-database-design" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>