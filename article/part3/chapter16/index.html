
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="基幹業務システム（販売管理・財務会計・生産管理）のデータベース設計を体系的に解説">
      
      
        <meta name="author" content="k2works">
      
      
      
        <link rel="prev" href="../chapter15/">
      
      
        <link rel="next" href="../chapter17/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>第16章 仕訳の設計 - 実践データベース設計：基幹業務システム編</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../docs/mkdocs/assets/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#16" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-header__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            実践データベース設計：基幹業務システム編
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              第16章 仕訳の設計
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  
  実践データベース設計

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="実践データベース設計：基幹業務システム編" class="md-nav__button md-logo" aria-label="実践データベース設計：基幹業務システム編" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    実践データベース設計：基幹業務システム編
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/k2works/practical-database-design" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    practical-database-design
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    実践データベース設計
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    実践データベース設計
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../techstack/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    技術スタック
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../outline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    アウトライン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    執筆ワークフロー
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    運用ガイド
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_6" >
        
          
          <label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    デプロイ
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    デプロイ
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy-sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SMS デモデプロイ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../deploy-fas/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    FAS デモデプロイ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_7" >
        
          
          <label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第1部 基幹業務システムの全体像
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    第1部 基幹業務システムの全体像
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter01/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第1章 基幹業務システムとは
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter02/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第2章 基幹業務システムの業務領域
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part1/chapter03/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第3章 業務フローの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_8" >
        
          
          <label class="md-nav__link" for="__nav_1_8" id="__nav_1_8_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第2部 販売管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_8">
            <span class="md-nav__icon md-icon"></span>
            
  
    第2部 販売管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter04/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第4章 販売管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter05/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第5章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter06/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第6章 受注・出荷・売上の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter07/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第7章 債権管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter08/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第8章 調達管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter09/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第9章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter10/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第10章 債務管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter11/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第11章 共通処理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter12/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第12章 販売管理データ設計（B社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part2/chapter13/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第13章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" checked>
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第3部 財務会計システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    第3部 財務会計システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter14/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#161" class="md-nav__link">
    <span class="md-ellipsis">
      
        16.1 仕訳テーブルの設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16.1 仕訳テーブルの設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        複式簿記と仕訳の概念
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="複式簿記と仕訳の概念">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        仕訳の具体例
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        仕訳処理の流れ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      
        仕訳テーブルの項目設計
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#er" class="md-nav__link">
    <span class="md-ellipsis">
      
        仕訳テーブルのER図
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      
        マイグレーション：仕訳テーブルの作成
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#162" class="md-nav__link">
    <span class="md-ellipsis">
      
        16.2 仕訳明細の設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16.2 仕訳明細の設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      
        仕訳明細の役割
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      
        単一仕訳と複合仕訳
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#163" class="md-nav__link">
    <span class="md-ellipsis">
      
        16.3 仕訳貸借明細の設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16.3 仕訳貸借明細の設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      
        仕訳貸借明細の項目
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="仕訳貸借明細の項目">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      
        基本情報
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      
        多通貨対応
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      
        管理会計情報
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      
        消費税情報
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      
        その他
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdd" class="md-nav__link">
    <span class="md-ellipsis">
      
        TDD による仕訳テーブルの実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="TDD による仕訳テーブルの実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enum" class="md-nav__link">
    <span class="md-ellipsis">
      
        ドメイン層：Enum定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      
        ドメイン層：エンティティ
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      
        テストコード
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output-port" class="md-nav__link">
    <span class="md-ellipsis">
      
        アプリケーション層（Output Port）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      
        インフラストラクチャ層
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#164" class="md-nav__link">
    <span class="md-ellipsis">
      
        16.4 リレーションと楽観ロックの設計
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="16.4 リレーションと楽観ロックの設計">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mybatis-resultmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        MyBatis ネストした ResultMap によるリレーション設定
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MyBatis ネストした ResultMap によるリレーション設定">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#resultmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        ネストした ResultMap の定義
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      
        リレーション設定のポイント
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      
        楽観ロックの実装
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="楽観ロックの実装">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flyway" class="md-nav__link">
    <span class="md-ellipsis">
      
        Flyway マイグレーション: バージョンカラム追加
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      
        エンティティへのバージョンフィールド追加
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mybatis-mapper" class="md-nav__link">
    <span class="md-ellipsis">
      
        MyBatis Mapper: 楽観ロック対応の更新
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      
        楽観ロック例外クラス
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repository" class="md-nav__link">
    <span class="md-ellipsis">
      
        Repository 実装: 楽観ロック対応
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tdd_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        TDD: 楽観ロックのテスト
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      
        楽観ロックのベストプラクティス
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      
        3層構造におけるリレーションと整合性
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3層構造におけるリレーションと整合性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      
        更新パターン
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      
        推奨アプローチ
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#16_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        第16章のまとめ
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="第16章のまとめ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    <span class="md-ellipsis">
      
        作成したテーブル
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#er_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        ER図
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    <span class="md-ellipsis">
      
        設計のポイント
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    <span class="md-ellipsis">
      
        ドメインロジック
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    <span class="md-ellipsis">
      
        次章の予告
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter17/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter18/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter19/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter20/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../chapter21/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第4部 生産管理システム
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    第4部 生産管理システム
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter22/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第22章 生産管理システムの全体像
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter23/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第23章 マスタ情報の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter24/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第24章 生産計画の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter25/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第25章 購買管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter26/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第26章 外注委託管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter27/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第27章 工程管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter28/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第28章 在庫管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter29/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第29章 品質管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter30/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第30章 製造原価管理の設計
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter31/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第31章 生産管理データ設計（E社事例）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part4/chapter32/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第32章 APIサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_11" >
        
          
          <label class="md-nav__link" for="__nav_1_11" id="__nav_1_11_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    第5部 エンタープライズインテグレーション
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_11">
            <span class="md-nav__icon md-icon"></span>
            
  
    第5部 エンタープライズインテグレーション
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter33.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第33章 システム統合の概要
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter34.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第34章 メッセージングパターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter35.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第35章 システム間連携パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter36.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第36章 マスタデータ管理（MDM）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter37.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第37章 イベント駆動アーキテクチャ
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter38.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第38章 API設計とサービス連携
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part5/chapter39.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第39章 データ連携の実装パターン
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_12" >
        
          
          <label class="md-nav__link" for="__nav_1_12" id="__nav_1_12_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 販売管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_12">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 販売管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study2-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_13" >
        
          
          <label class="md-nav__link" for="__nav_1_13" id="__nav_1_13_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_13">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study3-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_14" >
        
          
          <label class="md-nav__link" for="__nav_1_14" id="__nav_1_14_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 生産管理システム実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_14">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 生産管理システム実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究1 モノリスサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究2 JavaFXデスクトップアプリケーションの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-3/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究3 gRPCサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../study/study4-4/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    研究4 GraphQLサービスの実装
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_15" >
        
          
          <label class="md-nav__link" for="__nav_1_15" id="__nav_1_15_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    研究 財務会計システムORM実装編
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_15">
            <span class="md-nav__icon md-icon"></span>
            
  
    研究 財務会計システムORM実装編
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter14-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第14章 財務会計システムの全体像【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter15-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第15章 勘定科目の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter16-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第16章 仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter17-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第17章 自動仕訳の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter18-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第18章 勘定科目残高の設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter19-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第19章 赤黒とログの設計【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter20-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第20章 財務会計データ設計（D社事例）【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../part3-orm/chapter21-orm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    第21章 APIサービスの実装【ORM版】
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_16" >
        
          
          <label class="md-nav__link" for="__nav_1_16" id="__nav_1_16_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    付録
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_16">
            <span class="md-nav__icon md-icon"></span>
            
  
    付録
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/er-diagrams.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    A 全体ER図
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/table-definitions.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    B テーブル定義一覧
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../appendix/glossary.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    C 用語集
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_17" >
        
          
          <label class="md-nav__link" for="__nav_1_17" id="__nav_1_17_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    データベース
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_17_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_17">
            <span class="md-nav__icon md-icon"></span>
            
  
    データベース
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../assets/schemaspy-output/sms/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    SchemaSpy ER図（SMS）
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="16">第16章：仕訳の設計<a class="headerlink" href="#16" title="Permanent link">&para;</a></h1>
<p>財務会計システムの核心部分である「仕訳処理」を TDD で設計していきます。複式簿記の原則に基づき、仕訳データの登録・管理を実現するテーブル構造を設計します。</p>
<hr />
<h2 id="161">16.1 仕訳テーブルの設計<a class="headerlink" href="#161" title="Permanent link">&para;</a></h2>
<h3 id="_1">複式簿記と仕訳の概念<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h3>
<p>複式簿記は、すべての取引を「借方（かりかた）」と「貸方（かしかた）」の2つの側面から記録する方式です。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjI5NHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NDE0cHg7aGVpZ2h0OjI5NHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDQxNCAyOTQiIHdpZHRoPSI0MTRweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMzUwNzk7JiMyNDMzNTsmIzMxODA3OyYjMzUzNTI7JiMxMjM5ODsmIzIxNDA3OyYjMjEwNjM7PC90aXRsZT48ZGVmcy8+PGc+PGcgY2xhc3M9InRpdGxlIiBkYXRhLXNvdXJjZS1saW5lPSIxIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iMTUxLjA2NzYiIHk9IjIyLjk5NTEiPiYjMzUwNzk7JiMyNDMzNTsmIzMxODA3OyYjMzUzNTI7JiMxMjM5ODsmIzIxNDA3OyYjMjEwNjM7PC90ZXh0PjwvZz48IS0tY2x1c3RlciB0cmFuc2FjdGlvbi0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSJ0cmFuc2FjdGlvbiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgaWQ9ImVudDAwMDIiPjxyZWN0IGZpbGw9Im5vbmUiIGhlaWdodD0iMTUyLjE5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMzM1IiB4PSI3IiB5PSI0NC4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ljk5OTkiIHg9IjE2MC41MDAxIiB5PSI1OS4yOTIiPiYjMjE0NjI7JiMyNDM0MTs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgZGViaXQtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJ0cmFuc2FjdGlvbi5kZWJpdCIgZGF0YS1zb3VyY2UtbGluZT0iNCIgaWQ9ImVudDAwMDMiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iODUuMTg3NSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTEzLjY1ODkiIHg9IjMxLjE3IiB5PSI4Ny4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTMuNjU4OSIgeD0iNDEuMTciIHk9IjExMC4yOTIiPiYjMjA1MTE7JiMyNjA0MTsmIzY1Mjg4O0RlYml0JiM2NTI4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDEuMTciIHk9IjEyNi41ODg5Ij4mIzM2MDM5OyYjMjk5ODc7JiMxMjM5ODsmIzIyNjc5OyYjMjExNTI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjQxLjE3IiB5PSIxNDIuODg1NyI+JiMzNjAwMDsmIzIwNjYxOyYjMTIzOTg7JiMyODE4NzsmIzIzNTY5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSI0MS4xNyIgeT0iMTU5LjE4MjYiPiYjMzYwMjc7JiMyOTk5MjsmIzEyMzk4OyYjMzAzMzA7JiMyOTk4Mzs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgY3JlZGl0LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0idHJhbnNhY3Rpb24uY3JlZGl0IiBkYXRhLXNvdXJjZS1saW5lPSI1IiBpZD0iZW50MDAwNCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI4NS4xODc1IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMTguNDA5OSIgeD0iMTc5LjgiIHk9Ijg3LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5OC40MDk5IiB4PSIxODkuOCIgeT0iMTEwLjI5MiI+JiMzNjAyNDsmIzI2MDQxOyYjNjUyODg7Q3JlZGl0JiM2NTI4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMTg5LjgiIHk9IjEyNi41ODg5Ij4mIzM2MDM5OyYjMjk5ODc7JiMxMjM5ODsmIzI4MTg3OyYjMjM1Njk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE4OS44IiB5PSIxNDIuODg1NyI+JiMzNjAwMDsmIzIwNjYxOyYjMTIzOTg7JiMyMjY3OTsmIzIxMTUyOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIxODkuOCIgeT0iMTU5LjE4MjYiPiYjMjE0NTQ7JiMzMDQxMDsmIzEyMzk4OyYjMzAzMzA7JiMyOTk4Mzs8L3RleHQ+PC9nPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9IkdNTjYiIGRhdGEtc291cmNlLWxpbmU9IjExIiBpZD0iZW50MDAwNyI+PHBhdGggZD0iTTI2MC44NywyMzIuNDg2OSBMMjYwLjg3LDI4Ny44ODUzIEw0MDcuMTM0OCwyODcuODg1MyBMNDA3LjEzNDgsMjQyLjQ4NjkgTDM5Ny4xMzQ4LDIzMi40ODY5IEwyNjAuODcsMjMyLjQ4NjkiIGZpbGw9IiNGRUZGREQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0zOTcuMTM0OCwyMzIuNDg2OSBMMzk3LjEzNDgsMjQyLjQ4NjkgTDQwNy4xMzQ4LDI0Mi40ODY5IEwzOTcuMTM0OCwyMzIuNDg2OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MS4wMDAxIiB4PSIyNjYuODciIHk9IjI0OS41NTM4Ij4mIzM2MDI0OyYjMjA1MTE7JiMxOTk2ODsmIzMzMjY4OyYjMTIzOTg7JiMyMTQwNzsmIzIxMDYzOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMjUuMjY0OCIgeD0iMjY2Ljg3IiB5PSIyNjQuNjg2NiI+JiMyMDUxMTsmIzI2MDQxOyYjMjE1MTI7JiMzNTMzNjsgJiM2NTMwOTsgJiMzNjAyNDsmIzI2MDQxOyYjMjE1MTI7JiMzNTMzNjs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzguMDAwMSIgeD0iMjY2Ljg3IiB5PSIyNzkuODE5NCI+JiMyNDUxNzsmIzEyMzc4OyYjMTk5Njg7JiMzMzI2ODsmIzEyMzc3OyYjMTI0Mjc7PC90ZXh0PjwvZz48IS0tbGluayBkZWJpdCB0byBjcmVkaXQtLT48IS0tbGluayB0cmFuc2FjdGlvbiB0byBHTU42LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDIiIGRhdGEtZW50aXR5LTI9ImVudDAwMDciIGRhdGEtbGluay10eXBlPSJhc3NvY2lhdGlvbiIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGlkPSJsbms4Ij48cGF0aCBkPSJNMzM0LDE5Ni41MTE4IEMzMzQsMTk2LjY4NDIgMzM0LDE5Ni44NTY2IDMzNCwxOTcuMDI5IEMzMzQsMTk4LjQwODEgMzM0LDE5OS43ODYgMzM0LDIwMS4xNjAyIEMzMzQsMjEyLjE1MzEgMzM0LDIyMi45MDQ0IDMzNCwyMzIuMTA2OSIgZmlsbD0ibm9uZSIgaWQ9InRyYW5zYWN0aW9uLUdNTjYiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjcsNzsiLz48L2c+PD9wbGFudHVtbC1zcmMgTlAzMUlpRDA0OFJsLW5IQlp1NC1YUnc1VWFZcFFubEdOS1p0OWE5UmFBR0w2ZUxPaEtMSXI0REVLZ2YyZ1dqemMzWlRsVUtMdDJINk13X1ZwN3BfcDBYTmQ1MmlkdHNHZUxnaVROQU56THpXN0NGR0h5WVpaaDFQc3BHcTg5bzBsNmJXa3VrNVB4RWt4R1lOQ3Rvc3F6RUJEdkRMQmVEenNkOTVCZVU3SkJfd0FkZWdiOC10QzllUmk5cDN1RHMwSkpnM25OSzFGYk1LNkEyYzdvZ0FvbUhJcDYtUnpKQWpwN2lVOVZfTFZ3T1ZUUHE1dUxaREhoamdmbklXU3VKQTREbXl3Qlk0SzdSYWtVc0VRRFBybkJZV2tDTTV1QVVPN3NfVloycEJoNkRrX0tmeHNkX3hWUFRiZVVlMVMxTmU5QzJ2VkMzTHRYTDBpQng4LWxWcnIzR1JOMkJBMjJ3SWxXNDA/PjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h4 id="_2">仕訳の具体例<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h4>
<p>商品を現金で販売した場合の仕訳：</p>
<table>
<thead>
<tr>
<th>借方（Debit）</th>
<th>貸方（Credit）</th>
</tr>
</thead>
<tbody>
<tr>
<td>現金 100,000円</td>
<td>売上 100,000円</td>
</tr>
</tbody>
</table>
<p>売掛金を現金と受取手形で回収した場合の仕訳（複合仕訳）：</p>
<table>
<thead>
<tr>
<th>借方（Debit）</th>
<th>貸方（Credit）</th>
</tr>
</thead>
<tbody>
<tr>
<td>現金 80,000円</td>
<td>売掛金 100,000円</td>
</tr>
<tr>
<td>受取手形 20,000円</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="_3">仕訳処理の流れ<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkFDVElWSVRZIiBoZWlnaHQ9IjYwM3B4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MzgwcHg7aGVpZ2h0OjYwM3B4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM4MCA2MDMiIHdpZHRoPSIzODBweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjAxODE7JiMzNTM3OTsmIzEyMzk4OyYjMjc5Njk7JiMxMjQyODs8L3RpdGxlPjxkZWZzLz48Zz48ZyBjbGFzcz0idGl0bGUiIGRhdGEtc291cmNlLWxpbmU9IjEiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIxNTMuNTM1NyIgeT0iMzIuOTk1MSI+JiMyMDE4MTsmIzM1Mzc5OyYjMTIzOTg7JiMyNzk2OTsmIzEyNDI4OzwvdGV4dD48L2c+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSIyMC45NTMxIiBzdHlsZT0ic3Ryb2tlOm5vbmU7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMzQ3LjA3MTEiIHg9IjE1IiB5PSI1MC4wNDIiLz48ZWxsaXBzZSBjeD0iNjcuMDAwMyIgY3k9Ijg1Ljk5NTEiIGZpbGw9IiMyMjIyMjIiIHJ4PSIxMCIgcnk9IjEwIiBzdHlsZT0ic3Ryb2tlOiMyMjIyMjI7c3Ryb2tlLXdpZHRoOjE7Ii8+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMy45Njg4IiByeD0iMTIuNSIgcnk9IjEyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjkyLjAwMDUiIHg9IjIxIiB5PSIxMTUuOTk1MSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcyLjAwMDUiIHg9IjMxIiB5PSIxMzcuMTMzOCI+JiMyMjc3MDsmIzE5OTc4OyYjMjE0NjI7JiMyNDM0MTsmIzMwMzMwOyYjMjk5ODM7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI5Mi4wMDA1IiB4PSIyMSIgeT0iMTY5Ljk2MzkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3Mi4wMDA1IiB4PSIzMSIgeT0iMTkxLjEwMjUiPiYjMjI3NzA7JiMxOTk3ODsmIzIwMjUzOyYjMzEwODA7JiMyMDMxNjsmIzI1MTA0OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIxNSIgeDI9IjE1IiB5MT0iNTAuMDQyIiB5Mj0iNTkxLjc3NjQiLz48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjguMDAwNCIgeD0iMjAyLjYwNTIiIHk9IjIyMy45MzI2Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iMjEyLjYwNTIiIHk9IjI0NS4wNzEzIj4mIzIwMTgxOyYjMzUzNzk7JiMyMDgzNzsmIzIxMTQ3OzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTQwLjAwMDkiIHg9IjE2Ni42MDQ5IiB5PSIyNzcuOTAxNCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEyIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyMC4wMDA5IiB4PSIxNzYuNjA0OSIgeT0iMjk5LjA0Ij4mIzM2MDI0OyYjMjA1MTE7JiMxMjQ5NjsmIzEyNTIxOyYjMTI1MzE7JiMxMjQ3MzsmIzEyNDgxOyYjMTI0NTU7JiMxMjQ4MzsmIzEyNDYzOzwvdGV4dD48cG9seWdvbiBmaWxsPSIjRjFGMUYxIiBwb2ludHM9IjE3OS4wMDA3LDMzMS44NzAxLDI5NC4yMSwzMzEuODcwMSwzMDYuMjEsMzQzLjg3MDEsMjk0LjIxLDM1NS44NzAxLDE3OS4wMDA3LDM1NS44NzAxLDE2Ny4wMDA3LDM0My44NzAxLDE3OS4wMDA3LDMzMS44NzAxIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMSIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTUuMjA5MyIgeD0iMTc5LjAwMDciIHk9IjM0Ny42NzgyIj4mIzIwNTExOyYjMjYwNDE7JiMyMTUxMjsmIzM1MzM2OyA9ICYjMzYwMjQ7JiMyNjA0MTsmIzIxNTEyOyYjMzUzMzY7JiM2NTMxMTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTEiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjEuOTk5OCIgeD0iMTQ1LjAwMDkiIHk9IjM0MS4yNzU5Ij4mIzEyMzk5OyYjMTIzNTY7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjExIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjMyLjk5OTgiIHg9IjMwNi4yMSIgeT0iMzQxLjI3NTkiPiYjMTIzNTY7JiMxMjM1NjsmIzEyMzYwOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjguMDAwNCIgeD0iMTIzLjAwMDUiIHk9IjM2NS44NzAxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iMTMzLjAwMDUiIHk9IjM4Ny4wMDg4Ij4mIzIwMTgxOyYjMzUzNzk7JiMzMDMzMTsmIzM3NjgyOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iNjguMDAwNCIgeD0iMTIzLjAwMDUiIHk9IjQxOS44Mzg5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDguMDAwNCIgeD0iMTMzLjAwMDUiIHk9IjQ0MC45Nzc1Ij4mIzI3NTMxOyYjMzk2NDA7JiMyNjM1NjsmIzI2MDMyOzwvdGV4dD48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjMzLjk2ODgiIHJ4PSIxMi41IiByeT0iMTIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iODAuMDAwNSIgeD0iMjc2LjIwOTgiIHk9IjM2NS44NzAxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTIiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjAuMDAwNSIgeD0iMjg2LjIwOTgiIHk9IjM4Ny4wMDg4Ij4mIzEyNDU2OyYjMTI1MjE7JiMxMjU0MDsmIzM0OTIwOyYjMzEwMzQ7PC90ZXh0PjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI2OC4wMDA0IiB4PSIyODIuMjA5OCIgeT0iNDE5LjgzODkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OC4wMDA0IiB4PSIyOTIuMjA5OCIgeT0iNDQwLjk3NzUiPiYjMjA0NjI7JiMyNzQ5MTsmIzIwODM3OyYjMjExNDc7PC90ZXh0PjxlbGxpcHNlIGN4PSIzMTYuMjEiIGN5PSI0ODQuODA3NiIgZmlsbD0ibm9uZSIgcng9IjExIiByeT0iMTEiIHN0eWxlPSJzdHJva2U6IzIyMjIyMjtzdHJva2Utd2lkdGg6MTsiLz48ZWxsaXBzZSBjeD0iMzE2LjIxIiBjeT0iNDg0LjgwNzYiIGZpbGw9IiMyMjIyMjIiIHJ4PSI2IiByeT0iNiIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzMuOTY4OCIgcng9IjEyLjUiIHJ5PSIxMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSI2OC4wMDA0IiB4PSIyMDIuNjA1MiIgeT0iNTE1LjgwNzYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMiIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0OC4wMDA0IiB4PSIyMTIuNjA1MiIgeT0iNTM2Ljk0NjMiPiYjMjAxODE7JiMzNTM3OTsmIzIzNDM2OyYjMjAxMDI7PC90ZXh0PjxlbGxpcHNlIGN4PSIyMzYuNjA1NCIgY3k9IjU4MC43NzY0IiBmaWxsPSJub25lIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMjIyMjIyO3N0cm9rZS13aWR0aDoxOyIvPjxlbGxpcHNlIGN4PSIyMzYuNjA1NCIgY3k9IjU4MC43NzY0IiBmaWxsPSIjMjIyMjIyIiByeD0iNiIgcnk9IjYiIHN0eWxlPSJzdHJva2U6IzIyMjIyMjtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIxMTcuMDAwNSIgeDI9IjExNy4wMDA1IiB5MT0iNTAuMDQyIiB5Mj0iNTkxLjc3NjQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSIzNjAuMjEwMiIgeDI9IjM2MC4yMTAyIiB5MT0iNTAuMDQyIiB5Mj0iNTkxLjc3NjQiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjcuMDAwMyIgeDI9IjY3LjAwMDMiIHkxPSI5NS45OTUxIiB5Mj0iMTE1Ljk5NTEiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjYzLjAwMDMsMTA1Ljk5NTEsNjcuMDAwMywxMTUuOTk1MSw3MS4wMDAzLDEwNS45OTUxLDY3LjAwMDMsMTA5Ljk5NTEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjcuMDAwMyIgeDI9IjY3LjAwMDMiIHkxPSIxNDkuOTYzOSIgeTI9IjE2OS45NjM5Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI2My4wMDAzLDE1OS45NjM5LDY3LjAwMDMsMTY5Ljk2MzksNzEuMDAwMywxNTkuOTYzOSw2Ny4wMDAzLDE2My45NjM5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIzNi42MDU0IiB4Mj0iMjM2LjYwNTQiIHkxPSIyNTcuOTAxNCIgeTI9IjI3Ny45MDE0Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMzIuNjA1NCwyNjcuOTAxNCwyMzYuNjA1NCwyNzcuOTAxNCwyNDAuNjA1NCwyNjcuOTAxNCwyMzYuNjA1NCwyNzEuOTAxNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTcuMDAwNyIgeDI9IjE1Ny4wMDA3IiB5MT0iMzk5LjgzODkiIHkyPSI0MTkuODM4OSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTUzLjAwMDcsNDA5LjgzODksMTU3LjAwMDcsNDE5LjgzODksMTYxLjAwMDcsNDA5LjgzODksMTU3LjAwMDcsNDEzLjgzODkiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzE2LjIxIiB4Mj0iMzE2LjIxIiB5MT0iMzk5LjgzODkiIHkyPSI0MTkuODM4OSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzEyLjIxLDQwOS44Mzg5LDMxNi4yMSw0MTkuODM4OSwzMjAuMjEsNDA5LjgzODksMzE2LjIxLDQxMy44Mzg5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjMxNi4yMSIgeDI9IjMxNi4yMSIgeTE9IjQ1My44MDc2IiB5Mj0iNDczLjgwNzYiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjMxMi4yMSw0NjMuODA3NiwzMTYuMjEsNDczLjgwNzYsMzIwLjIxLDQ2My44MDc2LDMxNi4yMSw0NjcuODA3NiIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNjcuMDAwNyIgeDI9IjE1Ny4wMDA3IiB5MT0iMzQzLjg3MDEiIHkyPSIzNDMuODcwMSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTcuMDAwNyIgeDI9IjE1Ny4wMDA3IiB5MT0iMzQzLjg3MDEiIHkyPSIzNjUuODcwMSIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTUzLjAwMDcsMzU1Ljg3MDEsMTU3LjAwMDcsMzY1Ljg3MDEsMTYxLjAwMDcsMzU1Ljg3MDEsMTU3LjAwMDcsMzU5Ljg3MDEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMzA2LjIxIiB4Mj0iMzE2LjIxIiB5MT0iMzQzLjg3MDEiIHkyPSIzNDMuODcwMSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIzMTYuMjEiIHgyPSIzMTYuMjEiIHkxPSIzNDMuODcwMSIgeTI9IjM2NS44NzAxIi8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzMTIuMjEsMzU1Ljg3MDEsMzE2LjIxLDM2NS44NzAxLDMyMC4yMSwzNTUuODcwMSwzMTYuMjEsMzU5Ljg3MDEiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU3LjAwMDciIHgyPSIxNTcuMDAwNyIgeTE9IjQ1My44MDc2IiB5Mj0iNTAwLjgwNzYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU3LjAwMDciIHgyPSIyMzYuNjA1NCIgeTE9IjUwMC44MDc2IiB5Mj0iNTAwLjgwNzYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjM2LjYwNTQiIHgyPSIyMzYuNjA1NCIgeTE9IjUwMC44MDc2IiB5Mj0iNTE1LjgwNzYiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjIzMi42MDU0LDUwNS44MDc2LDIzNi42MDU0LDUxNS44MDc2LDI0MC42MDU0LDUwNS44MDc2LDIzNi42MDU0LDUwOS44MDc2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIzNi42MDU0IiB4Mj0iMjM2LjYwNTQiIHkxPSIzMTEuODcwMSIgeTI9IjMzMS44NzAxIi8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIyMzIuNjA1NCwzMjEuODcwMSwyMzYuNjA1NCwzMzEuODcwMSwyNDAuNjA1NCwzMjEuODcwMSwyMzYuNjA1NCwzMjUuODcwMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyMzYuNjA1NCIgeDI9IjIzNi42MDU0IiB5MT0iNTQ5Ljc3NjQiIHkyPSI1NjkuNzc2NCIvPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMjMyLjYwNTQsNTU5Ljc3NjQsMjM2LjYwNTQsNTY5Ljc3NjQsMjQwLjYwNTQsNTU5Ljc3NjQsMjM2LjYwNTQsNTYzLjc3NjQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNjcuMDAwMyIgeDI9IjY3LjAwMDMiIHkxPSIyMDMuOTMyNiIgeTI9IjIwOC45MzI2Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjY3LjAwMDMiIHgyPSIyMzYuNjA1NCIgeTE9IjIwOC45MzI2IiB5Mj0iMjA4LjkzMjYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjM2LjYwNTQiIHgyPSIyMzYuNjA1NCIgeTE9IjIwOC45MzI2IiB5Mj0iMjIzLjkzMjYiLz48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjIzMi42MDU0LDIxMy45MzI2LDIzNi42MDU0LDIyMy45MzI2LDI0MC42MDU0LDIxMy45MzI2LDIzNi42MDU0LDIxNy45MzI2IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTgiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzEuOTk5NiIgeD0iMzAuMDAwNSIgeT0iNjYuNzUiPiYjMjE5NDI7JiMyNjk4OTsmIzM3MDk2OyYjMzgyNzI7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE4IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjcxLjk5OTYiIHg9IjIwMi42MDU2IiB5PSI2Ni43NSI+JiMzMjA3NjsmIzI5NzAyOyYjMzcwOTY7JiMzODI3Mjs8L3RleHQ+PD9wbGFudHVtbC1zcmMgRk94RFFpOTA1NFJ0eW5JcHI1U216NjY0SFhlR0F5cWlOUFlDYk0wM3BROEU1TGoyaVE1SlloNzRNWkg2LVoxdFZmOUxOdzVKOVNCVHQ3a19tX2M4R3hlczVsamZvVFZXZk1oWldIeVlEOTNpTW9OQllsQUEzR1Y4OVVxUldiZm9hT2RqSER1cE1LcHJCRFNGaUxLVkhWNmk0b3VFSm9nOEJDRmhKUVlaU1NzdEpXOXZjeVo5dDMxYmpmTjM2Nlc0ejF0ZTZsbVRLMkQtMHFoMU5uZFV3VTI2SUlZc2FyNUd5VzFWT0NFU3J6eVlSYzlvUFZUbTB4bUxVQURjaFQycFZITGNIZzdJay1oWktTc181RmtxYURycnhWX2l3M1kxWU9GRlpfQVlWRTd3REpVNC00ZExTYjV0VENicjd6Y3pJd1UzcGxOSktFSlpxLWlGPz48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_4">仕訳テーブルの項目設計<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>仕訳伝票番号</strong></td>
<td>仕訳を一意に識別するキー</td>
</tr>
<tr>
<td><strong>起票日</strong></td>
<td>会計上の取引発生日</td>
</tr>
<tr>
<td><strong>入力日</strong></td>
<td>システムへの登録日</td>
</tr>
<tr>
<td><strong>決算仕訳フラグ</strong></td>
<td>決算整理仕訳かどうか（0:通常、1:決算）</td>
</tr>
<tr>
<td><strong>単振フラグ</strong></td>
<td>単一仕訳か複合仕訳か（0:複合、1:単一）</td>
</tr>
<tr>
<td><strong>仕訳伝票区分</strong></td>
<td>仕訳の種類（通常/決算/自動/振替）</td>
</tr>
<tr>
<td><strong>定期計上フラグ</strong></td>
<td>定期的な計上か否か</td>
</tr>
<tr>
<td><strong>社員コード</strong></td>
<td>起票担当者</td>
</tr>
<tr>
<td><strong>部門コード</strong></td>
<td>所属部門</td>
</tr>
<tr>
<td><strong>赤伝フラグ</strong></td>
<td>赤伝（取消）かどうか（0:黒伝、1:赤伝）</td>
</tr>
<tr>
<td><strong>赤黒伝票番号</strong></td>
<td>関連する赤黒伝票の番号</td>
</tr>
</tbody>
</table>
<h3 id="er">仕訳テーブルのER図<a class="headerlink" href="#er" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9Ijk4MHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6NTU5cHg7aGVpZ2h0Ojk4MHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDU1OSA5ODAiIHdpZHRoPSI1NTlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PGRlZnMvPjxnPjwhLS1jbGFzcyBKb3VybmFsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iSm91cm5hbCIgZGF0YS1zb3VyY2UtbGluZT0iMSIgaWQ9ImVudDAwMDIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjU5Ljg1OTQiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjI1NS41OTgzIiB4PSIyNi40MSIgeT0iNyIvPjxlbGxpcHNlIGN4PSIxMzUuOTU5MiIgY3k9IjIzIiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0xNDAuMDY4NiwyOSBMMTMyLjM0OTgsMjkgTDEzMi4zNDk4LDE2LjYwOTQgTDE0MC4wNjg2LDE2LjYwOTQgTDE0MC4wNjg2LDE4Ljc2NTYgTDEzNC44MDI5LDE4Ljc2NTYgTDEzNC44MDI5LDIxLjQzNzUgTDEzOS41Njg2LDIxLjQzNzUgTDEzOS41Njg2LDIzLjU5MzggTDEzNC44MDI5LDIzLjU5MzggTDEzNC44MDI5LDI2Ljg0MzggTDE0MC4wNjg2LDI2Ljg0MzggTDE0MC4wNjg2LDI5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjcuOTk5OSIgeD0iMTU2LjQ1OTIiIHk9IjI3Ljg0NjciPiYjMjAxODE7JiMzNTM3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMjcuNDEiIHgyPSIyODEuMDA4MyIgeTE9IjM5IiB5Mj0iMzkiLz48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjM3LjQxIiBjeT0iNTIuNjQ4NCIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSI0Ni40MSIgeT0iNTUuOTk1MSI+JiMyMDE4MTsmIzM1Mzc5OyYjMjAyNTM7JiMzMTA4MDsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0NS41OTg2IiB4PSIxMzAuNDA5NiIgeT0iNTUuOTk1MSI+OiBWQVJDSEFSKDEwKSAmIzE3MTtQSyYjMTg3OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjcuNDEiIHgyPSIyODEuMDA4MyIgeTE9IjYzLjI5NjkiIHkyPSI2My4yOTY5Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIzNy40MSIgY3k9Ijc2Ljk0NTMiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iNDYuNDEiIHk9IjgwLjI5MiI+JiMzNjIxNTsmIzMxMDgwOyYjMjYwODU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQ2LjkyMTkiIHg9Ijg4LjQwOTgiIHk9IjgwLjI5MiI+OiBEQVRFPC90ZXh0PjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMzcuNDEiIGN5PSI5My4yNDIyIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjQxLjk5OTgiIHg9IjQ2LjQxIiB5PSI5Ni41ODg5Ij4mIzIwODM3OyYjMjExNDc7JiMyNjA4NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDYuOTIxOSIgeD0iODguNDA5OCIgeT0iOTYuNTg4OSI+OiBEQVRFPC90ZXh0PjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMzcuNDEiIGN5PSIxMDkuNTM5MSIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSI0Ni40MSIgeT0iMTEyLjg4NTciPiYjMjc3NzA7JiMzMTYzOTsmIzIwMTgxOyYjMzUzNzk7JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjQ2MjkiIHg9IjE0NC40MDk2IiB5PSIxMTIuODg1NyI+OiBTTUFMTElOVDwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjM3LjQxIiBjeT0iMTI1LjgzNTkiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDYuNDEiIHk9IjEyOS4xODI2Ij4mIzIxMzM2OyYjMjUzOTE7JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjQ2MjkiIHg9IjExNi40MDk3IiB5PSIxMjkuMTgyNiI+OiBTTUFMTElOVDwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjM3LjQxIiBjeT0iMTQyLjEzMjgiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iNDYuNDEiIHk9IjE0NS40Nzk1Ij4mIzIwMTgxOyYjMzUzNzk7JiMyMDI1MzsmIzMxMDgwOyYjMjEzMDY7JiMyMDk5ODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTMuMTY2NiIgeD0iMTMwLjQwOTYiIHk9IjE0NS40Nzk1Ij46ICYjMjAxODE7JiMzNTM3OTsmIzIwMjUzOyYjMzEwODA7JiMyMTMwNjsmIzIwOTk4OzwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjM3LjQxIiBjeT0iMTU4LjQyOTciIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iNDYuNDEiIHk9IjE2MS43NzY0Ij4mIzIzNDUwOyYjMjYzOTk7JiMzNTMzNjsmIzE5OTc4OyYjMTI1MDE7JiMxMjUyMTsmIzEyNDY0OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC40NjI5IiB4PSIxNDQuNDA5NiIgeT0iMTYxLjc3NjQiPjogU01BTExJTlQ8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjQ2LjQxIiB5PSIxNzguMDczMiI+JiMzMTAzODsmIzIxNzI5OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDUuMjA5IiB4PSIxMTYuNDA5NyIgeT0iMTc4LjA3MzIiPjogVkFSQ0hBUigxMCkgJiMxNzE7RksmIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjQ2LjQxIiB5PSIxOTQuMzcwMSI+JiMzNzA5NjsmIzM4MjcyOyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzYuMzAxOCIgeD0iMTE2LjQwOTciIHk9IjE5NC4zNzAxIj46IFZBUkNIQVIoNSkgJiMxNzE7RksmIzE4Nzs8L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIzNy40MSIgY3k9IjIwNy4zMjAzIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjQ2LjQxIiB5PSIyMTAuNjY3Ij4mIzM2MTk2OyYjMjAyNTM7JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjQ2MjkiIHg9IjExNi40MDk3IiB5PSIyMTAuNjY3Ij46IFNNQUxMSU5UPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSI0Ni40MSIgeT0iMjI2Ljk2MzkiPiYjMzYxOTY7JiM0MDY1ODsmIzIwMjUzOyYjMzEwODA7JiMzMDA1ODsmIzIxNDk1OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MC41ODc5IiB4PSIxMzAuNDA5NiIgeT0iMjI2Ljk2MzkiPjogSU5URUdFUjwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjM3LjQxIiBjeT0iMjM5LjkxNDEiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iNDYuNDEiIHk9IjI0My4yNjA3Ij4mIzIwMzE2OyYjMjUxMDQ7JiMyNjA4NTsmIzI2MTc4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MC4zMDk2IiB4PSIxMDIuNDA5OCIgeT0iMjQzLjI2MDciPjogVElNRVNUQU1QPC90ZXh0PjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMzcuNDEiIGN5PSIyNTYuMjEwOSIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSI0Ni40MSIgeT0iMjU5LjU1NzYiPiYjMjYzNTY7JiMyNjAzMjsmIzI2MDg1OyYjMjYxNzg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjkwLjMwOTYiIHg9IjEwMi40MDk4IiB5PSIyNTkuNTU3NiI+OiBUSU1FU1RBTVA8L3RleHQ+PC9nPjwhLS1jbGFzcyBKb3VybmFsRGV0YWlsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iSm91cm5hbERldGFpbCIgZGF0YS1zb3VyY2UtbGluZT0iMTgiIGlkPSJlbnQwMDAzIj48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjEyOS40ODQ0IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIyOTQuNDEyNyIgeD0iNyIgeT0iMzQzLjg2Ii8+PGVsbGlwc2UgY3g9IjEyMS45NTY1IiBjeT0iMzU5Ljg2IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0xMjYuMDY1OSwzNjUuODYgTDExOC4zNDcxLDM2NS44NiBMMTE4LjM0NzEsMzUzLjQ2OTQgTDEyNi4wNjU5LDM1My40Njk0IEwxMjYuMDY1OSwzNTUuNjI1NiBMMTIwLjgwMDIsMzU1LjYyNTYgTDEyMC44MDAyLDM1OC4yOTc1IEwxMjUuNTY1OSwzNTguMjk3NSBMMTI1LjU2NTksMzYwLjQ1MzggTDEyMC44MDAyLDM2MC40NTM4IEwxMjAuODAwMiwzNjMuNzAzOCBMMTI2LjA2NTksMzYzLjcwMzggTDEyNi4wNjU5LDM2NS44NiBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjE0Mi40NTY1IiB5PSIzNjQuNzA2NyI+JiMyMDE4MTsmIzM1Mzc5OyYjMjYxMjY7JiMzMjA0ODs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjMwMC40MTI3IiB5MT0iMzc1Ljg2IiB5Mj0iMzc1Ljg2Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjM4OS41MDg0IiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjI3IiB5PSIzOTIuODU1MSI+JiMyMDE4MTsmIzM1Mzc5OyYjMjAyNTM7JiMzMTA4MDsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4NC40MTMxIiB4PSIxMTAuOTk5NiIgeT0iMzkyLjg1NTEiPjogVkFSQ0hBUigxMCkgJiMxNzE7UEsmIzE4NzsgJiMxNzE7RksmIzE4Nzs8L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjQwNS44MDUzIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjI3IiB5PSI0MDkuMTUyIj4mIzIwMTgxOyYjMzUzNzk7JiMzNDg5MjsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy42NjciIHg9Ijk2Ljk5OTciIHk9IjQwOS4xNTIiPjogU01BTExJTlQgJiMxNzE7UEsmIzE4Nzs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjgiIHgyPSIzMDAuNDEyNyIgeTE9IjQxNi40NTM4IiB5Mj0iNDE2LjQ1MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iMjciIHk9IjQzMy40NDg5Ij4mIzM0ODkyOyYjMjU2ODg7JiMzNTIwMTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI0LjIwOSIgeD0iNjguOTk5OCIgeT0iNDMzLjQ0ODkiPjogVkFSQ0hBUigxMDAwKTwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjE4IiBjeT0iNDQ2LjM5OTEiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iMjciIHk9IjQ0OS43NDU3Ij4mIzIwMzE2OyYjMjUxMDQ7JiMyNjA4NTsmIzI2MTc4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MC4zMDk2IiB4PSI4Mi45OTk4IiB5PSI0NDkuNzQ1NyI+OiBUSU1FU1RBTVA8L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjQ2Mi42OTU5IiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjI3IiB5PSI0NjYuMDQyNiI+JiMyNjM1NjsmIzI2MDMyOyYjMjYwODU7JiMyNjE3ODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTAuMzA5NiIgeD0iODIuOTk5OCIgeT0iNDY2LjA0MjYiPjogVElNRVNUQU1QPC90ZXh0PjwvZz48IS0tY2xhc3MgSm91cm5hbERlYml0Q3JlZGl0RGV0YWlsLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iSm91cm5hbERlYml0Q3JlZGl0RGV0YWlsIiBkYXRhLXNvdXJjZS1saW5lPSIyNyIgaWQ9ImVudDAwMDQiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iNDIyLjgyODEiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjI5NC40MTI3IiB4PSI3IiB5PSI1NTAuMzQiLz48ZWxsaXBzZSBjeD0iMTA3Ljk1NjUiIGN5PSI1NjYuMzQiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTExMi4wNjU5LDU3Mi4zNCBMMTA0LjM0NzIsNTcyLjM0IEwxMDQuMzQ3Miw1NTkuOTQ5NCBMMTEyLjA2NTksNTU5Ljk0OTQgTDExMi4wNjU5LDU2Mi4xMDU2IEwxMDYuODAwMyw1NjIuMTA1NiBMMTA2LjgwMDMsNTY0Ljc3NzUgTDExMS41NjU5LDU2NC43Nzc1IEwxMTEuNTY1OSw1NjYuOTMzOCBMMTA2LjgwMDMsNTY2LjkzMzggTDEwNi44MDAzLDU3MC4xODM4IEwxMTIuMDY1OSw1NzAuMTgzOCBMMTEyLjA2NTksNTcyLjM0IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMTI4LjQ1NjUiIHk9IjU3MS4xODY3Ij4mIzIwMTgxOyYjMzUzNzk7JiMzNjAyNDsmIzIwNTExOyYjMjYxMjY7JiMzMjA0ODs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjMwMC40MTI3IiB5MT0iNTgyLjM0IiB5Mj0iNTgyLjM0Ii8+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjU5NS45ODg0IiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjgzLjk5OTYiIHg9IjI3IiB5PSI1OTkuMzM1MSI+JiMyMDE4MTsmIzM1Mzc5OyYjMjAyNTM7JiMzMTA4MDsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4NC40MTMxIiB4PSIxMTAuOTk5NiIgeT0iNTk5LjMzNTEiPjogVkFSQ0hBUigxMCkgJiMxNzE7UEsmIzE4NzsgJiMxNzE7RksmIzE4Nzs8L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjYxMi4yODUzIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjI3IiB5PSI2MTUuNjMyIj4mIzIwMTgxOyYjMzUzNzk7JiMzNDg5MjsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNy42NjciIHg9Ijk2Ljk5OTciIHk9IjYxNS42MzIiPjogU01BTExJTlQgJiMxNzE7UEsmIzE4Nzs8L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9IjYyOC41ODIyIiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjI3IiB5PSI2MzEuOTI4OSI+JiMyMDE4MTsmIzM1Mzc5OyYjMzQ4OTI7JiMzNjAyNDsmIzIwNTExOyYjMjEzMDY7JiMyMDk5ODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ2LjM3MDciIHg9IjEyNC45OTk2IiB5PSI2MzEuOTI4OSI+OiAmIzIwMTgxOyYjMzUzNzk7JiMzNDg5MjsmIzM2MDI0OyYjMjA1MTE7JiMyMTMwNjsmIzIwOTk4OyAmIzE3MTtQSyYjMTg3OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iOCIgeDI9IjMwMC40MTI3IiB5MT0iNjM5LjIzMDYiIHkyPSI2MzkuMjMwNiIvPjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMTgiIGN5PSI2NTIuODc5MSIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSIyNyIgeT0iNjU2LjIyNTciPiYjMjEyMDg7JiMyMzQ1MDsmIzMxMTg1OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzNi4zMDE4IiB4PSIxMjQuOTk5NiIgeT0iNjU2LjIyNTciPjogVkFSQ0hBUig1KSAmIzE3MTtGSyYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iMjciIHk9IjY3Mi41MjI2Ij4mIzM1MDM2OyYjMjExNjE7JiMzMTE4NTsmIzMwNDQ2OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuMzk0NSIgeD0iMTI0Ljk5OTYiIHk9IjY3Mi41MjI2Ij46IFZBUkNIQVIoMTApPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIyNyIgeT0iNjg4LjgxOTUiPiYjMzcwOTY7JiMzODI3MjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM2LjMwMTgiIHg9Ijk2Ljk5OTciIHk9IjY4OC44MTk1Ij46IFZBUkNIQVIoNSkgJiMxNzE7RksmIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNS45OTk1IiB4PSIyNyIgeT0iNzA1LjExNjQiPiYjMTI1MDM7JiMxMjUyNTsmIzEyNDcyOyYjMTI0NTU7JiMxMjQ2MzsmIzEyNDg4OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDYuMzk0NSIgeD0iMTUyLjk5OTUiIHk9IjcwNS4xMTY0Ij46IFZBUkNIQVIoMTApPC90ZXh0PjxnIGRhdGEtdmlzaWJpbGl0eS1tb2RpZmllcj0iSUVfTUFOREFUT1JZIj48ZWxsaXBzZSBjeD0iMTgiIGN5PSI3MTguMDY2NiIgZmlsbD0iIzAwMDAwMCIgcng9IjMiIHJ5PSIzIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7Ii8+PC9nPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIyNyIgeT0iNzIxLjQxMzIiPiYjMjAxODE7JiMzNTM3OTsmIzM3MzI5OyYjMzg5ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExNC4yNDkiIHg9IjgyLjk5OTgiIHk9IjcyMS40MTMyIj46IERFQ0lNQUwoMTQsMik8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjI3IiB5PSI3MzcuNzEwMSI+JiMzNjg5MDsmIzM2MDA4OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny40ODczIiB4PSI5Ni45OTk3IiB5PSI3MzcuNzEwMSI+OiBWQVJDSEFSKDMpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2OS45OTk3IiB4PSIyNyIgeT0iNzU0LjAwNyI+JiMyODg1ODsmIzI2MzY3OyYjMTI1MjQ7JiMxMjU0MDsmIzEyNDg4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMDUuMzQxOCIgeD0iOTYuOTk5NyIgeT0iNzU0LjAwNyI+OiBERUNJTUFMKDgsMik8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS45OTk1IiB4PSIyNyIgeT0iNzcwLjMwMzkiPiYjMjI1MjI7JiMzNjYwMDsmIzI1NTYzOyYjMzE2Mzk7JiMyMDE4MTsmIzM1Mzc5OyYjMzczMjk7JiMzODk4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTE0LjI0OSIgeD0iMTM4Ljk5OTUiIHk9Ijc3MC4zMDM5Ij46IERFQ0lNQUwoMTQsMik8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjI3IiB5PSI3ODYuNjAwNyI+JiMyODA0MDsmIzM2MDI3OyYjMzEyNDY7JiMyMTMwNjsmIzIwOTk4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OS4xNjY3IiB4PSI5Ni45OTk3IiB5PSI3ODYuNjAwNyI+OiAmIzI4MDQwOyYjMzYwMjc7JiMzMTI0NjsmIzIxMzA2OyYjMjA5OTg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIyNyIgeT0iODAyLjg5NzYiPiYjMjgwNDA7JiMzNjAyNzsmIzMxMjQ2OyYjMjk1NzU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijc4LjQ2MjkiIHg9IjgyLjk5OTgiIHk9IjgwMi44OTc2Ij46IFNNQUxMSU5UPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSIyNyIgeT0iODE5LjE5NDUiPiYjMjgwNDA7JiMzNjAyNzsmIzMxMjQ2OyYjMzUzMzY7JiMzMTYzOTsmIzIxMzA2OyYjMjA5OTg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNy4xNjY2IiB4PSIxMjQuOTk5NiIgeT0iODE5LjE5NDUiPjogJiMyODA0MDsmIzM2MDI3OyYjMzEyNDY7JiMzNTMzNjsmIzMxNjM5OyYjMjEzMDY7JiMyMDk5ODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI3Ljk5OTkiIHg9IjI3IiB5PSI4MzUuNDkxNCI+JiMyNjM5OTsmIzI2MDg1OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0Ni45MjE5IiB4PSI1NC45OTk5IiB5PSI4MzUuNDkxNCI+OiBEQVRFPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI4My45OTk2IiB4PSIyNyIgeT0iODUxLjc4ODIiPiYjMzYwMzk7JiMzNzMyOTsmIzMyMzY4OyYjMTI1MDE7JiMxMjUyMTsmIzEyNDY0OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC40NjI5IiB4PSIxMTAuOTk5NiIgeT0iODUxLjc4ODIiPjogU01BTExJTlQ8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS45OTk1IiB4PSIyNyIgeT0iODY4LjA4NTEiPiYjMTI0NzU7JiMxMjQ2NDsmIzEyNTEzOyYjMTI1MzE7JiMxMjQ4ODsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA2LjM5NDUiIHg9IjEzOC45OTk1IiB5PSI4NjguMDg1MSI+OiBWQVJDSEFSKDEwKTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI1Ljk5OTUiIHg9IjI3IiB5PSI4ODQuMzgyIj4mIzMwNDU2OyYjMjUxNjM7JiMyMTIwODsmIzIzNDUwOyYjMzExODU7JiMzMDQ0NjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuNDg3MyIgeD0iMTUyLjk5OTUiIHk9Ijg4NC4zODIiPjogVkFSQ0hBUig1KTwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI1Ljk5OTUiIHg9IjI3IiB5PSI5MDAuNjc4OSI+JiMzMDQ1NjsmIzI1MTYzOyYjMzUwMzY7JiMyMTE2MTsmIzMxMTg1OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNi4zOTQ1IiB4PSIxNTIuOTk5NSIgeT0iOTAwLjY3ODkiPjogVkFSQ0hBUigxMCk8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjI3IiB5PSI5MTYuOTc1NyI+JiMyMDE4NDsmIzMxNjI3OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny40ODczIiB4PSI5Ni45OTk3IiB5PSI5MTYuOTc1NyI+OiBWQVJDSEFSKDEpPC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIyNyIgeT0iOTMzLjI3MjYiPiYjMjAxODQ7JiMzMTYyNzsmIzIwODY5OyYjMjM0ODE7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwNi4zOTQ1IiB4PSI4Mi45OTk4IiB5PSI5MzMuMjcyNiI+OiBWQVJDSEFSKDYwKTwvdGV4dD48ZyBkYXRhLXZpc2liaWxpdHktbW9kaWZpZXI9IklFX01BTkRBVE9SWSI+PGVsbGlwc2UgY3g9IjE4IiBjeT0iOTQ2LjIyMjgiIGZpbGw9IiMwMDAwMDAiIHJ4PSIzIiByeT0iMyIgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIvPjwvZz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNTUuOTk5OCIgeD0iMjciIHk9Ijk0OS41Njk1Ij4mIzIwMzE2OyYjMjUxMDQ7JiMyNjA4NTsmIzI2MTc4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5MC4zMDk2IiB4PSI4Mi45OTk4IiB5PSI5NDkuNTY5NSI+OiBUSU1FU1RBTVA8L3RleHQ+PGcgZGF0YS12aXNpYmlsaXR5LW1vZGlmaWVyPSJJRV9NQU5EQVRPUlkiPjxlbGxpcHNlIGN4PSIxOCIgY3k9Ijk2Mi41MTk3IiBmaWxsPSIjMDAwMDAwIiByeD0iMyIgcnk9IjMiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiLz48L2c+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjI3IiB5PSI5NjUuODY2NCI+JiMyNjM1NjsmIzI2MDMyOyYjMjYwODU7JiMyNjE3ODs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTAuMzA5NiIgeD0iODIuOTk5OCIgeT0iOTY1Ljg2NjQiPjogVElNRVNUQU1QPC90ZXh0PjwvZz48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSJHTU43IiBkYXRhLXNvdXJjZS1saW5lPSI1OCIgaWQ9ImVudDAwMDgiPjxwYXRoIGQ9Ik0zMTYuNzEsMTE2Ljc5IEwzMTYuNzEsMTMyLjkzIEwyODIuNDMsMTM2LjkzIEwzMTYuNzEsMTQwLjkzIEwzMTYuNzEsMTU3LjA1NTYgQTAsMCAwIDAgMCAzMTYuNzEsMTU3LjA1NTYgTDU0NS43MTAyLDE1Ny4wNTU2IEEwLDAgMCAwIDAgNTQ1LjcxMDIsMTU3LjA1NTYgTDU0NS43MTAyLDEyNi43OSBMNTM1LjcxMDIsMTE2Ljc5IEwzMTYuNzEsMTE2Ljc5IEEwLDAgMCAwIDAgMzE2LjcxLDExNi43OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTUzNS43MTAyLDExNi43OSBMNTM1LjcxMDIsMTI2Ljc5IEw1NDUuNzEwMiwxMjYuNzkgTDUzNS43MTAyLDExNi43OSIgZmlsbD0iI0ZFRkZERCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMwLjAwMDIiIHg9IjMyMi43MSIgeT0iMTMzLjg1NjkiPiYjMjAxODE7JiMzNTM3OTsmIzIwMjUzOyYjMzEwODA7JiMxMjM5ODsmIzEyNTA0OyYjMTI0ODM7JiMxMjQ4MDsmIzI0NzczOyYjMjI1Nzc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjIwOC4wMDAyIiB4PSIzMjIuNzEiIHk9IjE0OC45ODk3Ij4mIzM2MjE1OyYjMzEwODA7JiMyNjA4NTsmIzEyMjg5OyYjMjA4Mzc7JiMyMTE0NzsmIzI2MDg1OyYjMTIyODk7JiMyMTUwODsmIzMxMjc4OyYjMTI1MDE7JiMxMjUyMTsmIzEyNDY0OyYjMTI0MzQ7JiMzMTY0OTsmIzI5NzAyOzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iR01OMTAiIGRhdGEtc291cmNlLWxpbmU9IjYzIiBpZD0iZW50MDAxMSI+PHBhdGggZD0iTTMzNi4wNywzODguNDcgTDMzNi4wNyw0MDQuNiBMMzAxLjgyLDQwOC42IEwzMzYuMDcsNDEyLjYgTDMzNi4wNyw0MjguNzM1NiBBMCwwIDAgMCAwIDMzNi4wNyw0MjguNzM1NiBMNTA4LjM0MTIsNDI4LjczNTYgQTAsMCAwIDAgMCA1MDguMzQxMiw0MjguNzM1NiBMNTA4LjM0MTIsMzk4LjQ3IEw0OTguMzQxMiwzODguNDcgTDMzNi4wNywzODguNDcgQTAsMCAwIDAgMCAzMzYuMDcsMzg4LjQ3IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNDk4LjM0MTIsMzg4LjQ3IEw0OTguMzQxMiwzOTguNDcgTDUwOC4zNDEyLDM5OC40NyBMNDk4LjM0MTIsMzg4LjQ3IiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTcuMDAwMSIgeD0iMzQyLjA3IiB5PSI0MDUuNTM2OSI+JiMyMDE4MTsmIzM1Mzc5OyYjMTIzOTg7JiMzNDg5MjsmIzIxMzM2OyYjMjAzMDE7JiMxMjM5ODsmIzI0NzczOyYjMjI1Nzc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1MS4yNzEyIiB4PSIzNDIuMDciIHk9IjQyMC42Njk3Ij4xJiMxMjM4ODsmIzEyMzk4OyYjMjAxODE7JiMzNTM3OTsmIzEyMzk1OyYjMzUwNzk7JiMyNTk2ODsmIzEyMzk4OyYjMjYxMjY7JiMzMjA0ODsmIzM0ODkyOzwvdGV4dD48L2c+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iR01OMTMiIGRhdGEtc291cmNlLWxpbmU9IjY4IiBpZD0iZW50MDAxNCI+PHBhdGggZD0iTTMzNi4yMSw3NDEuNjIgTDMzNi4yMSw3NTcuNzYgTDMwMS43Niw3NjEuNzYgTDMzNi4yMSw3NjUuNzYgTDMzNi4yMSw3ODEuODg1NiBBMCwwIDAgMCAwIDMzNi4yMSw3ODEuODg1NiBMNTUyLjIxMDIsNzgxLjg4NTYgQTAsMCAwIDAgMCA1NTIuMjEwMiw3ODEuODg1NiBMNTUyLjIxMDIsNzUxLjYyIEw1NDIuMjEwMiw3NDEuNjIgTDMzNi4yMSw3NDEuNjIgQTAsMCAwIDAgMCAzMzYuMjEsNzQxLjYyIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNTQyLjIxMDIsNzQxLjYyIEw1NDIuMjEwMiw3NTEuNjIgTDU1Mi4yMTAyLDc1MS42MiBMNTQyLjIxMDIsNzQxLjYyIiBmaWxsPSIjRkVGRkREIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzAuMDAwMiIgeD0iMzQyLjIxIiB5PSI3NTguNjg2OSI+JiMyMDUxMTsmIzI2MDQxOyYjMTI1Mzk7JiMzNjAyNDsmIzI2MDQxOyYjMTIzOTg7JiMzNTQ0MzsmIzMyMDQ4OyYjMjQ3NzM7JiMyMjU3Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTk1LjAwMDIiIHg9IjM0Mi4yMSIgeT0iNzczLjgxOTciPiYjMjEyMDg7JiMyMzQ1MDsmIzMxMTg1OyYjMzA0NDY7JiMxMjI4OTsmIzM3MzI5OyYjMzg5ODk7JiMxMjI4OTsmIzM1MDM2OyYjMjExNjE7JiMyNDc3MzsmIzIyNTc3OyYjMTI0MzQ7JiMzMTY0OTsmIzI5NzAyOzwvdGV4dD48L2c+PCEtLWxpbmsgSm91cm5hbCB0byBKb3VybmFsRGV0YWlsLS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDIiIGRhdGEtZW50aXR5LTI9ImVudDAwMDMiIGRhdGEtbGluay10eXBlPSJjcm93Zm9vdCIgZGF0YS1zb3VyY2UtbGluZT0iNTQiIGlkPSJsbms1Ij48cGF0aCBjb2RlTGluZT0iNTQiIGQ9Ik0xNTQuMjEsMjc1LjIzIEMxNTQuMjEsMzAxLjczIDE1NC4yMSwzMDIuNTEgMTU0LjIxLDMyNS40NyIgZmlsbD0ibm9uZSIgaWQ9IkpvdXJuYWwtSm91cm5hbERldGFpbCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTAuMjEiIHgyPSIxNTguMjEiIHkxPSIyNzEuMjMiIHkyPSIyNzEuMjMiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTUwLjIxIiB4Mj0iMTU4LjIxIiB5MT0iMjc0LjIzIiB5Mj0iMjc0LjIzIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE1NC4yMSIgeDI9IjE1NC4yMSIgeTE9IjI3NS4yMyIgeTI9IjI2Ny4yMyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTQuMjEiIHgyPSIxNjAuMjEiIHkxPSIzMzUuNDciIHkyPSIzNDMuNDciLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU0LjIxIiB4Mj0iMTQ4LjIxIiB5MT0iMzM1LjQ3IiB5Mj0iMzQzLjQ3Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE1NC4yMSIgeDI9IjE1NC4yMSIgeTE9IjMzNS40NyIgeTI9IjM0My40NyIvPjxlbGxpcHNlIGN4PSIxNTQuMjEiIGN5PSIzMjkuNDciIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSIxNTUuMjEiIHk9IjMwOS45MjY5Ij4mIzIxNTQ3OyYjMTI0MTY7PC90ZXh0PjwvZz48IS0tbGluayBKb3VybmFsRGV0YWlsIHRvIEpvdXJuYWxEZWJpdENyZWRpdERldGFpbC0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDAzIiBkYXRhLWVudGl0eS0yPSJlbnQwMDA0IiBkYXRhLWxpbmstdHlwZT0iY3Jvd2Zvb3QiIGRhdGEtc291cmNlLWxpbmU9IjU1IiBpZD0ibG5rNiI+PHBhdGggY29kZUxpbmU9IjU1IiBkPSJNMTU0LjIxLDQ4MS42IEMxNTQuMjEsNTAzLjk1IDE1NC4yMSw1MDQuNDMgMTU0LjIxLDUzMi4xMSIgZmlsbD0ibm9uZSIgaWQ9IkpvdXJuYWxEZXRhaWwtSm91cm5hbERlYml0Q3JlZGl0RGV0YWlsIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE1MC4yMSIgeDI9IjE1OC4yMSIgeTE9IjQ3Ny42IiB5Mj0iNDc3LjYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTUwLjIxIiB4Mj0iMTU4LjIxIiB5MT0iNDgwLjYiIHkyPSI0ODAuNiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTQuMjEiIHgyPSIxNTQuMjEiIHkxPSI0ODEuNiIgeTI9IjQ3My42Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjE1NC4yMSIgeDI9IjE2MC4yMSIgeTE9IjU0Mi4xMSIgeTI9IjU1MC4xMSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTQuMjEiIHgyPSIxNDguMjEiIHkxPSI1NDIuMTEiIHkyPSI1NTAuMTEiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTU0LjIxIiB4Mj0iMTU0LjIxIiB5MT0iNTQyLjExIiB5Mj0iNTUwLjExIi8+PGVsbGlwc2UgY3g9IjE1NC4yMSIgY3k9IjUzNi4xMSIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjE1NS4yMSIgeT0iNTE2LjQwNjkiPiYjMjE1NDc7JiMxMjQxNjs8L3RleHQ+PC9nPjw/cGxhbnR1bWwtc3JjIGxMTFRKbkQxNTd0Vk54N2Y0c25pR2xzQThPSWFXUWVlNDBBRHhuWWdEWjRxbVZOMVdDYnNIc1p2QmZYMmZKTXJpU1dZa1hRQUtoZ1dGc093Q3pqX3VTbUV0TXdOQmMwcWxpdEVFVlVVVS1fVVVvU29BS1ZiTHdBbFBnSERoVW1KbnItODNzOGxmb1I3ZHVsSldZSEE0V1RnOS1fOWphUklkejdnYUlIcll1LTJldHR0V3dDVFdRdkVpUVRkdjY1bGgtM3RNdHBwLW41YnVpcmpIa2lGWGFGTUJQaFRIV2pQem90VWhuOXphb2owYThQVzV3ZWJuWFdSMld1RTNXbzdrVXJvMVl6enl5UVQ0UUFiQWFoRUNTaHZNLXZDdHlBdmxBYWJRdks1M3ZTSUFWdjRSbWpHZko2VEczMV9Gai14QjV6OWdXRWpsZzZxdlRyZ3Fnb1E1NmFXTmQ4S2hIbGh4V2ZKQjdHbERDZXBGQ3RYUDhmTTN4eko2SE9VNjBnRFhPRDM4eG9Bc0tFeUtNZzdsWFE0SUNsX25QYUxTYlhvX2tOLVkzbVVfVERfeFNvRHN2WTVmUVAxOHBUZFBxWUtXVFNvdmdUdWd5a2toaXZfY3c5dks0NUFsYnNZWndEb3RySGE4WWhfWnZuUlEzbWNUcy13MERTU2VTS0N4TE1vaXFRby1jS2o5ZmFWU3NYWHptOW9XOU52WVdxaEdSMDltTFVlTGcydzByS3dVS2JsZHRRUXpTSFFsUjFpWk5VZVJ1MU1lb0RteXpmcklyTlBDVy1xall2a0M5b2VMUHB6MVM0TjJxeXdOVHBYN2IyLVFYZUxsOWdyanVNdDZsd0hEMHlDZWdxcW8tc3dTZkI4SWk4clpKUDRUbUlMUS1GNTJKMjNOQnZiaHFiY0VLNzM4eVNiaHU2N2dhNGw4SVgwS0J3bWsxQjlMbDN5dVhMUW1VUFVpSERnSGVSZVktcTlKSHBEcElCenMwZFVfbGpuUkptbENwRC1Wc3BRak9Vd0hIekF4SzVMeUdjalc5bGo3Y1E3ZUowUGFvRllMRkpmQ3JjQ0ZNY08yQ3YxWHQ0VFdXbTQwMDg1V3JkcU9MLW10b3NlbkV0TllmckpSdVljc3h5SWdrajRCdjNLNzVxeDRvOUp5ajNaU1BzZktacXd4VkdYZ3Zxa3FfRVBQMDM2WV9JaEdUYXBZbWNTQlo3U3NieEt1ZDhITG5xNGpsaXNaWTRtdzZmWDFvZ3lNd1JFcFlIUk1hYzl5cDZZMXp1c2Q3Ry1uVHkwPz48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_5">マイグレーション：仕訳テーブルの作成<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h3>
<details>
<summary>マイグレーションSQL</summary>

<div class="highlight"><pre><span></span><code><span class="c1">-- src/main/resources/db/migration/V006__create_journal_tables.sql</span>

<span class="c1">-- 仕訳伝票区分</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="err">仕訳伝票区分</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;通常&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;決算&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;自動&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;振替&#39;</span><span class="p">);</span>

<span class="c1">-- 仕訳行貸借区分</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="err">仕訳行貸借区分</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;借方&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;貸方&#39;</span><span class="p">);</span>

<span class="c1">-- 消費税区分（仕訳用）</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="err">消費税区分</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;課税&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;非課税&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;免税&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;不課税&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;対象外&#39;</span><span class="p">);</span>

<span class="c1">-- 消費税計算区分（仕訳用）</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TYPE</span><span class="w"> </span><span class="err">消費税計算区分</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ENUM</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;外税&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;内税&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;税なし&#39;</span><span class="p">);</span>

<span class="c1">-- 仕訳ヘッダ</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;起票日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;入力日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;決算仕訳フラグ&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;単振フラグ&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;仕訳伝票区分&quot;</span><span class="w"> </span><span class="err">仕訳伝票区分</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;通常&#39;</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;定期計上フラグ&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;社員コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;部門コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;赤伝フラグ&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;赤黒伝票番号&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_仕訳_部門&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;部門コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;部門マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;部門コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- 仕訳明細</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;仕訳明細&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;仕訳行番号&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;行摘要&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;仕訳行番号&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_仕訳明細_仕訳&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="p">(</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span>
<span class="p">);</span>

<span class="c1">-- 仕訳貸借明細</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span><span class="w"> </span><span class="p">(</span>
<span class="w">    </span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;仕訳行番号&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;仕訳行貸借区分&quot;</span><span class="w"> </span><span class="err">仕訳行貸借区分</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;勘定科目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;補助科目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;部門コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;プロジェクトコード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;仕訳金額&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;通貨コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;JPY&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;為替レート&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">00</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;基軸換算仕訳金額&quot;</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;消費税区分&quot;</span><span class="w"> </span><span class="err">消費税区分</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;課税&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;消費税率&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;消費税計算区分&quot;</span><span class="w"> </span><span class="err">消費税計算区分</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;外税&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;期日&quot;</span><span class="w"> </span><span class="nb">DATE</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;資金繰フラグ&quot;</span><span class="w"> </span><span class="nb">SMALLINT</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;セグメントコード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;相手勘定科目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;相手補助科目コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;付箋コード&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;付箋内容&quot;</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">),</span>
<span class="w">    </span><span class="ss">&quot;作成日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="ss">&quot;更新日時&quot;</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">,</span>
<span class="w">    </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;仕訳行番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;仕訳行貸借区分&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_仕訳貸借明細_仕訳明細&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;仕訳行番号&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;仕訳明細&quot;</span><span class="p">(</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;仕訳行番号&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">DELETE</span><span class="w"> </span><span class="k">CASCADE</span><span class="p">,</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_仕訳貸借明細_勘定科目&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;勘定科目コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;勘定科目マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;勘定科目コード&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="k">CONSTRAINT</span><span class="w"> </span><span class="ss">&quot;fk_仕訳貸借明細_部門&quot;</span>
<span class="w">        </span><span class="k">FOREIGN</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="p">(</span><span class="ss">&quot;部門コード&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">REFERENCES</span><span class="w"> </span><span class="ss">&quot;部門マスタ&quot;</span><span class="p">(</span><span class="ss">&quot;部門コード&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="c1">-- インデックス</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_仕訳_起票日&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="p">(</span><span class="ss">&quot;起票日&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_仕訳_部門コード&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="p">(</span><span class="ss">&quot;部門コード&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_仕訳_仕訳伝票区分&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="p">(</span><span class="ss">&quot;仕訳伝票区分&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_仕訳貸借明細_勘定科目コード&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span><span class="p">(</span><span class="ss">&quot;勘定科目コード&quot;</span><span class="p">);</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">INDEX</span><span class="w"> </span><span class="ss">&quot;idx_仕訳貸借明細_部門コード&quot;</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span><span class="p">(</span><span class="ss">&quot;部門コード&quot;</span><span class="p">);</span>
</code></pre></div>

</details>

<details>
<summary>貸借バランスチェック関数</summary>

<div class="highlight"><pre><span></span><code><span class="c1">-- 貸借バランスチェック関数</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">REPLACE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">check_journal_balance</span><span class="p">()</span>
<span class="k">RETURNS</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span>
<span class="k">DECLARE</span>
<span class="w">    </span><span class="n">debit_total</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">credit_total</span><span class="w"> </span><span class="nb">DECIMAL</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="k">BEGIN</span>
<span class="w">    </span><span class="c1">-- 借方合計を計算</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="ss">&quot;仕訳金額&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">debit_total</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;仕訳伝票番号&quot;</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="ss">&quot;仕訳行貸借区分&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;借方&#39;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- 貸方合計を計算</span>
<span class="w">    </span><span class="k">SELECT</span><span class="w"> </span><span class="k">COALESCE</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="ss">&quot;仕訳金額&quot;</span><span class="p">),</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">INTO</span><span class="w"> </span><span class="n">credit_total</span>
<span class="w">    </span><span class="k">FROM</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span>
<span class="w">    </span><span class="k">WHERE</span><span class="w"> </span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;仕訳伝票番号&quot;</span>
<span class="w">    </span><span class="k">AND</span><span class="w"> </span><span class="ss">&quot;仕訳行貸借区分&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;貸方&#39;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">-- 貸借一致チェック（トリガー内では警告のみ、アプリ側で制御）</span>
<span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="n">debit_total</span><span class="w"> </span><span class="o">&lt;&gt;</span><span class="w"> </span><span class="n">credit_total</span><span class="w"> </span><span class="k">THEN</span>
<span class="w">        </span><span class="n">RAISE</span><span class="w"> </span><span class="n">WARNING</span><span class="w"> </span><span class="s1">&#39;仕訳伝票番号 % の貸借が一致していません: 借方=%, 貸方=%&#39;</span><span class="p">,</span>
<span class="w">            </span><span class="k">NEW</span><span class="p">.</span><span class="ss">&quot;仕訳伝票番号&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">debit_total</span><span class="p">,</span><span class="w"> </span><span class="n">credit_total</span><span class="p">;</span>
<span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">IF</span><span class="p">;</span>

<span class="w">    </span><span class="k">RETURN</span><span class="w"> </span><span class="k">NEW</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="err">$$</span><span class="w"> </span><span class="k">LANGUAGE</span><span class="w"> </span><span class="n">plpgsql</span><span class="p">;</span>

<span class="c1">-- 貸借バランスチェックトリガー（挿入・更新時）</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TRIGGER</span><span class="w"> </span><span class="ss">&quot;trg_check_journal_balance&quot;</span>
<span class="k">AFTER</span><span class="w"> </span><span class="k">INSERT</span><span class="w"> </span><span class="k">OR</span><span class="w"> </span><span class="k">UPDATE</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span>
<span class="k">FOR</span><span class="w"> </span><span class="k">EACH</span><span class="w"> </span><span class="k">ROW</span>
<span class="k">EXECUTE</span><span class="w"> </span><span class="k">FUNCTION</span><span class="w"> </span><span class="n">check_journal_balance</span><span class="p">();</span>
</code></pre></div>

</details>

<hr />
<h2 id="162">16.2 仕訳明細の設計<a class="headerlink" href="#162" title="Permanent link">&para;</a></h2>
<h3 id="_6">仕訳明細の役割<a class="headerlink" href="#_6" title="Permanent link">&para;</a></h3>
<p>仕訳明細は、仕訳伝票の行単位の情報を管理します。1つの仕訳伝票に複数の明細行を持つことができます。</p>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>仕訳伝票番号</strong></td>
<td>親となる仕訳伝票の番号（外部キー）</td>
</tr>
<tr>
<td><strong>仕訳行番号</strong></td>
<td>明細行の連番（1から始まる）</td>
</tr>
<tr>
<td><strong>行摘要</strong></td>
<td>その行の取引内容の説明（最大1000文字）</td>
</tr>
</tbody>
</table>
<h3 id="_7">単一仕訳と複合仕訳<a class="headerlink" href="#_7" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkRFU0NSSVBUSU9OIiBoZWlnaHQ9IjIwNHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MTE1NXB4O2hlaWdodDoyMDRweDtiYWNrZ3JvdW5kOiNGRkZGRkY7IiB2ZXJzaW9uPSIxLjEiIHZpZXdCb3g9IjAgMCAxMTU1IDIwNCIgd2lkdGg9IjExNTVweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjEzMzY7JiMxOTk2ODsmIzIwMTgxOyYjMzUzNzk7JiMxMjM5MjsmIzM1MDc5OyYjMjE1MTI7JiMyMDE4MTsmIzM1Mzc5OzwvdGl0bGU+PGRlZnMvPjxnPjxnIGNsYXNzPSJ0aXRsZSIgZGF0YS1zb3VyY2UtbGluZT0iMSI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyNS45OTk1IiB4PSI1MDcuNTAwMyIgeT0iMjIuOTk1MSI+JiMyMTMzNjsmIzE5OTY4OyYjMjAxODE7JiMzNTM3OTsmIzEyMzkyOyYjMzUwNzk7JiMyMTUxMjsmIzIwMTgxOyYjMzUzNzk7PC90ZXh0PjwvZz48IS0tY2x1c3RlciA/Pz8/Pz8/Pz8/PTE/LS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLi4uLi4uMS4iIGRhdGEtc291cmNlLWxpbmU9IjMiIGlkPSJlbnQwMDAyIj48cGF0aCBkPSJNOC41LDQzLjI5NjkgTDE4NC45NzEsNDMuMjk2OSBBMy43NSwzLjc1IDAgMCAxIDE4Ny40NzEsNDUuNzk2OSBMMTk0LjQ3MSw2NS41OTM4IEw0NDIuNSw2NS41OTM4IEEyLjUsMi41IDAgMCAxIDQ0NSw2OC4wOTM4IEw0NDUsMTk1LjA5NjkgQTIuNSwyLjUgMCAwIDEgNDQyLjUsMTk3LjU5NjkgTDguNSwxOTcuNTk2OSBBMi41LDIuNSAwIDAgMSA2LDE5NS4wOTY5IEw2LDQ1Ljc5NjkgQTIuNSwyLjUgMCAwIDEgOC41LDQzLjI5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MS41OyIgeDE9IjYiIHgyPSIxOTQuNDcxIiB5MT0iNjUuNTkzOCIgeTI9IjY1LjU5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc1LjQ3MSIgeD0iMTAiIHk9IjU4LjI5MiI+JiMyMTMzNjsmIzE5OTY4OyYjMjAxODE7JiMzNTM3OTsmIzY1Mjg4OyYjMjEzMzY7JiMyNTM5MTsmIzEyNTAxOyYjMTI1MjE7JiMxMjQ2NDs9MSYjNjUyODk7PC90ZXh0PjwvZz48IS0tY2x1c3RlciBzaW5nbGUtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uLi4uLi4xLi5zaW5nbGUiIGRhdGEtc291cmNlLWxpbmU9IjQiIGlkPSJlbnQwMDAzIj48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9Ijg3LjMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzOTEiIHg9IjMwIiB5PSI4Ni4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMi42MTQ4IiB4PSIxNjkuMTkyNiIgeT0iMTAxLjI5MiI+JiMyMDE4MTsmIzM1Mzc5OyYjMjYxMjY7JiMzMjA0ODsgJiMzNDg5MjsmIzMwMDU4OyYjMjE0OTU7MTwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgPz8/Pz8/Pz8/Pz0wPy0tPjxnIGNsYXNzPSJjbHVzdGVyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi4uLi4uLjAuIiBkYXRhLXNvdXJjZS1saW5lPSIxMCIgaWQ9ImVudDAwMDYiPjxwYXRoIGQ9Ik00NzEuNSw0My4yOTY5IEw2NDcuOTcxLDQzLjI5NjkgQTMuNzUsMy43NSAwIDAgMSA2NTAuNDcxLDQ1Ljc5NjkgTDY1Ny40NzEsNjUuNTkzOCBMMTE0NS41LDY1LjU5MzggQTIuNSwyLjUgMCAwIDEgMTE0OCw2OC4wOTM4IEwxMTQ4LDE5NS4wOTY5IEEyLjUsMi41IDAgMCAxIDExNDUuNSwxOTcuNTk2OSBMNDcxLjUsMTk3LjU5NjkgQTIuNSwyLjUgMCAwIDEgNDY5LDE5NS4wOTY5IEw0NjksNDUuNzk2OSBBMi41LDIuNSAwIDAgMSA0NzEuNSw0My4yOTY5IiBmaWxsPSJub25lIiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjEuNTsiIHgxPSI0NjkiIHgyPSI2NTcuNDcxIiB5MT0iNjUuNTkzOCIgeTI9IjY1LjU5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc1LjQ3MSIgeD0iNDczIiB5PSI1OC4yOTIiPiYjMzUwNzk7JiMyMTUxMjsmIzIwMTgxOyYjMzUzNzk7JiM2NTI4ODsmIzIxMzM2OyYjMjUzOTE7JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7PTAmIzY1Mjg5OzwvdGV4dD48L2c+PCEtLWNsdXN0ZXIgbGluZTEtLT48ZyBjbGFzcz0iY2x1c3RlciIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uLi4uLi4wLi5saW5lMSIgZGF0YS1zb3VyY2UtbGluZT0iMTEiIGlkPSJlbnQwMDA3Ij48cmVjdCBmaWxsPSJub25lIiBoZWlnaHQ9Ijg3LjMiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzOTUiIHg9IjQ5MyIgeT0iODYuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMTIuNjE0OCIgeD0iNjM0LjE5MjYiIHk9IjEwMS4yOTIiPiYjMjAxODE7JiMzNTM3OTsmIzI2MTI2OyYjMzIwNDg7ICYjMzQ4OTI7JiMzMDA1ODsmIzIxNDk1OzE8L3RleHQ+PC9nPjwhLS1jbHVzdGVyIGxpbmUyLS0+PGcgY2xhc3M9ImNsdXN0ZXIiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLi4uLi4uMC4ubGluZTIiIGRhdGEtc291cmNlLWxpbmU9IjE1IiBpZD0iZW50MDAxMCI+PHJlY3QgZmlsbD0ibm9uZSIgaGVpZ2h0PSI4Ny4zIiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB3aWR0aD0iMjEyIiB4PSI5MTIiIHk9Ijg2LjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTEyLjYxNDgiIHg9Ijk2MS42OTI2IiB5PSIxMDEuMjkyIj4mIzIwMTgxOyYjMzUzNzk7JiMyNjEyNjsmIzMyMDQ4OyAmIzM0ODkyOyYjMzAwNTg7JiMyMTQ5NTsyPC90ZXh0PjwvZz48IS0tZW50aXR5IHNkLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uLi4uLi4xLi5zaW5nbGUuc2QiIGRhdGEtc291cmNlLWxpbmU9IjUiIGlkPSJlbnQwMDA0Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE2MS41MTA0IiB4PSI0Ni4yNCIgeT0iMTIxLjI5NjkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxNDEuNTEwNCIgeD0iNTYuMjQiIHk9IjE0NC4yOTIiPiYjMjA1MTE7JiMyNjA0MTs6ICYjMjk2OTQ7JiMzNzMyOTsgMTAwLDAwMCYjMjA4NzA7PC90ZXh0PjwvZz48IS0tZW50aXR5IHNjLS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uLi4uLi4xLi5zaW5nbGUuc2MiIGRhdGEtc291cmNlLWxpbmU9IjYiIGlkPSJlbnQwMDA1Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjM2LjI5NjkiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE2MS41MTA0IiB4PSIyNDMuMjQiIHk9IjEyMS4yOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQxLjUxMDQiIHg9IjI1My4yNCIgeT0iMTQ0LjI5MiI+JiMzNjAyNDsmIzI2MDQxOzogJiMyMjc3MDsmIzE5OTc4OyAxMDAsMDAwJiMyMDg3MDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgZDEtLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi4uLi4uLjAuLmxpbmUxLmQxIiBkYXRhLXNvdXJjZS1saW5lPSIxMiIgaWQ9ImVudDAwMDgiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTUyLjYwMzIiIHg9IjUwOC43IiB5PSIxMjEuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzMi42MDMyIiB4PSI1MTguNyIgeT0iMTQ0LjI5MiI+JiMyMDUxMTsmIzI2MDQxOzogJiMyOTY5NDsmIzM3MzI5OyA4MCwwMDAmIzIwODcwOzwvdGV4dD48L2c+PCEtLWVudGl0eSBjMS0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4uLi4uLi4uMC4ubGluZTEuYzEiIGRhdGEtc291cmNlLWxpbmU9IjEzIiBpZD0iZW50MDAwOSI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzNi4yOTY5IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxNzUuNTEwNCIgeD0iNjk2LjI0IiB5PSIxMjEuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE1NS41MTA0IiB4PSI3MDYuMjQiIHk9IjE0NC4yOTIiPiYjMzYwMjQ7JiMyNjA0MTs6ICYjMjI3NzA7JiMyNTQ5OTsmIzM3MzI5OyAxMDAsMDAwJiMyMDg3MDs8L3RleHQ+PC9nPjwhLS1lbnRpdHkgZDItLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi4uLi4uLjAuLmxpbmUyLmQyIiBkYXRhLXNvdXJjZS1saW5lPSIxNiIgaWQ9ImVudDAwMTEiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMzYuMjk2OSIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTgwLjYwMzEiIHg9IjkyNy43IiB5PSIxMjEuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE2MC42MDMxIiB4PSI5MzcuNyIgeT0iMTQ0LjI5MiI+JiMyMDUxMTsmIzI2MDQxOzogJiMyMTQ2MzsmIzIxNDYyOyYjMjUxNjM7JiMyNDQxODsgMjAsMDAwJiMyMDg3MDs8L3RleHQ+PC9nPjw/cGxhbnR1bWwtc3JjIEF5YWlvS2JMVURleHV5Y0VYWVV4Znh2T2lWYm51dWVOSXpnVkprWTBTQmN1MlhBSmluRkpLbk1LYTVNenR6QzF2M3hoTVYtdVVVaFp2Zk1GY3BSTzZoeFZxd2NhS0NyTGI5ZlNhZllOM1pITTJRQnNzT28tdnJpc0FCbk9zRkR5d2dnZF9UaURiSEdJWW5NQUN5NWdLREdfUlBaX1JEZkVBdU5kX1ZqVWphektDM0dtcTM0bUM3WlFyV1JIYU9BaXppTWM3TTJySm5UbFVoQVoycURqQ2JTajQyOFNaLW1kQjh1dDhDdG5FUGJ2Z09QdXRNdzF1Zm1LR25uRVZ6T3Q2dWpGYW1zMVJZVmU1MkV1S3VvbUUtTGZfX0lkX1RFVVROT190Umo4bUdaTEdLUVd5MDQwPz48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<hr />
<h2 id="163">16.3 仕訳貸借明細の設計<a class="headerlink" href="#163" title="Permanent link">&para;</a></h2>
<h3 id="_8">仕訳貸借明細の項目<a class="headerlink" href="#_8" title="Permanent link">&para;</a></h3>
<p>仕訳貸借明細は、借方・貸方それぞれの詳細情報を管理する最も粒度の細かいテーブルです。</p>
<h4 id="_9">基本情報<a class="headerlink" href="#_9" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>仕訳伝票番号</strong></td>
<td>親となる仕訳伝票の番号</td>
</tr>
<tr>
<td><strong>仕訳行番号</strong></td>
<td>親となる仕訳明細の行番号</td>
</tr>
<tr>
<td><strong>仕訳行貸借区分</strong></td>
<td>借方/貸方の区分</td>
</tr>
<tr>
<td><strong>勘定科目コード</strong></td>
<td>使用する勘定科目</td>
</tr>
<tr>
<td><strong>補助科目コード</strong></td>
<td>補助科目（得意先、仕入先など）</td>
</tr>
<tr>
<td><strong>仕訳金額</strong></td>
<td>取引金額</td>
</tr>
</tbody>
</table>
<h4 id="_10">多通貨対応<a class="headerlink" href="#_10" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>通貨コード</strong></td>
<td>取引通貨（デフォルト: JPY）</td>
</tr>
<tr>
<td><strong>為替レート</strong></td>
<td>適用為替レート</td>
</tr>
<tr>
<td><strong>基軸換算仕訳金額</strong></td>
<td>基軸通貨（円）換算後の金額</td>
</tr>
</tbody>
</table>
<h4 id="_11">管理会計情報<a class="headerlink" href="#_11" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>部門コード</strong></td>
<td>配賦先部門</td>
</tr>
<tr>
<td><strong>プロジェクトコード</strong></td>
<td>関連プロジェクト</td>
</tr>
<tr>
<td><strong>セグメントコード</strong></td>
<td>セグメント情報</td>
</tr>
</tbody>
</table>
<h4 id="_12">消費税情報<a class="headerlink" href="#_12" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>消費税区分</strong></td>
<td>課税/非課税/免税/不課税/対象外</td>
</tr>
<tr>
<td><strong>消費税率</strong></td>
<td>適用税率（10, 8 など）</td>
</tr>
<tr>
<td><strong>消費税計算区分</strong></td>
<td>外税/内税/税なし</td>
</tr>
</tbody>
</table>
<h4 id="_13">その他<a class="headerlink" href="#_13" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>期日</strong></td>
<td>支払期日・入金期日</td>
</tr>
<tr>
<td><strong>資金繰フラグ</strong></td>
<td>資金繰表への計上対象か</td>
</tr>
<tr>
<td><strong>相手勘定科目コード</strong></td>
<td>相手勘定科目（元帳表示用）</td>
</tr>
<tr>
<td><strong>相手補助科目コード</strong></td>
<td>相手補助科目</td>
</tr>
<tr>
<td><strong>付箋コード</strong></td>
<td>付箋の種類</td>
</tr>
<tr>
<td><strong>付箋内容</strong></td>
<td>付箋の内容（メモ）</td>
</tr>
</tbody>
</table>
<h3 id="tdd">TDD による仕訳テーブルの実装<a class="headerlink" href="#tdd" title="Permanent link">&para;</a></h3>
<h4 id="enum">ドメイン層：Enum定義<a class="headerlink" href="#enum" title="Permanent link">&para;</a></h4>
<details>
<summary>仕訳伝票区分 Enum</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/domain/model/journal/JournalVoucherType.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Getter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>

<span class="nd">@Getter</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">JournalVoucherType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">NORMAL</span><span class="p">(</span><span class="s">&quot;通常&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">CLOSING</span><span class="p">(</span><span class="s">&quot;決算&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">AUTO</span><span class="p">(</span><span class="s">&quot;自動&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">TRANSFER</span><span class="p">(</span><span class="s">&quot;振替&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">JournalVoucherType</span><span class="w"> </span><span class="nf">fromDisplayName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">JournalVoucherType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">values</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="na">displayName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">displayName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;不正な仕訳伝票区分: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displayName</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>消費税区分 Enum</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/domain/model/journal/TaxType.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Getter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>

<span class="nd">@Getter</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">TaxType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">TAXABLE</span><span class="p">(</span><span class="s">&quot;課税&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">NON_TAXABLE</span><span class="p">(</span><span class="s">&quot;非課税&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">TAX_EXEMPT</span><span class="p">(</span><span class="s">&quot;免税&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">NOT_TAXABLE</span><span class="p">(</span><span class="s">&quot;不課税&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">OUT_OF_SCOPE</span><span class="p">(</span><span class="s">&quot;対象外&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">TaxType</span><span class="w"> </span><span class="nf">fromDisplayName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">TaxType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">values</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="na">displayName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">displayName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;不正な消費税区分: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displayName</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>消費税計算区分 Enum</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/domain/model/journal/TaxCalculationType.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Getter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>

<span class="nd">@Getter</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">TaxCalculationType</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">EXCLUSIVE</span><span class="p">(</span><span class="s">&quot;外税&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">INCLUSIVE</span><span class="p">(</span><span class="s">&quot;内税&quot;</span><span class="p">),</span>
<span class="w">    </span><span class="n">NO_TAX</span><span class="p">(</span><span class="s">&quot;税なし&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">TaxCalculationType</span><span class="w"> </span><span class="nf">fromDisplayName</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">displayName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">TaxCalculationType</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">values</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">type</span><span class="p">.</span><span class="na">displayName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">displayName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">type</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&quot;不正な消費税計算区分: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">displayName</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="_14">ドメイン層：エンティティ<a class="headerlink" href="#_14" title="Permanent link">&para;</a></h4>
<details>
<summary>仕訳エンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/domain/model/journal/Journal.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Journal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">journalVoucherNumber</span><span class="p">;</span><span class="w">      </span><span class="c1">// 仕訳伝票番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">postingDate</span><span class="p">;</span><span class="w">            </span><span class="c1">// 起票日</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">entryDate</span><span class="p">;</span><span class="w">              </span><span class="c1">// 入力日</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">closingJournalFlag</span><span class="p">;</span><span class="w">       </span><span class="c1">// 決算仕訳フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">singleEntryFlag</span><span class="p">;</span><span class="w">          </span><span class="c1">// 単振フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JournalVoucherType</span><span class="w"> </span><span class="n">voucherType</span><span class="p">;</span><span class="w">   </span><span class="c1">// 仕訳伝票区分</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">periodicPostingFlag</span><span class="p">;</span><span class="w">      </span><span class="c1">// 定期計上フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">employeeCode</span><span class="p">;</span><span class="w">              </span><span class="c1">// 社員コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span><span class="w">            </span><span class="c1">// 部門コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">redSlipFlag</span><span class="p">;</span><span class="w">              </span><span class="c1">// 赤伝フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">redBlackVoucherNumber</span><span class="p">;</span><span class="w">    </span><span class="c1">// 赤黒伝票番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span><span class="w">          </span><span class="c1">// 作成日時</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span><span class="w">          </span><span class="c1">// 更新日時</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">JournalDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 貸借バランスチェック</span>
<span class="cm">     * @return 借方合計と貸方合計が一致する場合 true</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isBalanced</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">debitTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="na">getDebitCreditDetails</span><span class="p">().</span><span class="na">stream</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">dc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dc</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">JournalDebitCreditDetail</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">creditTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="na">getDebitCreditDetails</span><span class="p">().</span><span class="na">stream</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">dc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dc</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">JournalDebitCreditDetail</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">debitTotal</span><span class="p">.</span><span class="na">compareTo</span><span class="p">(</span><span class="n">creditTotal</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 借方合計を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getDebitTotal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="na">getDebitCreditDetails</span><span class="p">().</span><span class="na">stream</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">dc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dc</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">JournalDebitCreditDetail</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * 貸方合計を取得</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="nf">getCreditTotal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">details</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">d</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">d</span><span class="p">.</span><span class="na">getDebitCreditDetails</span><span class="p">().</span><span class="na">stream</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">dc</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">dc</span><span class="p">.</span><span class="na">getDebitCreditType</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">JournalDebitCreditDetail</span><span class="p">::</span><span class="n">getAmount</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">reduce</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ZERO</span><span class="p">,</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">::</span><span class="n">add</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>仕訳明細エンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/domain/model/journal/JournalDetail.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalDetail</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">journalVoucherNumber</span><span class="p">;</span><span class="w">  </span><span class="c1">// 仕訳伝票番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span><span class="w">           </span><span class="c1">// 仕訳行番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">lineSummary</span><span class="p">;</span><span class="w">           </span><span class="c1">// 行摘要</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span><span class="w">      </span><span class="c1">// 作成日時</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span><span class="w">      </span><span class="c1">// 更新日時</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">JournalDebitCreditDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">debitCreditDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<details>
<summary>仕訳貸借明細エンティティ</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/domain/model/journal/JournalDebitCreditDetail.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.account.DebitCreditType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalDebitCreditDetail</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">journalVoucherNumber</span><span class="p">;</span><span class="w">      </span><span class="c1">// 仕訳伝票番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">lineNumber</span><span class="p">;</span><span class="w">               </span><span class="c1">// 仕訳行番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">DebitCreditType</span><span class="w"> </span><span class="n">debitCreditType</span><span class="p">;</span><span class="w">  </span><span class="c1">// 仕訳行貸借区分</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">;</span><span class="w">               </span><span class="c1">// 勘定科目コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">subAccountCode</span><span class="p">;</span><span class="w">            </span><span class="c1">// 補助科目コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span><span class="w">            </span><span class="c1">// 部門コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">projectCode</span><span class="p">;</span><span class="w">               </span><span class="c1">// プロジェクトコード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">amount</span><span class="p">;</span><span class="w">                </span><span class="c1">// 仕訳金額</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">currencyCode</span><span class="p">;</span><span class="w">              </span><span class="c1">// 通貨コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">exchangeRate</span><span class="p">;</span><span class="w">          </span><span class="c1">// 為替レート</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">BigDecimal</span><span class="w"> </span><span class="n">baseCurrencyAmount</span><span class="p">;</span><span class="w">    </span><span class="c1">// 基軸換算仕訳金額</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TaxType</span><span class="w"> </span><span class="n">taxType</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 消費税区分</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">taxRate</span><span class="p">;</span><span class="w">                  </span><span class="c1">// 消費税率</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">TaxCalculationType</span><span class="w"> </span><span class="n">taxCalcType</span><span class="p">;</span><span class="w">   </span><span class="c1">// 消費税計算区分</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">dueDate</span><span class="p">;</span><span class="w">                </span><span class="c1">// 期日</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">cashFlowFlag</span><span class="p">;</span><span class="w">             </span><span class="c1">// 資金繰フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">segmentCode</span><span class="p">;</span><span class="w">               </span><span class="c1">// セグメントコード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">counterAccountCode</span><span class="p">;</span><span class="w">        </span><span class="c1">// 相手勘定科目コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">counterSubAccountCode</span><span class="p">;</span><span class="w">     </span><span class="c1">// 相手補助科目コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">tagCode</span><span class="p">;</span><span class="w">                   </span><span class="c1">// 付箋コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">tagContent</span><span class="p">;</span><span class="w">                </span><span class="c1">// 付箋内容</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span><span class="w">          </span><span class="c1">// 作成日時</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span><span class="w">          </span><span class="c1">// 更新日時</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="_15">テストコード<a class="headerlink" href="#_15" title="Permanent link">&para;</a></h4>
<details>
<summary>仕訳リポジトリテスト</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/test/java/com/example/accounting/infrastructure/persistence/repository/JournalRepositoryTest.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.infrastructure.persistence.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.application.port.out.JournalRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.account.DebitCreditType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.testsetup.BaseIntegrationTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.*</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;仕訳リポジトリ&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">JournalRepositoryTest</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseIntegrationTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JournalRepository</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;仕訳の登録&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">Registration</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;単純仕訳（1行借方・1行貸方）を登録できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canRegisterSimpleJournal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange: 現金売上の仕訳データ</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createSimpleSalesJournal</span><span class="p">(</span><span class="s">&quot;J0001&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act: 仕訳を登録</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert: 登録されたデータを確認</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">savedJournal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0001&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">savedJournal</span><span class="p">).</span><span class="na">isPresent</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">savedJournal</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">getPostingDate</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">savedJournal</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">isBalanced</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;複合仕訳（複数行）を登録できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canRegisterCompoundJournal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange: 売掛金回収の複合仕訳</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createCompoundJournal</span><span class="p">(</span><span class="s">&quot;J0002&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act: 仕訳を登録</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert: 登録されたデータを確認</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">savedJournal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0002&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">savedJournal</span><span class="p">).</span><span class="na">isPresent</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">savedJournal</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">getDetails</span><span class="p">()).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">savedJournal</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">isBalanced</span><span class="p">()).</span><span class="na">isTrue</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;貸借が一致しない仕訳はバランスチェックでfalseを返す&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">shouldReturnFalseForUnbalancedJournal</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange: 貸借不一致の仕訳データ</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createUnbalancedJournal</span><span class="p">(</span><span class="s">&quot;J0003&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert: バランスチェック</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">journal</span><span class="p">.</span><span class="na">isBalanced</span><span class="p">()).</span><span class="na">isFalse</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;仕訳の検索&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">Search</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@BeforeEach</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUpTestData</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">createSimpleSalesJournal</span><span class="p">(</span><span class="s">&quot;J0001&quot;</span><span class="p">));</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">createCompoundJournal</span><span class="p">(</span><span class="s">&quot;J0002&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;起票日範囲で仕訳を検索できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canFindByDateRange</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByPostingDateBetween</span><span class="p">(</span>
<span class="w">                </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span>
<span class="w">                </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">)</span>
<span class="w">            </span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">journals</span><span class="p">).</span><span class="na">hasSize</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;勘定科目コードで仕訳を検索できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canFindByAccountCode</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByAccountCode</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">journals</span><span class="p">).</span><span class="na">isNotEmpty</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="nf">createSimpleSalesJournal</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">debitDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 現金</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">currencyCode</span><span class="p">(</span><span class="s">&quot;JPY&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">exchangeRate</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ONE</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">creditDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;41100&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 売上</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">currencyCode</span><span class="p">(</span><span class="s">&quot;JPY&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">exchangeRate</span><span class="p">(</span><span class="n">BigDecimal</span><span class="p">.</span><span class="na">ONE</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">journalDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineSummary</span><span class="p">(</span><span class="s">&quot;現金売上&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditDetails</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">debitDetail</span><span class="p">,</span><span class="w"> </span><span class="n">creditDetail</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Journal</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">postingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">entryDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">closingJournalFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">singleEntryFlag</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">voucherType</span><span class="p">(</span><span class="n">JournalVoucherType</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">periodicPostingFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">redSlipFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">journalDetail</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="nf">createCompoundJournal</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 売掛金100,000円を現金80,000円と受取手形20,000円で回収</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">debit1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 現金</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;80000&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">credit1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;11300&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 売掛金</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">debit2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;11200&quot;</span><span class="p">)</span><span class="w">  </span><span class="c1">// 受取手形</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;20000&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">detail1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineSummary</span><span class="p">(</span><span class="s">&quot;現金入金&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditDetails</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">debit1</span><span class="p">,</span><span class="w"> </span><span class="n">credit1</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">detail2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineSummary</span><span class="p">(</span><span class="s">&quot;手形入金&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditDetails</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">debit2</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Journal</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">postingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">entryDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">())</span>
<span class="w">            </span><span class="p">.</span><span class="na">closingJournalFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">singleEntryFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span><span class="w">  </span><span class="c1">// 複合仕訳</span>
<span class="w">            </span><span class="p">.</span><span class="na">voucherType</span><span class="p">(</span><span class="n">JournalVoucherType</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">detail1</span><span class="p">,</span><span class="w"> </span><span class="n">detail2</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="nf">createUnbalancedJournal</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">debitDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">creditDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;41100&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;90000&quot;</span><span class="p">))</span><span class="w">  </span><span class="c1">// 不一致</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">journalDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">debitCreditDetails</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">debitDetail</span><span class="p">,</span><span class="w"> </span><span class="n">creditDetail</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Journal</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">postingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">journalDetail</span><span class="p">))</span>
<span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="output-port">アプリケーション層（Output Port）<a class="headerlink" href="#output-port" title="Permanent link">&para;</a></h4>
<details>
<summary>仕訳リポジトリインターフェース</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/application/port/out/JournalRepository.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.application.port.out</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal.Journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Optional</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * 仕訳リポジトリ（Output Port）</span>
<span class="cm"> */</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">JournalRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="p">);</span>

<span class="w">    </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByVoucherNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">);</span>

<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPostingDateBetween</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">);</span>

<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByAccountCode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">);</span>

<span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByDepartmentCode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">);</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">);</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="_16">インフラストラクチャ層<a class="headerlink" href="#_16" title="Permanent link">&para;</a></h4>
<details>
<summary>MyBatis XML Mapper</summary>

<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper</span>
<span class="cp">        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.mapper.JournalMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳 ResultMap --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;JournalResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.fas.domain.model.journal.Journal&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;journalVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;postingDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;起票日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;entryDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;入力日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;closingJournalFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;決算仕訳フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;singleEntryFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;単振フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;voucherType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳伝票区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.JournalVoucherTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;periodicPostingFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;定期計上フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;employeeCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;社員コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;departmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;部門コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;redSlipFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;赤伝フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;redBlackVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;赤黒伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳明細 ResultMap --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;JournalDetailResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;journalVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineSummary&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;行摘要&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳貸借明細 ResultMap --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;JournalDebitCreditDetailResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDebitCreditDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;journalVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;debitCreditType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳行貸借区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.DebitCreditTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;accountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;勘定科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;subAccountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;補助科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;departmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;部門コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;projectCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;プロジェクトコード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;amount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;仕訳金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;currencyCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;通貨コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;exchangeRate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;為替レート&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;baseCurrencyAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;基軸換算仕訳金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;消費税区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.TaxTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxRate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;消費税率&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxCalcType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;消費税計算区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.TaxCalculationTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;dueDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;期日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;cashFlowFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;資金繰フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;segmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;セグメントコード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;counterAccountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;相手勘定科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;counterSubAccountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;相手補助科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;tagCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;付箋コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;tagContent&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;付箋内容&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳ヘッダ登録 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insertJournal&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.fas.domain.model.journal.Journal&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;仕訳&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;仕訳伝票番号&quot;,<span class="w"> </span>&quot;起票日&quot;,<span class="w"> </span>&quot;入力日&quot;,<span class="w"> </span>&quot;決算仕訳フラグ&quot;,<span class="w"> </span>&quot;単振フラグ&quot;,
<span class="w">            </span>&quot;仕訳伝票区分&quot;,<span class="w"> </span>&quot;定期計上フラグ&quot;,<span class="w"> </span>&quot;社員コード&quot;,<span class="w"> </span>&quot;部門コード&quot;,
<span class="w">            </span>&quot;赤伝フラグ&quot;,<span class="w"> </span>&quot;赤黒伝票番号&quot;,<span class="w"> </span>&quot;作成日時&quot;,<span class="w"> </span>&quot;更新日時&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{journalVoucherNumber},<span class="w"> </span>#{postingDate},<span class="w"> </span>#{entryDate},
<span class="w">            </span>#{closingJournalFlag},<span class="w"> </span>#{singleEntryFlag},
<span class="w">            </span>#{voucherType,<span class="w"> </span>typeHandler=com.example.fas.infrastructure.persistence.typehandler.JournalVoucherTypeHandler}::仕訳伝票区分,
<span class="w">            </span>#{periodicPostingFlag},<span class="w"> </span>#{employeeCode},<span class="w"> </span>#{departmentCode},
<span class="w">            </span>#{redSlipFlag},<span class="w"> </span>#{redBlackVoucherNumber},
<span class="w">            </span>CURRENT_TIMESTAMP,<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳明細登録 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insertJournalDetail&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;仕訳明細&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;仕訳伝票番号&quot;,<span class="w"> </span>&quot;仕訳行番号&quot;,<span class="w"> </span>&quot;行摘要&quot;,<span class="w"> </span>&quot;作成日時&quot;,<span class="w"> </span>&quot;更新日時&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{journalVoucherNumber},<span class="w"> </span>#{lineNumber},<span class="w"> </span>#{lineSummary},
<span class="w">            </span>CURRENT_TIMESTAMP,<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳貸借明細登録 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;insert</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;insertJournalDebitCreditDetail&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDebitCreditDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>INSERT<span class="w"> </span>INTO<span class="w"> </span>&quot;仕訳貸借明細&quot;<span class="w"> </span>(
<span class="w">            </span>&quot;仕訳伝票番号&quot;,<span class="w"> </span>&quot;仕訳行番号&quot;,<span class="w"> </span>&quot;仕訳行貸借区分&quot;,
<span class="w">            </span>&quot;勘定科目コード&quot;,<span class="w"> </span>&quot;補助科目コード&quot;,<span class="w"> </span>&quot;部門コード&quot;,<span class="w"> </span>&quot;プロジェクトコード&quot;,
<span class="w">            </span>&quot;仕訳金額&quot;,<span class="w"> </span>&quot;通貨コード&quot;,<span class="w"> </span>&quot;為替レート&quot;,<span class="w"> </span>&quot;基軸換算仕訳金額&quot;,
<span class="w">            </span>&quot;消費税区分&quot;,<span class="w"> </span>&quot;消費税率&quot;,<span class="w"> </span>&quot;消費税計算区分&quot;,
<span class="w">            </span>&quot;期日&quot;,<span class="w"> </span>&quot;資金繰フラグ&quot;,<span class="w"> </span>&quot;セグメントコード&quot;,
<span class="w">            </span>&quot;相手勘定科目コード&quot;,<span class="w"> </span>&quot;相手補助科目コード&quot;,
<span class="w">            </span>&quot;付箋コード&quot;,<span class="w"> </span>&quot;付箋内容&quot;,<span class="w"> </span>&quot;作成日時&quot;,<span class="w"> </span>&quot;更新日時&quot;
<span class="w">        </span>)<span class="w"> </span>VALUES<span class="w"> </span>(
<span class="w">            </span>#{journalVoucherNumber},<span class="w"> </span>#{lineNumber},
<span class="w">            </span>#{debitCreditType,<span class="w"> </span>typeHandler=com.example.fas.infrastructure.persistence.typehandler.DebitCreditTypeHandler}::仕訳行貸借区分,
<span class="w">            </span>#{accountCode},<span class="w"> </span>#{subAccountCode},<span class="w"> </span>#{departmentCode},<span class="w"> </span>#{projectCode},
<span class="w">            </span>#{amount},<span class="w"> </span>#{currencyCode},<span class="w"> </span>#{exchangeRate},<span class="w"> </span>#{baseCurrencyAmount},
<span class="w">            </span>#{taxType,<span class="w"> </span>typeHandler=com.example.fas.infrastructure.persistence.typehandler.TaxTypeHandler}::消費税区分,
<span class="w">            </span>#{taxRate},
<span class="w">            </span>#{taxCalcType,<span class="w"> </span>typeHandler=com.example.fas.infrastructure.persistence.typehandler.TaxCalculationTypeHandler}::消費税計算区分,
<span class="w">            </span>#{dueDate},<span class="w"> </span>#{cashFlowFlag},<span class="w"> </span>#{segmentCode},
<span class="w">            </span>#{counterAccountCode},<span class="w"> </span>#{counterSubAccountCode},
<span class="w">            </span>#{tagCode},<span class="w"> </span>#{tagContent},<span class="w"> </span>CURRENT_TIMESTAMP,<span class="w"> </span>CURRENT_TIMESTAMP
<span class="w">        </span>)
<span class="w">    </span><span class="nt">&lt;/insert&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳伝票番号で検索 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findByVoucherNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;JournalResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳明細検索 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findDetailsByVoucherNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;JournalDetailResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳明細&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherNumber}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;仕訳行番号&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳貸借明細検索 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findDCDetailsByVoucherAndLine&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;JournalDebitCreditDetailResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>*<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳貸借明細&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherNumber}
<span class="w">        </span>AND<span class="w"> </span>&quot;仕訳行番号&quot;<span class="w"> </span>=<span class="w"> </span>#{lineNumber}
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 起票日範囲で検索 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findVoucherNumbersByDateRange&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;String&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;起票日&quot;<span class="w"> </span>BETWEEN<span class="w"> </span>#{fromDate}<span class="w"> </span>AND<span class="w"> </span>#{toDate}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;仕訳伝票番号&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 勘定科目コードで検索 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findVoucherNumbersByAccountCode&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;String&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT<span class="w"> </span>DISTINCT<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳貸借明細&quot;
<span class="w">        </span>WHERE<span class="w"> </span>&quot;勘定科目コード&quot;<span class="w"> </span>=<span class="w"> </span>#{accountCode}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>&quot;仕訳伝票番号&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 削除 --&gt;</span>
<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteJournal&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>DELETE<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳&quot;<span class="w"> </span>WHERE<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherNumber}
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>

<span class="w">    </span><span class="nt">&lt;delete</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;deleteAll&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>TRUNCATE<span class="w"> </span>TABLE<span class="w"> </span>&quot;仕訳&quot;<span class="w"> </span>CASCADE
<span class="w">    </span><span class="nt">&lt;/delete&gt;</span>
<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<details>
<summary>仕訳リポジトリ実装</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/accounting/infrastructure/persistence/repository/JournalRepositoryImpl.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.infrastructure.persistence.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.application.port.out.JournalRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal.Journal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.infrastructure.persistence.mapper.JournalMapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Optional</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="nd">@Repository</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalRepositoryImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">JournalRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">JournalMapper</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// 1. 仕訳ヘッダを登録</span>
<span class="w">        </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">insertJournal</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// 2. 仕訳明細を登録</span>
<span class="w">        </span><span class="n">journal</span><span class="p">.</span><span class="na">getDetails</span><span class="p">().</span><span class="na">forEach</span><span class="p">(</span><span class="n">detail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">insertJournalDetail</span><span class="p">(</span><span class="n">detail</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// 3. 仕訳貸借明細を登録</span>
<span class="w">            </span><span class="n">detail</span><span class="p">.</span><span class="na">getDebitCreditDetails</span><span class="p">().</span><span class="na">forEach</span><span class="p">(</span><span class="n">dcDetail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">insertJournalDebitCreditDetail</span><span class="p">(</span><span class="n">dcDetail</span><span class="p">);</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByVoucherNumber</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">journal</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="kd">var</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findDetailsByVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">);</span>
<span class="w">                </span><span class="n">details</span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">detail</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">                    </span><span class="kd">var</span><span class="w"> </span><span class="n">dcDetails</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findDCDetailsByVoucherAndLine</span><span class="p">(</span>
<span class="w">                        </span><span class="n">voucherNumber</span><span class="p">,</span><span class="w"> </span><span class="n">detail</span><span class="p">.</span><span class="na">getLineNumber</span><span class="p">());</span>
<span class="w">                    </span><span class="n">detail</span><span class="p">.</span><span class="na">setDebitCreditDetails</span><span class="p">(</span><span class="n">dcDetails</span><span class="p">);</span>
<span class="w">                </span><span class="p">});</span>
<span class="w">                </span><span class="n">journal</span><span class="p">.</span><span class="na">setDetails</span><span class="p">(</span><span class="n">details</span><span class="p">);</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">journal</span><span class="p">;</span>
<span class="w">            </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByPostingDateBetween</span><span class="p">(</span><span class="n">LocalDate</span><span class="w"> </span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">toDate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findVoucherNumbersByDateRange</span><span class="p">(</span><span class="n">fromDate</span><span class="p">,</span><span class="w"> </span><span class="n">toDate</span><span class="p">).</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">findByVoucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">Optional</span><span class="p">::</span><span class="n">isPresent</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">Optional</span><span class="p">::</span><span class="n">get</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByAccountCode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">accountCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findVoucherNumbersByAccountCode</span><span class="p">(</span><span class="n">accountCode</span><span class="p">).</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">findByVoucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">Optional</span><span class="p">::</span><span class="n">isPresent</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">Optional</span><span class="p">::</span><span class="n">get</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByDepartmentCode</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findVoucherNumbersByDepartmentCode</span><span class="p">(</span><span class="n">departmentCode</span><span class="p">).</span><span class="na">stream</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">findByVoucherNumber</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">Optional</span><span class="p">::</span><span class="n">isPresent</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">Optional</span><span class="p">::</span><span class="n">get</span><span class="p">)</span>
<span class="w">            </span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">delete</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">deleteJournal</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">deleteAll</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<hr />
<h2 id="164">16.4 リレーションと楽観ロックの設計<a class="headerlink" href="#164" title="Permanent link">&para;</a></h2>
<h3 id="mybatis-resultmap">MyBatis ネストした ResultMap によるリレーション設定<a class="headerlink" href="#mybatis-resultmap" title="Permanent link">&para;</a></h3>
<p>仕訳データは、仕訳（ヘッダ）→ 仕訳明細 → 仕訳貸借明細の3層構造を持ちます。MyBatis でこの親子関係を効率的に取得するためのリレーション設定を実装します。</p>
<h4 id="resultmap">ネストした ResultMap の定義<a class="headerlink" href="#resultmap" title="Permanent link">&para;</a></h4>
<details>
<summary>JournalMapper.xml（リレーション設定）</summary>

<div class="highlight"><pre><span></span><code><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="cp">&lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
<span class="cp">        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;</span>

<span class="cm">&lt;!-- src/main/resources/mapper/JournalMapper.xml --&gt;</span>
<span class="nt">&lt;mapper</span><span class="w"> </span><span class="na">namespace=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.mapper.JournalMapper&quot;</span><span class="nt">&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳（ヘッダ）の ResultMap（リレーション込み） --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;journalWithDetailsResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.fas.domain.model.journal.Journal&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;journalVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_仕訳伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;postingDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_起票日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;entryDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_入力日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;closingJournalFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_決算仕訳フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;singleEntryFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_単振フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;voucherType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_仕訳伝票区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.JournalVoucherTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;periodicPostingFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_定期計上フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;employeeCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_社員コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;departmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_部門コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;redSlipFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_赤伝フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;redBlackVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_赤黒伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;version&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_バージョン&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;j_更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 仕訳明細との1:N関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;collection</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;details&quot;</span><span class="w"> </span><span class="na">ofType=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDetail&quot;</span>
<span class="w">                    </span><span class="na">resultMap=</span><span class="s">&quot;journalDetailNestedResultMap&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳明細のネスト ResultMap --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;journalDetailNestedResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;journalVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;d_仕訳伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;d_仕訳行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineSummary&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;d_行摘要&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;version&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;d_バージョン&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;d_作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;d_更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="cm">&lt;!-- 仕訳貸借明細との1:N関連 --&gt;</span>
<span class="w">        </span><span class="nt">&lt;collection</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;debitCreditDetails&quot;</span><span class="w"> </span><span class="na">ofType=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDebitCreditDetail&quot;</span>
<span class="w">                    </span><span class="na">resultMap=</span><span class="s">&quot;journalDebitCreditDetailNestedResultMap&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- 仕訳貸借明細のネスト ResultMap --&gt;</span>
<span class="w">    </span><span class="nt">&lt;resultMap</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;journalDebitCreditDetailNestedResultMap&quot;</span><span class="w"> </span><span class="na">type=</span><span class="s">&quot;com.example.fas.domain.model.journal.JournalDebitCreditDetail&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;journalVoucherNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_仕訳伝票番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;lineNumber&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_仕訳行番号&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;id</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;debitCreditType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_仕訳行貸借区分&quot;</span>
<span class="w">            </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.DebitCreditTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;accountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_勘定科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;subAccountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_補助科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;departmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_部門コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;projectCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_プロジェクトコード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;amount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_仕訳金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;currencyCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_通貨コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;exchangeRate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_為替レート&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;baseCurrencyAmount&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_基軸換算仕訳金額&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_消費税区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.TaxTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxRate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_消費税率&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;taxCalcType&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_消費税計算区分&quot;</span>
<span class="w">                </span><span class="na">typeHandler=</span><span class="s">&quot;com.example.fas.infrastructure.persistence.typehandler.TaxCalculationTypeHandler&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;dueDate&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_期日&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;cashFlowFlag&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_資金繰フラグ&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;segmentCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_セグメントコード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;counterAccountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_相手勘定科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;counterSubAccountCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_相手補助科目コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;tagCode&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_付箋コード&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;tagContent&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_付箋内容&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;version&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_バージョン&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;createdAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_作成日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">        </span><span class="nt">&lt;result</span><span class="w"> </span><span class="na">property=</span><span class="s">&quot;updatedAt&quot;</span><span class="w"> </span><span class="na">column=</span><span class="s">&quot;dc_更新日時&quot;</span><span class="nt">/&gt;</span>
<span class="w">    </span><span class="nt">&lt;/resultMap&gt;</span>

<span class="w">    </span><span class="cm">&lt;!-- JOIN による一括取得クエリ（3層構造） --&gt;</span>
<span class="w">    </span><span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findWithDetailsByVoucherNumber&quot;</span><span class="w"> </span><span class="na">resultMap=</span><span class="s">&quot;journalWithDetailsResultMap&quot;</span><span class="nt">&gt;</span>
<span class="w">        </span>SELECT
<span class="w">            </span>j.&quot;仕訳伝票番号&quot;<span class="w"> </span>AS<span class="w"> </span>j_仕訳伝票番号,
<span class="w">            </span>j.&quot;起票日&quot;<span class="w"> </span>AS<span class="w"> </span>j_起票日,
<span class="w">            </span>j.&quot;入力日&quot;<span class="w"> </span>AS<span class="w"> </span>j_入力日,
<span class="w">            </span>j.&quot;決算仕訳フラグ&quot;<span class="w"> </span>AS<span class="w"> </span>j_決算仕訳フラグ,
<span class="w">            </span>j.&quot;単振フラグ&quot;<span class="w"> </span>AS<span class="w"> </span>j_単振フラグ,
<span class="w">            </span>j.&quot;仕訳伝票区分&quot;<span class="w"> </span>AS<span class="w"> </span>j_仕訳伝票区分,
<span class="w">            </span>j.&quot;定期計上フラグ&quot;<span class="w"> </span>AS<span class="w"> </span>j_定期計上フラグ,
<span class="w">            </span>j.&quot;社員コード&quot;<span class="w"> </span>AS<span class="w"> </span>j_社員コード,
<span class="w">            </span>j.&quot;部門コード&quot;<span class="w"> </span>AS<span class="w"> </span>j_部門コード,
<span class="w">            </span>j.&quot;赤伝フラグ&quot;<span class="w"> </span>AS<span class="w"> </span>j_赤伝フラグ,
<span class="w">            </span>j.&quot;赤黒伝票番号&quot;<span class="w"> </span>AS<span class="w"> </span>j_赤黒伝票番号,
<span class="w">            </span>j.&quot;バージョン&quot;<span class="w"> </span>AS<span class="w"> </span>j_バージョン,
<span class="w">            </span>j.&quot;作成日時&quot;<span class="w"> </span>AS<span class="w"> </span>j_作成日時,
<span class="w">            </span>j.&quot;更新日時&quot;<span class="w"> </span>AS<span class="w"> </span>j_更新日時,
<span class="w">            </span>d.&quot;仕訳伝票番号&quot;<span class="w"> </span>AS<span class="w"> </span>d_仕訳伝票番号,
<span class="w">            </span>d.&quot;仕訳行番号&quot;<span class="w"> </span>AS<span class="w"> </span>d_仕訳行番号,
<span class="w">            </span>d.&quot;行摘要&quot;<span class="w"> </span>AS<span class="w"> </span>d_行摘要,
<span class="w">            </span>d.&quot;バージョン&quot;<span class="w"> </span>AS<span class="w"> </span>d_バージョン,
<span class="w">            </span>d.&quot;作成日時&quot;<span class="w"> </span>AS<span class="w"> </span>d_作成日時,
<span class="w">            </span>d.&quot;更新日時&quot;<span class="w"> </span>AS<span class="w"> </span>d_更新日時,
<span class="w">            </span>dc.&quot;仕訳伝票番号&quot;<span class="w"> </span>AS<span class="w"> </span>dc_仕訳伝票番号,
<span class="w">            </span>dc.&quot;仕訳行番号&quot;<span class="w"> </span>AS<span class="w"> </span>dc_仕訳行番号,
<span class="w">            </span>dc.&quot;仕訳行貸借区分&quot;<span class="w"> </span>AS<span class="w"> </span>dc_仕訳行貸借区分,
<span class="w">            </span>dc.&quot;勘定科目コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_勘定科目コード,
<span class="w">            </span>dc.&quot;補助科目コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_補助科目コード,
<span class="w">            </span>dc.&quot;部門コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_部門コード,
<span class="w">            </span>dc.&quot;プロジェクトコード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_プロジェクトコード,
<span class="w">            </span>dc.&quot;仕訳金額&quot;<span class="w"> </span>AS<span class="w"> </span>dc_仕訳金額,
<span class="w">            </span>dc.&quot;通貨コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_通貨コード,
<span class="w">            </span>dc.&quot;為替レート&quot;<span class="w"> </span>AS<span class="w"> </span>dc_為替レート,
<span class="w">            </span>dc.&quot;基軸換算仕訳金額&quot;<span class="w"> </span>AS<span class="w"> </span>dc_基軸換算仕訳金額,
<span class="w">            </span>dc.&quot;消費税区分&quot;<span class="w"> </span>AS<span class="w"> </span>dc_消費税区分,
<span class="w">            </span>dc.&quot;消費税率&quot;<span class="w"> </span>AS<span class="w"> </span>dc_消費税率,
<span class="w">            </span>dc.&quot;消費税計算区分&quot;<span class="w"> </span>AS<span class="w"> </span>dc_消費税計算区分,
<span class="w">            </span>dc.&quot;期日&quot;<span class="w"> </span>AS<span class="w"> </span>dc_期日,
<span class="w">            </span>dc.&quot;資金繰フラグ&quot;<span class="w"> </span>AS<span class="w"> </span>dc_資金繰フラグ,
<span class="w">            </span>dc.&quot;セグメントコード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_セグメントコード,
<span class="w">            </span>dc.&quot;相手勘定科目コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_相手勘定科目コード,
<span class="w">            </span>dc.&quot;相手補助科目コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_相手補助科目コード,
<span class="w">            </span>dc.&quot;付箋コード&quot;<span class="w"> </span>AS<span class="w"> </span>dc_付箋コード,
<span class="w">            </span>dc.&quot;付箋内容&quot;<span class="w"> </span>AS<span class="w"> </span>dc_付箋内容,
<span class="w">            </span>dc.&quot;バージョン&quot;<span class="w"> </span>AS<span class="w"> </span>dc_バージョン,
<span class="w">            </span>dc.&quot;作成日時&quot;<span class="w"> </span>AS<span class="w"> </span>dc_作成日時,
<span class="w">            </span>dc.&quot;更新日時&quot;<span class="w"> </span>AS<span class="w"> </span>dc_更新日時
<span class="w">        </span>FROM<span class="w"> </span>&quot;仕訳&quot;<span class="w"> </span>j
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;仕訳明細&quot;<span class="w"> </span>d<span class="w"> </span>ON<span class="w"> </span>j.&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>d.&quot;仕訳伝票番号&quot;
<span class="w">        </span>LEFT<span class="w"> </span>JOIN<span class="w"> </span>&quot;仕訳貸借明細&quot;<span class="w"> </span>dc<span class="w"> </span>ON<span class="w"> </span>d.&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>dc.&quot;仕訳伝票番号&quot;
<span class="w">            </span>AND<span class="w"> </span>d.&quot;仕訳行番号&quot;<span class="w"> </span>=<span class="w"> </span>dc.&quot;仕訳行番号&quot;
<span class="w">        </span>WHERE<span class="w"> </span>j.&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherNumber}
<span class="w">        </span>ORDER<span class="w"> </span>BY<span class="w"> </span>d.&quot;仕訳行番号&quot;,<span class="w"> </span>dc.&quot;仕訳行貸借区分&quot;
<span class="w">    </span><span class="nt">&lt;/select&gt;</span>

<span class="nt">&lt;/mapper&gt;</span>
</code></pre></div>

</details>

<h4 id="_17">リレーション設定のポイント<a class="headerlink" href="#_17" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>設定項目</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;collection&gt;</code></td>
<td>1:N 関連のマッピング</td>
</tr>
<tr>
<td><code>&lt;id&gt;</code></td>
<td>主キーの識別（MyBatis が重複排除に使用）</td>
</tr>
<tr>
<td>複合主キー</td>
<td>仕訳明細・仕訳貸借明細は複数の <code>&lt;id&gt;</code> で複合主キーを表現</td>
</tr>
<tr>
<td><code>resultMap</code></td>
<td>ネストした ResultMap の参照</td>
</tr>
<tr>
<td>エイリアス（AS）</td>
<td>カラム名の重複を避けるためのプレフィックス（j_, d_, dc_）</td>
</tr>
<tr>
<td><code>ORDER BY</code></td>
<td>コレクションの順序を保証</td>
</tr>
</tbody>
</table>
<h3 id="_18">楽観ロックの実装<a class="headerlink" href="#_18" title="Permanent link">&para;</a></h3>
<p>複数ユーザーが同時に仕訳データを編集する場合、データの整合性を保つために楽観ロック（Optimistic Locking）を実装します。</p>
<h4 id="flyway">Flyway マイグレーション: バージョンカラム追加<a class="headerlink" href="#flyway" title="Permanent link">&para;</a></h4>
<details>
<summary>V006__add_journal_version_columns.sql</summary>

<div class="highlight"><pre><span></span><code><span class="c1">-- src/main/resources/db/migration/V006__add_journal_version_columns.sql</span>

<span class="c1">-- 仕訳テーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 仕訳明細テーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;仕訳明細&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- 仕訳貸借明細テーブルにバージョンカラムを追加</span>
<span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span><span class="w"> </span><span class="k">ADD</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="nb">INTEGER</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>

<span class="c1">-- コメント追加</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;仕訳&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;仕訳明細&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
<span class="k">COMMENT</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="ss">&quot;仕訳貸借明細&quot;</span><span class="p">.</span><span class="ss">&quot;バージョン&quot;</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="s1">&#39;楽観ロック用バージョン番号&#39;</span><span class="p">;</span>
</code></pre></div>

</details>

<h4 id="_19">エンティティへのバージョンフィールド追加<a class="headerlink" href="#_19" title="Permanent link">&para;</a></h4>
<details>
<summary>Journal.java（バージョンフィールド追加）</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/fas/domain/model/journal/Journal.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.AllArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Builder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.Data</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.NoArgsConstructor</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDateTime</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="nd">@Data</span>
<span class="nd">@Builder</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@AllArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Journal</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">journalVoucherNumber</span><span class="p">;</span><span class="w">      </span><span class="c1">// 仕訳伝票番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">postingDate</span><span class="p">;</span><span class="w">            </span><span class="c1">// 起票日</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDate</span><span class="w"> </span><span class="n">entryDate</span><span class="p">;</span><span class="w">              </span><span class="c1">// 入力日</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">closingJournalFlag</span><span class="p">;</span><span class="w">       </span><span class="c1">// 決算仕訳フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">singleEntryFlag</span><span class="p">;</span><span class="w">          </span><span class="c1">// 単振フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JournalVoucherType</span><span class="w"> </span><span class="n">voucherType</span><span class="p">;</span><span class="w">   </span><span class="c1">// 仕訳伝票区分</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">periodicPostingFlag</span><span class="p">;</span><span class="w">      </span><span class="c1">// 定期計上フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">employeeCode</span><span class="p">;</span><span class="w">              </span><span class="c1">// 社員コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">departmentCode</span><span class="p">;</span><span class="w">            </span><span class="c1">// 部門コード</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Boolean</span><span class="w"> </span><span class="n">redSlipFlag</span><span class="p">;</span><span class="w">              </span><span class="c1">// 赤伝フラグ</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">redBlackVoucherNumber</span><span class="p">;</span><span class="w">    </span><span class="c1">// 赤黒伝票番号</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">createdAt</span><span class="p">;</span><span class="w">          </span><span class="c1">// 作成日時</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">LocalDateTime</span><span class="w"> </span><span class="n">updatedAt</span><span class="p">;</span><span class="w">          </span><span class="c1">// 更新日時</span>

<span class="w">    </span><span class="c1">// 楽観ロック用バージョン</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// リレーション</span>
<span class="w">    </span><span class="nd">@Builder.Default</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">JournalDetail</span><span class="o">&gt;</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">();</span>

<span class="w">    </span><span class="c1">// 以下、既存のビジネスロジック...</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="mybatis-mapper">MyBatis Mapper: 楽観ロック対応の更新<a class="headerlink" href="#mybatis-mapper" title="Permanent link">&para;</a></h4>
<details>
<summary>JournalMapper.xml（楽観ロック対応 UPDATE）</summary>

<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- 楽観ロック対応の更新（バージョンチェック付き） --&gt;</span>
<span class="nt">&lt;update</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;updateWithOptimisticLock&quot;</span><span class="w"> </span><span class="na">parameterType=</span><span class="s">&quot;com.example.fas.domain.model.journal.Journal&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>UPDATE<span class="w"> </span>&quot;仕訳&quot;
<span class="w">    </span>SET
<span class="w">        </span>&quot;起票日&quot;<span class="w"> </span>=<span class="w"> </span>#{postingDate},
<span class="w">        </span>&quot;入力日&quot;<span class="w"> </span>=<span class="w"> </span>#{entryDate},
<span class="w">        </span>&quot;決算仕訳フラグ&quot;<span class="w"> </span>=<span class="w"> </span>#{closingJournalFlag},
<span class="w">        </span>&quot;単振フラグ&quot;<span class="w"> </span>=<span class="w"> </span>#{singleEntryFlag},
<span class="w">        </span>&quot;仕訳伝票区分&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherType,<span class="w"> </span>typeHandler=com.example.fas.infrastructure.persistence.typehandler.JournalVoucherTypeHandler}::仕訳伝票区分,
<span class="w">        </span>&quot;定期計上フラグ&quot;<span class="w"> </span>=<span class="w"> </span>#{periodicPostingFlag},
<span class="w">        </span>&quot;社員コード&quot;<span class="w"> </span>=<span class="w"> </span>#{employeeCode},
<span class="w">        </span>&quot;部門コード&quot;<span class="w"> </span>=<span class="w"> </span>#{departmentCode},
<span class="w">        </span>&quot;赤伝フラグ&quot;<span class="w"> </span>=<span class="w"> </span>#{redSlipFlag},
<span class="w">        </span>&quot;赤黒伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{redBlackVoucherNumber},
<span class="w">        </span>&quot;更新日時&quot;<span class="w"> </span>=<span class="w"> </span>CURRENT_TIMESTAMP,
<span class="w">        </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>+<span class="w"> </span>1
<span class="w">    </span>WHERE<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{journalVoucherNumber}
<span class="w">    </span>AND<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>=<span class="w"> </span>#{version}
<span class="nt">&lt;/update&gt;</span>

<span class="cm">&lt;!-- バージョンのみ取得 --&gt;</span>
<span class="nt">&lt;select</span><span class="w"> </span><span class="na">id=</span><span class="s">&quot;findVersionByVoucherNumber&quot;</span><span class="w"> </span><span class="na">resultType=</span><span class="s">&quot;Integer&quot;</span><span class="nt">&gt;</span>
<span class="w">    </span>SELECT<span class="w"> </span>&quot;バージョン&quot;<span class="w"> </span>FROM<span class="w"> </span>&quot;仕訳&quot;
<span class="w">    </span>WHERE<span class="w"> </span>&quot;仕訳伝票番号&quot;<span class="w"> </span>=<span class="w"> </span>#{voucherNumber}
<span class="nt">&lt;/select&gt;</span>
</code></pre></div>

</details>

<h4 id="_20">楽観ロック例外クラス<a class="headerlink" href="#_20" title="Permanent link">&para;</a></h4>
<details>
<summary>OptimisticLockException.java</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/fas/domain/exception/OptimisticLockException.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.domain.exception</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">OptimisticLockException</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">RuntimeException</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">entityName</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">entityId</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">expectedVersion</span><span class="p">;</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">actualVersion</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">OptimisticLockException</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">entityName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">entityId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%s (ID: %s) は既に削除されています&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">entityName</span><span class="p">,</span><span class="w"> </span><span class="n">entityId</span><span class="p">));</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">entityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entityName</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">entityId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entityId</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">expectedVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">actualVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">OptimisticLockException</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">entityName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">entityId</span><span class="p">,</span>
<span class="w">                                    </span><span class="n">Integer</span><span class="w"> </span><span class="n">expectedVersion</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="n">actualVersion</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">super</span><span class="p">(</span><span class="n">String</span><span class="p">.</span><span class="na">format</span><span class="p">(</span><span class="s">&quot;%s (ID: %s) は他のユーザーによって更新されています。&quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s">&quot;期待バージョン: %d, 実際のバージョン: %d&quot;</span><span class="p">,</span>
<span class="w">                </span><span class="n">entityName</span><span class="p">,</span><span class="w"> </span><span class="n">entityId</span><span class="p">,</span><span class="w"> </span><span class="n">expectedVersion</span><span class="p">,</span><span class="w"> </span><span class="n">actualVersion</span><span class="p">));</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">entityName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entityName</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">entityId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">entityId</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">expectedVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">expectedVersion</span><span class="p">;</span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">actualVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actualVersion</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEntityName</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">entityName</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getEntityId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">entityId</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="nf">getExpectedVersion</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">expectedVersion</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Integer</span><span class="w"> </span><span class="nf">getActualVersion</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">actualVersion</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="repository">Repository 実装: 楽観ロック対応<a class="headerlink" href="#repository" title="Permanent link">&para;</a></h4>
<details>
<summary>JournalRepositoryImpl.java（楽観ロック対応）</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/main/java/com/example/fas/infrastructure/persistence/repository/JournalRepositoryImpl.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.infrastructure.persistence.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.application.port.out.JournalRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.exception.OptimisticLockException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal.Journal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.infrastructure.persistence.mapper.JournalMapper</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">lombok.RequiredArgsConstructor</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Repository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.transaction.annotation.Transactional</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Optional</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.stream.Collectors</span><span class="p">;</span>

<span class="nd">@Repository</span>
<span class="nd">@RequiredArgsConstructor</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">JournalRepositoryImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">JournalRepository</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">JournalMapper</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="nd">@Transactional</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">update</span><span class="p">(</span><span class="n">Journal</span><span class="w"> </span><span class="n">journal</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">updatedCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">updateWithOptimisticLock</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">updatedCount</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// バージョン不一致または削除済み</span>
<span class="w">            </span><span class="n">Integer</span><span class="w"> </span><span class="n">currentVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findVersionByVoucherNumber</span><span class="p">(</span>
<span class="w">                    </span><span class="n">journal</span><span class="p">.</span><span class="na">getJournalVoucherNumber</span><span class="p">());</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">currentVersion</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OptimisticLockException</span><span class="p">(</span><span class="s">&quot;仕訳&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">journal</span><span class="p">.</span><span class="na">getJournalVoucherNumber</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OptimisticLockException</span><span class="p">(</span><span class="s">&quot;仕訳&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">journal</span><span class="p">.</span><span class="na">getJournalVoucherNumber</span><span class="p">(),</span>
<span class="w">                        </span><span class="n">journal</span><span class="p">.</span><span class="na">getVersion</span><span class="p">(),</span><span class="w"> </span><span class="n">currentVersion</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Optional</span><span class="o">&lt;</span><span class="n">Journal</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">findByVoucherNumberWithDetails</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Optional</span><span class="p">.</span><span class="na">ofNullable</span><span class="p">(</span><span class="n">journalMapper</span><span class="p">.</span><span class="na">findWithDetailsByVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// その他のメソッド...</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="tdd_1">TDD: 楽観ロックのテスト<a class="headerlink" href="#tdd_1" title="Permanent link">&para;</a></h4>
<details>
<summary>JournalRepositoryOptimisticLockTest.java</summary>

<div class="highlight"><pre><span></span><code><span class="c1">// src/test/java/com/example/fas/infrastructure/persistence/repository/JournalRepositoryOptimisticLockTest.java</span>
<span class="kn">package</span><span class="w"> </span><span class="nn">com.example.fas.infrastructure.persistence.repository</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.application.port.out.JournalRepository</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.exception.OptimisticLockException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.account.DebitCreditType</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.domain.model.journal.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.example.fas.testsetup.BaseIntegrationTest</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.beans.factory.annotation.Autowired</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.math.BigDecimal</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.time.LocalDate</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>

<span class="kn">import static</span><span class="w"> </span><span class="nn">org.assertj.core.api.Assertions.*</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;仕訳リポジトリ - 楽観ロック&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">JournalRepositoryOptimisticLockTest</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">BaseIntegrationTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Autowired</span>
<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">JournalRepository</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@BeforeEach</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setUp</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">deleteAll</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;楽観ロック&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">OptimisticLocking</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;同じバージョンで更新できる&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">canUpdateWithSameVersion</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createTestJournal</span><span class="p">(</span><span class="s">&quot;J0001&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">fetched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0001&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="n">fetched</span><span class="p">.</span><span class="na">setDepartmentCode</span><span class="p">(</span><span class="s">&quot;DEPT-002&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">fetched</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Assert</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">updated</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0001&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">updated</span><span class="p">.</span><span class="na">getDepartmentCode</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="s">&quot;DEPT-002&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThat</span><span class="p">(</span><span class="n">updated</span><span class="p">.</span><span class="na">getVersion</span><span class="p">()).</span><span class="na">isEqualTo</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span><span class="c1">// バージョンがインクリメント</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;異なるバージョンで更新すると楽観ロック例外が発生する&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">throwsExceptionWhenVersionMismatch</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createTestJournal</span><span class="p">(</span><span class="s">&quot;J0002&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// ユーザーAが取得</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journalA</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0002&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="c1">// ユーザーBが取得</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journalB</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0002&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>

<span class="w">            </span><span class="c1">// ユーザーAが更新（成功）</span>
<span class="w">            </span><span class="n">journalA</span><span class="p">.</span><span class="na">setDepartmentCode</span><span class="p">(</span><span class="s">&quot;DEPT-A&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">journalA</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act &amp; Assert: ユーザーBが古いバージョンで更新（失敗）</span>
<span class="w">            </span><span class="n">journalB</span><span class="p">.</span><span class="na">setDepartmentCode</span><span class="p">(</span><span class="s">&quot;DEPT-B&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">journalB</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">OptimisticLockException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">hasMessageContaining</span><span class="p">(</span><span class="s">&quot;他のユーザーによって更新されています&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;削除済みデータを更新すると楽観ロック例外が発生する&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">throwsExceptionWhenAlreadyDeleted</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Arrange</span>
<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">journal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">createTestJournal</span><span class="p">(</span><span class="s">&quot;J0003&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">journal</span><span class="p">);</span>

<span class="w">            </span><span class="kd">var</span><span class="w"> </span><span class="n">fetched</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">findByVoucherNumber</span><span class="p">(</span><span class="s">&quot;J0003&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="s">&quot;J0003&quot;</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Act &amp; Assert</span>
<span class="w">            </span><span class="n">assertThatThrownBy</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">journalRepository</span><span class="p">.</span><span class="na">update</span><span class="p">(</span><span class="n">fetched</span><span class="p">))</span>
<span class="w">                    </span><span class="p">.</span><span class="na">isInstanceOf</span><span class="p">(</span><span class="n">OptimisticLockException</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">                    </span><span class="p">.</span><span class="na">hasMessageContaining</span><span class="p">(</span><span class="s">&quot;既に削除されています&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Journal</span><span class="w"> </span><span class="nf">createTestJournal</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">voucherNumber</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">debitDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">DEBIT</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;11110&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">creditDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDebitCreditDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">debitCreditType</span><span class="p">(</span><span class="n">DebitCreditType</span><span class="p">.</span><span class="na">CREDIT</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">accountCode</span><span class="p">(</span><span class="s">&quot;41100&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">amount</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">BigDecimal</span><span class="p">(</span><span class="s">&quot;100000&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="kd">var</span><span class="w"> </span><span class="n">journalDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JournalDetail</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineNumber</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">lineSummary</span><span class="p">(</span><span class="s">&quot;テスト仕訳&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">debitCreditDetails</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">debitDetail</span><span class="p">,</span><span class="w"> </span><span class="n">creditDetail</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Journal</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
<span class="w">                </span><span class="p">.</span><span class="na">journalVoucherNumber</span><span class="p">(</span><span class="n">voucherNumber</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">postingDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">2024</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">entryDate</span><span class="p">(</span><span class="n">LocalDate</span><span class="p">.</span><span class="na">now</span><span class="p">())</span>
<span class="w">                </span><span class="p">.</span><span class="na">closingJournalFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">singleEntryFlag</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">voucherType</span><span class="p">(</span><span class="n">JournalVoucherType</span><span class="p">.</span><span class="na">NORMAL</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">periodicPostingFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">departmentCode</span><span class="p">(</span><span class="s">&quot;DEPT-001&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">redSlipFlag</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="na">details</span><span class="p">(</span><span class="n">List</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">journalDetail</span><span class="p">))</span>
<span class="w">                </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>

</details>

<h4 id="_21">楽観ロックのベストプラクティス<a class="headerlink" href="#_21" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ポイント</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>バージョンカラム</strong></td>
<td>INTEGER 型で十分（オーバーフローは実用上問題なし）</td>
</tr>
<tr>
<td><strong>WHERE 条件</strong></td>
<td>必ず <code>AND "バージョン" = #{version}</code> を含める</td>
</tr>
<tr>
<td><strong>インクリメント</strong></td>
<td><code>"バージョン" = "バージョン" + 1</code> でアトミックに更新</td>
</tr>
<tr>
<td><strong>例外処理</strong></td>
<td>更新件数が0の場合は楽観ロック例外をスロー</td>
</tr>
<tr>
<td><strong>リトライ</strong></td>
<td>必要に応じて再取得・再更新のリトライロジックを実装</td>
</tr>
<tr>
<td><strong>3層構造の考慮</strong></td>
<td>仕訳は通常ヘッダ単位でロック、明細の個別ロックは必要に応じて追加</td>
</tr>
</tbody>
</table>
<h3 id="3">3層構造におけるリレーションと整合性<a class="headerlink" href="#3" title="Permanent link">&para;</a></h3>
<p>仕訳データは3層構造（仕訳 → 仕訳明細 → 仕訳貸借明細）を持つため、更新時の整合性確保が重要です。</p>
<h4 id="_22">更新パターン<a class="headerlink" href="#_22" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>パターン</th>
<th>説明</th>
<th>推奨</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ヘッダ単位ロック</strong></td>
<td>仕訳ヘッダのバージョンのみチェック</td>
<td>○ シンプルで実用的</td>
</tr>
<tr>
<td><strong>全層ロック</strong></td>
<td>仕訳・明細・貸借明細すべてのバージョンをチェック</td>
<td>△ 複雑だが厳密</td>
</tr>
<tr>
<td><strong>カスケード更新</strong></td>
<td>ヘッダ更新時に明細も一括削除・再挿入</td>
<td>△ 実装が簡単だが履歴管理に注意</td>
</tr>
</tbody>
</table>
<h4 id="_23">推奨アプローチ<a class="headerlink" href="#_23" title="Permanent link">&para;</a></h4>
<p>仕訳データは通常、伝票単位で一括編集されるため、<strong>ヘッダ単位ロック</strong>が推奨されます。明細の部分更新が必要な場合は、明細レベルのバージョンチェックを追加します。</p>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IlNFUVVFTkNFIiBoZWlnaHQ9IjU4MHB4IiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJub25lIiBzdHlsZT0id2lkdGg6MzU2cHg7aGVpZ2h0OjU4MHB4O2JhY2tncm91bmQ6I0ZGRkZGRjsiIHZlcnNpb249IjEuMSIgdmlld0JveD0iMCAwIDM1NiA1ODAiIHdpZHRoPSIzNTZweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjAxODE7JiMzNTM3OTsmIzI2MzU2OyYjMjYwMzI7JiMxMjM5ODsmIzI3MDA1OyYjMzUyNTE7JiMxMjUyNTsmIzEyNDgzOyYjMTI0NjM7JiMxMjUwMTsmIzEyNTI1OyYjMTI1NDA7PC90aXRsZT48ZGVmcy8+PGc+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGZvbnQtd2VpZ2h0PSJib2xkIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE4MS45OTkyIiB4PSI4MC45NjIxIiB5PSIyNy45OTUxIj4mIzIwMTgxOyYjMzUzNzk7JiMyNjM1NjsmIzI2MDMyOyYjMTIzOTg7JiMyNzAwNTsmIzM1MjUxOyYjMTI1MjU7JiMxMjQ4MzsmIzEyNDYzOyYjMTI1MDE7JiMxMjUyNTsmIzEyNTQwOzwvdGV4dD48ZyBjbGFzcz0icGFydGljaXBhbnQtbGlmZWxpbmUiIGRhdGEtZW50aXR5LXVpZD0icGFydDEiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi5BIiBpZD0icGFydDEtbGlmZWxpbmUiPjxnPjx0aXRsZT4uLi4uQTwvdGl0bGU+PHJlY3QgZmlsbD0iIzAwMDAwMCIgZmlsbC1vcGFjaXR5PSIwLjAwMDAwIiBoZWlnaHQ9IjM4MS40NjA5IiB3aWR0aD0iOCIgeD0iMzYuNzg4NSIgeT0iMTE4LjU5MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSI0MCIgeDI9IjQwIiB5MT0iMTE4LjU5MzgiIHkyPSI1MDAuMDU0NyIvPjwvZz48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50LWxpZmVsaW5lIiBkYXRhLWVudGl0eS11aWQ9InBhcnQyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uQiIgaWQ9InBhcnQyLWxpZmVsaW5lIj48Zz48dGl0bGU+Li4uLkI8L3RpdGxlPjxyZWN0IGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wMDAwMCIgaGVpZ2h0PSIzODEuNDYwOSIgd2lkdGg9IjgiIHg9IjExOC4zNzkiIHk9IjExOC41OTM4Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7c3Ryb2tlLWRhc2hhcnJheTo1LDU7IiB4MT0iMTIxLjU3NjkiIHgyPSIxMjEuNTc2OSIgeTE9IjExOC41OTM4IiB5Mj0iNTAwLjA1NDciLz48L2c+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudC1saWZlbGluZSIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MyIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iREIiIGlkPSJwYXJ0My1saWZlbGluZSI+PGc+PHRpdGxlPkRCPC90aXRsZT48cmVjdCBmaWxsPSIjMDAwMDAwIiBmaWxsLW9wYWNpdHk9IjAuMDAwMDAiIGhlaWdodD0iMzgxLjQ2MDkiIHdpZHRoPSI4IiB4PSIzMTcuOTIzNSIgeT0iMTE4LjU5MzgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTtzdHJva2UtZGFzaGFycmF5OjUsNTsiIHgxPSIzMjEuOTIzNSIgeDI9IjMyMS45MjM1IiB5MT0iMTE4LjU5MzgiIHkyPSI1MDAuMDU0NyIvPjwvZz48L2c+PGcgY2xhc3M9InBhcnRpY2lwYW50IHBhcnRpY2lwYW50LWhlYWQiIGRhdGEtZW50aXR5LXVpZD0icGFydDEiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi5BIiBpZD0icGFydDEtaGVhZCI+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjUuNTc2OSIgeD0iNSIgeT0iMTE1LjI5MiI+JiMxMjUxODsmIzEyNTQwOyYjMTI0NzA7JiMxMjU0MDtBPC90ZXh0PjxlbGxpcHNlIGN4PSI0MC43ODg1IiBjeT0iNTAuNzk2OSIgZmlsbD0iI0UyRTJGMCIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNDAuNzg4NSw1OC43OTY5IEw0MC43ODg1LDg1Ljc5NjkgTTI3Ljc4ODUsNjYuNzk2OSBMNTMuNzg4NSw2Ni43OTY5IE00MC43ODg1LDg1Ljc5NjkgTDI3Ljc4ODUsMTAwLjc5NjkgTTQwLjc4ODUsODUuNzk2OSBMNTMuNzg4NSwxMDAuNzk2OSIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC10YWlsIiBkYXRhLWVudGl0eS11aWQ9InBhcnQxIiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uQSIgaWQ9InBhcnQxLXRhaWwiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY1LjU3NjkiIHg9IjUiIHk9IjUxMi4wNDk4Ij4mIzEyNTE4OyYjMTI1NDA7JiMxMjQ3MDsmIzEyNTQwO0E8L3RleHQ+PGVsbGlwc2UgY3g9IjQwLjc4ODUiIGN5PSI1MjMuODUxNiIgZmlsbD0iI0UyRTJGMCIgcng9IjgiIHJ5PSI4IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiLz48cGF0aCBkPSJNNDAuNzg4NSw1MzEuODUxNiBMNDAuNzg4NSw1NTguODUxNiBNMjcuNzg4NSw1MzkuODUxNiBMNTMuNzg4NSw1MzkuODUxNiBNNDAuNzg4NSw1NTguODUxNiBMMjcuNzg4NSw1NzMuODUxNiBNNDAuNzg4NSw1NTguODUxNiBMNTMuNzg4NSw1NzMuODUxNiIgZmlsbD0ibm9uZSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PC9nPjxnIGNsYXNzPSJwYXJ0aWNpcGFudCBwYXJ0aWNpcGFudC1oZWFkIiBkYXRhLWVudGl0eS11aWQ9InBhcnQyIiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uQiIgaWQ9InBhcnQyLWhlYWQiPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY1LjYwNDIiIHg9Ijg2LjU3NjkiIHk9IjExNS4yOTIiPiYjMTI1MTg7JiMxMjU0MDsmIzEyNDcwOyYjMTI1NDA7QjwvdGV4dD48ZWxsaXBzZSBjeD0iMTIyLjM3OSIgY3k9IjUwLjc5NjkiIGZpbGw9IiNFMkUyRjAiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEyMi4zNzksNTguNzk2OSBMMTIyLjM3OSw4NS43OTY5IE0xMDkuMzc5LDY2Ljc5NjkgTDEzNS4zNzksNjYuNzk2OSBNMTIyLjM3OSw4NS43OTY5IEwxMDkuMzc5LDEwMC43OTY5IE0xMjIuMzc5LDg1Ljc5NjkgTDEzNS4zNzksMTAwLjc5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MiIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLkIiIGlkPSJwYXJ0Mi10YWlsIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI2NS42MDQyIiB4PSI4Ni41NzY5IiB5PSI1MTIuMDQ5OCI+JiMxMjUxODsmIzEyNTQwOyYjMTI0NzA7JiMxMjU0MDtCPC90ZXh0PjxlbGxpcHNlIGN4PSIxMjIuMzc5IiBjeT0iNTIzLjg1MTYiIGZpbGw9IiNFMkUyRjAiIHJ4PSI4IiByeT0iOCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTEyMi4zNzksNTMxLjg1MTYgTDEyMi4zNzksNTU4Ljg1MTYgTTEwOS4zNzksNTM5Ljg1MTYgTDEzNS4zNzksNTM5Ljg1MTYgTTEyMi4zNzksNTU4Ljg1MTYgTDEwOS4zNzksNTczLjg1MTYgTTEyMi4zNzksNTU4Ljg1MTYgTDEzNS4zNzksNTczLjg1MTYiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtaGVhZCIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MyIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iREIiIGlkPSJwYXJ0My1oZWFkIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMC4zODQ4IiB4PSIzMDguNzMxMSIgeT0iMTE1LjI5MiI+REI8L3RleHQ+PHBhdGggZD0iTTMwMy45MjM1LDY2LjI5NjkgQzMwMy45MjM1LDU2LjI5NjkgMzIxLjkyMzUsNTYuMjk2OSAzMjEuOTIzNSw1Ni4yOTY5IEMzMjEuOTIzNSw1Ni4yOTY5IDMzOS45MjM1LDU2LjI5NjkgMzM5LjkyMzUsNjYuMjk2OSBMMzM5LjkyMzUsOTIuMjk2OSBDMzM5LjkyMzUsMTAyLjI5NjkgMzIxLjkyMzUsMTAyLjI5NjkgMzIxLjkyMzUsMTAyLjI5NjkgQzMyMS45MjM1LDEwMi4yOTY5IDMwMy45MjM1LDEwMi4yOTY5IDMwMy45MjM1LDkyLjI5NjkgTDMwMy45MjM1LDY2LjI5NjkiIGZpbGw9IiNFMkUyRjAiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjxwYXRoIGQ9Ik0zMDMuOTIzNSw2Ni4yOTY5IEMzMDMuOTIzNSw3Ni4yOTY5IDMyMS45MjM1LDc2LjI5NjkgMzIxLjkyMzUsNzYuMjk2OSBDMzIxLjkyMzUsNzYuMjk2OSAzMzkuOTIzNSw3Ni4yOTY5IDMzOS45MjM1LDY2LjI5NjkiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjwvZz48ZyBjbGFzcz0icGFydGljaXBhbnQgcGFydGljaXBhbnQtdGFpbCIgZGF0YS1lbnRpdHktdWlkPSJwYXJ0MyIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iREIiIGlkPSJwYXJ0My10YWlsIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyMC4zODQ4IiB4PSIzMDguNzMxMSIgeT0iNTEyLjA0OTgiPkRCPC90ZXh0PjxwYXRoIGQ9Ik0zMDMuOTIzNSw1MjUuMzUxNiBDMzAzLjkyMzUsNTE1LjM1MTYgMzIxLjkyMzUsNTE1LjM1MTYgMzIxLjkyMzUsNTE1LjM1MTYgQzMyMS45MjM1LDUxNS4zNTE2IDMzOS45MjM1LDUxNS4zNTE2IDMzOS45MjM1LDUyNS4zNTE2IEwzMzkuOTIzNSw1NTEuMzUxNiBDMzM5LjkyMzUsNTYxLjM1MTYgMzIxLjkyMzUsNTYxLjM1MTYgMzIxLjkyMzUsNTYxLjM1MTYgQzMyMS45MjM1LDU2MS4zNTE2IDMwMy45MjM1LDU2MS4zNTE2IDMwMy45MjM1LDU1MS4zNTE2IEwzMDMuOTIzNSw1MjUuMzUxNiIgZmlsbD0iI0UyRTJGMCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7Ii8+PHBhdGggZD0iTTMwMy45MjM1LDUyNS4zNTE2IEMzMDMuOTIzNSw1MzUuMzUxNiAzMjEuOTIzNSw1MzUuMzUxNiAzMjEuOTIzNSw1MzUuMzUxNiBDMzIxLjkyMzUsNTM1LjM1MTYgMzM5LjkyMzUsNTM1LjM1MTYgMzM5LjkyMzUsNTI1LjM1MTYiIGZpbGw9Im5vbmUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIvPjwvZz48cmVjdCBmaWxsPSIjRUVFRUVFIiBoZWlnaHQ9IjMiIHN0eWxlPSJzdHJva2U6I0VFRUVFRTtzdHJva2Utd2lkdGg6MTsiIHdpZHRoPSIzNDQuOTIzNSIgeD0iMCIgeT0iMTQ5LjE2MDIiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMCIgeDI9IjM0NC45MjM1IiB5MT0iMTQ5LjE2MDIiIHkyPSIxNDkuMTYwMiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSIwIiB4Mj0iMzQ0LjkyMzUiIHkxPSIxNTIuMTYwMiIgeTI9IjE1Mi4xNjAyIi8+PHJlY3QgZmlsbD0iI0VFRUVFRSIgaGVpZ2h0PSIyMy4xMzI4IiBzdHlsZT0ic3Ryb2tlOiMwMDAwMDA7c3Ryb2tlLXdpZHRoOjI7IiB3aWR0aD0iOTYuNTI2IiB4PSIxMjQuMTk4NyIgeT0iMTM4LjU5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNzguMDAwMSIgeD0iMTMwLjE5ODciIHk9IjE1NC42NjA2Ij4mIzIxNDYyOyYjMjQ0NzE7JiMxMjUwMTsmIzEyNDU1OyYjMTI1NDA7JiMxMjQ3NDs8L3RleHQ+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtZW50aXR5LTE9InBhcnQxIiBkYXRhLWVudGl0eS0yPSJwYXJ0MyIgaWQ9Im1zZzEiPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMzA5LjkyMzUsMTg4Ljg1OTQsMzE5LjkyMzUsMTkyLjg1OTQsMzA5LjkyMzUsMTk2Ljg1OTQsMzEzLjkyMzUsMTkyLjg1OTQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDAuNzg4NSIgeDI9IjMxNS45MjM1IiB5MT0iMTkyLjg1OTQiIHkyPSIxOTIuODU5NCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijg4LjkxOCIgeD0iNDcuNzg4NSIgeT0iMTg3Ljc5MzUiPiYjMjAxODE7JiMzNTM3OTtKMDAwMSYjMjE0NjI7JiMyNDQ3MTs8L3RleHQ+PC9nPjxnIGNsYXNzPSJtZXNzYWdlIiBkYXRhLWVudGl0eS0xPSJwYXJ0MyIgZGF0YS1lbnRpdHktMj0icGFydDEiIGlkPSJtc2cyIj48cG9seWdvbiBmaWxsPSIjMTgxODE4IiBwb2ludHM9IjUxLjc4ODUsMjE3Ljk5MjIsNDEuNzg4NSwyMjEuOTkyMiw1MS43ODg1LDIyNS45OTIyLDQ3Ljc4ODUsMjIxLjk5MjIiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheToyLDI7IiB4MT0iNDUuNzg4NSIgeDI9IjMyMC45MjM1IiB5MT0iMjIxLjk5MjIiIHkyPSIyMjEuOTkyMiIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyMi4xMDk5IiB4PSI1Ny43ODg1IiB5PSIyMTYuOTI2MyI+Sm91cm5hbCh2ZXJzaW9uPTEpPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDIiIGRhdGEtZW50aXR5LTI9InBhcnQzIiBpZD0ibXNnMyI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzMDkuOTIzNSwyNDcuMTI1LDMxOS45MjM1LDI1MS4xMjUsMzA5LjkyMzUsMjU1LjEyNSwzMTMuOTIzNSwyNTEuMTI1IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMi4zNzkiIHgyPSIzMTUuOTIzNSIgeTE9IjI1MS4xMjUiIHkyPSIyNTEuMTI1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODguOTE4IiB4PSIxMjkuMzc5IiB5PSIyNDYuMDU5MSI+JiMyMDE4MTsmIzM1Mzc5O0owMDAxJiMyMTQ2MjsmIzI0NDcxOzwvdGV4dD48L2c+PGcgY2xhc3M9Im1lc3NhZ2UiIGRhdGEtZW50aXR5LTE9InBhcnQzIiBkYXRhLWVudGl0eS0yPSJwYXJ0MiIgaWQ9Im1zZzQiPjxwb2x5Z29uIGZpbGw9IiMxODE4MTgiIHBvaW50cz0iMTMzLjM3OSwyNzYuMjU3OCwxMjMuMzc5LDI4MC4yNTc4LDEzMy4zNzksMjg0LjI1NzgsMTI5LjM3OSwyODAuMjU3OCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTtzdHJva2UtZGFzaGFycmF5OjIsMjsiIHgxPSIxMjcuMzc5IiB4Mj0iMzIwLjkyMzUiIHkxPSIyODAuMjU3OCIgeTI9IjI4MC4yNTc4Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIyLjEwOTkiIHg9IjEzOS4zNzkiIHk9IjI3NS4xOTE5Ij5Kb3VybmFsKHZlcnNpb249MSk8L3RleHQ+PC9nPjxyZWN0IGZpbGw9IiNFRUVFRUUiIGhlaWdodD0iMyIgc3R5bGU9InN0cm9rZTojRUVFRUVFO3N0cm9rZS13aWR0aDoxOyIgd2lkdGg9IjM0NC45MjM1IiB4PSIwIiB5PSIzMDguODI0MiIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MTsiIHgxPSIwIiB4Mj0iMzQ0LjkyMzUiIHkxPSIzMDguODI0MiIgeTI9IjMwOC44MjQyIi8+PGxpbmUgc3R5bGU9InN0cm9rZTojMDAwMDAwO3N0cm9rZS13aWR0aDoxOyIgeDE9IjAiIHgyPSIzNDQuOTIzNSIgeTE9IjMxMS44MjQyIiB5Mj0iMzExLjgyNDIiLz48cmVjdCBmaWxsPSIjRUVFRUVFIiBoZWlnaHQ9IjIzLjEzMjgiIHN0eWxlPSJzdHJva2U6IzAwMDAwMDtzdHJva2Utd2lkdGg6MjsiIHdpZHRoPSI5Ni41MjYiIHg9IjEyNC4xOTg3IiB5PSIyOTguMjU3OCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3OC4wMDAxIiB4PSIxMzAuMTk4NyIgeT0iMzE0LjMyNDciPiYjMjYzNTY7JiMyNjAzMjsmIzEyNTAxOyYjMTI0NTU7JiMxMjU0MDsmIzEyNDc0OzwvdGV4dD48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDEiIGRhdGEtZW50aXR5LTI9InBhcnQzIiBpZD0ibXNnNSI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzMDkuOTIzNSwzNDguNTIzNCwzMTkuOTIzNSwzNTIuNTIzNCwzMDkuOTIzNSwzNTYuNTIzNCwzMTMuOTIzNSwzNTIuNTIzNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI0MC43ODg1IiB4Mj0iMzE1LjkyMzUiIHkxPSIzNTIuNTIzNCIgeTI9IjM1Mi41MjM0Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc1LjU0NDQiIHg9IjQ3Ljc4ODUiIHk9IjM0Ny40NTc1Ij5VUERBVEUgV0hFUkUgdmVyc2lvbj0xPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDMiIGRhdGEtZW50aXR5LTI9InBhcnQxIiBpZD0ibXNnNiI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSI1MS43ODg1LDM3Ny42NTYzLDQxLjc4ODUsMzgxLjY1NjMsNTEuNzg4NSwzODUuNjU2Myw0Ny43ODg1LDM4MS42NTYzIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjQ1Ljc4ODUiIHgyPSIzMjAuOTIzNSIgeTE9IjM4MS42NTYzIiB5Mj0iMzgxLjY1NjMiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIxMzMuMDUzMyIgeD0iNTcuNzg4NSIgeT0iMzc2LjU5MDMiPiYjMjYzNTY7JiMyNjAzMjsmIzI1MTA0OyYjMjExNTE7ICh2ZXJzaW9uPTIpPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDIiIGRhdGEtZW50aXR5LTI9InBhcnQzIiBpZD0ibXNnNyI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIzMDkuOTIzNSw0MDYuNzg5MSwzMTkuOTIzNSw0MTAuNzg5MSwzMDkuOTIzNSw0MTQuNzg5MSwzMTMuOTIzNSw0MTAuNzg5MSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxMjIuMzc5IiB4Mj0iMzE1LjkyMzUiIHkxPSI0MTAuNzg5MSIgeTI9IjQxMC43ODkxIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTc1LjU0NDQiIHg9IjEyOS4zNzkiIHk9IjQwNS43MjMxIj5VUERBVEUgV0hFUkUgdmVyc2lvbj0xPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDMiIGRhdGEtZW50aXR5LTI9InBhcnQyIiBpZD0ibXNnOCI+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMzMuMzc5LDQzNS45MjE5LDEyMy4zNzksNDM5LjkyMTksMTMzLjM3OSw0NDMuOTIxOSwxMjkuMzc5LDQzOS45MjE5IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6MiwyOyIgeDE9IjEyNy4zNzkiIHgyPSIzMjAuOTIzNSIgeTE9IjQzOS45MjE5IiB5Mj0iNDM5LjkyMTkiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMyIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI3MS4xNjM2IiB4PSIxMzkuMzc5IiB5PSI0MzQuODU2Ij4mIzI2MzU2OyYjMjYwMzI7JiMyMDIxNDsmIzI1OTY4Oz0wPC90ZXh0PjwvZz48ZyBjbGFzcz0ibWVzc2FnZSIgZGF0YS1lbnRpdHktMT0icGFydDIiIGRhdGEtZW50aXR5LTI9InBhcnQyIiBpZD0ibXNnOSI+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjEyMi4zNzkiIHgyPSIxNjQuMzc5IiB5MT0iNDY5LjA1NDciIHkyPSI0NjkuMDU0NyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNjQuMzc5IiB4Mj0iMTY0LjM3OSIgeTE9IjQ2OS4wNTQ3IiB5Mj0iNDgyLjA1NDciLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIzLjM3OSIgeDI9IjE2NC4zNzkiIHkxPSI0ODIuMDU0NyIgeTI9IjQ4Mi4wNTQ3Ii8+PHBvbHlnb24gZmlsbD0iIzE4MTgxOCIgcG9pbnRzPSIxMzMuMzc5LDQ3OC4wNTQ3LDEyMy4zNzksNDgyLjA1NDcsMTMzLjM3OSw0ODYuMDU0NywxMjkuMzc5LDQ4Mi4wNTQ3IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTYwLjE3NjgiIHg9IjEyOS4zNzkiIHk9IjQ2My45ODg4Ij5PcHRpbWlzdGljTG9ja0V4Y2VwdGlvbjwvdGV4dD48L2c+PD9wbGFudHVtbC1zcmMgQXlhaW9LYkxVQjl4d2VpTGN2X0R0bDlpc2VSN1pVa1VCVHR4T2pkY255cmg3cFN0RnN2UV94WHZBZll6WHVpaENSYWFscVpYU1ZDbzhFem5xcE9Xd09YNXA4YWg5UjRhQ0ljbkU1TjFuT2NCb3pQTXVNZF9qQVZ4ZmVDQ1FiZUVMaFBCbVRRTTJ5S1MxTHF4ZTZlNUF3WFpsMG1DMzBtWHNoWTBtaGYwTUxKYkxXZlUtUUw1VU9hdjZjTWZIU01QLU5jc1hmZWU5WmdIUGc4SlRYRDFoZVM2MzU2azNtcm1TR25uTEdadFMwcm9MTzJSV3lpQjQ5RVZUS251c1pMVjBNd2o0VDFReDN1WHRkR2RrRWJGVGN6eERkTTNoRzZjYVVaZ19HakFDZENwWXFpb2F0dG9heERUQXY5SldHQnZVRzAwPz48L2c+PC9zdmc+" class="uml" alt="uml diagram" title="" /></p>
<hr />
<h2 id="16_1">第16章のまとめ<a class="headerlink" href="#16_1" title="Permanent link">&para;</a></h2>
<h3 id="_24">作成したテーブル<a class="headerlink" href="#_24" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>テーブル名</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>仕訳</code></td>
<td>仕訳伝票のヘッダ情報（起票日、入力日、各種フラグ）</td>
</tr>
<tr>
<td><code>仕訳明細</code></td>
<td>仕訳の行単位の情報（行摘要）</td>
</tr>
<tr>
<td><code>仕訳貸借明細</code></td>
<td>借方・貸方の詳細（勘定科目、金額、補助情報）</td>
</tr>
</tbody>
</table>
<h3 id="er_1">ER図<a class="headerlink" href="#er_1" title="Permanent link">&para;</a></h3>
<p><img src="data:image/svg+xml;base64,PD9wbGFudHVtbCAxLjIwMjYuMD8+PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBjb250ZW50U3R5bGVUeXBlPSJ0ZXh0L2NzcyIgZGF0YS1kaWFncmFtLXR5cGU9IkNMQVNTIiBoZWlnaHQ9IjEwNjBweCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ibm9uZSIgc3R5bGU9IndpZHRoOjMxOXB4O2hlaWdodDoxMDYwcHg7YmFja2dyb3VuZDojRkZGRkZGOyIgdmVyc2lvbj0iMS4xIiB2aWV3Qm94PSIwIDAgMzE5IDEwNjAiIHdpZHRoPSIzMTlweCIgem9vbUFuZFBhbj0ibWFnbmlmeSI+PHRpdGxlPiYjMjAxODE7JiMzNTM3OTsmIzEyNDg2OyYjMTI1NDA7JiMxMjUwMjsmIzEyNTIzOyBFUiYjMjIyNTk7PC90aXRsZT48ZGVmcy8+PGc+PGcgY2xhc3M9InRpdGxlIiBkYXRhLXNvdXJjZS1saW5lPSIxIj48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgZm9udC13ZWlnaHQ9ImJvbGQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTIzLjIxNzMiIHg9IjkwLjk5MzIiIHk9IjIyLjk5NTEiPiYjMjAxODE7JiMzNTM3OTsmIzEyNDg2OyYjMTI1NDA7JiMxMjUwMjsmIzEyNTIzOyBFUiYjMjIyNTk7PC90ZXh0PjwvZz48IS0tY2xhc3MgPz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLiIgZGF0YS1zb3VyY2UtbGluZT0iMyIgaWQ9ImVudDAwMDIiPjxyZWN0IGZpbGw9IiNGMUYxRjEiIGhlaWdodD0iMjU5Ljg1OTQiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjEzNS4yMDM3IiB4PSIxNTEiIHk9IjQ0LjI5NjkiLz48ZWxsaXBzZSBjeD0iMjAwLjM1MTkiIGN5PSI2MC4yOTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yMDQuNDYxMyw2Ni4yOTY5IEwxOTYuNzQyNiw2Ni4yOTY5IEwxOTYuNzQyNiw1My45MDYzIEwyMDQuNDYxMyw1My45MDYzIEwyMDQuNDYxMyw1Ni4wNjI1IEwxOTkuMTk1Nyw1Ni4wNjI1IEwxOTkuMTk1Nyw1OC43MzQ0IEwyMDMuOTYxMyw1OC43MzQ0IEwyMDMuOTYxMyw2MC44OTA2IEwxOTkuMTk1Nyw2MC44OTA2IEwxOTkuMTk1Nyw2NC4xNDA2IEwyMDQuNDYxMyw2NC4xNDA2IEwyMDQuNDYxMyw2Ni4yOTY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjcuOTk5OSIgeD0iMjIwLjg1MTkiIHk9IjY1LjE0MzYiPiYjMjAxODE7JiMzNTM3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iMTUyIiB4Mj0iMjg1LjIwMzciIHkxPSI3Ni4yOTY5IiB5Mj0iNzYuMjk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEyMy4yMDM3IiB4PSIxNTciIHk9IjkzLjI5MiI+JiMyMDE4MTsmIzM1Mzc5OyYjMjAyNTM7JiMzMTA4MDsmIzMwMDU4OyYjMjE0OTU7ICYjMTcxO1BLJiMxODc7PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNTIiIHgyPSIyODUuMjAzNyIgeTE9IjEwMC41OTM4IiB5Mj0iMTAwLjU5MzgiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSIxNTciIHk9IjExNy41ODg5Ij4mIzM2MjE1OyYjMzEwODA7JiMyNjA4NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNDEuOTk5OCIgeD0iMTU3IiB5PSIxMzMuODg1NyI+JiMyMDgzNzsmIzIxMTQ3OyYjMjYwODU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjE1NyIgeT0iMTUwLjE4MjYiPiYjMjc3NzA7JiMzMTYzOTsmIzIwMTgxOyYjMzUzNzk7JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE1NyIgeT0iMTY2LjQ3OTUiPiYjMjEzMzY7JiMyNTM5MTsmIzEyNTAxOyYjMTI1MjE7JiMxMjQ2NDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMTU3IiB5PSIxODIuNzc2NCI+JiMyMDE4MTsmIzM1Mzc5OyYjMjAyNTM7JiMzMTA4MDsmIzIxMzA2OyYjMjA5OTg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9Ijk3Ljk5OTYiIHg9IjE1NyIgeT0iMTk5LjA3MzIiPiYjMjM0NTA7JiMyNjM5OTsmIzM1MzM2OyYjMTk5Nzg7JiMxMjUwMTsmIzEyNTIxOyYjMTI0NjQ7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE1NyIgeT0iMjE1LjM3MDEiPiYjMzEwMzg7JiMyMTcyOTsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iMTU3IiB5PSIyMzEuNjY3Ij4mIzM3MDk2OyYjMzgyNzI7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjE1NyIgeT0iMjQ3Ljk2MzkiPiYjMzYxOTY7JiMyMDI1MzsmIzEyNTAxOyYjMTI1MjE7JiMxMjQ2NDs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iMTU3IiB5PSIyNjQuMjYwNyI+JiMzNjE5NjsmIzQwNjU4OyYjMjAyNTM7JiMzMTA4MDsmIzMwMDU4OyYjMjE0OTU7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjE1NyIgeT0iMjgwLjU1NzYiPiYjMjAzMTY7JiMyNTEwNDsmIzI2MDg1OyYjMjYxNzg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjE1NyIgeT0iMjk2Ljg1NDUiPiYjMjYzNTY7JiMyNjAzMjsmIzI2MDg1OyYjMjYxNzg7PC90ZXh0PjwvZz48IS0tY2xhc3MgPz8/Py0tPjxnIGNsYXNzPSJlbnRpdHkiIGRhdGEtcXVhbGlmaWVkLW5hbWU9Ii4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjIwIiBpZD0iZW50MDAwMyI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIxMjkuNDg0NCIgcng9IjIuNSIgcnk9IjIuNSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB3aWR0aD0iMTU2Ljg4NzMiIHg9IjQyLjE2IiB5PSIzODEuMTU2OSIvPjxlbGxpcHNlIGN4PSI4OC4zNTM4IiBjeT0iMzk3LjE1NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTkyLjQ2MzIsNDAzLjE1NjkgTDg0Ljc0NDQsNDAzLjE1NjkgTDg0Ljc0NDQsMzkwLjc2NjMgTDkyLjQ2MzIsMzkwLjc2NjMgTDkyLjQ2MzIsMzkyLjkyMjUgTDg3LjE5NzUsMzkyLjkyMjUgTDg3LjE5NzUsMzk1LjU5NDQgTDkxLjk2MzIsMzk1LjU5NDQgTDkxLjk2MzIsMzk3Ljc1MDYgTDg3LjE5NzUsMzk3Ljc1MDYgTDg3LjE5NzUsNDAxLjAwMDYgTDkyLjQ2MzIsNDAxLjAwMDYgTDkyLjQ2MzIsNDAzLjE1NjkgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSIxMDguODUzOCIgeT0iNDAyLjAwMzYiPiYjMjAxODE7JiMzNTM3OTsmIzI2MTI2OyYjMzIwNDg7PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgeDE9IjQzLjE2IiB4Mj0iMTk4LjA0NzMiIHkxPSI0MTMuMTU2OSIgeTI9IjQxMy4xNTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTQ0Ljg4NzMiIHg9IjQ4LjE2IiB5PSI0MzAuMTUyIj4mIzIwMTgxOyYjMzUzNzk7JiMyMDI1MzsmIzMxMDgwOyYjMzAwNTg7JiMyMTQ5NTsgJiMxNzE7UEssRksmIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTA5LjIwMzgiIHg9IjQ4LjE2IiB5PSI0NDYuNDQ4OSI+JiMyMDE4MTsmIzM1Mzc5OyYjMzQ4OTI7JiMzMDA1ODsmIzIxNDk1OyAmIzE3MTtQSyYjMTg3OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iNDMuMTYiIHgyPSIxOTguMDQ3MyIgeTE9IjQ1My43NTA2IiB5Mj0iNDUzLjc1MDYiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI0MS45OTk4IiB4PSI0OC4xNiIgeT0iNDcwLjc0NTciPiYjMzQ4OTI7JiMyNTY4ODsmIzM1MjAxOzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI1NS45OTk4IiB4PSI0OC4xNiIgeT0iNDg3LjA0MjYiPiYjMjAzMTY7JiMyNTEwNDsmIzI2MDg1OyYjMjYxNzg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjQ4LjE2IiB5PSI1MDMuMzM5NSI+JiMyNjM1NjsmIzI2MDMyOyYjMjYwODU7JiMyNjE3ODs8L3RleHQ+PC9nPjwhLS1jbGFzcyA/Pz8/Pz8tLT48ZyBjbGFzcz0iZW50aXR5IiBkYXRhLXF1YWxpZmllZC1uYW1lPSIuLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjI5IiBpZD0iZW50MDAwNCI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSIzMDguNzUiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE1Ni44ODczIiB4PSI0Mi4xNiIgeT0iNTg3LjY0NjkiLz48ZWxsaXBzZSBjeD0iNzUuNTU5NSIgY3k9IjYwMy42NDY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik03OS42Njg4LDYwOS42NDY5IEw3MS45NTAxLDYwOS42NDY5IEw3MS45NTAxLDU5Ny4yNTYzIEw3OS42Njg4LDU5Ny4yNTYzIEw3OS42Njg4LDU5OS40MTI1IEw3NC40MDMyLDU5OS40MTI1IEw3NC40MDMyLDYwMi4wODQ0IEw3OS4xNjg4LDYwMi4wODQ0IEw3OS4xNjg4LDYwNC4yNDA2IEw3NC40MDMyLDYwNC4yNDA2IEw3NC40MDMyLDYwNy40OTA2IEw3OS42Njg4LDYwNy40OTA2IEw3OS42Njg4LDYwOS42NDY5IFogIiBmaWxsPSIjMDAwMDAwIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iODMuOTk5NiIgeD0iOTMuNjQ4MiIgeT0iNjA4LjQ5MzYiPiYjMjAxODE7JiMzNTM3OTsmIzM2MDI0OyYjMjA1MTE7JiMyNjEyNjsmIzMyMDQ4OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSI0My4xNiIgeDI9IjE5OC4wNDczIiB5MT0iNjE5LjY0NjkiIHkyPSI2MTkuNjQ2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjE0NC44ODczIiB4PSI0OC4xNiIgeT0iNjM2LjY0MiI+JiMyMDE4MTsmIzM1Mzc5OyYjMjAyNTM7JiMzMTA4MDsmIzMwMDU4OyYjMjE0OTU7ICYjMTcxO1BLLEZLJiMxODc7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwOS4yMDM4IiB4PSI0OC4xNiIgeT0iNjUyLjkzODkiPiYjMjAxODE7JiMzNTM3OTsmIzM0ODkyOyYjMzAwNTg7JiMyMTQ5NTsgJiMxNzE7UEsmIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM3LjIwMzciIHg9IjQ4LjE2IiB5PSI2NjkuMjM1NyI+JiMyMDE4MTsmIzM1Mzc5OyYjMzQ4OTI7JiMzNjAyNDsmIzIwNTExOyYjMjEzMDY7JiMyMDk5ODsgJiMxNzE7UEsmIzE4Nzs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjQzLjE2IiB4Mj0iMTk4LjA0NzMiIHkxPSI2NzYuNTM3NSIgeTI9IjY3Ni41Mzc1Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM2LjgxNCIgeD0iNDguMTYiIHk9IjY5My41MzI2Ij4mIzIxMjA4OyYjMjM0NTA7JiMzMTE4NTsmIzMwNDQ2OyYjMTI0Njc7JiMxMjU0MDsmIzEyNDg5OyAmIzE3MTtGSyYjMTg3OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSI0OC4xNiIgeT0iNzA5LjgyOTUiPiYjMzUwMzY7JiMyMTE2MTsmIzMxMTg1OyYjMzA0NDY7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwOC44MTQxIiB4PSI0OC4xNiIgeT0iNzI2LjEyNjQiPiYjMzcwOTY7JiMzODI3MjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsgJiMxNzE7RksmIzE4Nzs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTI1Ljk5OTUiIHg9IjQ4LjE2IiB5PSI3NDIuNDIzMiI+JiMxMjUwMzsmIzEyNTI1OyYjMTI0NzI7JiMxMjQ1NTsmIzEyNDYzOyYjMTI0ODg7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjQ4LjE2IiB5PSI3NTguNzIwMSI+JiMyMDE4MTsmIzM1Mzc5OyYjMzczMjk7JiMzODk4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDguMTYiIHk9Ijc3NS4wMTciPiYjMzY4OTA7JiMzNjAwODsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDguMTYiIHk9Ijc5MS4zMTM5Ij4mIzI4ODU4OyYjMjYzNjc7JiMxMjUyNDsmIzEyNTQwOyYjMTI0ODg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjExMS45OTk1IiB4PSI0OC4xNiIgeT0iODA3LjYxMDciPiYjMjI1MjI7JiMzNjYwMDsmIzI1NTYzOyYjMzE2Mzk7JiMyMDE4MTsmIzM1Mzc5OyYjMzczMjk7JiMzODk4OTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iNjkuOTk5NyIgeD0iNDguMTYiIHk9IjgyMy45MDc2Ij4mIzI4MDQwOyYjMzYwMjc7JiMzMTI0NjsmIzIxMzA2OyYjMjA5OTg7PC90ZXh0Pjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjU1Ljk5OTgiIHg9IjQ4LjE2IiB5PSI4NDAuMjA0NSI+JiMyODA0MDsmIzM2MDI3OyYjMzEyNDY7JiMyOTU3NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iOTcuOTk5NiIgeD0iNDguMTYiIHk9Ijg1Ni41MDE0Ij4mIzI4MDQwOyYjMzYwMjc7JiMzMTI0NjsmIzM1MzM2OyYjMzE2Mzk7JiMyMTMwNjsmIzIwOTk4OzwvdGV4dD48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSIyNy45OTk5IiB4PSI0OC4xNiIgeT0iODcyLjc5ODIiPiYjMjYzOTk7JiMyNjA4NTs8L3RleHQ+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTMuMzUwNiIgeD0iNDguMTYiIHk9Ijg4OS4wOTUxIj4uLi48L3RleHQ+PC9nPjwhLS1jbGFzcyA/Pz8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4uLiIgZGF0YS1zb3VyY2UtbGluZT0iNDkiIGlkPSJlbnQwMDA1Ij48cmVjdCBmaWxsPSIjRjFGMUYxIiBoZWlnaHQ9IjgwLjU5MzgiIHJ4PSIyLjUiIHJ5PSIyLjUiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MC41OyIgd2lkdGg9IjE0OS4yMDM3IiB4PSI3IiB5PSI5NzMuMzk2OSIvPjxlbGxpcHNlIGN4PSIzMC42NDE4IiBjeT0iOTg5LjM5NjkiIGZpbGw9IiNBREQxQjIiIHJ4PSIxMSIgcnk9IjExIiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHBhdGggZD0iTTM0Ljc1MTIsOTk1LjM5NjkgTDI3LjAzMjUsOTk1LjM5NjkgTDI3LjAzMjUsOTgzLjAwNjMgTDM0Ljc1MTIsOTgzLjAwNjMgTDM0Ljc1MTIsOTg1LjE2MjUgTDI5LjQ4NTYsOTg1LjE2MjUgTDI5LjQ4NTYsOTg3LjgzNDQgTDM0LjI1MTIsOTg3LjgzNDQgTDM0LjI1MTIsOTg5Ljk5MDYgTDI5LjQ4NTYsOTg5Ljk5MDYgTDI5LjQ4NTYsOTkzLjI0MDYgTDM0Ljc1MTIsOTkzLjI0MDYgTDM0Ljc1MTIsOTk1LjM5NjkgWiAiIGZpbGw9IiMwMDAwMDAiLz48dGV4dCBmaWxsPSIjMDAwMDAwIiBmb250LWZhbWlseT0ic2Fucy1zZXJpZiIgZm9udC1zaXplPSIxNCIgbGVuZ3RoQWRqdXN0PSJzcGFjaW5nIiB0ZXh0TGVuZ3RoPSI5Ny45OTk2IiB4PSI0Ni41NjIzIiB5PSI5OTQuMjQzNiI+JiMyMTIwODsmIzIzNDUwOyYjMzExODU7JiMzMDQ0NjsmIzEyNTEwOyYjMTI0NzM7JiMxMjQ3OTs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDowLjU7IiB4MT0iOCIgeDI9IjE1NS4yMDM3IiB5MT0iMTAwNS4zOTY5IiB5Mj0iMTAwNS4zOTY5Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTQiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMTM3LjIwMzciIHg9IjEzIiB5PSIxMDIyLjM5MiI+JiMyMTIwODsmIzIzNDUwOyYjMzExODU7JiMzMDQ0NjsmIzEyNDY3OyYjMTI1NDA7JiMxMjQ4OTsgJiMxNzE7UEsmIzE4Nzs8L3RleHQ+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjgiIHgyPSIxNTUuMjAzNyIgeTE9IjEwMjkuNjkzOCIgeTI9IjEwMjkuNjkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzLjM1MDYiIHg9IjEzIiB5PSIxMDQ2LjY4ODkiPi4uLjwvdGV4dD48L2c+PCEtLWNsYXNzID8/Pz8/LS0+PGcgY2xhc3M9ImVudGl0eSIgZGF0YS1xdWFsaWZpZWQtbmFtZT0iLi4uLi4iIGRhdGEtc291cmNlLWxpbmU9IjU1IiBpZD0iZW50MDAwNiI+PHJlY3QgZmlsbD0iI0YxRjFGMSIgaGVpZ2h0PSI4MC41OTM4IiByeD0iMi41IiByeT0iMi41IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHdpZHRoPSIxMjEuMjAzOCIgeD0iMTkxIiB5PSI5NzMuMzk2OSIvPjxlbGxpcHNlIGN4PSIyMTQuNjQxOCIgY3k9Ijk4OS4zOTY5IiBmaWxsPSIjQUREMUIyIiByeD0iMTEiIHJ5PSIxMSIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxwYXRoIGQ9Ik0yMTguNzUxMiw5OTUuMzk2OSBMMjExLjAzMjUsOTk1LjM5NjkgTDIxMS4wMzI1LDk4My4wMDYzIEwyMTguNzUxMiw5ODMuMDA2MyBMMjE4Ljc1MTIsOTg1LjE2MjUgTDIxMy40ODU2LDk4NS4xNjI1IEwyMTMuNDg1Niw5ODcuODM0NCBMMjE4LjI1MTIsOTg3LjgzNDQgTDIxOC4yNTEyLDk4OS45OTA2IEwyMTMuNDg1Niw5ODkuOTkwNiBMMjEzLjQ4NTYsOTkzLjI0MDYgTDIxOC43NTEyLDk5My4yNDA2IEwyMTguNzUxMiw5OTUuMzk2OSBaICIgZmlsbD0iIzAwMDAwMCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjY5Ljk5OTciIHg9IjIzMC41NjIzIiB5PSI5OTQuMjQzNiI+JiMzNzA5NjsmIzM4MjcyOyYjMTI1MTA7JiMxMjQ3MzsmIzEyNDc5OzwvdGV4dD48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjAuNTsiIHgxPSIxOTIiIHgyPSIzMTEuMjAzOCIgeTE9IjEwMDUuMzk2OSIgeTI9IjEwMDUuMzk2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEwOS4yMDM4IiB4PSIxOTciIHk9IjEwMjIuMzkyIj4mIzM3MDk2OyYjMzgyNzI7JiMxMjQ2NzsmIzEyNTQwOyYjMTI0ODk7ICYjMTcxO1BLJiMxODc7PC90ZXh0PjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxOTIiIHgyPSIzMTEuMjAzOCIgeTE9IjEwMjkuNjkzOCIgeTI9IjEwMjkuNjkzOCIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjE0IiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjEzLjM1MDYiIHg9IjE5NyIgeT0iMTA0Ni42ODg5Ij4uLi48L3RleHQ+PC9nPjwhLS1saW5rID8/IHRvID8/Pz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwMiIgZGF0YS1lbnRpdHktMj0iZW50MDAwMyIgZGF0YS1saW5rLXR5cGU9ImNyb3dmb290IiBkYXRhLXNvdXJjZS1saW5lPSI2MSIgaWQ9ImxuazciPjxwYXRoIGNvZGVMaW5lPSI2MSIgZD0iTTE2OC44NzY3LDMxMi4wNTU1IEMxNTkuMjQ2NywzMzguNTQ1NSAxNTguMzkzMSwzNDAuODg3NiAxNTAuMDUzMSwzNjMuODU3NiIgZmlsbD0ibm9uZSIgaWQ9IiYjMjAxODE7JiMzNTM3OTstJiMyMDE4MTsmIzM1Mzc5OyYjMjYxMjY7JiMzMjA0ODsiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTY2LjQ4NDEiIHgyPSIxNzQuMDAyNyIgeTE9IjMwNi45Mjk1IiB5Mj0iMzA5LjY2MjgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTY1LjQ1OTEiIHgyPSIxNzIuOTc3NyIgeTE9IjMwOS43NDkiIHkyPSIzMTIuNDgyMyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNjguODc2NyIgeDI9IjE3MS42MSIgeTE9IjMxMi4wNTU1IiB5Mj0iMzA0LjUzNjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTQ2LjY0MDMiIHgyPSIxNDkuNTQ5OCIgeTE9IjM3My4yNTcyIiB5Mj0iMzgyLjgyNDYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTQ2LjY0MDMiIHgyPSIxMzguMjcwMiIgeTE9IjM3My4yNTcyIiB5Mj0iMzc4LjcyOTIiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTQ2LjY0MDMiIHgyPSIxNDMuOTEiIHkxPSIzNzMuMjU3MiIgeTI9IjM4MC43NzY5Ii8+PGVsbGlwc2UgY3g9IjE0OC42ODgiIGN5PSIzNjcuNjE3NCIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjE2MS44MiIgeT0iMzQ3LjIyMzgiPiYjMjE1NDc7JiMxMjQxNjs8L3RleHQ+PC9nPjwhLS1saW5rID8/Pz8gdG8gPz8/Pz8/LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDMiIGRhdGEtZW50aXR5LTI9ImVudDAwMDQiIGRhdGEtbGluay10eXBlPSJjcm93Zm9vdCIgZGF0YS1zb3VyY2UtbGluZT0iNjIiIGlkPSJsbms4Ij48cGF0aCBjb2RlTGluZT0iNjIiIGQ9Ik0xMjAuNiw1MTkuMDg2OSBDMTIwLjYsNTQxLjgxNjkgMTIwLjYsNTQyLjQ3NjkgMTIwLjYsNTY5LjQyNjkiIGZpbGw9Im5vbmUiIGlkPSImIzIwMTgxOyYjMzUzNzk7JiMyNjEyNjsmIzMyMDQ4Oy0mIzIwMTgxOyYjMzUzNzk7JiMzNjAyNDsmIzIwNTExOyYjMjYxMjY7JiMzMjA0ODsiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTE2LjYiIHgyPSIxMjQuNiIgeTE9IjUxNS4wODY5IiB5Mj0iNTE1LjA4NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTE2LjYiIHgyPSIxMjQuNiIgeTE9IjUxOC4wODY5IiB5Mj0iNTE4LjA4NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwLjYiIHgyPSIxMjAuNiIgeTE9IjUxOS4wODY5IiB5Mj0iNTExLjA4NjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwLjYiIHgyPSIxMjYuNiIgeTE9IjU3OS40MjY5IiB5Mj0iNTg3LjQyNjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwLjYiIHgyPSIxMTQuNiIgeTE9IjU3OS40MjY5IiB5Mj0iNTg3LjQyNjkiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMTIwLjYiIHgyPSIxMjAuNiIgeTE9IjU3OS40MjY5IiB5Mj0iNTg3LjQyNjkiLz48ZWxsaXBzZSBjeD0iMTIwLjYiIGN5PSI1NzMuNDI2OSIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjEyMS42IiB5PSI1NTMuNzEzOCI+JiMyMTU0NzsmIzEyNDE2OzwvdGV4dD48L2c+PCEtLWxpbmsgPz8/Pz8/IHRvID8/Pz8/Pz8tLT48ZyBjbGFzcz0ibGluayIgZGF0YS1lbnRpdHktMT0iZW50MDAwNCIgZGF0YS1lbnRpdHktMj0iZW50MDAwNSIgZGF0YS1saW5rLXR5cGU9ImNyb3dmb290IiBkYXRhLXNvdXJjZS1saW5lPSI2MyIgaWQ9ImxuazkiPjxwYXRoIGNvZGVMaW5lPSI2MyIgZD0iTTk1Ljc5MjcsOTE0LjU3MTQgQzkxLjcwMjcsOTQyLjg0MTQgOTEuNDk0MSw5NDQuMjQ5MSA4OC40NzQxLDk2NS4xNDkxIiBmaWxsPSJub25lIiBpZD0iJiMyMDE4MTsmIzM1Mzc5OyYjMzYwMjQ7JiMyMDUxMTsmIzI2MTI2OyYjMzIwNDg7LSYjMjEyMDg7JiMyMzQ1MDsmIzMxMTg1OyYjMzA0NDY7JiMxMjUxMDsmIzEyNDczOyYjMTI0Nzk7IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheTo3LDc7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9Ijk3LjIyNDUiIHgyPSI5Mi40MzE4IiB5MT0iOTA0LjY3NDQiIHkyPSI4OTUuODk3OCIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5Ny4yMjQ1IiB4Mj0iMTA0LjMwODIiIHkxPSI5MDQuNjc0NCIgeTI9Ijg5Ny42MTYiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iOTcuMjI0NSIgeDI9Ijk4LjM3IiB5MT0iOTA0LjY3NDQiIHkyPSI4OTYuNzU2OSIvPjxlbGxpcHNlIGN4PSI5Ni4zNjU0IiBjeT0iOTEwLjYxMjYiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSI5MS44NjA5IiB4Mj0iODMuOTQzMiIgeTE9Ijk2OS42OCIgeTI9Ijk2OC41MzU5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjkyLjI5IiB4Mj0iODQuMzcyMiIgeTE9Ijk2Ni43MTA5IiB5Mj0iOTY1LjU2NjgiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iODguNDc0MSIgeDI9Ijg3LjMzIiB5MT0iOTY1LjE0OTEiIHkyPSI5NzMuMDY2OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSI5NC4xMyIgeT0iOTM5LjQ2MzgiPiYjMjE0NDI7JiMyOTAzMTs8L3RleHQ+PC9nPjwhLS1saW5rID8/Pz8/PyB0byA/Pz8/Py0tPjxnIGNsYXNzPSJsaW5rIiBkYXRhLWVudGl0eS0xPSJlbnQwMDA0IiBkYXRhLWVudGl0eS0yPSJlbnQwMDA2IiBkYXRhLWxpbmstdHlwZT0iY3Jvd2Zvb3QiIGRhdGEtc291cmNlLWxpbmU9IjY0IiBpZD0ibG5rMTAiPjxwYXRoIGNvZGVMaW5lPSI2NCIgZD0iTTE4MS42MDYsOTEzLjEzNTIgQzE4OC44MDYsOTI5LjIxNTIgMTg5LjI2LDkyOC42MjY5IDE5Ny42LDk0My4zOTY5IEMyMDMuMzEsOTUzLjQ4NjkgMjAxLjI5NjYsOTUxLjc0OTggMjA4LjQyNjYsOTYxLjExOTgiIGZpbGw9Im5vbmUiIGlkPSImIzIwMTgxOyYjMzUzNzk7JiMzNjAyNDsmIzIwNTExOyYjMjYxMjY7JiMzMjA0ODstJiMzNzA5NjsmIzM4MjcyOyYjMTI1MTA7JiMxMjQ3MzsmIzEyNDc5OyIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxO3N0cm9rZS1kYXNoYXJyYXk6Nyw3OyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNzcuNTE5MyIgeDI9IjE2OC43NzM5IiB5MT0iOTA0LjAwODQiIHkyPSI4OTkuMTU4OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNzcuNTE5MyIgeDI9IjE3OS43MjYxIiB5MT0iOTA0LjAwODQiIHkyPSI4OTQuMjU0OSIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIxNzcuNTE5MyIgeDI9IjE3NC4yNSIgeTE9IjkwNC4wMDg0IiB5Mj0iODk2LjcwNjkiLz48ZWxsaXBzZSBjeD0iMTc5Ljk3MTMiIGN5PSI5MDkuNDg0NSIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIxMC44NDg5IiB4Mj0iMjE3LjUxIiB5MT0iOTY0LjMwMzEiIHkyPSI5NzMuMDU2OSIvPjxlbGxpcHNlIGN4PSIyMTAuODQ4OSIgY3k9Ijk2NC4zMDMxIiBmaWxsPSJub25lIiByeD0iNCIgcnk9IjQiIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiLz48bGluZSBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7IiB4MT0iMjE4LjI3MSIgeDI9IjIxMS45MDQ2IiB5MT0iOTY3LjQ1MTQiIHkyPSI5NzIuMjk1OSIvPjx0ZXh0IGZpbGw9IiMwMDAwMDAiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBmb250LXNpemU9IjEzIiBsZW5ndGhBZGp1c3Q9InNwYWNpbmciIHRleHRMZW5ndGg9IjI2IiB4PSIxOTguNiIgeT0iOTM5LjQ2MzgiPiYjMjE0NDI7JiMyOTAzMTs8L3RleHQ+PC9nPjwhLS1saW5rID8/IHRvID8/Pz8/LS0+PGcgY2xhc3M9ImxpbmsiIGRhdGEtZW50aXR5LTE9ImVudDAwMDIiIGRhdGEtZW50aXR5LTI9ImVudDAwMDYiIGRhdGEtbGluay10eXBlPSJjcm93Zm9vdCIgZGF0YS1zb3VyY2UtbGluZT0iNjUiIGlkPSJsbmsxMSI+PHBhdGggY29kZUxpbmU9IjY1IiBkPSJNMjI0LjM5NzksMzIyLjIzMjkgQzIzMi4wMjc5LDUxNi4wODI5IDI0NC43ODAxLDgzOS40Mzg1IDI0OS40NTAxLDk1OC4wOTg1IiBmaWxsPSJub25lIiBpZD0iJiMyMDE4MTsmIzM1Mzc5Oy0mIzM3MDk2OyYjMzgyNzI7JiMxMjUxMDsmIzEyNDczOyYjMTI0Nzk7IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7c3Ryb2tlLWRhc2hhcnJheTo3LDc7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyNC4wMDQ2IiB4Mj0iMjE3LjY5NDYiIHkxPSIzMTIuMjQwNyIgeTI9IjMwNC40ODI5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyNC4wMDQ2IiB4Mj0iMjI5LjY4NTQiIHkxPSIzMTIuMjQwNyIgeTI9IjMwNC4wMTA5Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjIyNC4wMDQ2IiB4Mj0iMjIzLjY5IiB5MT0iMzEyLjI0MDciIHkyPSIzMDQuMjQ2OSIvPjxlbGxpcHNlIGN4PSIyMjQuMjQwNiIgY3k9IjMxOC4yMzYiIGZpbGw9Im5vbmUiIHJ4PSI0IiByeT0iNCIgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIvPjxsaW5lIHN0eWxlPSJzdHJva2U6IzE4MTgxODtzdHJva2Utd2lkdGg6MTsiIHgxPSIyNDkuNjA3NCIgeDI9IjI1MC4wNCIgeTE9Ijk2Mi4wOTU0IiB5Mj0iOTczLjA4NjkiLz48ZWxsaXBzZSBjeD0iMjQ5LjYwNzQiIGN5PSI5NjIuMDk1NCIgZmlsbD0ibm9uZSIgcng9IjQiIHJ5PSI0IiBzdHlsZT0ic3Ryb2tlOiMxODE4MTg7c3Ryb2tlLXdpZHRoOjE7Ii8+PGxpbmUgc3R5bGU9InN0cm9rZTojMTgxODE4O3N0cm9rZS13aWR0aDoxOyIgeDE9IjI1My44Nzk2IiB4Mj0iMjQ1Ljg4NTgiIHkxPSI5NjguOTMyNyIgeTI9Ijk2OS4yNDczIi8+PHRleHQgZmlsbD0iIzAwMDAwMCIgZm9udC1mYW1pbHk9InNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iMTMiIGxlbmd0aEFkanVzdD0ic3BhY2luZyIgdGV4dExlbmd0aD0iMjYiIHg9IjIzNC41OCIgeT0iNTUzLjcxMzgiPiYjMjE0NDI7JiMyOTAzMTs8L3RleHQ+PC9nPjw/cGxhbnR1bWwtc3JjIGZMRkJKaTkwNUR0RkxwSWtmSHpXWTNsVGszNy0wbWlJOG5pc25mQldKODJBRjRKM0d1ZUk4YVdISFVJWDIzdS1QZlg3X3lBMTVqaEk0NkZTcFJkdGRGaXVsR3E3bXVTMVFKaDlTeHNGS0hvWjN1bUE2Qk1iZEdFWXpHNDg3OE0zdU1FQjg5cTB5cDd6azY0RGRVS1ZJRlBEeWxsdHp4UXRXU3k3LUYxRFg2Y24wS1lpR1BCUXg0TFZuZ25KTjNKOE96SjJpMGo4a2FISnBwUHNiWU1mQ0w3Wlc3SkFqNUJia1plVDlNcVlndC1IZ25nNl9WY2FQeTEwa2I2OHNmV0Z3d0FBcEhWT2M1bXd2bU5KcG1mTEJ5SGl6MWUyZ1dyZWVNazFvQ2ctajlIWFcteHdoSlR0UHVrUklMdkJVVnNlZk1Za25FekZfejJKenFPYU1sck52c05PaDZOd3dIWUJkOVU0a1FvUE9yZmR3UHA4cHNsb2ttZjlqYlFJZ3BPbG8xV0xDTmgyUzhIWDRxRm5GTExST2F2WDk3OTZCR3NDUTlkdFQzbDl1OVhndG5XenBoNEFJN05DOW9FUXJQUXRPV2RmZ3lmeDR3UGRoQWpPT2ZQOXM0MVNZSDBrQTlOZ3hGMWFNTlFPd3plUHRNQnVaazZ0eTdVVDVta2x0NUtpNm5ud2hwNGhJa2xGS0hJVkJ0SllsZ2lqUU9EU2ozNkNSVzFOdENMcnRPRDd1U2Y2R2hBaUE2ak1kS2NwYUNNUVF3S1huUkVWSF9HeHlHUzA/PjwvZz48L3N2Zz4=" class="uml" alt="uml diagram" title="" /></p>
<h3 id="_25">設計のポイント<a class="headerlink" href="#_25" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>3階層構造</strong>: 仕訳 → 仕訳明細 → 仕訳貸借明細の親子関係</li>
<li><strong>複式簿記の原則</strong>: 借方合計 = 貸方合計の貸借一致チェック</li>
<li><strong>単一仕訳と複合仕訳</strong>: 単振フラグで区別</li>
<li><strong>赤黒処理対応</strong>: 赤伝フラグと赤黒伝票番号で訂正履歴を管理</li>
<li><strong>多通貨対応</strong>: 通貨コード、為替レート、基軸換算金額</li>
<li><strong>消費税対応</strong>: 消費税区分、消費税率、消費税計算区分</li>
<li><strong>管理会計対応</strong>: 部門コード、プロジェクトコード、セグメントコード</li>
</ol>
<h3 id="_26">ドメインロジック<a class="headerlink" href="#_26" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>メソッド</th>
<th>説明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>isBalanced()</code></td>
<td>借方合計と貸方合計が一致するかチェック</td>
</tr>
<tr>
<td><code>getDebitTotal()</code></td>
<td>借方合計を取得</td>
</tr>
<tr>
<td><code>getCreditTotal()</code></td>
<td>貸方合計を取得</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="_27">次章の予告<a class="headerlink" href="#_27" title="Permanent link">&para;</a></h2>
<p>第17章では、自動仕訳の設計に進みます。販売管理システムと会計システムの連携、自動仕訳パターンマスタの設計、売上伝票から仕訳伝票への転記ロジックを TDD で実装していきます。</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
    <a href="https://github.com/k2works/practical-database-design" target="_blank" rel="noopener" title="GitHub Repository" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "search.suggest", "search.highlight"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
      
        <script src="../../../docs/assets/js/extra.js"></script>
      
    
  </body>
</html>